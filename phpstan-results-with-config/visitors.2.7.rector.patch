diff --git a/src/Controller/Report/Cities.php b/src/Controller/Report/Cities.php
index 04ba762..9cfa429 100644
--- a/src/Controller/Report/Cities.php
+++ b/src/Controller/Report/Cities.php
@@ -20,14 +20,14 @@ class Cities extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -44,10 +44,10 @@ class Cities extends ControllerBase {
   /**
    * Constructs a Cities object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -149,7 +149,7 @@ class Cities extends ControllerBase {
       $visitors_city_link = $visitors_city_link->toRenderable();
       $rows[] = array(
         ++$i,
-        render($visitors_city_link),
+        \Drupal::service('renderer')->render($visitors_city_link),
         $data->visitors_city,
         $data->count
       );
diff --git a/src/Controller/Report/CityHits.php b/src/Controller/Report/CityHits.php
index ab48775..ec846b5 100644
--- a/src/Controller/Report/CityHits.php
+++ b/src/Controller/Report/CityHits.php
@@ -19,14 +19,14 @@ class CityHits extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -43,10 +43,10 @@ class CityHits extends ControllerBase {
   /**
    * Constructs a CityHits object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
diff --git a/src/Controller/Report/Countries.php b/src/Controller/Report/Countries.php
index c24766e..d5e7a11 100644
--- a/src/Controller/Report/Countries.php
+++ b/src/Controller/Report/Countries.php
@@ -19,14 +19,14 @@ class Countries extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -43,10 +43,10 @@ class Countries extends ControllerBase {
   /**
    * Constructs a Countries object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -144,7 +144,7 @@ class Countries extends ControllerBase {
       $visitors_country_link = $visitors_country_link->toRenderable();
       $rows[] = array(
         ++$i,
-        render($visitors_country_link),
+        \Drupal::service('renderer')->render($visitors_country_link),
         $data->count
       );
     }
diff --git a/src/Controller/Report/DaysOfMonth.php b/src/Controller/Report/DaysOfMonth.php
index 5b216af..32d51c0 100644
--- a/src/Controller/Report/DaysOfMonth.php
+++ b/src/Controller/Report/DaysOfMonth.php
@@ -17,14 +17,14 @@ class DaysOfMonth extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -41,10 +41,10 @@ class DaysOfMonth extends ControllerBase {
   /**
    * Constructs a DaysOfMonth object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -78,7 +78,7 @@ class DaysOfMonth extends ControllerBase {
       'visitors_date_filter_form' => $form,
       'visitors_jqplot' => array(
         '#theme'  => 'visitors_jqplot',
-        '#path'   => drupal_get_path('module', 'visitors'),
+        '#path'   => \Drupal::service('extension.list.module')->getPath('visitors'),
         '#x'      => implode(', ', range(1, 31)),
         '#y'      => implode(', ', $y),
         '#width'  => $config->get('chart_width'),
diff --git a/src/Controller/Report/DaysOfWeek.php b/src/Controller/Report/DaysOfWeek.php
index 713641b..62a674b 100644
--- a/src/Controller/Report/DaysOfWeek.php
+++ b/src/Controller/Report/DaysOfWeek.php
@@ -18,14 +18,14 @@ class DaysOfWeek extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -42,10 +42,10 @@ class DaysOfWeek extends ControllerBase {
   /**
    * Constructs a DaysOfWeek object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -83,7 +83,7 @@ class DaysOfWeek extends ControllerBase {
       'visitors_date_filter_form' => $form,
       'visitors_jqplot' => array(
         '#theme'  => 'visitors_jqplot',
-        '#path'   => drupal_get_path('module', 'visitors'),
+        '#path'   => \Drupal::service('extension.list.module')->getPath('visitors'),
         '#x'      => implode(', ', $x),
         '#y'      => implode(', ', $y),
         '#width'  => $config->get('chart_width'),
diff --git a/src/Controller/Report/HitDetails.php b/src/Controller/Report/HitDetails.php
index 33d9dbc..a8fce61 100644
--- a/src/Controller/Report/HitDetails.php
+++ b/src/Controller/Report/HitDetails.php
@@ -19,7 +19,7 @@ class HitDetails extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
@@ -33,7 +33,7 @@ class HitDetails extends ControllerBase {
   /**
    * Constructs a HitDetails object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    */
   public function __construct(DateFormatterInterface $date_formatter) {
diff --git a/src/Controller/Report/Hits.php b/src/Controller/Report/Hits.php
index 82de012..6ffd22e 100644
--- a/src/Controller/Report/Hits.php
+++ b/src/Controller/Report/Hits.php
@@ -20,14 +20,14 @@ class Hits extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -44,10 +44,10 @@ class Hits extends ControllerBase {
   /**
    * Constructs a Hits object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -192,8 +192,8 @@ class Hits extends ControllerBase {
         $data->visitors_id,
         $this->date->format($data->visitors_date_time, 'short'),
               Html::escape($data->visitors_title) . " - ". $data->visitors_url,
-        render($user_profile_link),
-        render($visitors_host_link)
+        \Drupal::service('renderer')->render($user_profile_link),
+        \Drupal::service('renderer')->render($visitors_host_link)
       );
     }
 
diff --git a/src/Controller/Report/Hosts.php b/src/Controller/Report/Hosts.php
index 8e37405..2199f0c 100644
--- a/src/Controller/Report/Hosts.php
+++ b/src/Controller/Report/Hosts.php
@@ -20,14 +20,14 @@ class Hosts extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -44,10 +44,10 @@ class Hosts extends ControllerBase {
   /**
    * Constructs a Hosts object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -157,7 +157,7 @@ class Hosts extends ControllerBase {
         //$whois_enable ? l($ip, 'whois/' . $ip, $attr) : check_plain($ip),
         $ip,
         $data->count,
-        render($visitors_host_link)
+        \Drupal::service('renderer')->render($visitors_host_link)
       );
     }
 
diff --git a/src/Controller/Report/Hours.php b/src/Controller/Report/Hours.php
index 2ed3a20..8c3e143 100644
--- a/src/Controller/Report/Hours.php
+++ b/src/Controller/Report/Hours.php
@@ -17,14 +17,14 @@ class Hours extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -41,10 +41,10 @@ class Hours extends ControllerBase {
   /**
    * Constructs a Hours object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -78,7 +78,7 @@ class Hours extends ControllerBase {
       'visitors_date_filter_form' => $form,
       'visitors_jqplot' => array(
         '#theme'  => 'visitors_jqplot',
-        '#path'   => drupal_get_path('module', 'visitors'),
+        '#path'   => \Drupal::service('extension.list.module')->getPath('visitors'),
         '#x'      => implode(', ', range(0, 23)),
         '#y'      => implode(', ', $y),
         '#width'  => $config->get('chart_width'),
diff --git a/src/Controller/Report/MonthlyHistory.php b/src/Controller/Report/MonthlyHistory.php
index 39e5bf0..9f066cd 100644
--- a/src/Controller/Report/MonthlyHistory.php
+++ b/src/Controller/Report/MonthlyHistory.php
@@ -17,14 +17,14 @@ class MonthlyHistory extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -41,10 +41,10 @@ class MonthlyHistory extends ControllerBase {
   /**
    * Constructs a MonthlyHistory object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
@@ -75,7 +75,7 @@ class MonthlyHistory extends ControllerBase {
       'visitors_date_filter_form' => $form,
       'visitors_jqplot' => array(
         '#theme'  => 'visitors_jqplot',
-        '#path'   => drupal_get_path('module', 'visitors'),
+        '#path'   => \Drupal::service('extension.list.module')->getPath('visitors'),
         '#x'      => implode(', ', $x),
         '#y'      => implode(', ', $y),
         '#width'  => $config->get('chart_width'),
diff --git a/src/Controller/Report/Node.php b/src/Controller/Report/Node.php
index 9ca3089..f5d3fea 100644
--- a/src/Controller/Report/Node.php
+++ b/src/Controller/Report/Node.php
@@ -21,14 +21,14 @@ class Node extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -45,10 +45,10 @@ class Node extends ControllerBase {
   /**
    * Constructs a Node object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
diff --git a/src/Controller/Report/RecentHits.php b/src/Controller/Report/RecentHits.php
index ecadb67..5c2ebb4 100644
--- a/src/Controller/Report/RecentHits.php
+++ b/src/Controller/Report/RecentHits.php
@@ -19,14 +19,14 @@ class RecentHits extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -43,10 +43,10 @@ class RecentHits extends ControllerBase {
   /**
    * Constructs a RecentHits object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
diff --git a/src/Controller/Report/Referers.php b/src/Controller/Report/Referers.php
index 553a1cc..4f70a52 100644
--- a/src/Controller/Report/Referers.php
+++ b/src/Controller/Report/Referers.php
@@ -24,14 +24,14 @@ class Referers extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -48,10 +48,10 @@ class Referers extends ControllerBase {
   /**
    * Constructs a Referers object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
diff --git a/src/Controller/Report/TopPages.php b/src/Controller/Report/TopPages.php
index b8eb8d4..0110ac6 100644
--- a/src/Controller/Report/TopPages.php
+++ b/src/Controller/Report/TopPages.php
@@ -17,14 +17,14 @@ class TopPages extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -41,10 +41,10 @@ class TopPages extends ControllerBase {
   /**
    * Constructs a TopPages object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
diff --git a/src/Controller/Report/UserActivity.php b/src/Controller/Report/UserActivity.php
index bb24968..f517973 100644
--- a/src/Controller/Report/UserActivity.php
+++ b/src/Controller/Report/UserActivity.php
@@ -17,14 +17,14 @@ class UserActivity extends ControllerBase {
   /**
    * The date service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $date;
 
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
@@ -41,10 +41,10 @@ class UserActivity extends ControllerBase {
   /**
    * Constructs a UserActivity object.
    *
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date
+   * @param DateFormatterInterface $date
    *   The date service.
    *
-   * @param \Drupal\Core\Form\FormBuilderInterface $form_builder
+   * @param FormBuilderInterface $form_builder
    *   The form builder service.
    */
   public function __construct(DateFormatterInterface $date_formatter, FormBuilderInterface $form_builder) {
diff --git a/src/EventSubscriber/KernelTerminateSubscriber.php b/src/EventSubscriber/KernelTerminateSubscriber.php
index 0f51294..d12ed26 100644
--- a/src/EventSubscriber/KernelTerminateSubscriber.php
+++ b/src/EventSubscriber/KernelTerminateSubscriber.php
@@ -7,12 +7,12 @@
 
 namespace Drupal\visitors\EventSubscriber;
 
+use Symfony\Component\HttpKernel\Event\TerminateEvent;
 use Drupal;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\CronInterface;
 use Drupal\Core\State\StateInterface;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
-use Symfony\Component\HttpKernel\Event\PostResponseEvent;
 use Symfony\Component\HttpKernel\KernelEvents;
 use Symfony\Cmf\Component\Routing\RouteObjectInterface;
 use Symfony\Component\HttpFoundation\Request;
@@ -33,10 +33,10 @@ class KernelTerminateSubscriber implements EventSubscriberInterface {
   /**
    * Store visitors data when a request terminates.
    *
-   * @param Symfony\Component\HttpKernel\Event\PostResponseEvent $event
+   * @param TerminateEvent $event
    *   The Event to process.
    */
-  public function onTerminate(PostResponseEvent $event) {
+  public function onTerminate(TerminateEvent $event) {
     $this->request = $event->getRequest();
 
     $user = \Drupal::currentUser();

diff --git a/modules/file_downoad_link_media/src/Plugin/Field/FieldFormatter/FileDownloadLinkMedia.php b/modules/file_downoad_link_media/src/Plugin/Field/FieldFormatter/FileDownloadLinkMedia.php
index 7dfe556..e6c490c 100644
--- a/modules/file_downoad_link_media/src/Plugin/Field/FieldFormatter/FileDownloadLinkMedia.php
+++ b/modules/file_downoad_link_media/src/Plugin/Field/FieldFormatter/FileDownloadLinkMedia.php
@@ -28,7 +28,7 @@ class FileDownloadLinkMedia extends EntityReferenceFormatterBase implements Cont
   /**
    * Module handler service.
    *
-   * @var \Drupal\Core\Extension\ModuleHandler
+   * @var ModuleHandler
    */
   protected $moduleHandler;
 
@@ -46,7 +46,7 @@ class FileDownloadLinkMedia extends EntityReferenceFormatterBase implements Cont
    *   The plugin_id for the formatter.
    * @param mixed $plugin_definition
    *   The plugin implementation definition.
-   * @param \Drupal\Core\Field\FieldDefinitionInterface $field_definition
+   * @param FieldDefinitionInterface $field_definition
    *   The definition of the field to which the formatter is associated.
    * @param array $settings
    *   The formatter settings.
@@ -56,7 +56,7 @@ class FileDownloadLinkMedia extends EntityReferenceFormatterBase implements Cont
    *   The view mode.
    * @param array $third_party_settings
    *   Any third party settings.
-   * @param \Drupal\Core\Extension\ModuleHandler $module_handler
+   * @param ModuleHandler $module_handler
    *   Module handler service.
    * @param \Drupal\token\TokenEntityMapper|null $token_entity_mapper
    *   Token entity mapper if token module is installed. Otherwise NULL.
diff --git a/src/Plugin/Field/FieldFormatter/FileDownloadLink.php b/src/Plugin/Field/FieldFormatter/FileDownloadLink.php
index a27f48f..372c0fb 100644
--- a/src/Plugin/Field/FieldFormatter/FileDownloadLink.php
+++ b/src/Plugin/Field/FieldFormatter/FileDownloadLink.php
@@ -31,14 +31,14 @@ class FileDownloadLink extends FileFormatterBase implements ContainerFactoryPlug
   /**
    * Token service.
    *
-   * @var \Drupal\Core\Utility\Token
+   * @var Token
    */
   protected $token;
 
   /**
    * Module handler service.
    *
-   * @var \Drupal\Core\Extension\ModuleHandler
+   * @var ModuleHandler
    */
   protected $moduleHandler;
 
@@ -56,7 +56,7 @@ class FileDownloadLink extends FileFormatterBase implements ContainerFactoryPlug
    *   The plugin_id for the formatter.
    * @param mixed $plugin_definition
    *   The plugin implementation definition.
-   * @param \Drupal\Core\Field\FieldDefinitionInterface $field_definition
+   * @param FieldDefinitionInterface $field_definition
    *   The definition of the field to which the formatter is associated.
    * @param array $settings
    *   The formatter settings.
@@ -66,9 +66,9 @@ class FileDownloadLink extends FileFormatterBase implements ContainerFactoryPlug
    *   The view mode.
    * @param array $third_party_settings
    *   Any third party settings.
-   * @param \Drupal\Core\Utility\Token $token
+   * @param Token $token
    *   Token service.
-   * @param \Drupal\Core\Extension\ModuleHandler $module_handler
+   * @param ModuleHandler $module_handler
    *   Module handler service.
    * @param \Drupal\token\TokenEntityMapper|null $token_entity_mapper
    *   Token entity mapper if token module is installed. Otherwise NULL.
@@ -266,7 +266,7 @@ class FileDownloadLink extends FileFormatterBase implements ContainerFactoryPlug
       $elements[$delta] = [
         '#type' => 'link',
         '#title' => $this->getSetting('link_text'),
-        '#url' => Url::fromUri(file_create_url($file->getFileUri())),
+        '#url' => \Drupal::service('file_url_generator')->generate($file->getFileUri()),
         '#options' => $options,
         '#cache' => [
           'tags' => $file->getCacheTags(),
diff --git a/tests/src/Kernel/FileDownloadLinkMediaApplicableTest.php b/tests/src/Kernel/FileDownloadLinkMediaApplicableTest.php
index 8317f67..08da99e 100644
--- a/tests/src/Kernel/FileDownloadLinkMediaApplicableTest.php
+++ b/tests/src/Kernel/FileDownloadLinkMediaApplicableTest.php
@@ -24,7 +24,7 @@ class FileDownloadLinkMediaApplicableTest extends KernelTestBase {
   /**
    * A test node.
    *
-   * @var Drupal\node\Entity\Node
+   * @var Node
    */
   public $node;
 
@@ -48,7 +48,7 @@ class FileDownloadLinkMediaApplicableTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installConfig(['system', 'field']);
     $this->installSchema('user', ['users_data']);
@@ -113,7 +113,7 @@ class FileDownloadLinkMediaApplicableTest extends KernelTestBase {
    * This node has several media fields to test with, though no media
    * items are actually created.
    *
-   * @return Drupal\node\Entity\Node
+   * @return Node
    *   An node to be used for testing.
    */
   protected function createTestNode() {
diff --git a/tests/src/Kernel/FileDownloadLinkMediaTest.php b/tests/src/Kernel/FileDownloadLinkMediaTest.php
index 2b701b2..0329448 100644
--- a/tests/src/Kernel/FileDownloadLinkMediaTest.php
+++ b/tests/src/Kernel/FileDownloadLinkMediaTest.php
@@ -37,7 +37,7 @@ class FileDownloadLinkMediaTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installConfig(['system', 'field']);
     $this->installSchema('file', ['file_usage']);
@@ -65,7 +65,7 @@ class FileDownloadLinkMediaTest extends KernelTestBase {
     $expected_deep_render = [
       '#type' => 'link',
       '#title' => 'Download',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -119,7 +119,7 @@ class FileDownloadLinkMediaTest extends KernelTestBase {
     $expected_deep_render = [
       '#type' => 'link',
       '#title' => 'file.txt',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
diff --git a/tests/src/Kernel/FileDownloadLinkMediaTestTrait.php b/tests/src/Kernel/FileDownloadLinkMediaTestTrait.php
index 79f44b0..f3cc98a 100644
--- a/tests/src/Kernel/FileDownloadLinkMediaTestTrait.php
+++ b/tests/src/Kernel/FileDownloadLinkMediaTestTrait.php
@@ -22,21 +22,21 @@ trait FileDownloadLinkMediaTestTrait {
   /**
    * A test node.
    *
-   * @var Drupal\node\Entity\Node
+   * @var Node
    */
   public $node;
 
   /**
    * A test media.
    *
-   * @var Drupal\media\Entity\Media
+   * @var Media
    */
   public $media;
 
   /**
    * Helper function to create media that can be used for testing.
    *
-   * @return Drupal\media\Entity\Media
+   * @return Media
    *   A media to be used for testing.
    */
   protected function createTestMedia() {
@@ -58,7 +58,7 @@ trait FileDownloadLinkMediaTestTrait {
   /**
    * Helper function to create node that can be used for testing.
    *
-   * @return Drupal\node\Entity\Node
+   * @return Node
    *   An node to be used for testing.
    */
   protected function createTestNode() {
diff --git a/tests/src/Kernel/FileDownloadLinkMediaTokenTest.php b/tests/src/Kernel/FileDownloadLinkMediaTokenTest.php
index 0f033db..1a0d04d 100644
--- a/tests/src/Kernel/FileDownloadLinkMediaTokenTest.php
+++ b/tests/src/Kernel/FileDownloadLinkMediaTokenTest.php
@@ -39,7 +39,7 @@ class FileDownloadLinkMediaTokenTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installConfig(['system', 'field']);
     $this->installSchema('file', ['file_usage']);
@@ -73,7 +73,7 @@ class FileDownloadLinkMediaTokenTest extends KernelTestBase {
     $expected_deep_render = [
       '#type' => 'link',
       '#title' => 'Test Media (txt)',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -124,7 +124,7 @@ class FileDownloadLinkMediaTokenTest extends KernelTestBase {
     $expected_deep_render = [
       '#type' => 'link',
       '#title' => 'Download Media Now!',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -177,7 +177,7 @@ class FileDownloadLinkMediaTokenTest extends KernelTestBase {
     $expected_deep_render = [
       '#type' => 'link',
       '#title' => 'Download Media Now!',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
diff --git a/tests/src/Kernel/FileDownloadLinkTest.php b/tests/src/Kernel/FileDownloadLinkTest.php
index 38ca20f..65ad180 100644
--- a/tests/src/Kernel/FileDownloadLinkTest.php
+++ b/tests/src/Kernel/FileDownloadLinkTest.php
@@ -33,7 +33,7 @@ class FileDownloadLinkTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installConfig(['system', 'field']);
     $this->installSchema('file', ['file_usage']);
@@ -57,7 +57,7 @@ class FileDownloadLinkTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'Download',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -99,7 +99,7 @@ class FileDownloadLinkTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'file.txt',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -134,7 +134,7 @@ class FileDownloadLinkTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'Download',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -176,7 +176,7 @@ class FileDownloadLinkTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'file.png',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
diff --git a/tests/src/Kernel/FileDownloadLinkTestTrait.php b/tests/src/Kernel/FileDownloadLinkTestTrait.php
index 835a5bb..a528551 100644
--- a/tests/src/Kernel/FileDownloadLinkTestTrait.php
+++ b/tests/src/Kernel/FileDownloadLinkTestTrait.php
@@ -18,14 +18,14 @@ trait FileDownloadLinkTestTrait {
   /**
    * A test entity.
    *
-   * @var Drupal\node\Entity\Node
+   * @var Node
    */
   public $entity;
 
   /**
    * Helper function to create entity that can be used for testing.
    *
-   * @return Drupal\node\Entity\Node
+   * @return Node
    *   An entity to be used for testing.
    */
   protected function createTestEntity() {
@@ -58,7 +58,7 @@ trait FileDownloadLinkTestTrait {
     ]);
     $instance->save();
 
-    $image_path = drupal_get_path('theme', 'stable') . '/images/core/druplicon.png';
+    $image_path = \Drupal::service('extension.list.theme')->getPath('stable') . '/images/core/druplicon.png';
     file_put_contents('public://file.png', file_get_contents($image_path));
     $file_image = File::create([
       'uri' => 'public://file.png',
diff --git a/tests/src/Kernel/FileDownloadLinkTokenTest.php b/tests/src/Kernel/FileDownloadLinkTokenTest.php
index 85f6fcc..4fd7c09 100644
--- a/tests/src/Kernel/FileDownloadLinkTokenTest.php
+++ b/tests/src/Kernel/FileDownloadLinkTokenTest.php
@@ -37,7 +37,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installConfig(['system', 'field']);
     $this->installSchema('file', ['file_usage']);
@@ -68,7 +68,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'The extension is txt',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -107,7 +107,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'The image width is 88',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -146,7 +146,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'The extension is png',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -186,7 +186,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'Testing tokens in title',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -227,7 +227,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'Testing tokens in classes',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -268,7 +268,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_delta_0 = [
       '#type' => 'link',
       '#title' => 'This alt text is for the first image.',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -288,7 +288,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_delta_1 = [
       '#type' => 'link',
       '#title' => "When delta is 1 we should see this alt text. Let's add special chars & test them!",
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -332,7 +332,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'file.txt',
-      '#url' => Url::fromUri(file_create_url('public://file.txt')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.txt'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -372,7 +372,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'Download this, 99',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [
@@ -406,7 +406,7 @@ class FileDownloadLinkTokenTest extends KernelTestBase {
     $expected_render = [
       '#type' => 'link',
       '#title' => 'Download',
-      '#url' => Url::fromUri(file_create_url('public://file.png')),
+      '#url' => \Drupal::service('file_url_generator')->generate('public://file.png'),
       '#options' => [
         'attributes' => [
           'class' => [

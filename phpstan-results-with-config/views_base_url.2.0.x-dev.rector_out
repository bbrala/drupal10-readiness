modules/contrib/views_base_url/src/Plugin/views/field/BaseUrl.php
modules/contrib/views_base_url/tests/src/Functional/ViewsBaseUrlFieldTest.php
modules/contrib/views_base_url/views_base_url.views.inc

2 files with changes
====================

1) modules/contrib/views_base_url/tests/src/Functional/ViewsBaseUrlFieldTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\views_base_url\Functional;

+use Drupal\user\UserInterface;
+use Drupal\path_alias\PathAliasStorage;
+use Drupal\path_alias\AliasManager;
+use Drupal\Core\File\FileSystemInterface;
 use Drupal\Component\Utility\Random;
 use Drupal\Core\Url;
 use Drupal\Tests\BrowserTestBase;
@@ @@
   /**
    * A user with various administrative privileges.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $adminUser;

@@ @@
   /**
    * Path alias storage.
    *
-   * @var \Drupal\path_alias\PathAliasStorage
+   * @var PathAliasStorage
    */
   protected $pathAliasStorage;

@@ @@
   /**
    * Path alias manager.
    *
-   * @var \Drupal\path_alias\AliasManager
+   * @var AliasManager
    */
   protected $pathAliasManager;

@@ @@
   /**
    * Definition of File System Interface.
    *
-   * @var \Drupal\Core\File\FileSystemInterface
+   * @var FileSystemInterface
    */
   protected $fileSystem;

@@ @@
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();

     $this->adminUser = $this->drupalCreateUser([
@@ @@
     ]);
     $random = new Random();

-    /** @var \Drupal\path_alias\PathAliasStorage $pathAliasStorage */
+    /** @var PathAliasStorage $pathAliasStorage */
     $this->pathAliasStorage = $this->container->get('entity_type.manager')->getStorage('path_alias');
-    /** @var \Drupal\path_alias\AliasManager $pathAliasManager */
+    /** @var AliasManager $pathAliasManager */
     $this->pathAliasManager = $this->container->get('path_alias.manager');
-    /** @var \Drupal\Core\File\FileSystemInterface $fileSystem */;
+    /** @var FileSystemInterface $fileSystem */
+    ;
     $this->fileSystem = $this->container->get('file_system');
     // Create $this->nodeCount nodes.
     $this->drupalLogin($this->adminUser);
@@ @@
         'title[0][value]' => $title,
         'files[field_image_0]' => $this->fileSystem->realpath($image->uri),
       ];
-      $this->drupalPostForm('node/add/article', $edit, t('Save'));
-      $this->drupalPostForm(NULL, ['field_image[0][alt]' => $title], t('Save'));
+      $this->drupalGet('node/add/article');
+      $this->submitForm($edit, t('Save'));
+      $this->submitForm(['field_image[0][alt]' => $title], t('Save'));

       $this->nodes[$i] = $this->drupalGetNodeByTitle($title);
       $path_alias = $this->pathAliasStorage->create([
@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-link-no-settings-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-link-no-settings-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
       ':path' => $link_path,
       ':text' => $link_text,
     ]);
-    $this->assertEqual(count($elements), $this->nodeCount, 'Views base url rendered as link with no settings set');
+    $this->assertEquals(count($elements), $this->nodeCount, 'Views base url rendered as link with no settings set');
   }

   /**
@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-nolink-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-no-link-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
     $elements = $this->xpath('//div[contains(@class,"views-field-base-url")]/span[@class="field-content" and text()=:value]', [
       ':value' => $base_url,
     ]);
-    $this->assertEqual(count($elements), $this->nodeCount, t('Base url is displayed @count times', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('Base url is displayed @count times', [
       '@count' => $this->nodeCount,
     ]));
   }
@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-link-all-settings-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-link-all-settings-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
         ':target' => $link_target,
         ':text' => $link_text,
       ]);
-      $this->assertEqual(count($elements), 1, 'Views base url rendered as link with all settings');
+      $this->assertEquals(count($elements), 1, 'Views base url rendered as link with all settings');
     }
   }

@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-link-link-path-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-link-link-path-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
         ':path' => $link_path,
         ':text' => $link_text,
       ]);
-      $this->assertEqual(count($elements), 1, 'Views base url rendered as link with link path set');
+      $this->assertEquals(count($elements), 1, 'Views base url rendered as link with link path set');
     }
   }

@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-link-link-text-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-link-link-text-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
         ':path' => $link_path,
         ':text' => $link_text,
       ]);
-      $this->assertEqual(count($elements), 1, 'Views base url rendered as link with link text set');
+      $this->assertEquals(count($elements), 1, 'Views base url rendered as link with link text set');
     }
   }

@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-link-link-query-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-link-link-query-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
       ])->toUriString(),
       ':text' => $link_text,
     ]);
-    $this->assertEqual(count($elements), $this->nodeCount, 'Views base url rendered as link with link query set');
+    $this->assertEquals(count($elements), $this->nodeCount, 'Views base url rendered as link with link query set');
   }

   /**
@@ @@
     global $base_url;

     $this->drupalGet('views-base-url-image-test');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     $elements = $this->xpath('//div[contains(@class,"view-views-base-url-image-test")]/div[@class="view-content"]/div[contains(@class,"views-row")]');
-    $this->assertEqual(count($elements), $this->nodeCount, t('There are @count rows', [
+    $this->assertEquals(count($elements), $this->nodeCount, t('There are @count rows', [
       '@count' => $this->nodeCount,
     ]));

@@ @@
       $field = $node->get('field_image');
       $value = $field->getValue();

-      $image_uri = file_url_transform_relative(file_create_url($field->entity->getFileUri()));
+      $image_uri = \Drupal::service('file_url_generator')->generateString($field->entity->getFileUri());
       $image_alt = $value[0]['alt'];
       $image_width = $value[0]['width'];
       $image_height = $value[0]['height'];
@@ @@
         ':height' => $image_height,
         ':alt' => $image_alt,
       ]);
-      $this->assertEqual(count($elements), 1, 'Views base url rendered as link image');
+      $this->assertEquals(count($elements), 1, 'Views base url rendered as link image');
     }
   }
    ----------- end diff -----------

Applied rules:
 * AssertEqualRector
 * AssertResponseRector
 * FileUrlTransformRelativeRector
 * UiHelperTraitDrupalPostFormRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/views_base_url/src/Plugin/views/field/BaseUrl.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\views_base_url\Plugin\views\field;

+use Drupal\path_alias\AliasManager;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\path_alias\AliasManagerInterface;
 use Drupal\views\Plugin\views\field\FieldPluginBase;
@@ @@
   /**
    * Definition of path alias manager.
    *
-   * @var \Drupal\path_alias\AliasManager
+   * @var AliasManager
    */
   protected $pathAliasManager;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


 [OK] 2 files have been changed by Rector                                       


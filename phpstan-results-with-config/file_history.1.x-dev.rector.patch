diff --git a/file_history.info.yml b/file_history.info.yml
index c5d8946..8c1d07e 100644
--- a/file_history.info.yml
+++ b/file_history.info.yml
@@ -1,7 +1,7 @@
 name: File History
 type: module
 description: A upload/selector file form_API field_type to manage history of a configuration file
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: Form_API
 dependencies:
   - drupal:file
diff --git a/src/Controller/FileHistoryController.php b/src/Controller/FileHistoryController.php
index f17762d..609c776 100644
--- a/src/Controller/FileHistoryController.php
+++ b/src/Controller/FileHistoryController.php
@@ -17,7 +17,7 @@ class FileHistoryController extends ControllerBase {
   /**
    * File system.
    *
-   * @var \Drupal\Core\File\FileSystem
+   * @var FileSystem
    */
   private $fileSystemService;
 
@@ -33,7 +33,7 @@ class FileHistoryController extends ControllerBase {
    */
   public static function create(ContainerInterface $container) {
 
-    /** @var \Drupal\Core\File\FileSystem $file_system_service */
+    /** @var FileSystem $file_system_service */
     $file_system_service = $container->get('file_system');
 
     return new static($file_system_service);
@@ -42,10 +42,10 @@ class FileHistoryController extends ControllerBase {
   /**
    * Download non public files.
    *
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    *   File object.
    *
-   * @return \Symfony\Component\HttpFoundation\Response
+   * @return Response
    *   File content
    */
   public function downloadFile(FileInterface $file) {
diff --git a/src/Element/FileHistory.php b/src/Element/FileHistory.php
index 6fa71ca..4489ca8 100644
--- a/src/Element/FileHistory.php
+++ b/src/Element/FileHistory.php
@@ -2,6 +2,10 @@
 
 namespace Drupal\file_history\Element;
 
+use Drupal\Core\Render\RendererInterface;
+use Drupal\file\FileInterface;
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Symfony\Component\HttpFoundation\File\UploadedFile;
 use Drupal\Component\Utility\NestedArray;
 use Drupal\Core\Ajax\AjaxResponse;
 use Drupal\Core\Ajax\ReplaceCommand;
@@ -98,16 +102,16 @@ class FileHistory extends FormElement {
    *
    * @param mixed $form
    *   The build form.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The form state.
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The current request.
    *
-   * @return \Drupal\Core\Ajax\AjaxResponse
+   * @return AjaxResponse
    *   The ajax response of the ajax upload.
    */
   public static function uploadAjaxCallback(&$form, FormStateInterface &$form_state, Request $request) {
-    /** @var \Drupal\Core\Render\RendererInterface $renderer */
+    /** @var RendererInterface $renderer */
     $renderer = \Drupal::service('renderer');
 
     $form_parents = explode('/', $request->query->get('element_parents'));
@@ -417,10 +421,10 @@ class FileHistory extends FormElement {
    * @param string $uri
    *   Uri of file.
    *
-   * @return \Drupal\file\FileInterface|null
+   * @return FileInterface|null
    *   returns a file given the uri.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
+   * @throws InvalidPluginDefinitionException
    */
   public static function getFileFromUri($uri) {
     $files = \Drupal::entityTypeManager()->getStorage('file')->loadByProperties(['uri' => $uri]);
@@ -434,10 +438,10 @@ class FileHistory extends FormElement {
   /**
    * Generate Download URL.
    *
-   * @param \Drupal\file\Entity\File $file
+   * @param File $file
    *   File object.
    *
-   * @return \Drupal\Core\Url
+   * @return Url
    *   Url object
    */
   public static function makeDownloadLink(File $file) {
@@ -446,7 +450,7 @@ class FileHistory extends FormElement {
     $scheme = \Drupal::service('stream_wrapper_manager')->getScheme($path);
 
     if ($scheme == 'public') {
-      $filepath = file_create_url($path);
+      $filepath = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
       return Url::fromUri($filepath);
     }
     else {
@@ -464,7 +468,7 @@ class FileHistory extends FormElement {
    *   Element.
    * @param mixed $input
    *   Input.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   FormState.
    *
    * @return bool
@@ -474,7 +478,7 @@ class FileHistory extends FormElement {
 
     $all_files = \Drupal::request()->files->get('files', []);
     $upload_name = $element['#name'];
-    /** @var \Symfony\Component\HttpFoundation\File\UploadedFile $uploaded_file */
+    /** @var UploadedFile $uploaded_file */
     $uploaded_file = $all_files[$upload_name];
 
     if (is_array($uploaded_file) && isset($uploaded_file[0])) {
@@ -491,7 +495,7 @@ class FileHistory extends FormElement {
         $file_data_for_validation = [
           'file_original_name' => $uploaded_file->getClientOriginalName(),
           'file_original_extension' => $uploaded_file->getClientOriginalExtension(),
-          'file_size' => $uploaded_file->getClientSize(),
+          'file_size' => $uploaded_file->getSize(),
           'file_path' => $uploaded_file->getRealPath(),
         ];
 
@@ -520,7 +524,7 @@ class FileHistory extends FormElement {
       // If validation pass, we save file.
       $destination = isset($element['#upload_location']) ? $element['#upload_location'] : NULL;
 
-      \Drupal::service('file_system')->prepareDirectory($destination, \Drupal\Core\File\FileSystemInterface::CREATE_DIRECTORY);
+      \Drupal::service('file_system')->prepareDirectory($destination, FileSystemInterface::CREATE_DIRECTORY);
 
       if (!$files = file_save_upload($upload_name, $element['#upload_validators'], $destination)) {
         \Drupal::logger('file')->notice('The file upload failed. %upload', ['%upload' => $upload_name]);
@@ -529,7 +533,7 @@ class FileHistory extends FormElement {
       }
       else {
         // Set file as permanent.
-        /** @var \Drupal\file\Entity\File $file */
+        /** @var File $file */
         foreach ($files as $file) {
           if ($file != NULL && $file->isTemporary()) {
             $file->setPermanent();
@@ -546,7 +550,7 @@ class FileHistory extends FormElement {
    *
    * @param mixed $element
    *   Element.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   Form state.
    *
    * @return array

modules/contrib/insert/insert.api.php
modules/contrib/insert/insert.module
modules/contrib/insert/insert.update.php
modules/contrib/insert/modules/insert_colorbox/insert_colorbox.module
modules/contrib/insert/modules/insert_colorbox/tests/src/FunctionalJavaScript/InsertColorboxTest.php
modules/contrib/insert/modules/insert_colorbox/tests/src/FunctionalJavaScript/InsertColorboxTestBase.php
modules/contrib/insert/modules/insert_media/insert_media.module
modules/contrib/insert/modules/insert_responsive_image/insert_responsive_image.module
modules/contrib/insert/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTest.php
modules/contrib/insert/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTestBase.php
modules/contrib/insert/src/Controller/RotateController.php
modules/contrib/insert/src/Form/ConfigForm.php
modules/contrib/insert/src/Plugin/migrate/destination/PerComponentEntityFormDisplayInsert.php
modules/contrib/insert/src/Plugin/migrate/process/FieldInstanceWidgetInsertSettings.php
modules/contrib/insert/src/Utility/InsertUtility.php
modules/contrib/insert/tests/src/FunctionalJavaScript/InsertFileTest.php
modules/contrib/insert/tests/src/FunctionalJavaScript/InsertFileTestBase.php
modules/contrib/insert/tests/src/FunctionalJavaScript/InsertImageCKEditorTest.php
modules/contrib/insert/tests/src/FunctionalJavaScript/InsertImageCKEditorTestBase.php
modules/contrib/insert/tests/src/FunctionalJavaScript/InsertImageTest.php
modules/contrib/insert/tests/src/FunctionalJavaScript/InsertImageTestBase.php
modules/contrib/insert/tests/src/FunctionalJavaScript/TextFieldCreationTrait.php

12 files with changes
=====================

1) modules/contrib/insert/tests/src/FunctionalJavaScript/TextFieldCreationTrait.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\insert\FunctionalJavascript;

+use Drupal\Core\Entity\EntityInterface;
+use Drupal\Core\Entity\Display\EntityDisplayInterface;
 use Drupal\field\Entity\FieldConfig;
 use Drupal\field\Entity\FieldStorageConfig;

@@ @@
    * @param string (optional) $description
    *   A description for the field. Defaults to ''.
    *
-   * @return \Drupal\Core\Entity\EntityInterface
+   * @return EntityInterface
    */
   protected function createTextField($name, $type_name, $type = 'text_long', array $storage_settings = [], array $field_settings = [], array $widget_settings = [], array $formatter_settings = [], $description = '') {
     FieldStorageConfig::create([
@@ @@
     ]);
     $field_config->save();

-    /** @var \Drupal\Core\Entity\Display\EntityDisplayInterface $entity */
+    /** @var EntityDisplayInterface $entity */
     $entity = \Drupal::entityTypeManager()
       ->getStorage('entity_form_display')
       ->load('node.' . $type_name . '.default');
@@ @@
       ])
       ->save();

-    /** @var \Drupal\Core\Entity\Display\EntityDisplayInterface $entity */
+    /** @var EntityDisplayInterface $entity */
     $entity = \Drupal::entityTypeManager()
       ->getStorage('entity_view_display')
       ->load('node.' . $type_name . '.default');
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


2) modules/contrib/insert/tests/src/FunctionalJavaScript/InsertImageTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\insert\FunctionalJavascript;

+use Behat\Mink\Element\NodeElement;
 /**
  * Tests Insert module's image insert capability.
  *
@@ @@
     $page->findLink('↺')->click();

     $body->waitFor(20, function ($element) {
-      /** @var \Behat\Mink\Element\NodeElement $element */
+      /** @var NodeElement $element */
       return strpos($element->getValue(), 'width="20"') !== FALSE;
     });

@@ @@
     $page->findLink('↺')->click();

     $body->waitFor(20, function ($element) {
-      /** @var \Behat\Mink\Element\NodeElement $element */
+      /** @var NodeElement $element */
       return strpos($element->getValue(), 'width="40"') !== FALSE;
     });

@@ @@
     $page->findLink('↺')->click();

     $body->waitFor(20, function ($element) {
-      /** @var \Behat\Mink\Element\NodeElement $element */
+      /** @var NodeElement $element */
       return strpos($element->getValue(), 'width="20"') !== FALSE;
     });

@@ @@
     $page->findLink('↺')->click();

     $body->waitFor(20, function ($element) {
-      /** @var \Behat\Mink\Element\NodeElement $element */
+      /** @var NodeElement $element */
       return strpos($element->getValue(), 'width="40"') !== FALSE;
     });

@@ @@
     $wrappers[0]->findLink('↺')->click();

     $body->waitFor(20, function ($element) {
-      /** @var \Behat\Mink\Element\NodeElement $element */
+      /** @var NodeElement $element */
       return strpos($element->getValue(), 'width="20"') !== FALSE;
     });

@@ @@
     $wrappers[1]->findLink('↺')->click();

     $body->waitFor(20, function ($element) {
-      /** @var \Behat\Mink\Element\NodeElement $element */
+      /** @var NodeElement $element */
       return strpos($element->getValue(), 'width="20"') !== FALSE;
     });
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


3) modules/contrib/insert/tests/src/FunctionalJavaScript/InsertImageCKEditorTestBase.php:19

    ---------- begin diff ----------
@@ @@
   /**
    * @inheritdoc
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     // Create text format and associate CKEditor.
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/insert/tests/src/FunctionalJavaScript/InsertFileTestBase.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\insert\FunctionalJavascript;

+use Drupal\user\UserInterface;
+use Behat\Mink\Element\DocumentElement;
 use Drupal\Core\StringTranslation\StringTranslationTrait;
 use Drupal\FunctionalJavascriptTests\WebDriverTestBase;
 use Drupal\Tests\file\Functional\FileFieldCreationTrait;
@@ @@
   public static $modules = ['node', 'file', 'insert', 'field_ui'];

   /**
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $adminUser;

@@ @@
   /**
    *
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     $this->contentTypeName = 'article';
@@ @@
   }

   /**
-   * @return \Behat\Mink\Element\DocumentElement
+   * @return DocumentElement
    */
   protected function gotoInsertConfig() {
     $this->drupalGet('admin/config/content/insert');
@@ @@
   }

   /**
-   * @param \Behat\Mink\Element\DocumentElement $page
+   * @param DocumentElement $page
    */
   protected function saveInsertConfig($page) {
     $page->findButton('edit-submit')->click();
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/insert/src/Utility/InsertUtility.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\insert\Utility;

+use Drupal\Core\Image\Image;
 use Drupal\Component\Utility\Html;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\file\FileInterface;
@@ @@
    * detect that all items were enabled when having set the value the last time.
    *
    * @param array $element
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    */
   public static function validateList(array $element, FormStateInterface &$form_state) {
     if (array_key_exists('#options', $element)
@@ @@
   }

   /**
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    * @return bool
    */
   public static function isImage($file) {
-    /** @var \Drupal\Core\Image\Image $image */
+    /** @var Image $image */
     $image = \Drupal::service('image.factory')->get($file->getFileUri());

     return $image->isValid();
@@ @@
   }

   /**
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    * @param string $styleName
    * @param bool (optional) $absolute
    * @return null|string
    */
   public static function buildDerivativeUrl(FileInterface $file, $styleName, $absolute = FALSE) {
-    /** @var \Drupal\image\Entity\ImageStyle $style */
+    /** @var ImageStyle $style */
     $style = ImageStyle::load($styleName);

     if ($style !== NULL) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


6) modules/contrib/insert/src/Form/ConfigForm.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\insert\Form;

+use Drupal\filter\Entity\FilterFormat;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\Core\Form\ConfigFormBase;
@@ @@
     $config = $this->config('insert.config');

     $text_formats = array_map(function ($format) {
-      /** @var \Drupal\filter\Entity\FilterFormat $format */
+      /** @var FilterFormat $format */
       return $format->label();
     }, filter_formats());

@@ @@

   /**
    * @param array $element
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    */
   public static function string_to_array(array $element, &$form_state) {
     $value = str_replace(',', ' ', trim($element['#value']));
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/insert/src/Controller/RotateController.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\insert\Controller;

+use Drupal\Core\Image\ImageInterface;
+use Drupal\Core\Field\FieldDefinitionInterface;
 use Drupal\Core\Controller\ControllerBase;
 use Drupal\file\Entity\File;
 use Drupal\image\Entity\ImageStyle;
@@ @@
    * Rotates an image regenerating image derivatives for every image style and
    * saving the corresponding entity with the updated image dimensions.
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *
-   * @return \Symfony\Component\HttpFoundation\JsonResponse
+   * @return JsonResponse
    */
   public function rotate(Request $request) {
     $fid = $request->query->get('fid', NULL);
@@ @@
       return new JsonResponse([]);
     }

-    /** @var \Drupal\Core\Image\ImageInterface $image */
+    /** @var ImageInterface $image */
     $image = \Drupal::service('image.factory')->get($file->getFileUri());

     if (!$image->isValid()) {
@@ @@
     $node = Node::load($nid);
     if ($node !== NULL) {

-      /** @var \Drupal\Core\Field\FieldDefinitionInterface $definition */
+      /** @var FieldDefinitionInterface $definition */
       foreach ($node->getFieldDefinitions() as $field_name => $definition) {
         if ($definition->getType() === 'image') {
           $value = $node->get($field_name)->getValue();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


8) modules/contrib/insert/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTestBase.php:24

    ---------- begin diff ----------
@@ @@
   /**
    * @inheritdoc
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     // Install the 'wide' responsive image style.
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


9) modules/contrib/insert/modules/insert_responsive_image/insert_responsive_image.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\file\Entity\File;
 /**
  * @file
  */
@@ @@
     return;
   }

-  /** @var \Drupal\file\Entity\File $file */
+  /** @var File $file */
   $file = $element['#insert'][$insertType]['file'];
   $styleName = $insertStyleNameSegments[1];
   $responsiveStyle = ResponsiveImageStyle::load($styleName);
@@ @@
   $style = ImageStyle::load($responsiveStyle->getFallbackImageStyle());

   $vars['url'] = $style === NULL
-    ? file_create_url($file->getFileUri())
+    ? \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri())
     : $style->buildUrl($file->getFileUri());

   if (!\Drupal::config('insert.config')->get('absolute')) {
-    $vars['url'] = file_url_transform_relative($vars['url']);
+    $vars['url'] = \Drupal::service('file_url_generator')->transformRelative($vars['url']);
   }

   // Have Responsive Image module generate the srcset and sizes attributes:
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * FileUrlTransformRelativeRector
 * ArgumentRemoverRector


10) modules/contrib/insert/modules/insert_media/insert_media.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Entity\EntityTypeManagerInterface;
+use Drupal\Core\Entity\EntityViewModeInterface;
 /**
  * @file
  */
@@ @@
 }

 /**
- * @param \Drupal\Core\Field\WidgetInterface $plugin
+ * @param WidgetInterface $plugin
  * @return array
  */
 function _insert_media_settings($plugin) {
@@ @@
   $element['#insert']['settings']['styles'] = $settings['view_modes'];
   $element['#insert']['settings']['default'] = $settings['default'];

-  /** @var \Drupal\Core\Entity\EntityTypeManagerInterface $entityTypeManager */
+  /** @var EntityTypeManagerInterface $entityTypeManager */
   $entityTypeManager = \Drupal::entityTypeManager();

   foreach ($element['selection'] as $key => &$selectionElement) {
@@ @@
 /**
  * Returns all media view modes.
  *
- * @return \Drupal\Core\Entity\EntityViewModeInterface[]
+ * @return EntityViewModeInterface[]
  */
 function _insert_media_get_view_modes() {
   $viewModes = \Drupal::entityTypeManager()
@@ @@
  * Implements hook_field_widget_form_alter().
  */
 function insert_media_field_widget_form_alter(array &$element, FormStateInterface $form_state, array $context) {
-  /** @var \Drupal\Core\Field\WidgetInterface $plugin */
+  /** @var WidgetInterface $plugin */
   $plugin = $context['widget'];
   $pluginId = $plugin->getPluginId();

@@ @@
  * Implements hook_field_widget_settings_summary_alter().
  */
 function insert_media_field_widget_settings_summary_alter(array &$summary, array $context) {
-  /** @var \Drupal\Core\Field\WidgetInterface $plugin */
+  /** @var WidgetInterface $plugin */
   $plugin = $context['widget'];
   $pluginId = $plugin->getPluginId();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


11) modules/contrib/insert/modules/insert_colorbox/insert_colorbox.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Config\Config;
 /**
  * @file
  */
@@ @@
  * Implements hook_insert_config_submit_form().
  */
 function insert_colorbox_insert_config_submit_form(FormStateInterface $form_state) {
-  /** @var \Drupal\Core\Config\Config $config */
+  /** @var Config $config */
   $config = \Drupal::getContainer()
     ->get('config.factory')
     ->getEditable('insert_colorbox.config');
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


12) modules/contrib/insert/insert.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\node\NodeForm;
+use Drupal\Core\Image\ImageInterface;
 /**
  * @file
  */
@@ @@
  * @see \Drupal\file\Plugin\Field\FieldWidget\FileWidget::process()
  *
  * @param array $element
- * @param \Drupal\Core\Form\FormStateInterface $form_state
+ * @param FormStateInterface $form_state
  * @param array $form
  *
  * @return array
@@ @@
       'widgets' => [$insertType => $settings],
     ];

-    /** @var \Drupal\node\NodeForm $form */
+    /** @var NodeForm $form */
     $form = $form_state->getFormObject();
     $node = $form->getEntity();

@@ @@
     return FALSE;
   }

-  /** @var \Drupal\file\Entity\File $file */
+  /** @var File $file */
   $file = File::load($item['fids'][0]);

   $config = \Drupal::config('insert.config');
@@ @@
     return [];
   }

-  /** @var \Drupal\file\Entity\File $file */
+  /** @var File $file */
   $file = $element['#insert'][$insertType]['file'];

   if ($file === NULL) {
@@ @@
     'entity_type' => $file->getEntityTypeId(),
     'mime_type' => $file->getMimeType(),
     'uuid' => $file->uuid(),
-    'url' => file_create_url($file->getFileUri()),
+    'url' => \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()),
   ];

   if (!$config->get('absolute')) {
@@ @@
 }

 /**
- * @param \Drupal\Core\Field\WidgetInterface $plugin
+ * @param WidgetInterface $plugin
  * @return array
  */
 function _insert_settings($plugin) {
@@ @@
  * Implements hook_field_widget_settings_summary_alter().
  */
 function insert_field_widget_settings_summary_alter(array &$summary, array $context) {
-  /** @var \Drupal\Core\Field\WidgetInterface $plugin */
+  /** @var WidgetInterface $plugin */
   $plugin = $context['widget'];
   $pluginId = $plugin->getPluginId();

@@ @@
  * Implements hook_field_widget_form_alter().
  */
 function insert_field_widget_form_alter(array &$element, FormStateInterface $form_state, array $context) {
-  /** @var \Drupal\Core\Field\WidgetInterface $plugin */
+  /** @var WidgetInterface $plugin */
   $plugin = $context['widget'];
   $pluginId = $plugin->getPluginId();

@@ @@

 /**
  * @param array $element
- * @param \Drupal\Core\Form\FormStateInterface $form_state
+ * @param FormStateInterface $form_state
  */
 function _insert_allowed_html_validate(array $element, FormStateInterface &$form_state) {
   $tags = [
@@ @@
  * particular image is transformed according to the image style.
  */
 function template_preprocess_insert_image(array &$vars) {
-  /** @var \Drupal\Core\Image\ImageInterface $image */
+  /** @var ImageInterface $image */
   $image = \Drupal::service('image.factory')->get($vars['file']->getFileUri());
   if ($image->isValid()) {
     if (!empty($vars['insert_settings']['width']) && $image->getWidth() > $vars['insert_settings']['width']) {
@@ @@
     return;
   }

-  /** @var \Drupal\image\Entity\ImageStyle $style */
+  /** @var ImageStyle $style */
   $style = ImageStyle::load(
     isset($vars['insert__auto']) ? $vars['insert__auto'] : $vars['style_name']
   );
@@ @@
  * Preprocess variables for the insert-link.html.twig file.
  */
 function template_preprocess_insert_link(array &$vars) {
-  /** @var \Drupal\file\Entity\File $vars['file'] */
+  /** @var File $vars ['file'] */
   $vars['name'] = $vars['file']->getFilename();
 }

@@ @@
  * Preprocess variables for the insert-icon-link.html.twig file.
  */
 function template_preprocess_insert_icon_link(array &$vars) {
-  /** @var \Drupal\file\Entity\File $file */
+  /** @var File $file */
   $file = $vars['file'];

   $vars['name'] = $file->getFilename();
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ArgumentRemoverRector


 [OK] 12 files have been changed by Rector                                      


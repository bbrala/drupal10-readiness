diff --git a/modules/moodle_rest_migrate/src/Plugin/migrate/process/MoodleFile.php b/modules/moodle_rest_migrate/src/Plugin/migrate/process/MoodleFile.php
index 14bcd81..af94e1a 100644
--- a/modules/moodle_rest_migrate/src/Plugin/migrate/process/MoodleFile.php
+++ b/modules/moodle_rest_migrate/src/Plugin/migrate/process/MoodleFile.php
@@ -62,28 +62,28 @@ class MoodleFile extends FileProcessBase implements ContainerFactoryPluginInterf
   /**
    * The stream wrapper manager service.
    *
-   * @var \Drupal\Core\StreamWrapper\StreamWrapperManagerInterface
+   * @var StreamWrapperManagerInterface
    */
   protected $streamWrapperManager;
 
   /**
    * Entity type manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * The file system service.
    *
-   * @var \Drupal\Core\File\FileSystemInterface
+   * @var FileSystemInterface
    */
   protected $fileSystem;
 
   /**
    * The Moodle rest connection.
    *
-   * @var \Drupal\moodle_rest\Services\MoodleRest
+   * @var MoodleRest
    */
   protected $moodle;
 
@@ -96,13 +96,13 @@ class MoodleFile extends FileProcessBase implements ContainerFactoryPluginInterf
    *   The plugin ID.
    * @param array $plugin_definition
    *   The plugin definition.
-   * @param \Drupal\Core\StreamWrapper\StreamWrapperManagerInterface $stream_wrappers
+   * @param StreamWrapperManagerInterface $stream_wrappers
    *   The stream wrapper manager service.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   Entity type manager.
-   * @param \Drupal\Core\File\FileSystemInterface $file_system
+   * @param FileSystemInterface $file_system
    *   The file system service.
-   * @param \Drupal\moodle_rest\Services\MoodleRest $moodle
+   * @param MoodleRest $moodle
    *   The moodle rest connection.
    */
   public function __construct(array $configuration, $plugin_id, array $plugin_definition, StreamWrapperManagerInterface $stream_wrappers, EntityTypeManagerInterface $entity_type_manager, FileSystemInterface $file_system, MoodleRest $moodle) {
diff --git a/modules/moodle_rest_migrate/src/Plugin/migrate/source/MoodleBase.php b/modules/moodle_rest_migrate/src/Plugin/migrate/source/MoodleBase.php
index 6b3e35d..3c06359 100644
--- a/modules/moodle_rest_migrate/src/Plugin/migrate/source/MoodleBase.php
+++ b/modules/moodle_rest_migrate/src/Plugin/migrate/source/MoodleBase.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\moodle_rest_migrate\Plugin\migrate\source;
 
+use Drupal\migrate\MigrateException;
 use Drupal\Component\Plugin\ConfigurableInterface;
 use Drupal\Core\Plugin\ContainerFactoryPluginInterface;
 use Drupal\moodle_rest\Services\MoodleRest;
@@ -105,7 +106,7 @@ class MoodleBase extends SourcePluginBase implements ConfigurableInterface, Cont
   /**
    * {@inheritdoc}
    *
-   * @throws \Drupal\migrate\MigrateException
+   * @throws MigrateException
    */
   public function initializeIterator() {
     foreach ($this->getResults() as $result) {
diff --git a/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/process/MoodleFileTest.php b/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/process/MoodleFileTest.php
index f1c7d31..9ae0378 100644
--- a/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/process/MoodleFileTest.php
+++ b/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/process/MoodleFileTest.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\Tests\moodle_rest_migrate\Kernel\Plugin\migrate\process;
 
+use Prophecy\PhpUnit\ProphecyTrait;
+use Drupal\Core\File\FileSystemInterface;
 use Drupal\Core\StreamWrapper\StreamWrapperInterface;
 use Drupal\KernelTests\Core\File\FileTestBase;
 use Drupal\migrate\MigrateExecutableInterface;
@@ -17,6 +19,7 @@ use GuzzleHttp\Psr7\Response;
  */
 class MoodleFileTest extends FileTestBase {
 
+  use ProphecyTrait;
   /**
    * {@inheritdoc}
    */
@@ -31,7 +34,7 @@ class MoodleFileTest extends FileTestBase {
   /**
    * The file system service.
    *
-   * @var \Drupal\Core\File\FileSystemInterface
+   * @var FileSystemInterface
    */
   protected $fileSystem;
 
diff --git a/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/source/MoodleBaseTest.php b/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/source/MoodleBaseTest.php
index 474c11a..2c8cd89 100644
--- a/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/source/MoodleBaseTest.php
+++ b/modules/moodle_rest_migrate/tests/src/Kernel/Plugin/migrate/source/MoodleBaseTest.php
@@ -43,9 +43,7 @@ class MoodleBaseTest extends MigrateTestBase {
     $this->installConfig(['node', 'moodle_rest_migrate_test']);
 
     // Mock results from Moodle Server.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->any())
       ->method('requestFunction')
       ->with('core_course_get_courses')
@@ -83,9 +81,7 @@ class MoodleBaseTest extends MigrateTestBase {
     $this->installConfig(['node', 'moodle_rest_migrate_test']);
 
     // Mock results from Moodle Server.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->any())
       ->method('requestFunction')
       ->with('core_course_get_courses_by_field')
diff --git a/modules/moodle_rest_user/src/Commands/MoodleDrushCommands.php b/modules/moodle_rest_user/src/Commands/MoodleDrushCommands.php
index 785670d..7baeaba 100644
--- a/modules/moodle_rest_user/src/Commands/MoodleDrushCommands.php
+++ b/modules/moodle_rest_user/src/Commands/MoodleDrushCommands.php
@@ -16,14 +16,14 @@ class MoodleDrushCommands extends DrushCommands {
   /**
    * Moodle Batch helper class.
    *
-   * @var \Drupal\moodle_rest_user\UserBatchHelper
+   * @var UserBatchHelper
    */
   protected $batchHelper;
 
   /**
    * Entity type service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
diff --git a/modules/moodle_rest_user/src/Controller/CourseController.php b/modules/moodle_rest_user/src/Controller/CourseController.php
index 5d61078..673d7b3 100644
--- a/modules/moodle_rest_user/src/Controller/CourseController.php
+++ b/modules/moodle_rest_user/src/Controller/CourseController.php
@@ -17,23 +17,23 @@ class CourseController extends ControllerBase {
   /**
    * The entity type manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * The Moodle Rest Functions Service.
    *
-   * @var \Drupal\moodle_rest\Services\RestFunctions
+   * @var RestFunctions
    */
   protected $moodle;
 
   /**
    * Construct for Course Controller.
    *
-   * @param Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager.
-   * @param Drupal\moodle_rest\Services\RestFunctions $moodle
+   * @param RestFunctions $moodle
    *   Moodle rest functions service.
    */
   public function __construct(EntityTypeManagerInterface $entity_type_manager, RestFunctions $moodle) {
diff --git a/modules/moodle_rest_user/src/Event/MoodleUserAssociate.php b/modules/moodle_rest_user/src/Event/MoodleUserAssociate.php
index c1ca62d..05b4414 100644
--- a/modules/moodle_rest_user/src/Event/MoodleUserAssociate.php
+++ b/modules/moodle_rest_user/src/Event/MoodleUserAssociate.php
@@ -2,8 +2,8 @@
 
 namespace Drupal\moodle_rest_user\Event;
 
+use Symfony\Contracts\EventDispatcher\Event;
 use Drupal\user\UserInterface;
-use Symfony\Component\EventDispatcher\Event;
 
 /**
  * A matching Moodle acount is trying to be found for a user entity.
diff --git a/modules/moodle_rest_user/src/Event/MoodleUserMap.php b/modules/moodle_rest_user/src/Event/MoodleUserMap.php
index 9ba34fa..62fca54 100644
--- a/modules/moodle_rest_user/src/Event/MoodleUserMap.php
+++ b/modules/moodle_rest_user/src/Event/MoodleUserMap.php
@@ -2,8 +2,8 @@
 
 namespace Drupal\moodle_rest_user\Event;
 
+use Symfony\Contracts\EventDispatcher\Event;
 use Drupal\migrate\Row;
-use Symfony\Component\EventDispatcher\Event;
 
 /**
  * Map fields for push to, pull from, Moodle.
@@ -26,7 +26,7 @@ class MoodleUserMap extends Event {
    * there and calling the NestedArray functions. Well that and having a source
    * and destination.
    *
-   * @var \Drupal\migrate\Row
+   * @var Row
    */
   public $row;
 
@@ -40,7 +40,7 @@ class MoodleUserMap extends Event {
   /**
    * Event constructor.
    *
-   * @param \Drupal\migrate\Row $row
+   * @param Row $row
    *   The row being mapped.
    * @param array $config
    *   The mapping configuration.
diff --git a/modules/moodle_rest_user/src/EventSubscriber/AssociateEventSubscriber.php b/modules/moodle_rest_user/src/EventSubscriber/AssociateEventSubscriber.php
index 3ad89a1..eaf7a66 100644
--- a/modules/moodle_rest_user/src/EventSubscriber/AssociateEventSubscriber.php
+++ b/modules/moodle_rest_user/src/EventSubscriber/AssociateEventSubscriber.php
@@ -15,7 +15,7 @@ class AssociateEventSubscriber implements EventSubscriberInterface {
   /**
    * Moodle REST functions.
    *
-   * @var \Drupal\moodle_rest\Services\RestFunctions
+   * @var RestFunctions
    */
   protected $moodle;
 
@@ -38,7 +38,7 @@ class AssociateEventSubscriber implements EventSubscriberInterface {
   /**
    * Subscribe to the user login event dispatched.
    *
-   * @param \Drupal\moodle_rest_user\Event\MoodleUserAssociate $event
+   * @param MoodleUserAssociate $event
    *   User association event.
    */
   public function associateByEmail(MoodleUserAssociate $event) {
diff --git a/modules/moodle_rest_user/src/EventSubscriber/UserMapSubscriber.php b/modules/moodle_rest_user/src/EventSubscriber/UserMapSubscriber.php
index 0dd6835..d4f3873 100644
--- a/modules/moodle_rest_user/src/EventSubscriber/UserMapSubscriber.php
+++ b/modules/moodle_rest_user/src/EventSubscriber/UserMapSubscriber.php
@@ -23,7 +23,7 @@ class UserMapSubscriber implements EventSubscriberInterface {
   /**
    * Map fields from Drupal User Account to Moodle Account.
    *
-   * @param \Drupal\moodle_rest_user\Event\MoodleUserMap $event
+   * @param MoodleUserMap $event
    *   Mapping event.
    */
   public function mapToMoodle(MoodleUserMap $event) {
@@ -35,7 +35,7 @@ class UserMapSubscriber implements EventSubscriberInterface {
   /**
    * Map fields from Drupal User Account to Moodle Account.
    *
-   * @param \Drupal\moodle_rest_user\Event\MoodleUserMap $event
+   * @param MoodleUserMap $event
    *   Mapping event.
    */
   public function mapToDrupal(MoodleUserMap $event) {
diff --git a/modules/moodle_rest_user/src/ExtraFields.php b/modules/moodle_rest_user/src/ExtraFields.php
index 59858c7..942c339 100644
--- a/modules/moodle_rest_user/src/ExtraFields.php
+++ b/modules/moodle_rest_user/src/ExtraFields.php
@@ -24,50 +24,50 @@ class ExtraFields implements ContainerInjectionInterface {
   /**
    * The entity type manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * Moodle REST functions service.
    *
-   * @var \Drupal\moodle_rest\Services\RestFunctions
+   * @var RestFunctions
    */
   protected $moodle;
 
   /**
    * Current user.
    *
-   * @var \Drupal\Core\Session\AccountProxyInterface
+   * @var AccountProxyInterface
    */
   protected $currentUser;
 
   /**
    * Current Route Match.
    *
-   * @var \Drupal\Core\Routing\RouteMatchInterface
+   * @var RouteMatchInterface
    */
   protected $routeMatch;
 
   /**
    * Module handler.
    *
-   * @var \Drupal\Core\Extension\ModuleHandlerInterface
+   * @var ModuleHandlerInterface
    */
   protected $moduleHandler;
 
   /**
    * DirectoryExtraFieldDisplay constructor.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   Entity type manager.
-   * @param \Drupal\moodle_rest\Services\RestFunctions $moodle
+   * @param RestFunctions $moodle
    *   Moodle REST functions service.
-   * @param \Drupal\Core\Session\AccountProxyInterface $current_user
+   * @param AccountProxyInterface $current_user
    *   Current user.
-   * @param \Drupal\Core\Routing\RouteMatchInterface $route_match
+   * @param RouteMatchInterface $route_match
    *   Current Route Match.
-   * @param \Drupal\Core\Extension\ModuleHandlerInterface $module_handler
+   * @param ModuleHandlerInterface $module_handler
    *   Module handler.
    */
   public function __construct(EntityTypeManagerInterface $entity_type_manager, RestFunctions $moodle, AccountProxyInterface $current_user, RouteMatchInterface $route_match, ModuleHandlerInterface $module_handler) {
diff --git a/modules/moodle_rest_user/src/Form/SettingsForm.php b/modules/moodle_rest_user/src/Form/SettingsForm.php
index dd90892..c2c861f 100644
--- a/modules/moodle_rest_user/src/Form/SettingsForm.php
+++ b/modules/moodle_rest_user/src/Form/SettingsForm.php
@@ -16,14 +16,14 @@ class SettingsForm extends ConfigFormBase {
   /**
    * The entity field manager.
    *
-   * @var \Drupal\Core\Entity\EntityFieldManagerInterface
+   * @var EntityFieldManagerInterface
    */
   protected $entityFieldManager;
 
   /**
    * Constructs a \Drupal\system\ConfigFormBase object.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The factory for configuration objects.
    */
   public function __construct(ConfigFactoryInterface $config_factory, EntityFieldManagerInterface $entity_field_manager) {
diff --git a/modules/moodle_rest_user/src/UserBatchHelper.php b/modules/moodle_rest_user/src/UserBatchHelper.php
index c419974..ec7ffda 100644
--- a/modules/moodle_rest_user/src/UserBatchHelper.php
+++ b/modules/moodle_rest_user/src/UserBatchHelper.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\moodle_rest_user;
 
+use Drupal\Core\Config\ImmutableConfig;
+use Drupal\user\UserStorage;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\DependencyInjection\ContainerInjectionInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
@@ -23,32 +25,32 @@ class UserBatchHelper implements ContainerInjectionInterface {
   /**
    * The event dispatcher.
    *
-   * @var \Symfony\Component\EventDispatcher\EventDispatcherInterface
+   * @var EventDispatcherInterface
    */
   protected $eventDispatcher;
 
   /**
    * Module settings.
    *
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $settings;
 
   /**
    * User storage.
    *
-   * @var \Drupal\user\UserStorage
+   * @var UserStorage
    */
   protected $userStorage;
 
   /**
    * Batch Helper constructor.
    *
-   * @param \Symfony\Component\EventDispatcher\EventDispatcherInterface $event_dispatcher
+   * @param EventDispatcherInterface $event_dispatcher
    *   Event Dispatcher.
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The factory for configuration objects.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   Entity Type Manager.
    */
   public function __construct(EventDispatcherInterface $event_dispatcher, ConfigFactoryInterface $config_factory, EntityTypeManagerInterface $entity_type_manager) {
@@ -94,7 +96,7 @@ class UserBatchHelper implements ContainerInjectionInterface {
 
     try {
       $event = new MoodleUserAssociate($account);
-      $this->eventDispatcher->dispatch(MoodleUserAssociate::EVENT_NAME, $event);
+      $this->eventDispatcher->dispatch($event, MoodleUserAssociate::EVENT_NAME);
     }
     catch (ServicesMoodleRestException $e) {
       \watchdog_exception('issup_moodle', $e, '%type: @message "@body" in %function (line %line of %file).', ['@body' => $e->getBody()['exception']]);
diff --git a/modules/moodle_rest_user/src/UserEventHelper.php b/modules/moodle_rest_user/src/UserEventHelper.php
index 45383d3..cb51849 100644
--- a/modules/moodle_rest_user/src/UserEventHelper.php
+++ b/modules/moodle_rest_user/src/UserEventHelper.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\moodle_rest_user;
 
+use Drupal\Core\Config\ImmutableConfig;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\DependencyInjection\ContainerInjectionInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ -23,32 +24,32 @@ class UserEventHelper implements ContainerInjectionInterface {
   /**
    * The event dispatcher.
    *
-   * @var \Symfony\Component\EventDispatcher\EventDispatcherInterface
+   * @var EventDispatcherInterface
    */
   protected $eventDispatcher;
 
   /**
    * Module settings.
    *
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $settings;
 
   /**
    * Moodle Rest Functions connector.
    *
-   * @var \Drupal\moodle_rest\Services\RestFunctions
+   * @var RestFunctions
    */
   protected $moodle;
 
   /**
    * User Event Helper constructor.
    *
-   * @param \Symfony\Component\EventDispatcher\EventDispatcherInterface $event_dispatcher
+   * @param EventDispatcherInterface $event_dispatcher
    *   Event dispatcher.
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The factory for configuration objects.
-   * @param \Drupal\moodle_rest\Services\RestFunctions $moodle
+   * @param RestFunctions $moodle
    *   The Moodle REST Functions connector.
    */
   public function __construct(EventDispatcherInterface $event_dispatcher, ConfigFactoryInterface $config_factory, RestFunctions $moodle) {
@@ -251,14 +252,14 @@ class UserEventHelper implements ContainerInjectionInterface {
    */
   public function associateAccount(UserInterface $account): int {
     $event = new MoodleUserAssociate($account);
-    $this->eventDispatcher->dispatch(MoodleUserAssociate::EVENT_NAME, $event);
+    $this->eventDispatcher->dispatch($event, MoodleUserAssociate::EVENT_NAME);
     return $event->moodleId;
   }
 
   /**
    * Push a new user into Moodle.
    *
-   * @param \Drupal\user\UserInterface $account
+   * @param UserInterface $account
    *   The user to be added to Moodle.
    */
   protected function createMoodleUser(UserInterface $account) {
@@ -267,7 +268,7 @@ class UserEventHelper implements ContainerInjectionInterface {
     $row = new Row($source, array_flip(array_column($mapping, 'drupal')));
     // @todo Map can throw an exception for missing fields?
     $event = new MoodleUserMap($row, $mapping);
-    $this->eventDispatcher->dispatch(MoodleUserMap::PUSH_EVENT, $event);
+    $this->eventDispatcher->dispatch($event, MoodleUserMap::PUSH_EVENT);
     try {
       $result = $this->moodle->createUsers([$event->row->getDestination()]);
       $result = reset($result);
@@ -283,7 +284,7 @@ class UserEventHelper implements ContainerInjectionInterface {
   /**
    * Pull user fields from Moodle to a user.
    *
-   * @param \Drupal\user\UserInterface $account
+   * @param UserInterface $account
    *   The user account to be pulled.
    * @param int $moodle_id
    *   Moodle ID of account.
@@ -302,7 +303,7 @@ class UserEventHelper implements ContainerInjectionInterface {
       $mapping = $this->settings->get('pull_fields');
       $row = new Row($moodle_user, array_flip(array_column($mapping, 'moodle')));
       $event = new MoodleUserMap($row, $mapping);
-      $this->eventDispatcher->dispatch(MoodleUserMap::PULL_EVENT, $event);
+      $this->eventDispatcher->dispatch($event, MoodleUserMap::PULL_EVENT);
       foreach ($row->getDestination() as $field_name => $values) {
         $field = $update_account->$field_name;
         if ($field instanceof TypedDataInterface) {
@@ -317,7 +318,7 @@ class UserEventHelper implements ContainerInjectionInterface {
   /**
    * Push user fields to a Moodle user.
    *
-   * @param \Drupal\user\UserInterface $account
+   * @param UserInterface $account
    *   The user accout to push.
    * @param int $moodle_id
    *   Moodle ID of account.
@@ -328,7 +329,7 @@ class UserEventHelper implements ContainerInjectionInterface {
     $row = new Row($source, array_flip(array_column($mapping, 'drupal')));
     // @todo Map can throw an exception for missing fields?
     $event = new MoodleUserMap($row, $mapping);
-    $this->eventDispatcher->dispatch(MoodleUserMap::PUSH_EVENT, $event);
+    $this->eventDispatcher->dispatch($event, MoodleUserMap::PUSH_EVENT);
     try {
       $mapped_fields = $event->row->getDestination();
       $mapped_fields['id'] = $moodle_id;
diff --git a/modules/moodle_rest_user/tests/src/Kernel/UserEventHelperTest.php b/modules/moodle_rest_user/tests/src/Kernel/UserEventHelperTest.php
index d9fd007..f9a06a3 100644
--- a/modules/moodle_rest_user/tests/src/Kernel/UserEventHelperTest.php
+++ b/modules/moodle_rest_user/tests/src/Kernel/UserEventHelperTest.php
@@ -69,9 +69,7 @@ class UserEventHelperTest extends KernelTestBase {
     $this->assertEquals($pull, $settings->get('pull_fields'));
 
     // Create user. Default config. No ID found.
-    $event_dispatcher = $this->getMockBuilder(EventDispatcherInterface::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $event_dispatcher = $this->createMock(EventDispatcherInterface::class);
     $event_dispatcher->expects($this->once())
       ->method('dispatch');
     $this->container->set('event_dispatcher', $event_dispatcher);
@@ -91,9 +89,7 @@ class UserEventHelperTest extends KernelTestBase {
     // Would be nice to run this via calling the
     // UserEventHelper::associateAccount method calling the event subscribers
     // however it serializes the required mock which breaks phpunit.
-    $moodle = $this->getMockBuilder(RestFunctions::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $moodle = $this->createMock(RestFunctions::class);
     $moodle->expects($this->once())
       ->method('getUsersByField')
       ->with('email', ['two@example.com'])
@@ -125,6 +121,7 @@ class UserEventHelperTest extends KernelTestBase {
 
   /**
    * Test create user.
+   * @doesNotPerformAssertions
    */
   public function testCreateUser(): void {
     $settings = $this->container->get('config.factory')
@@ -150,9 +147,7 @@ class UserEventHelperTest extends KernelTestBase {
     ]);
     $settings->save();
 
-    $moodle = $this->getMockBuilder(RestFunctions::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $moodle = $this->createMock(RestFunctions::class);
     $moodle->expects($this->once())
       ->method('createUsers')
       ->with([
@@ -197,9 +192,7 @@ class UserEventHelperTest extends KernelTestBase {
     $settings->save();
 
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_user_get_users', [
@@ -221,17 +214,15 @@ class UserEventHelperTest extends KernelTestBase {
     \Drupal::entityTypeManager()->getStorage('user')->resetCache();
     $account = User::load($account->id());
 
-    $this->assertEqual($account->getAccountName(), 'student_one');
-    $this->assertEqual($account->getEmail(), 'one@example.com');
+    $this->assertEquals($account->getAccountName(), 'student_one');
+    $this->assertEquals($account->getEmail(), 'one@example.com');
   }
 
   /**
    * Test push users.
    */
   public function testPushUsers(): void {
-    $moodle = $this->getMockBuilder(RestFunctions::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $moodle = $this->createMock(RestFunctions::class);
     $moodle->expects($this->once())
       ->method('updateUsers')
       ->with([
diff --git a/src/Plugin/Field/FieldFormatter/MoodleIdLinkFormatter.php b/src/Plugin/Field/FieldFormatter/MoodleIdLinkFormatter.php
index 6c35e25..f0d1cdc 100644
--- a/src/Plugin/Field/FieldFormatter/MoodleIdLinkFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/MoodleIdLinkFormatter.php
@@ -25,7 +25,7 @@ class MoodleIdLinkFormatter extends FormatterBase {
   /**
    * The Moodle REST settings.
    *
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $moodleSettings;
 
@@ -43,7 +43,7 @@ class MoodleIdLinkFormatter extends FormatterBase {
   /**
    * Set Moodle settings.
    *
-   * @param \Drupal\Core\Config\ImmutableConfig $settings
+   * @param ImmutableConfig $settings
    *   The Moodle REST settings.
    */
   public function setMoodleSettings(ImmutableConfig $settings) {
diff --git a/src/Services/MoodleRest.php b/src/Services/MoodleRest.php
index 76d4792..70eff99 100644
--- a/src/Services/MoodleRest.php
+++ b/src/Services/MoodleRest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\moodle_rest\Services;
 
+use GuzzleHttp\Psr7\Response;
 use GuzzleHttp\ClientInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use GuzzleHttp\Exception\TransferException;
@@ -14,14 +15,14 @@ class MoodleRest {
   /**
    * The HTTP client.
    *
-   * @var \GuzzleHttp\ClientInterface
+   * @var ClientInterface
    */
   protected $httpClient;
 
   /**
    * The config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;
 
@@ -42,9 +43,9 @@ class MoodleRest {
   /**
    * Constructs a MoodleRest object.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The config factory.
-   * @param \GuzzleHttp\ClientInterface $http_client
+   * @param ClientInterface $http_client
    *   The HTTP client.
    */
   public function __construct(ConfigFactoryInterface $config_factory, ClientInterface $http_client) {
@@ -106,7 +107,7 @@ class MoodleRest {
    * @return mixed
    *   NULL, string or array as defined by the Webservice Function.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    */
   public function requestFunction($name, array $params = []) {
     $host = $this->getBaseUrl();
@@ -180,11 +181,11 @@ class MoodleRest {
    * @param string $type
    *   Optional request type.
    *
-   * @return \GuzzleHttp\Psr7\Response
+   * @return Response
    *   Guzzle response object.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
-   * @throws \GuzzleHttp\Exception\TransferException
+   * @throws MoodleRestException
+   * @throws TransferException
    */
   public function request(array $options, $type = 'GET') {
     $host = $this->getBaseUrl();
@@ -221,11 +222,11 @@ class MoodleRest {
    *   if it was an external link. The repository may have to export the file
    *   to an offline format.
    *
-   * @return \GuzzleHttp\Psr7\Response
+   * @return Response
    *   Guzzle response object.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
-   * @throws \GuzzleHttp\Exception\TransferException
+   * @throws MoodleRestException
+   * @throws TransferException
    */
   public function requestFile($url, $preview = '', $offline = NULL) {
     $host = $this->getBaseUrl();
diff --git a/src/Services/RestFunctions.php b/src/Services/RestFunctions.php
index e474e8c..bf79d75 100644
--- a/src/Services/RestFunctions.php
+++ b/src/Services/RestFunctions.php
@@ -19,14 +19,14 @@ class RestFunctions {
   /**
    * The Rest WS connector.
    *
-   * @var \Drupal\moodle_rest\Services\MoodleRest
+   * @var MoodleRest
    */
   protected $rest;
 
   /**
    * The module logger channel.
    *
-   * @var \Psr\Log\LoggerInterface
+   * @var LoggerInterface
    */
   protected $logger;
 
@@ -40,7 +40,7 @@ class RestFunctions {
   /**
    * Constructs a RestFunctions object.
    *
-   * @param \Psr\Log\LoggerInterface $logger
+   * @param LoggerInterface $logger
    *   The logger.channel.moodle_rest service.
    */
   public function __construct(LoggerInterface $logger) {
@@ -73,7 +73,6 @@ class RestFunctions {
    *
    * Moodle `core_webservice_*` functions.
    */
-
   /**
    * Get some site info / user info / list web service functions.
    *
@@ -82,7 +81,7 @@ class RestFunctions {
    * @return array
    *   Array as defined by version of Moodle.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    */
   public function getSiteInfo() {
     if (empty(self::$cache['site_info'])) {
@@ -277,7 +276,6 @@ class RestFunctions {
    *
    * @see https://github.com/moodle/moodle/blob/master/user/externallib.php
    */
-
   /**
    * Create Users.
    *
@@ -299,7 +297,7 @@ class RestFunctions {
    *     username string user name
    *   ].
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    *   Notably: Invalid parameter value detected. Including with message
    *   Invalid parameter value detected (Username already exists: username).
    */
@@ -314,7 +312,7 @@ class RestFunctions {
    * @param array $users
    *   Array of users. Required key 'id', and fields to update.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    */
   public function updateUsers(array $users): void {
     $this->getRestClient()->requestFunction('core_user_update_users', ['users' => $users]);
@@ -326,7 +324,7 @@ class RestFunctions {
    * @param int[] $user_ids
    *   User IDs.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    */
   public function deleteUsers(array $user_ids): void {
     $this->getRestClient()->requestFunction('core_user_delete_users', ['userids' => $user_ids]);
@@ -343,7 +341,7 @@ class RestFunctions {
    * @return array
    *   Array of matching users.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    */
   public function getUsers(array $criteria): array {
     $arguments = [];
@@ -372,7 +370,7 @@ class RestFunctions {
    * @return array
    *   Array of matching users.
    *
-   * @throws \Drupal\moodle_rest\Services\MoodleRestException
+   * @throws MoodleRestException
    */
   public function getUsersByField(string $field, array $values): array {
     return $this->getRestClient()->requestFunction('core_user_get_users_by_field', [
diff --git a/tests/src/Kernel/FunctionsServiceTest.php b/tests/src/Kernel/FunctionsServiceTest.php
index 45a7621..ba66034 100644
--- a/tests/src/Kernel/FunctionsServiceTest.php
+++ b/tests/src/Kernel/FunctionsServiceTest.php
@@ -29,9 +29,7 @@ class FunctionsServiceTest extends KernelTestBase {
    */
   public function testSiteInfo(array $result): void {
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_webservice_get_site_info')
@@ -49,9 +47,7 @@ class FunctionsServiceTest extends KernelTestBase {
    * Test handling exceptions in siteInfo field methods.
    */
   public function testSiteInfoExceptions(): void {
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->any())
       ->method('requestFunction')
       ->will($this->throwException(new MoodleRestException('', 500)));
@@ -64,9 +60,7 @@ class FunctionsServiceTest extends KernelTestBase {
     $this->assertEquals('', $rest_functions->getSiteInfoSitename());
     $this->assertEquals([], $rest_functions->getSiteInfoFunctions());
 
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->any())
       ->method('requestFunction')
       ->will($this->throwException(new MoodleRestException('', 403, NULL, ['errorcode' => 'accessexception'])));
@@ -84,9 +78,7 @@ class FunctionsServiceTest extends KernelTestBase {
    */
   public function testSwitchRestClient(): void {
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_webservice_get_site_info')
@@ -96,9 +88,7 @@ class FunctionsServiceTest extends KernelTestBase {
     $rest_functions = $this->container->get('moodle_rest.rest_functions');
     $this->assertEquals(['original_result'], $rest_functions->getSiteInfo());
 
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_webservice_get_site_info')
@@ -116,9 +106,7 @@ class FunctionsServiceTest extends KernelTestBase {
    */
   public function testGetCourses(array $result): void {
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_course_get_courses')
@@ -138,9 +126,7 @@ class FunctionsServiceTest extends KernelTestBase {
    */
   public function testGetCoursesByField(array $result): void {
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_course_get_courses_by_field')
@@ -159,9 +145,7 @@ class FunctionsServiceTest extends KernelTestBase {
 
     // Request a single course id.
     // Then request courses and get an access denied on one.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->any())
       ->method('requestFunction')
       ->withConsecutive(
@@ -190,9 +174,7 @@ class FunctionsServiceTest extends KernelTestBase {
         ],
       );
     $this->container->set('moodle_rest.rest_ws', $rest);
-    $logger = $this->getMockBuilder(LoggerInterface::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $logger = $this->createMock(LoggerInterface::class);
     $logger->expects($this->once())
       ->method('warning');
     $this->container->set('logger.channel.moodle_rest', $logger);
@@ -201,9 +183,7 @@ class FunctionsServiceTest extends KernelTestBase {
     $this->assertEquals([['id' => 1]], $rest_functions->getCoursesByField('ids', '1,2'));
 
     // Send incorrect parameters get an exception.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->will(
@@ -250,9 +230,7 @@ class FunctionsServiceTest extends KernelTestBase {
     ];
     $delete_users = [3, 6];
 
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->any())
       ->method('requestFunction')
       ->withConsecutive(
@@ -290,9 +268,7 @@ class FunctionsServiceTest extends KernelTestBase {
    */
   public function testGetUsers(array $result): void {
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_user_get_users', [
@@ -316,9 +292,7 @@ class FunctionsServiceTest extends KernelTestBase {
    */
   public function testGetUsersByField(array $result): void {
     // Use default REST client from container.
-    $rest = $this->getMockBuilder(MoodleRest::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $rest = $this->createMock(MoodleRest::class);
     $rest->expects($this->once())
       ->method('requestFunction')
       ->with('core_user_get_users_by_field', [
diff --git a/tests/src/Kernel/RestServiceTest.php b/tests/src/Kernel/RestServiceTest.php
index 027e32a..3e7f802 100644
--- a/tests/src/Kernel/RestServiceTest.php
+++ b/tests/src/Kernel/RestServiceTest.php
@@ -36,9 +36,7 @@ class RestServiceTest extends KernelTestBase {
    * Check configuration handling in request.
    */
   public function testConfig(): void {
-    $http_client = $this->getMockBuilder(ClientInterface::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $http_client = $this->createMock(ClientInterface::class);
     $http_client->expects($this->once())
       ->method('request')
       ->with(
@@ -66,9 +64,7 @@ class RestServiceTest extends KernelTestBase {
    * Test wsfunction call.
    */
   public function testRequestFunction(): void {
-    $http_client = $this->getMockBuilder(ClientInterface::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $http_client = $this->createMock(ClientInterface::class);
     $http_client->expects($this->exactly(2))
       ->method('request')
       ->withConsecutive([
@@ -115,9 +111,7 @@ class RestServiceTest extends KernelTestBase {
    * Test guzzle exception.
    */
   public function testRequestException(): void {
-    $http_client = $this->getMockBuilder(ClientInterface::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $http_client = $this->createMock(ClientInterface::class);
     $http_client->expects($this->any())
       ->method('request')
       ->will($this->throwException(new TransferException()));
@@ -134,9 +128,7 @@ class RestServiceTest extends KernelTestBase {
    * Test Moodle exceptions.
    */
   public function testMoodleException(): void {
-    $http_client = $this->getMockBuilder(ClientInterface::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $http_client = $this->createMock(ClientInterface::class);
     $http_client->expects($this->exactly(2))
       ->method('request')
       ->willReturnOnConsecutiveCalls(

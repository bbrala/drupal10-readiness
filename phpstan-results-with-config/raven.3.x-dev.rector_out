modules/contrib/raven/raven.api.php
modules/contrib/raven/raven.install
modules/contrib/raven/raven.module
modules/contrib/raven/raven.post_update.php
modules/contrib/raven/src/Commands/RavenCommands.php
modules/contrib/raven/src/Config/SecKitOverrides.php
modules/contrib/raven/src/EventSubscriber/CspSubscriber.php
modules/contrib/raven/src/EventSubscriber/RequestSubscriber.php
modules/contrib/raven/src/Exception/RateLimitException.php
modules/contrib/raven/src/Form/RavenConfigForm.php
modules/contrib/raven/src/Http/HttpClientMiddleware.php
modules/contrib/raven/src/Integration/RemoveExceptionFrameVarsIntegration.php
modules/contrib/raven/src/Integration/SanitizeIntegration.php
modules/contrib/raven/src/Logger/Raven.php
modules/contrib/raven/src/Plugin/CspReportingHandler/Raven.php
modules/contrib/raven/src/Twig/TwigTracingExtension.php
modules/contrib/raven/tests/modules/raven_test.module
modules/contrib/raven/tests/src/Functional/CspTest.php
modules/contrib/raven/tests/src/Functional/DrushTest.php
modules/contrib/raven/tests/src/Functional/RavenTest.php
modules/contrib/raven/tests/src/Functional/SecKitTest.php
modules/contrib/raven/tests/src/FunctionalJavascript/RavenTest.php
modules/contrib/raven/tests/src/Unit/ProxyConfigTest.php

9 files with changes
====================

1) modules/contrib/raven/tests/src/Unit/ProxyConfigTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\raven\Unit;

+use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Extension\ModuleHandlerInterface;
 use Drupal\Core\Logger\LogMessageParserInterface;
 use Drupal\Core\Site\Settings;
@@ @@
   /**
    * The module handler.
    *
-   * @var \Drupal\Core\Extension\ModuleHandlerInterface
+   * @var ModuleHandlerInterface
    */
   protected $moduleHandler;

@@ @@
   /**
    * The message's placeholders parser.
    *
-   * @var \Drupal\Core\Logger\LogMessageParserInterface
+   * @var LogMessageParserInterface
    */
   protected $parser;

@@ @@
    * @dataProvider proxyConfigurationData
    */
   public function testProxyConfiguration(string $dsn, array $config, string $proxy): void {
-    /** @var \Drupal\Core\Config\ConfigFactoryInterface $configFactory */
+    /** @var ConfigFactoryInterface $configFactory */
     $configFactory = $this->getConfigFactoryStub([
       'raven.settings' => [
         'client_key' => $dsn,
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/raven/src/Twig/TwigTracingExtension.php:18

    ---------- begin diff ----------
@@ @@
   /**
    * Config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

@@ @@
   /**
    * This method is called before execution.
    *
-   * @param \Twig\Profiler\Profile $profile
+   * @param Profile $profile
    *   The profiling data.
    */
   public function enter(Profile $profile): void {
@@ @@
   /**
    * This method is called when execution is finished.
    *
-   * @param \Twig\Profiler\Profile $profile
+   * @param Profile $profile
    *   The profiling data.
    */
   public function leave(Profile $profile): void {
@@ @@
   /**
    * Gets a short description for the span.
    *
-   * @param \Twig\Profiler\Profile $profile
+   * @param Profile $profile
    *   The profiling data.
    */
   private function getSpanDescription(Profile $profile): string {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/raven/src/Logger/Raven.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\raven\Logger;

+use function Sentry\init;
+use function Sentry\configureScope;
+use function Sentry\captureEvent;
+use function Sentry\captureException;
+use function Sentry\addBreadcrumb;
 use Drupal\Component\ClassFinder\ClassFinder;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\DependencyInjection\DependencySerializationTrait;
@@ @@
   /**
    * Config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

@@ @@
   /**
    * Current user.
    *
-   * @var \Drupal\Core\Session\AccountInterface|null
+   * @var AccountInterface|null
    */
   protected $currentUser;

@@ @@
   /**
    * The module handler.
    *
-   * @var \Drupal\Core\Extension\ModuleHandlerInterface
+   * @var ModuleHandlerInterface
    */
   protected $moduleHandler;

@@ @@
   /**
    * The message's placeholders parser.
    *
-   * @var \Drupal\Core\Logger\LogMessageParserInterface
+   * @var LogMessageParserInterface
    */
   protected $parser;

@@ @@
   /**
    * Request stack.
    *
-   * @var \Symfony\Component\HttpFoundation\RequestStack|null
+   * @var RequestStack|null
    */
   protected $requestStack;

@@ @@
   /**
    * The settings array.
    *
-   * @var \Drupal\Core\Site\Settings
+   * @var Settings
    */
   protected $settings;

@@ @@
   /**
    * Constructs a Raven log object.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The configuration factory object.
-   * @param \Drupal\Core\Logger\LogMessageParserInterface $parser
+   * @param LogMessageParserInterface $parser
    *   The parser to use when extracting message variables.
-   * @param \Drupal\Core\Extension\ModuleHandlerInterface $module_handler
+   * @param ModuleHandlerInterface $module_handler
    *   The module handler.
    * @param string $environment
    *   The kernel.environment parameter.
-   * @param \Drupal\Core\Session\AccountInterface|null $current_user
+   * @param AccountInterface|null $current_user
    *   The current user (optional).
-   * @param \Symfony\Component\HttpFoundation\RequestStack|null $request_stack
+   * @param RequestStack|null $request_stack
    *   The request stack (optional).
-   * @param \Drupal\Core\Site\Settings|null $settings
+   * @param Settings|null $settings
    *   The settings array (optional).
    */
   public function __construct(ConfigFactoryInterface $config_factory, LogMessageParserInterface $parser, ModuleHandlerInterface $module_handler, $environment, AccountInterface $current_user = NULL, RequestStack $request_stack = NULL, Settings $settings = NULL) {
@@ @@
         SentrySdk::init()->bindClient(ClientBuilder::create($options)->setLogger(Drush::logger())->getClient());
       }
       else {
-        \Sentry\init($options);
+        init($options);
       }
     }
     catch (\InvalidArgumentException $e) {
@@ @@
       return NULL;
     }
     // Set default user context.
-    \Sentry\configureScope(function (Scope $scope) use ($config): void {
+    configureScope(function (Scope $scope) use ($config): void {
       $user = ['id' => $this->currentUser ? $this->currentUser->id() : 0];
       if ($this->requestStack && ($request = $this->requestStack->getCurrentRequest())) {
         $user['ip_address'] = $request->getClientIp();
@@ @@
       $start = microtime(TRUE);
       $rateLimit = $config->get('rate_limit');
       if (!$rateLimit || $counter < $rateLimit) {
-        \Sentry\captureEvent($event, EventHint::fromArray($eventHint));
+        captureEvent($event, EventHint::fromArray($eventHint));
       }
       elseif ($counter == $rateLimit) {
-        \Sentry\captureException(new RateLimitException('Log event discarded due to rate limit exceeded; future log events will not be captured by Sentry.'));
+        captureException(new RateLimitException('Log event discarded due to rate limit exceeded; future log events will not be captured by Sentry.'));
       }
       $counter++;
       if ($parent = SentrySdk::getCurrentHub()->getSpan()) {
@@ @@
     }
     $this->moduleHandler->alter('raven_breadcrumb', $breadcrumb);
     if (!empty($breadcrumb['process'])) {
-      \Sentry\addBreadcrumb(Breadcrumb::fromArray($breadcrumb['breadcrumb']));
+      addBreadcrumb(Breadcrumb::fromArray($breadcrumb['breadcrumb']));
     }
   }

@@ @@
    */
   public function onConsoleError(ConsoleErrorEvent $event): void {
     if ($this->getClient()) {
-      \Sentry\captureException($event->getError());
+      captureException($event->getError());
     }
   }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


4) modules/contrib/raven/src/Form/RavenConfigForm.php:238

    ---------- begin diff ----------
@@ @@
    *
    * @param mixed[] $form
    *   The logging and errors config form.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The form state.
    */
   public static function submitForm(array &$form, FormStateInterface $form_state): void {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


5) modules/contrib/raven/src/EventSubscriber/RequestSubscriber.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\raven\EventSubscriber;

+use Symfony\Component\DependencyInjection\ContainerInterface;
+use Sentry\Tracing\Transaction;
+use function Sentry\startTransaction;
 use Consolidation\AnnotatedCommand\CommandData;
 use Drupal\Component\Datetime\TimeInterface;
 use Drupal\Core\Database\Database;
@@ @@
   /**
    * Config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface|null
+   * @var ConfigFactoryInterface|null
    */
   protected $configFactory;

@@ @@
   /**
    * {@inheritdoc}
    *
-   * @var \Symfony\Component\DependencyInjection\ContainerInterface|null
+   * @var ContainerInterface|null
    */
   protected $container;

@@ @@
   /**
    * Raven logger service.
    *
-   * @var \Drupal\raven\Logger\Raven|null
+   * @var Raven|null
    */
   protected $logger;

@@ @@
   /**
    * Time service.
    *
-   * @var \Drupal\Component\Datetime\TimeInterface|null
+   * @var TimeInterface|null
    */
   protected $time;

@@ @@
   /**
    * The transaction for HTTP requests.
    *
-   * @var \Sentry\Tracing\Transaction|null
+   * @var Transaction|null
    */
   public $transaction;

@@ @@
   /**
    * Constructs the request subscriber.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The configuration factory object.
-   * @param \Drupal\raven\Logger\Raven $logger
+   * @param Raven $logger
    *   The logger service.
-   * @param \Drupal\Component\Datetime\TimeInterface $time
+   * @param TimeInterface $time
    *   The time service.
    */
   public function __construct(ConfigFactoryInterface $config_factory = NULL, Raven $logger = NULL, TimeInterface $time = NULL) {
@@ @@
     $transactionContext->setName('drush ' . $commandData->input()->getArgument('command'));
     $transactionContext->setOp('drush.command');
     $transactionContext->setStartTimestamp($this->time->getRequestMicroTime());
-    $this->transaction = \Sentry\startTransaction($transactionContext);
+    $this->transaction = startTransaction($transactionContext);
     SentrySdk::getCurrentHub()->setSpan($this->transaction);
     if ($config->get('database_tracing')) {
       foreach (Database::getAllConnectionInfo() as $key => $info) {
@@ @@
       'http.url' => $request->getUri(),
     ]);
     $transactionContext->setStartTimestamp($this->time->getRequestMicroTime());
-    $this->transaction = \Sentry\startTransaction($transactionContext);
+    $this->transaction = startTransaction($transactionContext);
     SentrySdk::getCurrentHub()->setSpan($this->transaction);
     if ($config->get('database_tracing')) {
       foreach (Database::getAllConnectionInfo() as $key => $info) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


6) modules/contrib/raven/src/EventSubscriber/CspSubscriber.php:16

    ---------- begin diff ----------
@@ @@
   /**
    * The configuration factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   private $configFactory;

@@ @@
   /**
    * CspSubscriber constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $configFactory
+   * @param ConfigFactoryInterface $configFactory
    *   The config factory service.
    */
   public function __construct(ConfigFactoryInterface $configFactory) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


7) modules/contrib/raven/src/Config/SecKitOverrides.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\raven\Config;

+use Drupal\Core\Config\StorableConfigBase;
 use Drupal\Core\Cache\CacheableMetadata;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Config\ConfigFactoryOverrideInterface;
@@ @@
   /**
    * Config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

@@ @@
   /**
    * Constructs the Security Kit config overrider.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The configuration factory object.
    */
   public function __construct(ConfigFactoryInterface $config_factory) {
@@ @@
    * @param string $collection
    *   The configuration collection.
    *
-   * @return \Drupal\Core\Config\StorableConfigBase|null
+   * @return StorableConfigBase|null
    *   The configuration object for the provided name and collection.
    */
   public function createConfigObject($name, $collection = StorageInterface::DEFAULT_COLLECTION) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


8) modules/contrib/raven/src/Commands/RavenCommands.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\raven\Commands;

+use function Sentry\captureMessage;
 use Consolidation\AnnotatedCommand\CommandData;
 use Drupal\raven\EventSubscriber\RequestSubscriber;
 use Drupal\raven\Logger\Raven;
@@ @@
   /**
    * The @raven.request_subscriber service.
    *
-   * @var \Drupal\raven\EventSubscriber\RequestSubscriber|null
+   * @var RequestSubscriber|null
    */
   protected $eventSubscriber;

@@ @@
   /**
    * The @logger.raven service.
    *
-   * @var \Drupal\raven\Logger\Raven|null
+   * @var Raven|null
    */
   protected $ravenLogger;

@@ @@

     $start = microtime(TRUE);

-    $id = \Sentry\captureMessage($message, $severity);
+    $id = captureMessage($message, $severity);

     if ($parent = SentrySdk::getCurrentHub()->getSpan()) {
       $span = new SpanContext();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


9) modules/contrib/raven/raven.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use function Sentry\captureEvent;
 /**
  * @file
  * Raven Drupal module.
@@ @@
     ];
     $formatted_message = strtr($message, $message_placeholders);
     $event->setMessage($message, $message_placeholders, $formatted_message);
-    \Sentry\captureEvent($event);
+    captureEvent($event);
   }
 }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


 [ERROR] Could not process                                                      
         "modules/contrib/raven/src/Plugin/CspReportingHandler/Raven.php" file, 
         due to:                                                                
         "Analyze error: "Class Drupal\csp\Plugin\ReportingHandlerBase not      
         found.". Include your files in "$rectorConfig->autoloadPaths([...]);" or
         "$rectorConfig->bootstrapFiles([...]);" in "rector.php" config.        
         See https://github.com/rectorphp/rector#configuration".                


diff --git a/src/Controller/ImportFilesController.php b/src/Controller/ImportFilesController.php
index 04cc6a3..69c0985 100644
--- a/src/Controller/ImportFilesController.php
+++ b/src/Controller/ImportFilesController.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\easydb\Controller;
 
+use Drupal\Core\TempStore\PrivateTempStore;
 use Drupal\Component\Serialization\Json;
 use Drupal\Core\Controller\ControllerBase;
 use Drupal\Core\File\FileSystemInterface;
@@ -26,14 +27,14 @@ class ImportFilesController extends ControllerBase {
   /**
    * The user temp store.
    *
-   * @var \Drupal\Core\TempStore\PrivateTempStore
+   * @var PrivateTempStore
    */
   protected $tempstore;
 
   /**
    * The user data service.
    *
-   * @var \Drupal\user\UserDataInterface
+   * @var UserDataInterface
    */
   protected $userData;
 
@@ -64,7 +65,7 @@ class ImportFilesController extends ControllerBase {
    * request to the Drupal browser window it originates from. See
    * easydb.routing.yml and EasydbFile::processManagedFile().
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The request object.
    * @param string $eb_uuid
    *   The entity browser uuid which is used as a token.
@@ -278,7 +279,7 @@ class ImportFilesController extends ControllerBase {
         }
       }
     }
-    $file = file_save_data($file_data, $uri, FileSystemInterface::EXISTS_RENAME);
+    $file = \Drupal::service('file.repository')->writeData($file_data, $uri, FileSystemInterface::EXISTS_RENAME);
     // Proceed only if saving the file was successful.
     if ($file === FALSE) {
       $this->setError(
@@ -383,7 +384,7 @@ class ImportFilesController extends ControllerBase {
       $response_this_file['resourceid'] = $media_entity->id();
       $response_this_file['action_taken'] = 'insert';
     }
-    $response_this_file['url'] = file_create_url($file->getFileUri());
+    $response_this_file['url'] = \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri());
     // If there was no error, status is "done".
     if (empty($response_this_file['status'])) {
       $response_this_file['status'] = 'done';

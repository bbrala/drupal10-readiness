diff --git a/media_twig_tools.info.yml b/media_twig_tools.info.yml
index 1a05645..67ba704 100644
--- a/media_twig_tools.info.yml
+++ b/media_twig_tools.info.yml
@@ -2,8 +2,7 @@ name: Media Twig Tools
 type: module
 description: Liste d&#039;outils facilitant l&#039;intégration de media
 package: lycanthrop
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 dependencies:
   - drupal:media
 
diff --git a/src/Config/MediaTwigToolsConfig.php b/src/Config/MediaTwigToolsConfig.php
index 441315f..e786cec 100644
--- a/src/Config/MediaTwigToolsConfig.php
+++ b/src/Config/MediaTwigToolsConfig.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\media_twig_tools\Config;
 
+use Drupal\Core\Config\Config;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityStorageInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
@@ -52,28 +53,28 @@ class MediaTwigToolsConfig implements MediaTwigToolsConfigInterface {
   /**
    * Config.
    *
-   * @var \Drupal\Core\Config\Config
+   * @var Config
    */
   protected $conf;
 
   /**
    * The file System.
    *
-   * @var \Drupal\Core\File\FileSystemInterface
+   * @var FileSystemInterface
    */
   protected $fileSystem;
 
   /**
    * File storage.
    *
-   * @var \Drupal\Core\Entity\EntityStorageInterface
+   * @var EntityStorageInterface
    */
   protected EntityStorageInterface $fileStorage;
 
   /**
    * Image style storage.
    *
-   * @var \Drupal\Core\Entity\EntityStorageInterface
+   * @var EntityStorageInterface
    */
   protected EntityStorageInterface $imageStyleStorage;
 
@@ -203,7 +204,7 @@ class MediaTwigToolsConfig implements MediaTwigToolsConfigInterface {
   /**
    * REturn the file storage.
    *
-   * @return \Drupal\Core\Entity\EntityStorageInterface
+   * @return EntityStorageInterface
    *   The file storage.
    */
   public function getFileStorage(): EntityStorageInterface {
@@ -213,7 +214,7 @@ class MediaTwigToolsConfig implements MediaTwigToolsConfigInterface {
   /**
    * Return the image style storage.
    *
-   * @return \Drupal\Core\Entity\EntityStorageInterface
+   * @return EntityStorageInterface
    *   The image style storage.
    */
   public function getImageStyleStorage(): EntityStorageInterface {
diff --git a/src/Config/MediaTwigToolsConfigInterface.php b/src/Config/MediaTwigToolsConfigInterface.php
index 7a90ae5..a1b8bc9 100644
--- a/src/Config/MediaTwigToolsConfigInterface.php
+++ b/src/Config/MediaTwigToolsConfigInterface.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\media_twig_tools\Config;
 
+use Drupal\Core\Entity\EntityStorageInterface;
 /**
  * Configuration for MediaTwigTools settings.
  *
@@ -61,7 +62,7 @@ interface MediaTwigToolsConfigInterface {
   /**
    * REturn the file storage.
    *
-   * @return \Drupal\Core\Entity\EntityStorageInterface
+   * @return EntityStorageInterface
    *   The file storage.
    */
   public function getFileStorage();
@@ -69,7 +70,7 @@ interface MediaTwigToolsConfigInterface {
   /**
    * Return the image style storage.
    *
-   * @return \Drupal\Core\Entity\EntityStorageInterface
+   * @return EntityStorageInterface
    *   The image style storage.
    */
   public function getImageStyleStorage();
diff --git a/src/EventSubscribers/ImageBuilderEventSubscriber.php b/src/EventSubscribers/ImageBuilderEventSubscriber.php
index 4a19bda..9527670 100644
--- a/src/EventSubscribers/ImageBuilderEventSubscriber.php
+++ b/src/EventSubscribers/ImageBuilderEventSubscriber.php
@@ -20,14 +20,14 @@ class ImageBuilderEventSubscriber implements EventSubscriberInterface, TrustedCa
   /**
    * ImageBuilder.
    *
-   * @var \Drupal\media_twig_tools\Services\ImageBuilder
+   * @var ImageBuilder
    */
   protected $imageBuilder;
 
   /**
    * ImageBuilderEventSubscriber constructor.
    *
-   * @param \Drupal\media_twig_tools\Services\ImageBuilder $imageBuilder
+   * @param ImageBuilder $imageBuilder
    *   The ImageBuilder service.
    */
   public function __construct(ImageBuilder $imageBuilder) {
@@ -53,7 +53,7 @@ class ImageBuilderEventSubscriber implements EventSubscriberInterface, TrustedCa
   /**
    * On Kernel response.
    *
-   * @param \Symfony\Component\HttpKernel\Event\ResponseEvent $responseEvent
+   * @param ResponseEvent $responseEvent
    *   The response event.
    */
   public function onResponse(ResponseEvent $responseEvent) {
diff --git a/src/Form/SettingsForm.php b/src/Form/SettingsForm.php
index 43b01c4..66ad253 100644
--- a/src/Form/SettingsForm.php
+++ b/src/Form/SettingsForm.php
@@ -15,7 +15,7 @@ class SettingsForm extends FormBase {
   /**
    * Conf.
    *
-   * @var \Drupal\media_twig_tools\Config\MediaTwigToolsConfig
+   * @var MediaTwigToolsConfig
    */
   protected $conf;
 
@@ -29,7 +29,7 @@ class SettingsForm extends FormBase {
   /**
    * SettingsForm constructor.
    *
-   * @param \Drupal\media_twig_tools\Config\MediaTwigToolsConfig $conf
+   * @param MediaTwigToolsConfig $conf
    *   The media twig tools config.
    */
   public function __construct(MediaTwigToolsConfig $conf) {
@@ -41,7 +41,7 @@ class SettingsForm extends FormBase {
    */
   public static function create(ContainerInterface $container) {
     return new static(
-      $container->get(MediaTwigToolsConfig::SERVICE_NAME),
+      $this->conf,
     );
   }
 
@@ -88,7 +88,7 @@ class SettingsForm extends FormBase {
   /**
    * Init settings.
    *
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The formstate.
    * @param bool $open
    *   The part should be open by default.
@@ -146,7 +146,7 @@ class SettingsForm extends FormBase {
   /**
    * Init the clear images form part.
    *
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The form state.
    *
    * @return array
@@ -200,7 +200,7 @@ class SettingsForm extends FormBase {
   /**
    * Save settings action.
    *
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The form state.
    */
   protected function saveSettings(FormStateInterface $form_state) {
@@ -214,7 +214,7 @@ class SettingsForm extends FormBase {
   /**
    * Clear images action.
    *
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The formstate.
    */
   protected function clearImages(FormStateInterface $form_state) {
diff --git a/src/Generators/ImageGenerator.php b/src/Generators/ImageGenerator.php
index 6f5f9c6..54f52e5 100644
--- a/src/Generators/ImageGenerator.php
+++ b/src/Generators/ImageGenerator.php
@@ -16,7 +16,7 @@ class ImageGenerator {
   /**
    * The ImageBuilder service.
    *
-   * @var \Drupal\media_twig_tools\Services\ImageBuilder
+   * @var ImageBuilder
    */
   protected $imageBuilder;
 
diff --git a/src/Services/ImageBuilder.php b/src/Services/ImageBuilder.php
index ca8aae2..653e303 100644
--- a/src/Services/ImageBuilder.php
+++ b/src/Services/ImageBuilder.php
@@ -31,14 +31,14 @@ class ImageBuilder {
   /**
    * Conf.
    *
-   * @var \Drupal\media_twig_tools\Config\MediaTwigToolsConfigInterface
+   * @var MediaTwigToolsConfigInterface
    */
   protected $mediaTwigToolsConfig;
 
   /**
    * ImageBuilder constructor.
    *
-   * @param \Drupal\media_twig_tools\Config\MediaTwigToolsConfigInterface $mediaTwigToolsConfig
+   * @param MediaTwigToolsConfigInterface $mediaTwigToolsConfig
    *   The config.
    */
   public function __construct(MediaTwigToolsConfigInterface $mediaTwigToolsConfig) {
@@ -242,7 +242,7 @@ class ImageBuilder {
    * @param string $path
    *   The image path.
    *
-   * @return \Drupal\media_twig_tools\Generators\ImageGenerator
+   * @return ImageGenerator
    *   The Image Generator.
    *
    * @throws \Exception
@@ -319,7 +319,7 @@ class ImageBuilder {
     $rules = $this->getRulesData($srcSettings);
 
     // Get style.
-    /** @var \Drupal\image\ImageStyleInterface $style */
+    /** @var ImageStyleInterface $style */
     $style = isset($rules[MediaTwigTools::OPTION_STYLE]) ? $rules[MediaTwigTools::OPTION_STYLE] : NULL;
     if (!$style) {
       if (isset($srcSetSettings[MediaTwigTools::OPTION_STYLE])) {
@@ -353,7 +353,7 @@ class ImageBuilder {
   /**
    * Scale and crop image.
    *
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    *   THe file.
    * @param int $width
    *   THe width.
@@ -382,7 +382,7 @@ class ImageBuilder {
   /**
    * Return ruled url.
    *
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    *   The file.
    * @param array $rules
    *   THe rules.
diff --git a/src/Services/MediaTwigTools.php b/src/Services/MediaTwigTools.php
index a1319b4..0fca4dd 100644
--- a/src/Services/MediaTwigTools.php
+++ b/src/Services/MediaTwigTools.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\media_twig_tools\Services;
 
+use Drupal\Core\TypedData\Exception\MissingDataException;
+use Drupal\file\Entity\File;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Field\EntityReferenceFieldItemList;
 use Drupal\Core\Field\Plugin\Field\FieldType\EntityReferenceItem;
@@ -115,50 +117,50 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Entity TYpe manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * LanguageManager.
    *
-   * @var \Drupal\Core\Language\LanguageManagerInterface
+   * @var LanguageManagerInterface
    */
   protected $languageManager;
 
   /**
    * ImageBuilder.
    *
-   * @var \Drupal\media_twig_tools\Services\ImageBuilder
+   * @var ImageBuilder
    */
   protected $imageBuilder;
 
   /**
    * The configuration.
    *
-   * @var \Drupal\media_twig_tools\Config\MediaTwigToolsConfig
+   * @var MediaTwigToolsConfig
    */
   protected MediaTwigToolsConfig $conf;
 
   /**
    * The file system.
    *
-   * @var \Drupal\Core\File\FileSystemInterface
+   * @var FileSystemInterface
    */
   protected FileSystemInterface $fileSystem;
 
   /**
    * TwigUtils constructor.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entityTypeManager
+   * @param EntityTypeManagerInterface $entityTypeManager
    *   The entity type manager.
-   * @param \Drupal\Core\Language\LanguageManagerInterface $languageManager
+   * @param LanguageManagerInterface $languageManager
    *   The language Manager.
-   * @param \Drupal\media_twig_tools\Services\ImageBuilder $imageBuilder
+   * @param ImageBuilder $imageBuilder
    *   The image builder.
-   * @param \Drupal\media_twig_tools\Config\MediaTwigToolsConfig $conf
+   * @param MediaTwigToolsConfig $conf
    *   The configuration.
-   * @param \Drupal\Core\File\FileSystemInterface $fileSystem
+   * @param FileSystemInterface $fileSystem
    *   THe file system.
    */
   public function __construct(EntityTypeManagerInterface $entityTypeManager, LanguageManagerInterface $languageManager, ImageBuilder $imageBuilder, MediaTwigToolsConfig $conf, FileSystemInterface $fileSystem) {
@@ -296,7 +298,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Return the build array of the image formatter according to options.
    *
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   The media.
    * @param array $options
    *   The options.
@@ -304,11 +306,11 @@ class MediaTwigTools extends AbstractExtension {
    * @return array|false
    *   The build array.
    *
-   * @throws \Drupal\Core\TypedData\Exception\MissingDataException
+   * @throws MissingDataException
    */
   protected function getImageBuildArrayFromMedia(MediaInterface $media, array $options) {
     // Récupération du fichier.
-    /** @var \Drupal\file\FileInterface $file */
+    /** @var FileInterface $file */
     $file = $media->get($options[static::OPTION_FIELD_NAME])
       ->referencedEntities()[0];
     if (is_null($file)) {
@@ -354,14 +356,14 @@ class MediaTwigTools extends AbstractExtension {
    *
    * @param array $imageFormatterBuild
    *   The image formatter build array.
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    *   The file.
    * @param array $options
    *   The options.
    */
   protected function initImageFormatterStyleData(array &$imageFormatterBuild, FileInterface $file, array $options) {
     // Récupération de l'url stylée.
-    /** @var \Drupal\image\ImageStyleInterface $style */
+    /** @var ImageStyleInterface $style */
     if ($style = $options[static::OPTION_STYLE]) {
       $styledImageUri = $style->buildUri($file->getFileUri());
       $imageFormatterBuild['#image_style'] = $style->id();
@@ -428,12 +430,12 @@ class MediaTwigTools extends AbstractExtension {
    *
    * @param array $imageFormatterBuild
    *   The image formatter build array.
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   The media.
    * @param array $options
    *   The options.
    *
-   * @throws \Drupal\Core\TypedData\Exception\MissingDataException
+   * @throws MissingDataException
    */
   protected function initImageMeta(array &$imageFormatterBuild, MediaInterface $media, array $options) {
     $imageData = $media->get($options[static::OPTION_FIELD_NAME])
@@ -453,7 +455,7 @@ class MediaTwigTools extends AbstractExtension {
    *
    * @param array $imageFormatterBuild
    *   The image formatter build array.
-   * @param \Drupal\media\Entity\Media $media
+   * @param Media $media
    *   The media.
    * @param array $options
    *   The options.
@@ -473,7 +475,7 @@ class MediaTwigTools extends AbstractExtension {
    *
    * @param array $imageFormatterBuild
    *   THe build array.
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   THe media.
    * @param array $options
    *   The options.
@@ -538,18 +540,18 @@ class MediaTwigTools extends AbstractExtension {
         ->load($style);
     }
     $url = NULL;
-    /** @var \Drupal\file\Entity\File $file */
+    /** @var File $file */
     if ($file = $this->conf->getFileStorage()->load($fileId)) {
       if ($style) {
-        $url = file_create_url($style->buildUri($file->getFileUri()));
+        $url = \Drupal::service('file_url_generator')->generateAbsoluteString($style->buildUri($file->getFileUri()));
       }
       else {
-        $url = file_create_url($file->getFileUri());
+        $url = \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri());
       }
     }
 
     if ($relative) {
-      $url = file_url_transform_relative($url);
+      $url = \Drupal::service('file_url_generator')->transformRelative($url);
     }
 
     return $url;
@@ -558,7 +560,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Return the file id from media.
    *
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   The media.
    * @param array $options
    *   The options.
@@ -594,7 +596,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Return picture data.
    *
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   The media.
    * @param array $options
    *   The options.
@@ -626,7 +628,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Return the a sourrce from settings.
    *
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   The media.
    * @param string $mediaQuery
    *   The media query for the source.
@@ -653,7 +655,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Return src set from source settings.
    *
-   * @param \Drupal\media\Entity\Media $media
+   * @param Media $media
    *   The media.
    * @param array $settings
    *   The src settings.
@@ -688,7 +690,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Return the list of built files from the media.
    *
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   The media.
    *
    * @return string[]
@@ -724,7 +726,7 @@ class MediaTwigTools extends AbstractExtension {
   /**
    * Clear built files.
    *
-   * @param \Drupal\media\MediaInterface $media
+   * @param MediaInterface $media
    *   Media.
    */
   public function clearBuiltFilesFromMedia(MediaInterface $media) {
diff --git a/tests/src/Unit/ImageBuilderTest.php b/tests/src/Unit/ImageBuilderTest.php
index 1d43728..1277cc7 100644
--- a/tests/src/Unit/ImageBuilderTest.php
+++ b/tests/src/Unit/ImageBuilderTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\media_twig_tools\Unit;
 
+use PHPUnit\Framework\MockObject\MockObject;
 use Drupal\Core\Entity\EntityInterface;
 use Drupal\file\Entity\File;
 use Drupal\image\Entity\ImageStyle;
@@ -27,7 +28,7 @@ class ImageBuilderTest extends UnitTestCase {
   /**
    * ImageBuilder.
    *
-   * @var \Drupal\media_twig_tools\Services\ImageBuilder
+   * @var ImageBuilder
    */
   protected $imageBuilders;
 
@@ -41,7 +42,7 @@ class ImageBuilderTest extends UnitTestCase {
   /**
    * Input File.
    *
-   * @var \Drupal\file\Entity\File|\PHPUnit\Framework\MockObject\MockObject
+   * @var File|MockObject
    */
   protected $file;
 
@@ -77,7 +78,7 @@ class ImageBuilderTest extends UnitTestCase {
    *
    * @param array $data
    *   Input data.
-   * @param \Drupal\Core\Entity\EntityInterface $file
+   * @param EntityInterface $file
    *   The file.
    */
   protected function testData(array $data, EntityInterface $file) {
@@ -99,13 +100,11 @@ class ImageBuilderTest extends UnitTestCase {
   /**
    * Return the config mock.
    *
-   * @return \Drupal\media_twig_tools\Config\MediaTwigToolsConfig|\PHPUnit\Framework\MockObject\MockObject
+   * @return MediaTwigToolsConfig|MockObject
    *   The mock.
    */
   protected function mockConfig() {
-    $conf = $this->getMockBuilder(MediaTwigToolsConfig::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $conf = $this->createMock(MediaTwigToolsConfig::class);
 
     $conf->expects($this->any())
       ->method('getDirname')
@@ -116,15 +115,11 @@ class ImageBuilderTest extends UnitTestCase {
       ->will($this->returnValue('landscape'));
 
     // Init the image style storage mock.
-    $imageStyleStorage = $this->getMockBuilder(ImageStyleStorage::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $imageStyleStorage = $this->createMock(ImageStyleStorage::class);
     $imageStyleStorage->expects($this->any())
       ->method('load')
       ->willReturnCallback(function ($id) {
-        $imageStyleMock = $this->getMockBuilder(ImageStyle::class)
-          ->disableOriginalConstructor()
-          ->getMock();
+        $imageStyleMock = $this->createMock(ImageStyle::class);
         $imageStyleMock->expects($this->any())
           ->method('id')
           ->will($this->returnValue($id));
@@ -142,14 +137,12 @@ class ImageBuilderTest extends UnitTestCase {
   /**
    * Mock file.
    *
-   * @return \Drupal\file\Entity\File|\PHPUnit\Framework\MockObject\MockObject
+   * @return File|MockObject
    *   The file mock.
    */
   protected function mockFile() {
     // Define file.
-    $file = $this->getMockBuilder(File::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $file = $this->createMock(File::class);
     $file->expects($this->any())
       ->method('id')
       ->will($this->returnValue(1));

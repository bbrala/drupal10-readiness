diff --git a/file_upload_directory_change.info.yml b/file_upload_directory_change.info.yml
index 4f5a1ae..c21f6c1 100644
--- a/file_upload_directory_change.info.yml
+++ b/file_upload_directory_change.info.yml
@@ -3,8 +3,7 @@ type: module
 description: This module give the possibilty to change the affectation (public/private) of an uploaded files.
 
 package: Media
-core: '8.x'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 # project: 'file_upload_directory_change'
 
 # Information added by Drupal.org packaging script on 2020-11-16
diff --git a/src/FileUploadDirectoryChangeField.php b/src/FileUploadDirectoryChangeField.php
index 169e082..a1c4a9f 100644
--- a/src/FileUploadDirectoryChangeField.php
+++ b/src/FileUploadDirectoryChangeField.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\file_upload_directory_change;
 
+use Drupal\Core\Field\Plugin\Field\FieldWidget\BooleanCheckboxWidget;
+use Drupal\file_upload_directory_change\Service\FileServiceInterface;
 use Drupal\Core\Field\FieldDefinitionInterface;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\Core\Field\WidgetInterface;
@@ -61,7 +63,7 @@ class FileUploadDirectoryChangeField {
    * Alters the summary of widget settings form.
    */
   public static function alterWidgetSettingsSummary(&$summary, $context) {
-    /** @var \Drupal\Core\Field\Plugin\Field\FieldWidget\BooleanCheckboxWidget $widget */
+    /** @var BooleanCheckboxWidget $widget */
     $widget = $context['widget'];
     if (static::isWidgetSupported($widget)) {
       $status = $widget->getThirdPartySetting('file_upload_directory_change', 'enabled') ? t('Yes') : t('No');
@@ -74,10 +76,10 @@ class FileUploadDirectoryChangeField {
    */
   public static function processWidget($element, FormStateInterface $form_state, $form) {
     if (isset($element['#default_value']) && isset($element['#default_value']['target_id'])) {
-      $file = \Drupal\file\Entity\File::load($element['#default_value']['target_id']);
+      $file = File::load($element['#default_value']['target_id']);
       $uri = $file->getFileUri();
 
-      /** @var \Drupal\file_upload_directory_change\Service\FileServiceInterface $fudc_file_service */
+      /** @var FileServiceInterface $fudc_file_service */
       $fudc_file_service =  \Drupal::service('file_upload_directory_change.file_service');
       $new_uri = $fudc_file_service->changeFilePath($uri);
 
@@ -101,7 +103,7 @@ class FileUploadDirectoryChangeField {
       return;
     }
 
-    /** @var \Drupal\file_upload_directory_change\Service\FileServiceInterface $fudc_file_service */
+    /** @var FileServiceInterface $fudc_file_service */
     $fudc_file_service =  \Drupal::service('file_upload_directory_change.file_service');
     foreach($input['fids'] as $fid) {
       $fudc_file_service->directoryChange($fid);
diff --git a/src/Service/FileService.php b/src/Service/FileService.php
index 47ec943..619a1f5 100644
--- a/src/Service/FileService.php
+++ b/src/Service/FileService.php
@@ -51,7 +51,7 @@ class FileService implements FileServiceInterface {
     // If current file exists.
     if (realpath($this->fileSystem->realpath($file->getFileUri()))) {
       // Move file
-      file_move($file, $new_uri);
+      \Drupal::service('file.repository')->move($file, $new_uri);
     }
     else {
       // if current file not exists

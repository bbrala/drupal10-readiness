diff --git a/mpbx.module b/mpbx.module
index c719a37..a7539cb 100644
--- a/mpbx.module
+++ b/mpbx.module
@@ -1,5 +1,7 @@
 <?php
 
+use Drupal\Core\Block\BlockManager;
+use Drupal\Core\Render\Renderer;
 /**
  * @file
  * This module allows you to add a map to your site.
@@ -50,9 +52,9 @@ function mpbx_tokens($type, $tokens, array $data, array $options, BubbleableMeta
     foreach ($tokens as $name => $original) {
       switch ($name) {
         case 'map':
-          /** @var \Drupal\Core\Block\BlockManager $block_manager */
+          /** @var BlockManager $block_manager */
           $block_manager = \Drupal::service('plugin.manager.block');
-          /** @var \Drupal\Core\Render\Renderer $renderer */
+          /** @var Renderer $renderer */
           $renderer = \Drupal::service('renderer');
           $plugin_block = $block_manager->createInstance('mpbx_block', []);
           $block = $plugin_block->build();
diff --git a/src/Form/MpbxSettingsForm.php b/src/Form/MpbxSettingsForm.php
index 4bdbb67..0738cda 100644
--- a/src/Form/MpbxSettingsForm.php
+++ b/src/Form/MpbxSettingsForm.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\mpbx\Form;
 
+use Drupal\Core\Cache\CacheBackendInterface;
 use Drupal\Core\Form\ConfigFormBase;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\media\Entity\Media;
@@ -275,12 +276,12 @@ class MpbxSettingsForm extends ConfigFormBase {
    */
   public function submitForm(array &$form, FormStateInterface $form_state) {
 
-    /** @var \Drupal\Core\Cache\CacheBackendInterface $cacheRender */
+    /** @var CacheBackendInterface $cacheRender */
     $cacheRender = \Drupal::service('cache.render');
 
     if ($form_state->getValue('marker')) {
       $marker = Media::load($form_state->getValue('marker'));
-      $marker_url = file_create_url($marker->field_media_image->entity->getFileUri());
+      $marker_url = \Drupal::service('file_url_generator')->generateAbsoluteString($marker->field_media_image->entity->getFileUri());
 
       $this->configFactory->getEditable(static::SETTINGS)
         ->set('marker.id', $form_state->getValue('marker'))
diff --git a/tests/src/Functional/MpbxTest.php b/tests/src/Functional/MpbxTest.php
index deddbef..5d05538 100644
--- a/tests/src/Functional/MpbxTest.php
+++ b/tests/src/Functional/MpbxTest.php
@@ -28,7 +28,7 @@ class MpbxTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->drupalLogin($this->rootUser);

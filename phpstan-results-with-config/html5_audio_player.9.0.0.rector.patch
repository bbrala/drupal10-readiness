diff --git a/html5_audio_player.module b/html5_audio_player.module
index 07f08d7..c620100 100644
--- a/html5_audio_player.module
+++ b/html5_audio_player.module
@@ -1,5 +1,7 @@
 <?php
 
+use Drupal\Core\Entity\EntityInterface;
+use Drupal\Core\Entity\Display\EntityViewDisplayInterface;
 /**
  * @file
  * Provides replacement functionality.
@@ -12,7 +14,7 @@ use Drupal\Core\Database\Database;
 /**
  * Implements hook_node_view_alter().
  */
-function html5_audio_player_node_view_alter(array &$build, Drupal\Core\Entity\EntityInterface $entity, \Drupal\Core\Entity\Display\EntityViewDisplayInterface $display){
+function html5_audio_player_node_view_alter(array &$build, EntityInterface $entity, EntityViewDisplayInterface $display){
 	$database = \Drupal::database();
   $query = $database->select('html5_audio_player', 'h')
            ->fields('h', ['title', 'token', 'script']);
@@ -45,4 +47,4 @@ function  html5_audio_player_block_content_view_alter(array &$build, BlockConten
 function html5_audio_player_page_attachments(array &$attachments) {
   $attachments['#attached']['library'][] = 'html5_audio_player/html5audioplayer';
 }
-?>
\ No newline at end of file
+?>
diff --git a/src/Controller/Html5AudioPlayerController.php b/src/Controller/Html5AudioPlayerController.php
index cccdf60..35d4871 100644
--- a/src/Controller/Html5AudioPlayerController.php
+++ b/src/Controller/Html5AudioPlayerController.php
@@ -60,7 +60,7 @@ class Html5AudioPlayerController extends ControllerBase{
               ->execute();
       $redirect = new RedirectResponse(Url::fromUserInput('/admin/config/development/html5_audio_player')->toString());
       $redirect->send();
-      drupal_set_message(t('Player deleted successfully.'));
+      $this->messenger()->addStatus(t('Player deleted successfully.'));
     }
     else {
       $redirect = new RedirectResponse(Url::fromUserInput('/admin/config/development/html5_audio_player')->toString());
diff --git a/src/Form/Html5AudioPlayerEditForm.php b/src/Form/Html5AudioPlayerEditForm.php
index 2b0ee22..5cd1a77 100644
--- a/src/Form/Html5AudioPlayerEditForm.php
+++ b/src/Form/Html5AudioPlayerEditForm.php
@@ -33,7 +33,9 @@ class Html5AudioPlayerEditForm extends FormBase
   $current_path = \Drupal::service('path.current')->getPath();
   $current_path_explode = explode('/', $current_path);
   $get_token = $current_path_explode[6];
-  $get_data_token = db_query("SELECT * FROM html5_audio_player WHERE token='".$get_token."'")->fetchAll();
+  // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+		// You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+		$get_data_token = \Drupal::database()->query("SELECT * FROM html5_audio_player WHERE token='".$get_token."'")->fetchAll();
   $get_title = $get_data_token[0]->title;
 	$form['html5_audio_player_heading'] = array(
 	    '#type' => 'markup',
@@ -152,6 +154,6 @@ class Html5AudioPlayerEditForm extends FormBase
     ->execute();
     $redirect = new RedirectResponse(Url::fromUserInput('/admin/config/development/html5_audio_player')->toString());
     $redirect->send();
-    drupal_set_message(t('Player Updated successfully .'));
+    $this->messenger()->addStatus(t('Player Updated successfully .'));
   }
 }
diff --git a/src/Form/Html5AudioPlayerForm.php b/src/Form/Html5AudioPlayerForm.php
index ce0bede..8285f5c 100644
--- a/src/Form/Html5AudioPlayerForm.php
+++ b/src/Form/Html5AudioPlayerForm.php
@@ -6,7 +6,7 @@ namespace Drupal\html5_audio_player\Form;
  * @file
  * Provides html5_audio_player functionality.
  */
-
+use Drupal\Core\File\FileSystemInterface;
 use Drupal\Core\Form\FormBase;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\Core\Database\Database;
@@ -92,7 +92,7 @@ class Html5AudioPlayerForm extends FormBase
    */
   public function submitForm(array &$form, FormStateInterface $form_state) {
     $validators = array('file_validate_extensions' => array('wav mp3 ogg'));
-    $files = file_save_upload('html5_audio_player_upload_audio', $validators, 'public://', FILE_EXISTS_REPLACE);
+    $files = file_save_upload('html5_audio_player_upload_audio', $validators, 'public://', FileSystemInterface::EXISTS_REPLACE);
     $file = File::load($files[0]);
     if($file) {
       kint($files);
@@ -100,10 +100,12 @@ class Html5AudioPlayerForm extends FormBase
       $file->setPermanent();
       $file->save();
     }
-    $id = db_query("SELECT MAX(fid) as max_id FROM file_managed")->fetchCol();
-    $file = \Drupal\file\Entity\File::load($id[0]);
+    // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+				// You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+				$id = \Drupal::database()->query("SELECT MAX(fid) as max_id FROM file_managed")->fetchCol();
+    $file = File::load($id[0]);
     $uri = $file->getFileUri();
-    $url = \Drupal\Core\Url::fromUri(file_create_url($uri))->toString();
+    $url = \Drupal::service('file_url_generator')->generate($uri)->toString();
     $file_type = $file->getMimeType();
     $repeat_element = $form_state->getValue('html5_audio_player_repeat');
     $muted_element = $form_state->getValue('html5_audio_player_muted');
@@ -159,6 +161,6 @@ class Html5AudioPlayerForm extends FormBase
     )->execute();
     $redirect = new RedirectResponse(Url::fromUserInput('/admin/config/development/html5_audio_player')->toString());
     $redirect->send();
-    drupal_set_message(t('Player added successfully .'));
+    $this->messenger()->addStatus(t('Player added successfully .'));
   }
 }
\ No newline at end of file

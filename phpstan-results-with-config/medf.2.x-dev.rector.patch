diff --git a/src/Plugin/Filter/MediaEntityDownloadFilter.php b/src/Plugin/Filter/MediaEntityDownloadFilter.php
index f561bbb..513c171 100644
--- a/src/Plugin/Filter/MediaEntityDownloadFilter.php
+++ b/src/Plugin/Filter/MediaEntityDownloadFilter.php
@@ -36,7 +36,7 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
   /**
    * The entity repository.
    *
-   * @var \Drupal\Core\Entity\EntityRepositoryInterface
+   * @var EntityRepositoryInterface
    */
   protected $entityRepository;
 
@@ -56,7 +56,7 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
    *   The plugin_id for the plugin instance.
    * @param mixed $plugin_definition
    *   The plugin implementation definition.
-   * @param \Drupal\Core\Entity\EntityRepositoryInterface $entity_repository
+   * @param EntityRepositoryInterface $entity_repository
    *   The entity repository service.
    */
   public function __construct(array $configuration, $plugin_id, $plugin_definition, EntityRepositoryInterface $entity_repository, SubstitutionManagerInterface $substitution_manager) {
@@ -83,7 +83,7 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
    * {@inheritdoc}
    */
   public function process($text, $langcode) {
-    /** @var \Drupal\filter\FilterProcessResult $entity */
+    /** @var FilterProcessResult $entity */
     $result = new FilterProcessResult($text);
 
     if (strpos($text, 'data-entity-type') === FALSE && strpos($text, 'data-entity-uuid') === FALSE) {
@@ -105,7 +105,7 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
   }
 
   /**
-   * @param \Drupal\filter\FilterProcessResult $result
+   * @param FilterProcessResult $result
    * @param \DOMElement $element
    * @param $langcode
    */
@@ -117,13 +117,13 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
     if (!$this->isValidMediaReference($entity_type, $uuid)) {
       return;
     }
-    /** @var \Drupal\Core\Entity\EntityInterface $entity */
+    /** @var EntityInterface $entity */
     $entity = $this->loadTranslatedEntity($entity_type, $uuid, $langcode);
 
     if (!$entity) {
       return;
     }
-    /** @var \Drupal\Core\Url $url */
+    /** @var Url $url */
     $url = $this->getUrl($entity);
 
     if (!$url) {
@@ -149,9 +149,9 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
   }
 
   /**
-   * @param \Drupal\Core\Entity\EntityInterface $entity
+   * @param EntityInterface $entity
    *
-   * @return \Drupal\Core\Url|null
+   * @return Url|null
    */
   private function getUrl(EntityInterface $entity) {
     if (!$entity->hasField(self::FIELD_FILE_NAME)) {
@@ -162,7 +162,7 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
       ->first()
       ->entity
       ->getFileUri();
-    $url = file_create_url($fileUri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($fileUri);
 
     return Url::fromUri($url);
   }
@@ -190,10 +190,10 @@ class MediaEntityDownloadFilter extends FilterBase implements ContainerFactoryPl
    * @param string $uuid
    * @param string $langcode
    *
-   * @return \Drupal\Core\Entity\EntityInterface|null
+   * @return EntityInterface|null
    */
   private function loadTranslatedEntity($entity_type, $uuid, $langcode) {
-    /** @var \Drupal\Core\Entity\EntityInterface $entity */
+    /** @var EntityInterface $entity */
     $entity = $this->entityRepository
       ->loadEntityByUuid($entity_type, $uuid);
 

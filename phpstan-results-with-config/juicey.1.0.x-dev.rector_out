modules/contrib/juicey/juicebox/juicebox.api.php
modules/contrib/juicey/juicebox/juicebox.install
modules/contrib/juicey/juicebox/juicebox.module
modules/contrib/juicey/juicebox/src/Controller/JuiceboxXmlControllerBase.php
modules/contrib/juicey/juicebox/src/Controller/JuiceboxXmlControllerField.php
modules/contrib/juicey/juicebox/src/Controller/JuiceboxXmlControllerViewsStyle.php
modules/contrib/juicey/juicebox/src/Form/SettingsForm.php
modules/contrib/juicey/juicebox/src/JuiceboxFormatter.php
modules/contrib/juicey/juicebox/src/JuiceboxFormatterInterface.php
modules/contrib/juicey/juicebox/src/JuiceboxGallery.php
modules/contrib/juicey/juicebox/src/JuiceboxGalleryInterface.php
modules/contrib/juicey/juicebox/src/Plugin/Derivative/JuiceboxConfFieldContextualLinks.php
modules/contrib/juicey/juicebox/src/Plugin/Field/FieldFormatter/JuiceboxFieldFormatter.php
modules/contrib/juicey/juicebox/src/Plugin/views/style/JuiceboxDisplayStyle.php
modules/contrib/juicey/juicebox/templates/juicebox.theme.inc
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxCaseTestBase.php
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxConfCase.php
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxConfGlobalCase.php
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxFieldFormatterCase.php
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxFileCase.php
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxSubRequestCase.php
modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxViewsCase.php

12 files with changes
=====================

1) modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxViewsCase.php:103

    ---------- begin diff ----------
@@ @@
     $this->drupalGet('juicebox-views-test-advanced');
     $this->assertSession()->responseContains(trim(json_encode(['configUrl' => $xml_url]), '{}"'));
     $this->assertSession()->responseContains('juicebox-views-test--page-2');
-    $this->assertSession()->responseContains(Html::escape(file_url_transform_relative($test_image_url)));
+    $this->assertSession()->responseContains(Html::escape(\Drupal::service('file_url_generator')->transformRelative($test_image_url)));
     // Check for correct XML.
     $this->drupalGet($xml_path);
     $this->assertSession()->responseContains('<?xml version="1.0" encoding="UTF-8"?>');
    ----------- end diff -----------

Applied rules:
 * FileUrlTransformRelativeRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxFieldFormatterCase.php:88

    ---------- begin diff ----------
@@ @@
     $this->assertSession('Your settings have been saved. Gallery configuration changes saved.');
     // Get the urls to the image and thumb derivatives expected.
     $uri = File::load($node->{$this->instFieldName}[0]->target_id)->getFileUri();
-    $test_formatted_image_url = file_create_url($uri);
+    $test_formatted_image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
     $test_formatted_thumb_url = \Drupal::entityTypeManager()->getStorage('image_style')->load('thumbnail')->buildUrl($uri);
     // Check for correct embed markup as anon user.
     $this->drupalLogout();
     $this->drupalGet('node/' . $node->id());
-    $this->assertSession(Html::escape(file_url_transform_relative($test_formatted_image_url)) . ' Test styled image found in embed code');
+    $this->assertSession(Html::escape(\Drupal::service('file_url_generator')->transformRelative($test_formatted_image_url)) . ' Test styled image found in embed code');
     // Check for correct XML.
     $this->drupalGet('juicebox/xml/field/node/' . $node->id() . '/' . $this->instFieldName . '/full');
     $this->assertSession()->responseContains('imageURL="' . Html::escape($test_formatted_image_url));
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * FileUrlTransformRelativeRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/juicey/juicebox/tests/src/Functional/JuiceboxConfCase.php:150

    ---------- begin diff ----------
@@ @@
       // Get the urls to the main image with and without "large" styling.
       $node = $this->node;
       $uri = File::load($node->{$this->instFieldName}[0]->target_id)->getFileUri();
-      $test_image_url = file_create_url($uri);
+      $test_image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
       $test_image_url_formatted = \Drupal::entityTypeManager()->getStorage('image_style')->load('juicebox_medium')->buildUrl($uri);
       // Check control case without custom configuration.
       $this->drupalGet('juicebox/xml/field/node/' . $node->id() . '/' . $this->instFieldName . '/full');
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/juicey/juicebox/src/Plugin/views/style/JuiceboxDisplayStyle.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\juicebox\Plugin\views\style;

+use Symfony\Component\HttpFoundation\Request;
 use Symfony\Component\DependencyInjection\ContainerInterface;
 use Symfony\Component\HttpFoundation\RequestStack;
 use Drupal\views\Plugin\views\style\StylePluginBase;
@@ @@
   /**
    * A Juicebox formatter service.
    *
-   * @var \Drupal\juicebox\JuiceboxFormatterInterface
+   * @var JuiceboxFormatterInterface
    */
   protected $juicebox;

@@ @@
   /**
    * A Drupal entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
   /**
    * A Drupal entity field manager service.
    *
-   * @var \Drupal\Core\Entity\EntityFieldManagerInterface
+   * @var EntityFieldManagerInterface
    */
   protected $entityFieldManager;

@@ @@
   /**
    * A Drupal string translation service.
    *
-   * @var \Drupal\Core\StringTranslation\TranslationInterface
+   * @var TranslationInterface
    */
   protected $stringTranslation;

@@ @@
   /**
    * A Symfony request object for the current request.
    *
-   * @var \Symfony\Component\HttpFoundation\Request
+   * @var Request
    */
   protected $request;

@@ @@
   /**
    * Build the gallery based on loaded Drupal views data.
    *
-   * @param Drupal\juicebox\JuiceboxGalleryInterface $gallery
+   * @param JuiceboxGalleryInterface $gallery
    *   An initialized Juicebox gallery object.
    */
   protected function buildGallery(JuiceboxGalleryInterface $gallery) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/juicey/juicebox/src/Plugin/Field/FieldFormatter/JuiceboxFieldFormatter.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\juicebox\Plugin\Field\FieldFormatter;

+use Symfony\Component\HttpFoundation\Request;
 use Symfony\Component\DependencyInjection\ContainerInterface;
 use Symfony\Component\HttpFoundation\RequestStack;
 use Drupal\Core\Field\FieldItemListInterface;
@@ @@
   /**
    * A Juicebox formatter service.
    *
-   * @var \Drupal\juicebox\JuiceboxFormatterInterface
+   * @var JuiceboxFormatterInterface
    */
   protected $juicebox;

@@ @@
   /**
    * A Drupal entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
   /**
    * A Drupal link generator service.
    *
-   * @var \Drupal\Core\Utility\LinkGeneratorInterface
+   * @var LinkGeneratorInterface
    */
   protected $linkGenerator;

@@ @@
   /**
    * A Symfony request object for the current request.
    *
-   * @var \Symfony\Component\HttpFoundation\Request
+   * @var Request
    */
   protected $request;

@@ @@
   /**
    * The renderer.
    *
-   * @var \Drupal\Core\Render\RendererInterface
+   * @var RendererInterface
    */
   protected $renderer;

@@ @@
   /**
    * The entity_display repository.
    *
-   * @var \Drupal\Core\Entity\EntityDisplayRepository
+   * @var EntityDisplayRepository
    */
   protected $entityDisplayRepo;

@@ @@
   /**
    * Utility to build a Juicebox gallery based on field formatter data.
    *
-   * @param Drupal\juicebox\JuiceboxGalleryInterface $gallery
+   * @param JuiceboxGalleryInterface $gallery
    *   An initialized Juicebox gallery object.
-   * @param Drupal\Core\Field\FieldItemListInterface $items
+   * @param FieldItemListInterface $items
    *   A list of field items that contain file data for the gallery.
    */
   protected function buildGallery(JuiceboxGalleryInterface $gallery, FieldItemListInterface $items) {
@@ @@
    * string of text here, as opposed to a render array, beacuse this output must
    * be valid for use in both HTML and XML.
    *
-   * @param \Drupal\Core\Field\FieldItemInterface $item
+   * @param FieldItemInterface $item
    *   A field item implementing FieldItemInterface.
    * @param string $source
    *   The source property that contains the text we want to extract. This
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/juicey/juicebox/src/Plugin/Derivative/JuiceboxConfFieldContextualLinks.php:18

    ---------- begin diff ----------
@@ @@
   /**
    * A Drupal entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
   /**
    * Constructor.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
-   * @param \Drupal\Core\StringTranslation\TranslationInterface $string_translation
+   * @param TranslationInterface $string_translation
    *   A string translation service.
    */
   public function __construct(EntityTypeManagerInterface $entity_type_manager, TranslationInterface $string_translation) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/juicey/juicebox/src/JuiceboxFormatterInterface.php:17

    ---------- begin diff ----------
@@ @@
    *   URL for the gallery XML, but no formal structure is strictly required.
    *   This information should uniquely identify the gallery.
    *
-   * @return Drupal\juicebox\JuiceboxGalleryInterface
+   * @return JuiceboxGalleryInterface
    *   An initialized Juicebox gallery object.
    */
   public function newGallery(array $id_args);
@@ @@
    *
    * Task that should take place whenever gallery of any type/source is built.
    *
-   * @param Drupal\juicebox\JuiceboxGalleryInterface $gallery
+   * @param JuiceboxGalleryInterface $gallery
    *   An initialized Juicebox gallery object.
    * @param array $settings
    *   An associative array of common gallery-specific settings.
@@ @@
    * Extract in an array structure that can be used when adding a new
    * image to the gallery.
    *
-   * @param Drupal\file\FileInterface $image_file
+   * @param FileInterface $image_file
    *   A file entity representing the main image.
    * @param string $image_style
    *   The Drupal image style to apply to the main image.
-   * @param Drupal\file\FileInterface $thumb_file
+   * @param FileInterface $thumb_file
    *   A file entity representing the thumbnail image.
    * @param string $thumb_style
    *   The Drupal image style to apply to the thumbnail image.
@@ @@
    * renderEmbed(). It also uses the Drupal theme system as opposed to just
    * returning direct markup. Within Drupal this method should always be used.
    *
-   * @param Drupal\juicebox\JuiceboxGalleryInterface $gallery
+   * @param JuiceboxGalleryInterface $gallery
    *   An fully populated Juicebox gallery object.
    * @param array $settings
    *   An associative array of gallery-specific settings.
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


8) modules/contrib/juicey/juicebox/src/JuiceboxFormatter.php:26

    ---------- begin diff ----------
@@ @@
   /**
    * A Drupal configuration factory service.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected ConfigFactoryInterface $configFactory;

@@ @@
   /**
    * A Drupal URL generator service.
    *
-   * @var \Drupal\Core\Routing\UrlGeneratorInterface
+   * @var UrlGeneratorInterface
    */
   protected UrlGeneratorInterface $urlGenerator;

@@ @@
   /**
    * A Drupal module manager service.
    *
-   * @var \Drupal\Core\Extension\ModuleHandlerInterface
+   * @var ModuleHandlerInterface
    */
   protected ModuleHandlerInterface $moduleManager;

@@ @@
   /**
    * A Drupal current path service.
    *
-   * @var \Drupal\Core\Path\CurrentPathStack
+   * @var CurrentPathStack
    */
   protected CurrentPathStack $currentPathStack;

@@ @@
   /**
    * A Symfony request object for the current request.
    *
-   * @var \Symfony\Component\HttpFoundation\Request
+   * @var Request
    */
   protected Request $request;

@@ @@
   /**
    * The messenger service.
    *
-   * @var \Drupal\Core\Messenger\MessengerInterface
+   * @var MessengerInterface
    */
   protected MessengerInterface $messenger;

@@ @@
   /**
    * A Drupal entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected EntityTypeManagerInterface $entityTypeManager;

@@ @@
   /**
    * Constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The Drupal config factory that can be used to derive global Juicebox
    *   settings.
-   * @param \Drupal\Core\StringTranslation\TranslationInterface $string_translation
+   * @param TranslationInterface $string_translation
    *   A string translation service.
-   * @param \Drupal\Core\Routing\UrlGeneratorInterface $url_generator
+   * @param UrlGeneratorInterface $url_generator
    *   A URL generator service.
-   * @param \Drupal\Core\Extension\ModuleHandlerInterface $module_manager
+   * @param ModuleHandlerInterface $module_manager
    *   A module manager service.
-   * @param \Drupal\Core\Path\CurrentPathStack $currentPathStack
+   * @param CurrentPathStack $currentPathStack
    *   A current path service.
-   * @param \Symfony\Component\HttpFoundation\RequestStack $request_stack
+   * @param RequestStack $request_stack
    *   The Symfony request stack from which to extract the current request.
-   * @param \Drupal\Core\Messenger\MessengerInterface $messenger_interface
+   * @param MessengerInterface $messenger_interface
    *   The messenger interface.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
    */
   public function __construct(ConfigFactoryInterface $config_factory,
@@ @@
    * If so it styles the output as a mimetype image icon representing the file
    * type. Otherwise, the item is styled normally with the passed image style.
    *
-   * @param \Drupal\file\FileInterface $file
+   * @param FileInterface $file
    *   A file entity containing the image data to append Juicebox styled image
    *   data to.
    * @param string $style
@@ @@
     $image_data = [];
     $image_data['juicebox_compatible'] = TRUE;
     // Set the normal, unstyled, url for reference.
-    $image_data['unstyled_src'] = file_create_url($file->getFileUri());
+    $image_data['unstyled_src'] = \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri());
     // Check compatibility if configured and if the library info contains
     // mimetype compatibility information.
     if ($check_compatible && !empty($library['compatible_mimetypes']) && !in_array($mimetype, $library['compatible_mimetypes'])) {
       // If the item is not compatible, find the substitute mimetype icon.
       $image_data['juicebox_compatible'] = FALSE;
-      $icon_dir = drupal_get_path('module', 'juicebox') . '/images/mimetypes';
+      $icon_dir = \Drupal::service('extension.list.module')->getPath('juicebox') . '/images/mimetypes';
       // We only have icons for each major type, so simplify accordingly.
       // file_icon_class() could also be useful here but would require
       // supporting icons for more package types.
@@ @@
       $type_parts = explode('/', $mimetype);
       $icon_path = $icon_dir . '/' . reset($type_parts) . '.png';
       if (file_exists($icon_path)) {
-        $image_data['imageURL'] = file_create_url($icon_path);
+        $image_data['imageURL'] = \Drupal::service('file_url_generator')->generateAbsoluteString($icon_path);
       }
       else {
-        $image_data['imageURL'] = file_create_url($icon_dir . '/general.png');
+        $image_data['imageURL'] = \Drupal::service('file_url_generator')->generateAbsoluteString($icon_dir . '/general.png');
       }
     }
     // If the item is compatible, style it.
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * FileCreateUrlRector
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


9) modules/contrib/juicey/juicebox/src/Form/SettingsForm.php:23

    ---------- begin diff ----------
@@ @@
   /**
    * Constructs a new SettingsForm object.
    *
-   * @param \Drupal\juicebox\JuiceboxFormatter $juicebox_formatter
+   * @param JuiceboxFormatter $juicebox_formatter
    *   The Juicebox formatter service.
    */
   public function __construct(JuiceboxFormatter $juicebox_formatter) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


10) modules/contrib/juicey/juicebox/src/Controller/JuiceboxXmlControllerViewsStyle.php:27

    ---------- begin diff ----------
@@ @@
   /**
    * The loaded view involved in this XML request.
    *
-   * @var \Drupal\views\ViewExecutable
+   * @var ViewExecutable
    */
   protected $view;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


11) modules/contrib/juicey/juicebox/src/Controller/JuiceboxXmlControllerField.php:48

    ---------- begin diff ----------
@@ @@
   /**
    * The loaded entity involved in this XML request.
    *
-   * @var \Drupal\Core\Entity\EntityInterface
+   * @var EntityInterface
    */
   protected $entity;

@@ @@
   /**
    * A Drupal entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
   /**
    * A Drupal entity respository service.
    *
-   * @var \Drupal\Core\Entity\EntityRepositoryInterface
+   * @var EntityRepositoryInterface
    */
   protected $entityRepository;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


12) modules/contrib/juicey/juicebox/src/Controller/JuiceboxXmlControllerBase.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\juicebox\Controller;

+use Drupal\juicebox\JuiceboxGalleryInterface;
 use Symfony\Component\DependencyInjection\ContainerInterface;
 use Symfony\Component\HttpKernel\HttpKernelInterface;
 use Symfony\Component\HttpKernel\Exception\AccessDeniedHttpException;
@@ @@
   /**
    * A Drupal configuration factory service.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

@@ @@
   /**
    * A Symfony request object for the current request.
    *
-   * @var \Symfony\Component\HttpFoundation\Request
+   * @var Request
    */
   protected $request;

@@ @@
   /**
    * The Symfony http kernel service.
    *
-   * @var \Symfony\Component\HttpKernel\HttpKernelInterface
+   * @var HttpKernelInterface
    */
   protected $httpKernel;

@@ @@
   /**
    * Constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The Drupal config factory that can be used to derive global Juicebox
    *   settings.
-   * @param \Symfony\Component\HttpFoundation\RequestStack $request_stack
+   * @param RequestStack $request_stack
    *   The Symfony request stack from which to extract the current request.
-   * @param \Symfony\Component\HttpKernel\HttpKernelInterface $http_kernel
+   * @param HttpKernelInterface $http_kernel
    *   The Symfony http kernel service.
    */
   public function __construct(ConfigFactoryInterface $config_factory, RequestStack $request_stack, HttpKernelInterface $http_kernel) {
@@ @@
   /**
    * Common controller for the Juicebox XML.
    *
-   * @return \Symfony\Component\HttpFoundation\Response
+   * @return Response
    *   A Symfony response object containing the XML information.
    */
   public function xmlController() {
@@ @@
   /**
    * Get the Juicebox gallery object.
    *
-   * @return Drupal\juicebox\JuiceboxGalleryInterface
+   * @return JuiceboxGalleryInterface
    *   A Juicebox gallery object.
    */
   abstract protected function getGallery();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


 [OK] 12 files have been changed by Rector                                      


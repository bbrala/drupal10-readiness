modules/contrib/light_saml_idp/light_saml_idp.module
modules/contrib/light_saml_idp/src/Controller/LightSamlIdpController.php
modules/contrib/light_saml_idp/src/Entity/ServiceProvider.php
modules/contrib/light_saml_idp/src/Entity/ServiceProviderInterface.php
modules/contrib/light_saml_idp/src/Entity/ServiceProviderRepository.php
modules/contrib/light_saml_idp/src/EventSubscriber/StoreAnonymousSAMLRequestSubscriber.php
modules/contrib/light_saml_idp/src/Form/LightSAMLIdpConfigForm.php
modules/contrib/light_saml_idp/src/Form/ServiceProviderDeleteForm.php
modules/contrib/light_saml_idp/src/Form/ServiceProviderForm.php
modules/contrib/light_saml_idp/src/IdentityProvider.php
modules/contrib/light_saml_idp/src/LightSaml/Model/Metadata/KeyDescriptor.php
modules/contrib/light_saml_idp/src/SamlGenerator.php
modules/contrib/light_saml_idp/src/SamlGeneratorInterface.php
modules/contrib/light_saml_idp/src/SamlParser.php
modules/contrib/light_saml_idp/src/ServiceProviderListBuilder.php

11 files with changes
=====================

1) modules/contrib/light_saml_idp/src/ServiceProviderListBuilder.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\light_saml_idp;

+use Drupal\Core\Entity\EntityMalformedException;
 use Drupal\Core\Config\Entity\ConfigEntityListBuilder;
 use Drupal\Core\Entity\EntityInterface;

@@ @@
   /**
    * Overridden for consistent camelCasing.
    *
-   * @param \Drupal\Core\Entity\EntityInterface $entity
+   * @param EntityInterface $entity
    *
    * @return array
-   * @throws \Drupal\Core\Entity\EntityMalformedException
+   * @throws EntityMalformedException
    */
   public function getOperations(EntityInterface $entity) {
     $operations = parent::getOperations($entity);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/light_saml_idp/src/SamlParser.php:10

    ---------- begin diff ----------
@@ @@
   /**
    * @param string $samlRequest
    *
-   * @return \LightSaml\Model\Protocol\AuthnRequest
+   * @return AuthnRequest
    */
   public function buildAuthnRequest(string $samlRequest): AuthnRequest {
     $xml = base64_decode($samlRequest);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


3) modules/contrib/light_saml_idp/src/SamlGeneratorInterface.php:16

    ---------- begin diff ----------
@@ @@
   ): SAMLResponse;

   /**
-   * @return \LightSaml\Model\Assertion\Issuer|null
+   * @return Issuer|null
    */
   public function getAssertionIssuer(): ?Issuer;

@@ @@
   ): Assertion;

   /**
-   * @param \Drupal\light_saml_idp\Entity\ServiceProviderInterface $serviceProvider
+   * @param ServiceProviderInterface $serviceProvider
    * @param \LightSaml\Model\Protocol\Response $samlMessage
-   * @param \LightSaml\Model\Assertion\Assertion $assertion
+   * @param Assertion $assertion
    */
   public function addAssertionToResponse(
     ServiceProviderInterface $serviceProvider,
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


4) modules/contrib/light_saml_idp/src/SamlGenerator.php:33

    ---------- begin diff ----------
@@ @@
   /**
    * A logger instance.
    *
-   * @var \Psr\Log\LoggerInterface
+   * @var LoggerInterface
    */
   protected $logger;

@@ @@
   /**
    * A IdentityProvider instance.
    *
-   * @var \Drupal\light_saml_idp\IdentityProvider
+   * @var IdentityProvider
    */
   protected $identityProvider;

@@ @@
   /**
    * A time instance.
    *
-   * @var \Drupal\Component\Datetime\TimeInterface
+   * @var TimeInterface
    */
   protected $time;

@@ @@
   /**
    * The config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

@@ @@
   }

   /**
-   * @return \LightSaml\Model\Assertion\Issuer|null
+   * @return Issuer|null
    */
   public function getAssertionIssuer(): ?Issuer {
     if ($entityId = $this->identityProvider->getEntityId()) {
@@ @@
   }

   /**
-   * @param \Drupal\light_saml_idp\Entity\ServiceProviderInterface $serviceProvider
+   * @param ServiceProviderInterface $serviceProvider
    *
-   * @return \LightSaml\Model\XmlDSig\SignatureWriter
+   * @return SignatureWriter
    */
   protected function getSignature(ServiceProviderInterface $serviceProvider): SignatureWriter {
     return new SignatureWriter(
@@ @@
   }

   /**
-   * @param \Drupal\light_saml_idp\Entity\ServiceProviderInterface $serviceProvider
+   * @param ServiceProviderInterface $serviceProvider
    * @param \LightSaml\Model\Protocol\Response $samlMessage
-   * @param \LightSaml\Model\Assertion\Assertion $assertion
+   * @param Assertion $assertion
    */
   public function addAssertionToResponse(
     ServiceProviderInterface $serviceProvider,
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


5) modules/contrib/light_saml_idp/src/IdentityProvider.php:23

    ---------- begin diff ----------
@@ @@
   /**
    * The config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

   /**
-   * @var \LightSaml\Credential\X509Certificate|null
+   * @var X509Certificate|null
    */
   protected $signingCertificate;

   /**
-   * @var \RobRichards\XMLSecLibs\XMLSecurityKey|null
+   * @var XMLSecurityKey|null
    */
   protected $signingPrivateKey;

@@ @@
   /**
    * IdentityProvider constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $configFactory
+   * @param ConfigFactoryInterface $configFactory
    */
   public function __construct(ConfigFactoryInterface $configFactory) {
     $this->configFactory = $configFactory;
@@ @@
   /**
    * @param $certificateLocation
    *
-   * @return \LightSaml\Credential\X509Certificate|null
+   * @return X509Certificate|null
    */
   protected function loadX509Certificate($certificateLocation): ?X509Certificate {
     try {
@@ @@
    *
    * @param $privateKeyLocation
    *
-   * @return \RobRichards\XMLSecLibs\XMLSecurityKey|null
+   * @return XMLSecurityKey|null
    */
   protected function loadPrivateKey($privateKeyLocation): ?XMLSecurityKey {
     if (is_file($privateKeyLocation)) {
@@ @@
   }

   /**
-   * @return \LightSaml\Credential\X509Certificate|null
+   * @return X509Certificate|null
    */
   public function getSigningCertificate(): ?X509Certificate {
     return $this->signingCertificate;
@@ @@
   }

   /**
-   * @return \RobRichards\XMLSecLibs\XMLSecurityKey|null
+   * @return XMLSecurityKey|null
    */
   public function getSigningPublicKey(): ?XMLSecurityKey {
     return KeyHelper::createPublicKey($this->getSigningCertificate());
@@ @@
   }

   /**
-   * @return \RobRichards\XMLSecLibs\XMLSecurityKey|null
+   * @return XMLSecurityKey|null
    */
   public function getSigningPrivateKey(): ?XMLSecurityKey {
     return $this->signingPrivateKey;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


6) modules/contrib/light_saml_idp/src/Form/ServiceProviderForm.php:161

    ---------- begin diff ----------
@@ @@

   /**
    * @param array $form
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    */
   public function validateForm(array &$form, FormStateInterface $form_state) {
     foreach (['signingCertificate', 'encryptionCertificate'] as $certificate) {
@@ @@
   }

   /**
-   * @return \Drupal\light_saml_idp\Entity\ServiceProviderInterface
+   * @return ServiceProviderInterface
    */
   public function getEntity(): ServiceProviderInterface {
     return parent::getEntity();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/light_saml_idp/src/EventSubscriber/StoreAnonymousSAMLRequestSubscriber.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\light_saml_idp\EventSubscriber;

+use Drupal\Core\Session\AccountProxyInterface;
+use Symfony\Component\HttpKernel\Event\ExceptionEvent;
 use Drupal\Core\Routing\RouteMatch;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
-use Symfony\Component\HttpKernel\Event\GetResponseForExceptionEvent;
 use Symfony\Component\HttpKernel\Exception\AccessDeniedHttpException;
 use Symfony\Component\HttpKernel\KernelEvents;

@@ @@
  */
 class StoreAnonymousSAMLRequestSubscriber implements EventSubscriberInterface {

-  /** @var \Drupal\Core\Session\AccountProxyInterface */
+  /** @var AccountProxyInterface */
   protected $account;

   /**
@@ @@
   /**
    * Store the SAML request data in the user's session.
    *
-   * @param \Symfony\Component\HttpKernel\Event\GetResponseForExceptionEvent $event
+   * @param ExceptionEvent $event
    */
-  public function storeSAMLRequest(GetResponseForExceptionEvent $event) {
-    if ($event->getException() instanceof AccessDeniedHttpException && $this->account->isAnonymous()) {
+  public function storeSAMLRequest(ExceptionEvent $event) {
+    if ($event->getThrowable() instanceof AccessDeniedHttpException && $this->account->isAnonymous()) {
       $request = $event->getRequest();
       $routeName = RouteMatch::createFromRequest($request)->getRouteName();
       $samlRequest = $request->get('SAMLRequest');
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * RenameMethodRector
 * RenameClassRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


8) modules/contrib/light_saml_idp/src/Entity/ServiceProviderRepository.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\light_saml_idp\Entity;

+use Drupal\Core\Entity\EntityStorageInterface;
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
 use Drupal\Core\Entity\EntityRepository;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Language\LanguageManagerInterface;
@@ @@
 class ServiceProviderRepository extends EntityRepository {

   /**
-   * @var \Drupal\Core\Entity\EntityStorageInterface
+   * @var EntityStorageInterface
    */
   protected $entityStorage;

@@ @@
   /**
    * ServiceProviderRepository constructor.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
-   * @param \Drupal\Core\Language\LanguageManagerInterface $language_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
+   * @param LanguageManagerInterface $language_manager
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
    */
   public function __construct(
     EntityTypeManagerInterface $entity_type_manager,
@@ @@
   /**
    * @param string $entityId
    *
-   * @return \Drupal\light_saml_idp\Entity\ServiceProviderInterface|null
+   * @return ServiceProviderInterface|null
    */
   public function loadEntityByEntityId(string $entityId): ?ServiceProviderInterface {
     $entities = $this->entityStorage->loadByProperties(['entityId'=> $entityId]);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


9) modules/contrib/light_saml_idp/src/Entity/ServiceProviderInterface.php:120

    ---------- begin diff ----------
@@ @@
   public function setEncryptionMethod(string $encryption_method): void;

   /**
-   * @return \RobRichards\XMLSecLibs\XMLSecurityKey
+   * @return XMLSecurityKey
    */
   public function getEncryptionPublicKey(): XMLSecurityKey;

   /**
-   * @return \RobRichards\XMLSecLibs\XMLSecurityKey
+   * @return XMLSecurityKey
    */
   public function getSigningPublicKey(): XMLSecurityKey;
 }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


10) modules/contrib/light_saml_idp/src/Controller/LightSamlIdpController.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\light_saml_idp\Controller;

+use Drupal\light_saml_idp\SamlGenerator;
+use LightSaml\Binding\BindingFactory;
+use LightSaml\Context\Profile\MessageContext;
 use Drupal\Core\Controller\ControllerBase;
 use Drupal\Core\Messenger\MessengerInterface;
 use Drupal\Core\Session\AccountProxy;
@@ @@
   /**
    * A SamlGenerator instance.
    *
-   * @var \Drupal\light_saml_idp\SamlGenerator
+   * @var SamlGenerator
    */
   protected $samlGenerator;

@@ @@
   /**
    * A SamlParser instance.
    *
-   * @var \Drupal\light_saml_idp\SamlParser
+   * @var SamlParser
    */
   protected $samlParser;

   /**
-   * @var \LightSaml\Validator\Model\Xsd\XsdValidator
+   * @var XsdValidator
    */
   protected $xsdValidator;

@@ @@
   /**
    * Service provider repository.
    *
-   * @var \Drupal\light_saml_idp\Entity\ServiceProviderRepository
+   * @var ServiceProviderRepository
    */
   protected $serviceProviderRepository;

@@ @@
   /**
    * A IdentityProvider instance.
    *
-   * @var \Drupal\light_saml_idp\IdentityProvider
+   * @var IdentityProvider
    */
   protected $identityProvider;

@@ @@
   /**
    * Drupal\Core\Session\AccountProxy definition.
    *
-   * @var \Drupal\Core\Session\AccountProxy
+   * @var AccountProxy
    */
   protected $currentUser;

   /**
-   * @var \Drupal\Core\Messenger\MessengerInterface
+   * @var MessengerInterface
    */
   protected $messenger;

@@ @@
   /**
    * LightSamlIdpController constructor.
    *
-   * @param \Drupal\light_saml_idp\SamlGeneratorInterface $samlGenerator
-   * @param \Drupal\light_saml_idp\SamlParser $samlParser
-   * @param \LightSaml\Validator\Model\Xsd\XsdValidator $xsdValidator
-   * @param \Drupal\light_saml_idp\Entity\ServiceProviderRepository $serviceProviderRepository
-   * @param \Drupal\Core\Session\AccountProxy $currentUser
-   * @param \Drupal\light_saml_idp\IdentityProvider $identityProvider
-   * @param \Drupal\Core\Messenger\MessengerInterface $messenger
+   * @param SamlGeneratorInterface $samlGenerator
+   * @param SamlParser $samlParser
+   * @param XsdValidator $xsdValidator
+   * @param ServiceProviderRepository $serviceProviderRepository
+   * @param AccountProxy $currentUser
+   * @param IdentityProvider $identityProvider
+   * @param MessengerInterface $messenger
    */
   public function __construct(
     SamlGeneratorInterface $samlGenerator,
@@ @@
   /**
    * Logs in a user by parsing a AuthnRequest from a ServiceProvider.
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The request.
    *
-   * @return \Symfony\Component\HttpFoundation\Response
+   * @return Response
    */
   public function login(Request $request) {
     $session = $request->getSession();
@@ @@
    *
    * @param null $relayState
    *
-   * @return \Symfony\Component\HttpFoundation\Response
+   * @return Response
    */
   protected function getSamlHttpPostResponse($serviceProvider, $requestId = '', $relayState = NULL): Response {
     $samlMessage = $this->samlGenerator->buildSamlMessage($serviceProvider, $requestId);
@@ @@
     }
     $assertion = $this->samlGenerator->buildAssertion($serviceProvider, $this->currentUser, $requestId);
     $this->samlGenerator->addAssertionToResponse($serviceProvider, $samlMessage, $assertion);
-    $bindingFactory = new \LightSaml\Binding\BindingFactory();
+    $bindingFactory = new BindingFactory();

-    $messageContext = new \LightSaml\Context\Profile\MessageContext();
+    $messageContext = new MessageContext();
     $messageContext->setMessage($samlMessage)->asResponse();

     // We only support SAML 2.0 HTTP POST binding for now.
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


11) modules/contrib/light_saml_idp/light_saml_idp.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Datetime\DateFormatter;
+use Drupal\Core\Render\Renderer;
 use LightSaml\Credential\X509Certificate;
 use Drupal\Component\Render\MarkupInterface;

@@ @@
 /**
  * Outputs readable x509 certificate info.
  *
- * @param \LightSaml\Credential\X509Certificate $cert
+ * @param X509Certificate $cert
  *
- * @return \Drupal\Component\Render\MarkupInterface|null
+ * @return MarkupInterface|null
  * @throws \Exception
  */
 function _light_saml_idp_cert_info(X509Certificate $cert): ?MarkupInterface {
   if ($cert->getInfo() !== null) {
-    /** @var \Drupal\Core\Datetime\DateFormatter $dateFormatter */
+    /** @var DateFormatter $dateFormatter */
     $dateFormatter = \Drupal::service('date.formatter');
-    /** @var \Drupal\Core\Render\Renderer $renderer */
+    /** @var Renderer $renderer */
     $renderer = \Drupal::service('renderer');

     $info = [
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


 [OK] 11 files have been changed by Rector                                      


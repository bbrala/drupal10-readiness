diff --git a/simple_html_mail.info.yml b/simple_html_mail.info.yml
index 846e6a8..3bfd022 100644
--- a/simple_html_mail.info.yml
+++ b/simple_html_mail.info.yml
@@ -1,8 +1,7 @@
 name: Simple HTML mail
 description: Sending HTML templated mails
 type: module
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: Mail
 configure: simple_html_mail.settings
 dependencies:
diff --git a/simple_html_mail.install b/simple_html_mail.install
index 560ae96..a5ff309 100644
--- a/simple_html_mail.install
+++ b/simple_html_mail.install
@@ -9,7 +9,7 @@ function simple_html_mail_install() {
 
   $data = file_get_contents('modules/contrib/simple_html_mail/images/email-logo.png');
 
-  $file_info = file_save_data($data, 'public://email-logo.png', FileSystemInterface::EXISTS_REPLACE);
+  $file_info = \Drupal::service('file.repository')->writeData($data, 'public://email-logo.png', FileSystemInterface::EXISTS_REPLACE);
 
   $config->set('image', [$file_info->id()])->save(TRUE);
 }
diff --git a/simple_html_mail.module b/simple_html_mail.module
index 08387c6..0975db8 100644
--- a/simple_html_mail.module
+++ b/simple_html_mail.module
@@ -1,5 +1,6 @@
 <?php
 
+use Drupal\file\Entity\File;
 /**
  * @file
  */
@@ -22,7 +23,7 @@ function simple_html_mail_send($params) {
       if ($params['body'] instanceof Markup) {
         $params['body'] = $params['body']->__toString();
       } elseif (isset($params['body']['#theme'])) {
-        $params['body'] = render($params['body'])->__toString();
+        $params['body'] = \Drupal::service('renderer')->render($params['body'])->__toString();
       }
       reroute_email_mail_alter($params);
       // Return back Markup object so that HTML is rendered.
@@ -38,7 +39,7 @@ function simple_html_mail_send($params) {
   $from = $site_config->get('mail');
   $from_name = $site_config->get('name');
 
-  $image_file = \Drupal\file\Entity\File::load($mail_config->get('image')[0]);
+  $image_file = File::load($mail_config->get('image')[0]);
 
   if ($image_file) {
     $image_uri = $image_file->getFileUri();
@@ -47,7 +48,7 @@ function simple_html_mail_send($params) {
   $params['site_name'] = $from_name;
   $params['header_slogan'] = $mail_config->get('header_slogan');
   $params['footer_text'] = $mail_config->get('footer_text');
-  $params['image'] = isset($image_uri) ? file_create_url($image_uri) : '';
+  $params['image'] = isset($image_uri) ? \Drupal::service('file_url_generator')->generateAbsoluteString($image_uri) : '';
 
   $html = [
     '#theme' => 'simple_html_mail',
@@ -134,7 +135,7 @@ function simple_html_mail_mail_alter(&$message) {
       $body_text .= $item;
     }
 
-    $image_file = \Drupal\file\Entity\File::load($mail_config->get('image')[0]);
+    $image_file = File::load($mail_config->get('image')[0]);
 
     if ($image_file) {
       $image_uri = $image_file->getFileUri();
@@ -147,7 +148,7 @@ function simple_html_mail_mail_alter(&$message) {
       'site_name' => $site_config->get('name'),
       'header_slogan' => $mail_config->get('header_slogan'),
       'footer_text' => $mail_config->get('footer_text'),
-      'image' => isset($image_uri) ? file_create_url($image_uri) : '',
+      'image' => isset($image_uri) ? \Drupal::service('file_url_generator')->generateAbsoluteString($image_uri) : '',
     ];
 
     $body = [
diff --git a/src/Form/HtmlMailSettingsForm.php b/src/Form/HtmlMailSettingsForm.php
index 7627ee4..7f64852 100644
--- a/src/Form/HtmlMailSettingsForm.php
+++ b/src/Form/HtmlMailSettingsForm.php
@@ -2,6 +2,9 @@
 
 namespace Drupal\simple_html_mail\Form;
 
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\Entity\EntityStorageException;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Form\ConfigFormBase;
@@ -16,16 +19,16 @@ class HtmlMailSettingsForm extends ConfigFormBase {
   /**
    * The entity type manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * Constructs a HtmlMailSettingsForm object.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The factory for configuration objects.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager.
    */
   public function __construct(ConfigFactoryInterface $config_factory, EntityTypeManagerInterface $entity_type_manager) {
@@ -105,10 +108,10 @@ class HtmlMailSettingsForm extends ConfigFormBase {
    * {@inheritdoc}
    *
    * @param array $form
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @param FormStateInterface $form_state
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
+   * @throws EntityStorageException
    */
   public function submitForm(array &$form, FormStateInterface $form_state) {
     // Save image as permanent.

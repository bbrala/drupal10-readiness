diff --git a/src/Controller/DownloadCountController.php b/src/Controller/DownloadCountController.php
index f51d68a..c5e83ac 100644
--- a/src/Controller/DownloadCountController.php
+++ b/src/Controller/DownloadCountController.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\download_count\Controller;
 
+use Drupal\Core\Queue\QueueInterface;
 use Drupal\Component\Utility\Unicode;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Controller\ControllerBase;
@@ -23,41 +24,41 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
   /**
    * Configuration factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;
 
   /**
    * Current user object.
    *
-   * @var \Drupal\Core\Session\AccountInterface
+   * @var AccountInterface
    */
   protected $currentUser;
 
   /**
    * Date Formatter.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $dateFormatter;
 
   /**
    * Queue manager.
    *
-   * @var \Drupal\Core\Queue\QueueInterface
+   * @var QueueInterface
    */
   protected $queue;
 
   /**
    * DownloadCountController constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   Config Factory.
-   * @param \Drupal\Core\Session\AccountInterface $current_user
+   * @param AccountInterface $current_user
    *   Current User.
-   * @param \Drupal\Core\Datetime\DateFormatterInterface $date_formatter
+   * @param DateFormatterInterface $date_formatter
    *   Date Formatter.
-   * @param \Drupal\Core\Queue\QueueFactory $queue
+   * @param QueueFactory $queue
    *   Queue Manager.
    */
   public function __construct(ConfigFactoryInterface $config_factory, AccountInterface $current_user, DateFormatterInterface $date_formatter, QueueFactory $queue) {
@@ -240,7 +241,7 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
       '#empty' => $this->t('No files have been downloaded.'),
     ];
 
-    $output .= render($table);
+    $output .= \Drupal::service('renderer')->render($table);
 
     $output .= '<div id="download-count-total-bottom">' . $this->t('Total Downloads:') . ' ' . number_format($total_downloads) . '</div>';
     if ($items_per_page > 0) {
@@ -251,7 +252,7 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
         '#route_name' => 'download_count.reports',
         'attributes' => ['tags' => []],
       ];
-      $output .= render($pager);
+      $output .= \Drupal::service('renderer')->render($pager);
     }
     if (!empty($page_footer['value'])) {
       $output .= '<div id="download-count-footer">' . Html::escape($page_footer['value'], $page_footer['format']) . '</div>';
@@ -355,7 +356,7 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
     $query->range(0, $config->get('download_count_details_daily_limit'));
     $result = $query->execute();
     $daily = $this->downloadCountDetailsTable($result, 'Daily', 'Day');
-    $output .= render($daily['output']);
+    $output .= \Drupal::service('renderer')->render($daily['output']);
     if ($sparkline_type != 'none') {
       $values['daily'] = implode(',', array_reverse($daily['values']));
       $output .= '<div class="download-count-sparkline-daily">' . $this->t('Rendering Sparkline...') . '</div>';
@@ -367,7 +368,7 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
     $query->range(0, $config->get('download_count_details_weekly_limit'));
     $result = $query->execute();
     $weekly = $this->downloadCountDetailsTable($result, 'Weekly', 'Week');
-    $output .= render($weekly['output']);
+    $output .= \Drupal::service('renderer')->render($weekly['output']);
     if ($sparkline_type != 'none') {
       $values['weekly'] = implode(',', array_reverse($weekly['values']));
       $output .= '<div class="download-count-sparkline-weekly">' . $this->t('Rendering Sparkline...') . '</div>';
@@ -378,7 +379,7 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
     $query->range(0, $config->get('download_count_details_monthly_limit'));
     $result = $query->execute();
     $monthly = $this->downloadCountDetailsTable($result, 'Monthly', 'Month');
-    $output .= render($monthly['output']);
+    $output .= \Drupal::service('renderer')->render($monthly['output']);
     if ($sparkline_type != 'none') {
       $values['monthly'] = implode(',', array_reverse($monthly['values']));
       $output .= '<div class="download-count-sparkline-monthly">' . $this->t('Rendering Sparkline...') . '</div>';
@@ -389,7 +390,7 @@ class DownloadCountController extends ControllerBase implements ContainerInjecti
     $query->range(0, $config->get('download_count_details_yearly_limit'));
     $result = $query->execute();
     $yearly = $this->downloadCountDetailsTable($result, 'Yearly', 'Year');
-    $output .= render($yearly['output']);
+    $output .= \Drupal::service('renderer')->render($yearly['output']);
     if ($sparkline_type != 'none') {
       $values['yearly'] = implode(',', array_reverse($yearly['values']));
       $output .= '<div class="download-count-sparkline-yearly">' . $this->t('Rendering Sparkline...') . '</div>';
diff --git a/src/Plugin/Block/RecentDownload.php b/src/Plugin/Block/RecentDownload.php
index 7329985..5b36a2d 100644
--- a/src/Plugin/Block/RecentDownload.php
+++ b/src/Plugin/Block/RecentDownload.php
@@ -25,7 +25,7 @@ class RecentDownload extends BlockBase implements ContainerFactoryPluginInterfac
   /**
    * The date formatter service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatterInterface
+   * @var DateFormatterInterface
    */
   protected $dateFormatter;
 
diff --git a/src/Plugin/Field/FieldFormatter/FieldDownloadCount.php b/src/Plugin/Field/FieldFormatter/FieldDownloadCount.php
index e4aa23d..f9fbe65 100644
--- a/src/Plugin/Field/FieldFormatter/FieldDownloadCount.php
+++ b/src/Plugin/Field/FieldFormatter/FieldDownloadCount.php
@@ -45,7 +45,7 @@ class FieldDownloadCount extends GenericFileFormatter {
         $file->download = $download;
       }
 
-      $url = file_create_url($file->getFileUri());
+      $url = \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri());
 
       $options = [
         'attributes' => [

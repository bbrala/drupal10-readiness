modules/contrib/filefield_paths/filefield_paths.api.php
modules/contrib/filefield_paths/filefield_paths.drush.inc
modules/contrib/filefield_paths/filefield_paths.inc
modules/contrib/filefield_paths/filefield_paths.install
modules/contrib/filefield_paths/filefield_paths.module
modules/contrib/filefield_paths/filefield_paths.tokens.inc
modules/contrib/filefield_paths/src/Form/SettingsForm.php
modules/contrib/filefield_paths/src/Redirect.php
modules/contrib/filefield_paths/src/RedirectInterface.php
modules/contrib/filefield_paths/tests/filefield_paths_test/src/StreamWrapper/FileFieldPathsDummyReadOnlyStreamWrapper.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsGeneralTest.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsPathautoTest.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsRedirectTest.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsTestBase.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsTokensTest.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsTransliterationTest.php
modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsUpdateTest.php

13 files with changes
=====================

1) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsUpdateTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Drupal\Core\Entity\Entity\EntityViewDisplay;
+use Drupal\file\Entity\File;
 /**
  * Test update functionality.
  *
@@ @@
     $this->createImageField($field_name, $this->contentType, []);

     // Modify display settings.
-    /** @var \Drupal\Core\Entity\Entity\EntityViewDisplay $display */
+    /** @var EntityViewDisplay $display */
     $display = \Drupal::entityTypeManager()
       ->getStorage('entity_view_display')
       ->load("node.{$this->contentType}.default");
@@ @@
     ])->save();

     $this->drupalGet("admin/structure/types/manage/{$this->contentType}/display");
-    /** @var \Drupal\Core\Entity\Entity\EntityViewDisplay $original_display */
+    /** @var EntityViewDisplay $original_display */
     $original_display = \Drupal::entityTypeManager()
       ->getStorage('entity_view_display')
       ->load("node.{$this->contentType}.default");

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('image');
     $nid = $this->uploadNodeFile($test_file, $field_name, $this->contentType);
     $this->submitForm(["{$field_name}[0][alt]" => $this->randomString()], 'Save');
@@ @@
     $this->drupalGet("node/{$nid}");
     $date = date('Y-m');
     // The File is in the default path.
-    $this->assertRaw("{$this->publicFilesDirectory}/styles/thumbnail/public/{$date}/{$test_file->getFilename()}");
+    $this->assertSession()->responseContains("{$this->publicFilesDirectory}/styles/thumbnail/public/{$date}/{$test_file->getFilename()}");

     // Trigger retroactive updates.
     $this->drupalGet("admin/structure/types/manage/{$this->contentType}/fields/node.{$this->contentType}.{$field_name}");
@@ @@
     // Ensure that the file path has been retroactively updated.
     $this->drupalGet("node/{$nid}");
     // The File path has been retroactively updated.
-    $this->assertRaw("{$this->publicFilesDirectory}/styles/thumbnail/public/node/{$nid}/{$test_file->getFilename()}");
+    $this->assertSession()->responseContains("{$this->publicFilesDirectory}/styles/thumbnail/public/node/{$nid}/{$test_file->getFilename()}");
   }

 }
    ----------- end diff -----------

Applied rules:
 * AssertRawRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


2) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsTransliterationTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Drupal\file\Entity\File;
 use Drupal\Component\Utility\Unicode;

 /**
@@ @@
     $this->drupalGet("admin/structure/types/manage/{$this->contentType}/fields/node.{$this->contentType}.{$field_name}");
     foreach (['path', 'name'] as $field) {
       // Transliteration checkbox is present in File settings.
-      $this->assertField("third_party_settings[filefield_paths][file_{$field}][options][transliterate]");
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // Change assertion to buttonExists() if checking for a button.
+      $this->assertSession()->fieldExists("third_party_settings[filefield_paths][file_{$field}][options][transliterate]");

       $element = $this->xpath('//input[@name=:name]/@disabled', [':name' => "third_party_settings[filefield_paths][file_{$field}][options][transliterate]"]);
       $this->assertEmpty($element, 'Transliteration checkbox is not disabled in File ' . Unicode::ucfirst($field) . ' settings.');
@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $edit['title[0][value]'] = 'тест';

@@ @@
     // Ensure that file path/name have been processed correctly by
     // Transliteration.
     $node = \Drupal::entitytypeManager()->getStorage('node')->load($nid);
-    $this->assertEqual($node->{$field_name}[0]->entity->getFileUri(), "public://node/test/test.txt", 'File path/name has been processed correctly by Transliteration');
+    $this->assertEquals($node->{$field_name}[0]->entity->getFileUri(), "public://node/test/test.txt", 'File path/name has been processed correctly by Transliteration');
   }

 }
    ----------- end diff -----------

Applied rules:
 * AssertEqualRector
 * AssertFieldRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


3) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsTokensTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Drupal\file\Entity\File;
+use Drupal\Core\File\FileSystemInterface;
 /**
  * Test token functionality.
  *
@@ @@
    */
   public function testTokensBasic() {
     // Prepare a test text file.
-    /** @var \Drupal\file\Entity\File $text_file */
+    /** @var File $text_file */
     $text_file = $this->getTestFile('text');
     $text_file->save();

@@ @@
    */
   public function testTokensMoved() {
     // Prepare a test text file.
-    /** @var \Drupal\file\Entity\File $text_file */
+    /** @var File $text_file */
     $text_file = $this->getTestFile('text');
     $text_file->save();

     // Move the text file.
-    $moved_file = file_move($text_file, 'public://moved.diff');
+    $moved_file = \Drupal::service('file.repository')->move($text_file, 'public://moved.diff');

     // Ensure tokens are processed correctly.
     $data = ['file' => $moved_file];
@@ @@
    */
   public function testTokensMultiExtension() {
     // Prepare a test text file.
-    /** @var \Drupal\file\Entity\File $text_file */
+    /** @var File $text_file */
     $text_file = $this->getTestFile('text');
-    /** @var \Drupal\Core\File\FileSystemInterface $file_system */
+    /** @var FileSystemInterface $file_system */
     $file_system = \Drupal::service('file_system');
     $file_system->copy($text_file->getFileUri(), 'public://text.multiext.txt');
     $files = $file_system->scanDirectory('public://', '/text\.multiext\.txt/');
     $multiext_file = current($files);
-    /** @var \Drupal\file\Entity\File $multiext_file */
+    /** @var File $multiext_file */
     $multiext_file = \Drupal::entityTypeManager()
       ->getStorage('file')
       ->create((array) $multiext_file);
@@ @@
    */
   public function testTokensUtf() {
     // Prepare a test text file.
-    /** @var \Drupal\file\Entity\File $text_file */
+    /** @var File $text_file */
     $text_file = $this->getTestFile('text');
-    /** @var \Drupal\Core\File\FileSystemInterface $file_system */
+    /** @var FileSystemInterface $file_system */
     $file_system = \Drupal::service('file_system');
     $file_system->copy($text_file->getFileUri(), 'public://тест.txt');
     $files = $file_system->scanDirectory('public://', '/тест\.txt/');
     $utf_file = current($files);
-    /** @var \Drupal\file\Entity\File $utf_file */
+    /** @var File $utf_file */
     $utf_file = \Drupal::entityTypeManager()
       ->getStorage('file')
       ->create((array) $utf_file);
    ----------- end diff -----------

Applied rules:
 * FileMoveRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsTestBase.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Behat\Mink\Exception\ResponseTextException;
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\Entity\EntityStorageException;
+use Drupal\Core\Entity\EntityDisplayRepositoryInterface;
+use Drupal\Core\Entity\EntityInterface;
 use Drupal\Tests\file\Functional\FileFieldTestBase;
 use Drupal\Tests\TestFileCreationTrait;

@@ @@
    * @param array $widget_settings
    *   A list of widget settings that will be added to the widget defaults.
    *
-   * @throws \Behat\Mink\Exception\ResponseTextException
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws ResponseTextException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
+   * @throws EntityStorageException
    */
   public function createFileField($name, $entity_type, $bundle, $storage_settings = [], $field_settings = [], $third_party_settings = [], $widget_settings = []) {
     $entity_type_manager = \Drupal::entityTypeManager();
@@ @@
       ->create($field)
       ->save();

-    /** @var \Drupal\Core\Entity\EntityDisplayRepositoryInterface $edr */
+    /** @var EntityDisplayRepositoryInterface $edr */
     $edr = \Drupal::service('entity_display.repository');
     $edr->getFormDisplay($entity_type, $bundle, 'default')
       ->setComponent($name, [
@@ @@
    * @param array $widget_settings
    *   A list of widget settings that will be added to the widget defaults.
    *
-   * @return \Drupal\Core\Entity\EntityInterface
+   * @return EntityInterface
    *   A image field configuration entity.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
+   * @throws EntityStorageException
    */
   public function createImageField($name, $type_name, array $storage_settings = [], array $field_settings = [], array $third_party_settings = [], array $widget_settings = []) {
     $entity_type_manager = \Drupal::entityTypeManager();
@@ @@
       ]);
     $field_config->save();

-    /** @var \Drupal\Core\Entity\EntityDisplayRepositoryInterface $edr */
+    /** @var EntityDisplayRepositoryInterface $edr */
     $edr = \Drupal::service('entity_display.repository');
     $edr->getFormDisplay('node', $type_name, 'default')
       ->setComponent($name, [
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsRedirectTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Drupal\Core\Entity\EntityTypeManagerInterface;
+use Drupal\file\Entity\File;
 use Drupal\Core\StreamWrapper\PublicStream;

 /**
@@ @@
   /**
    * Entity type manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $nid = $this->uploadNodeFile($test_file, $field_name, $this->contentType);
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsPathautoTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Drupal\file\Entity\File;
+use Drupal\node\NodeInterface;
 use Drupal\Component\Utility\Unicode;

 /**
@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $node_title = $this->randomString() . ' ' . $this->randomString();
     $edit['title[0][value]'] = $node_title;
@@ @@
     $this->submitForm($edit, 'Save');

     // Ensure that file path/name have been processed correctly by Pathauto.
-    /** @var \Drupal\node\NodeInterface[] $nodes */
+    /** @var NodeInterface[] $nodes */
     $nodes = \Drupal::service('entity_type.manager')->getStorage('node')
       ->loadByProperties(['title' => $node_title]);
     $node = reset($nodes);
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


7) modules/contrib/filefield_paths/tests/src/Functional/FileFieldPathsGeneralTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\filefield_paths\Functional;

+use Drupal\file\Entity\File;
+use Drupal\node\NodeStorage;
+use Drupal\file\FileUsage\FileUsageInterface;
 use Drupal\Core\Field\FieldStorageDefinitionInterface;
 use Drupal\node\Entity\Node;

@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $this->drupalGet("node/add/{$this->contentType}");
     $edit['title[0][value]'] = $this->randomMachineName();
@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $nid = $this->uploadNodeFile($test_file, $field_name, $this->contentType);

@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node without an attached file.
-    /** @var \Drupal\node\Entity\Node $node */
+    /** @var Node $node */
     $node = $this->drupalCreateNode(['type' => $this->contentType]);

     // Create a file object.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $test_file->setPermanent();
     $test_file->save();
@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');

     $title = "{$this->randomMachineName()}/{$this->randomMachineName()}";
@@ @@
    * Test a file usage of a basic file upload with File (Field) Paths.
    */
   public function testFileUsage() {
-    /** @var \Drupal\node\NodeStorage $node_storage */
+    /** @var NodeStorage $node_storage */
     $node_storage = $this->container->get('entity_type.manager')
       ->getStorage('node');
-    /** @var \Drupal\file\FileUsage\FileUsageInterface $file_usage */
+    /** @var FileUsageInterface $file_usage */
     $file_usage = $this->container->get('file.usage');

     // Create a File field with 'node/[node:nid]' as the File path.
@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, [], [], $third_party_settings);

     // Create a node with a test file.
-    /** @var \Drupal\file\Entity\File $test_file */
+    /** @var File $test_file */
     $test_file = $this->getTestFile('text');
     $nid = $this->uploadNodeFile($test_file, $field_name, $this->contentType);

@@ @@
     $this->createFileField($field_name, 'node', $this->contentType, $field_settings, $instance_settings);

     // Get a test file.
-    /** @var \Drupal\file\Entity\File $file */
+    /** @var File $file */
     $file = $this->getTestFile('image');

     // Prepare the file for the test 'ffp-dummy-readonly://' read-only stream
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


8) modules/contrib/filefield_paths/src/RedirectInterface.php:15

    ---------- begin diff ----------
@@ @@
    *   The source file URL.
    * @param string $path
    *   The moved file URL.
-   * @param \Drupal\Core\Language\Language $language
+   * @param Language $language
    *   The language of the source file.
    */
   public function createRedirect($source, $path, Language $language);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


9) modules/contrib/filefield_paths/src/Redirect.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\filefield_paths;

+use Drupal\Core\Entity\EntityStorageInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\StreamWrapper\StreamWrapperManager;
@@ @@
   /**
    * The redirect storage.
    *
-   * @var \Drupal\Core\Entity\EntityStorageInterface
+   * @var EntityStorageInterface
    */
   protected $redirectStorage;

@@ @@
   /**
    * The stream wrapper manager.
    *
-   * @var \Drupal\Core\StreamWrapper\StreamWrapperManagerInterface
+   * @var StreamWrapperManagerInterface
    */
   protected $streamWrapperManager;

@@ @@
   /**
    * The config factory service.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

@@ @@
   /**
    * A logger instance.
    *
-   * @var \Psr\Log\LoggerInterface
+   * @var LoggerInterface
    */
   protected $logger;

@@ @@
   /**
    * Constructs a new redirect service.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager.
-   * @param \Drupal\Core\StreamWrapper\StreamWrapperManagerInterface $stream_wrapper_manager
+   * @param StreamWrapperManagerInterface $stream_wrapper_manager
    *   The stream wrapper manager.
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The config factory.
-   * @param \Psr\Log\LoggerInterface $logger
+   * @param LoggerInterface $logger
    *   The logger service.
    */
   public function __construct(EntityTypeManagerInterface $entity_type_manager, StreamWrapperManagerInterface $stream_wrapper_manager, ConfigFactoryInterface $config_factory, LoggerInterface $logger) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


10) modules/contrib/filefield_paths/src/Form/SettingsForm.php:20

    ---------- begin diff ----------
@@ @@
   /**
    * Stream wrapper manager.
    *
-   * @var \Drupal\Core\StreamWrapper\StreamWrapperManagerInterface
+   * @var StreamWrapperManagerInterface
    */
   protected $streamWrapperManager;

@@ @@
   /**
    * Fi;esystem service.
    *
-   * @var \Drupal\Core\File\FileSystemInterface
+   * @var FileSystemInterface
    */
   protected $fileSystem;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


11) modules/contrib/filefield_paths/filefield_paths.tokens.inc:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\file\Entity\File;
 /**
  * @file
  * Tokens for the File (Field) Paths module.
@@ @@
   if ($type == 'file' && !empty($data['file'])) {
     $file_system = \Drupal::service('file_system');

-    /** @var \Drupal\file\Entity\File $file */
+    /** @var File $file */
     $file = $data['file'];

     foreach ($tokens as $name => $original) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


12) modules/contrib/filefield_paths/filefield_paths.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Entity\EntityTypeInterface;
+use Drupal\Core\Entity\ContentEntityStorageBase;
 /**
  * @file
  * Contains core functions for the File (Field) Paths module.
@@ @@
 /**
  * Implements hook_entity_base_field_info().
  */
-function filefield_paths_entity_base_field_info(\Drupal\Core\Entity\EntityTypeInterface $entity_type) {
+function filefield_paths_entity_base_field_info(EntityTypeInterface $entity_type) {
   $fields = [];
   if ($entity_type->id() == 'file') {
     $fields['origname'] = BaseFieldDefinition::create('string')
@@ @@
  * Implements hook_form_FORM_ID_alter().
  */
 function filefield_paths_form_field_config_edit_form_alter(array &$form, FormStateInterface $form_state) {
-  /** @var Drupal\field\Entity\FieldConfig $field */
+  /** @var FieldConfig $field */
   $field = $form_state->getFormObject()->getEntity();
   $class = $field->getClass();

@@ @@
     $context['sandbox']['max'] = count($objects);
     $context['sandbox']['objects'] = $objects;
   }
-  /** @var Drupal\Core\Entity\ContentEntityStorageBase $entity_storage */
+  /** @var ContentEntityStorageBase $entity_storage */
   $entity_storage = \Drupal::entityTypeManager()
     ->getStorage($field_config->getTargetEntityTypeId());

@@ @@
  *   The source file URL.
  * @param string $path
  *   The moved file URL.
- * @param \Drupal\Core\Language\Language $language
+ * @param Language $language
  *   The language of the source file.
  *
  * @deprecated in filefield_paths:1.0.0 and will be removed before
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


13) modules/contrib/filefield_paths/filefield_paths.inc:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\field\Entity\FieldConfig;
+use Drupal\field\Entity\FieldStorageConfig;
+use Drupal\file\Entity\File;
 /**
  * @file
  * File (Field) Paths module integration.
@@ @@
  * Implements hook_filefield_paths_process_file().
  */
 function filefield_paths_filefield_paths_process_file(ContentEntityInterface $entity, FileFieldItemList $field, array $settings = []) {
-  /** @var \Drupal\field\Entity\FieldConfig $field_config */
+  /** @var FieldConfig $field_config */
   $field_config = $field->getFieldDefinition();
-  /** @var \Drupal\field\Entity\FieldStorageConfig $field_storage */
+  /** @var FieldStorageConfig $field_storage */
   $field_storage = $field_config->getFieldStorageDefinition();

   $file_system = \Drupal::service('file_system');
@@ @@
   $wrappers = $stream_wrapper_manager->getWrappers(StreamWrapperInterface::WRITE);

   $destination_scheme_name = $field_storage->getSetting('uri_scheme');
-  /** @var \Drupal\Core\StreamWrapper\StreamWrapperInterface $temporary_scheme */
+  /** @var StreamWrapperInterface $temporary_scheme */
   $temporary_scheme = $stream_wrapper_manager->getViaUri(\Drupal::config('filefield_paths.settings')
     ->get('temp_location'));
   $temporary_scheme_name = key($stream_wrapper_manager->getWrappers($temporary_scheme->getType()));
   $schemas = [$temporary_scheme_name, $destination_scheme_name];

-  /** @var \Drupal\file\Entity\File $file */
+  /** @var File $file */
   foreach ($field->referencedEntities() as $file) {
-    /** @var \Drupal\Core\StreamWrapper\StreamWrapperInterface $source_scheme */
+    /** @var StreamWrapperInterface $source_scheme */
     $source_scheme = $stream_wrapper_manager->getViaUri($file->getFileUri());
     $source_scheme_name = key($stream_wrapper_manager->getWrappers($source_scheme->getType()));
     if (in_array($source_scheme_name, $schemas) && !empty($wrappers[$destination_scheme_name])) {
@@ @@
       // Process file if this is a new entity, 'Active updating' is set or
       // file wasn't previously attached to the entity.
       if (!$entity->isNew() && isset($entity->original) && empty($settings['active_updating']) && !$entity->original->{$field->getName()}->isEmpty()) {
-        /** @var \Drupal\file\Entity\File $original_file */
+        /** @var File $original_file */
         foreach ($entity->original->{$field->getName()}->referencedEntities() as $original_file) {
           if ($original_file->id() == $file->id()) {
             continue(2);
@@ @@
         $dirname = $file_system->dirname($destination);
         if (
           \Drupal::service('file_system')->prepareDirectory($dirname, FileSystem::CREATE_DIRECTORY)
-          && $new_file = file_move($file, $destination)
+          && $new_file = \Drupal::service('file.repository')->move($file, $destination)
         ) {
           // Create redirect from old location.
           if (
    ----------- end diff -----------

Applied rules:
 * FileMoveRector
 * ArgumentRemoverRector


 [OK] 13 files have been changed by Rector                                      


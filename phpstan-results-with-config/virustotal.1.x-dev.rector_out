modules/contrib/virustotal/src/Controller/VirusTotalReportController.php
modules/contrib/virustotal/src/Entity/VirusTotalReport.php
modules/contrib/virustotal/src/Entity/VirusTotalReportInterface.php
modules/contrib/virustotal/src/Entity/VirusTotalReportViewsData.php
modules/contrib/virustotal/src/EventSubscriber/VirusTotalFileDeleteSubscriber.php
modules/contrib/virustotal/src/EventSubscriber/VirusTotalFileInsertSubscriber.php
modules/contrib/virustotal/src/Form/VirusTotalCommentForm.php
modules/contrib/virustotal/src/Form/VirusTotalReportDeleteForm.php
modules/contrib/virustotal/src/Form/VirusTotalReportForm.php
modules/contrib/virustotal/src/Form/VirusTotalReportSettingsForm.php
modules/contrib/virustotal/src/Form/VirusTotalScanURLForm.php
modules/contrib/virustotal/src/Form/VirusTotalSettingsForm.php
modules/contrib/virustotal/src/Plugin/VirusTotal/VirusTotalScanner.php
modules/contrib/virustotal/src/VirusTotalReportAccessControlHandler.php
modules/contrib/virustotal/src/VirusTotalReportHtmlRouteProvider.php
modules/contrib/virustotal/src/VirusTotalReportListBuilder.php
modules/contrib/virustotal/src/VirusTotalReportTranslationHandler.php
modules/contrib/virustotal/virustotal.install
modules/contrib/virustotal/virustotal.module

13 files with changes
=====================

1) modules/contrib/virustotal/virustotal.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\Entity\EntityMalformedException;
+use Drupal\Core\Entity\EntityStorageException;
+use Drupal\virustotal\Entity\VirusTotalReport;
 /**
  * @file
  * virustotal.module
@@ @@
 /**
  * Implements hook_cron().
  *
- * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
- * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
- * @throws \Drupal\Core\Entity\EntityMalformedException
- * @throws \Drupal\Core\Entity\EntityStorageException
+ * @throws InvalidPluginDefinitionException
+ * @throws PluginNotFoundException
+ * @throws EntityMalformedException
+ * @throws EntityStorageException
  */
 function virustotal_cron() {
   // Get and set cron last run time.
@@ @@
   foreach ($entity_ids as $entity_id) {
     $report = $virustotal_storage->load($entity_id);
     if ($report !== NULL) {
-      /** @var \Drupal\virustotal\Entity\VirusTotalReport $report */
+      /** @var VirusTotalReport $report */
       $report->updateReport();
       if ($report->isInfected()) {
         $file = $report->getRelatedFile();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


2) modules/contrib/virustotal/virustotal.install:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\virustotal\Entity\VirusTotalReport;
 /**
  * @file
  * virustotal.install
@@ @@
     foreach ($entity_ids as $entity_id) {
       $report = $virustotal_storage->load($entity_id);
       if ($report !== NULL) {
-        /** @var \Drupal\virustotal\Entity\VirusTotalReport $report */
+        /** @var VirusTotalReport $report */
         if ($report->isInfected()) {
           $infected_entities_qty++;
         }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


3) modules/contrib/virustotal/src/VirusTotalReportHtmlRouteProvider.php:31

    ---------- begin diff ----------
@@ @@
   /**
    * Gets the settings form route.
    *
-   * @param \Drupal\Core\Entity\EntityTypeInterface $entity_type
+   * @param EntityTypeInterface $entity_type
    *   The entity type.
    *
-   * @return \Symfony\Component\Routing\Route|null
+   * @return Route|null
    *   The generated route, if available.
    */
   protected function getSettingsFormRoute(EntityTypeInterface $entity_type) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/virustotal/src/VirusTotalReportAccessControlHandler.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\virustotal;

+use Drupal\virustotal\Entity\VirusTotalReportInterface;
 use Drupal\Core\Entity\EntityAccessControlHandler;
 use Drupal\Core\Entity\EntityInterface;
 use Drupal\Core\Session\AccountInterface;
@@ @@
    * {@inheritdoc}
    */
   protected function checkAccess(EntityInterface $entity, $operation, AccountInterface $account) {
-    /** @var \Drupal\virustotal\Entity\VirusTotalReportInterface $entity */
+    /** @var VirusTotalReportInterface $entity */
     switch ($operation) {
       case 'view':
         if (!$entity->isPublished()) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/virustotal/src/Form/VirusTotalSettingsForm.php:19

    ---------- begin diff ----------
@@ @@
   /**
    * Constructs a CommonSettingsPageForm object.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The factory for configuration objects.
-   * @param \Drupal\Core\Cache\CacheBackendInterface $cacheBackend
+   * @param CacheBackendInterface $cacheBackend
    *   The cacheBackend service.
-   * @param \Drupal\Core\ProxyClass\Routing\RouteBuilder $routerBuilder
+   * @param RouteBuilder $routerBuilder
    *   The routerBuilder service.
    */
   public function __construct(ConfigFactoryInterface $config_factory, CacheBackendInterface $cacheBackend, RouteBuilder $routerBuilder) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/virustotal/src/Form/VirusTotalScanURLForm.php:22

    ---------- begin diff ----------
@@ @@
   /**
    * Constructs a CommonSettingsPageForm object.
    *
-   * @param \Drupal\Core\Cache\CacheBackendInterface $cacheBackend
+   * @param CacheBackendInterface $cacheBackend
    *   The cacheBackend service.
-   * @param \Drupal\dblog\Logger\DbLog $logger
+   * @param DbLog $logger
    *   The logger interface.
    */
   public function __construct(CacheBackendInterface $cacheBackend, DbLog $logger) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/virustotal/src/Form/VirusTotalReportSettingsForm.php:26

    ---------- begin diff ----------
@@ @@
    *
    * @param array $form
    *   An associative array containing the structure of the form.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The current state of the form.
    */
   public function submitForm(array &$form, FormStateInterface $form_state) {
@@ @@
    *
    * @param array $form
    *   An associative array containing the structure of the form.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The current state of the form.
    *
    * @return array
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


8) modules/contrib/virustotal/src/Form/VirusTotalReportForm.php:19

    ---------- begin diff ----------
@@ @@
   /**
    * The current user account.
    *
-   * @var \Drupal\Core\Session\AccountProxyInterface
+   * @var AccountProxyInterface
    */
   protected $account;

@@ @@
   /**
    * Constructs a new VirusTotalReportForm.
    *
-   * @param \Drupal\Core\Entity\EntityRepositoryInterface $entity_repository
+   * @param EntityRepositoryInterface $entity_repository
    *   The entity repository service.
-   * @param \Drupal\Core\Entity\EntityTypeBundleInfoInterface $entity_type_bundle_info
+   * @param EntityTypeBundleInfoInterface $entity_type_bundle_info
    *   The entity type bundle service.
-   * @param \Drupal\Component\Datetime\TimeInterface $time
+   * @param TimeInterface $time
    *   The time service.
-   * @param \Drupal\Core\Session\AccountProxyInterface $account
+   * @param AccountProxyInterface $account
    *   The current user account.
    */
   public function __construct(EntityRepositoryInterface $entity_repository, EntityTypeBundleInfoInterface $entity_type_bundle_info = NULL, TimeInterface $time = NULL, AccountProxyInterface $account) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


9) modules/contrib/virustotal/src/Form/VirusTotalCommentForm.php:17

    ---------- begin diff ----------
@@ @@
   /**
    * Constructs a CommonSettingsPageForm object.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entityTypeManager
+   * @param EntityTypeManagerInterface $entityTypeManager
    *   The entity type manager service.
    */
   public function __construct(EntityTypeManagerInterface $entityTypeManager) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


10) modules/contrib/virustotal/src/EventSubscriber/VirusTotalFileInsertSubscriber.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\virustotal\EventSubscriber;

+use Drupal\file\Entity\File;
+use Symfony\Component\HttpFoundation\Request;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityStorageException;
 use Drupal\Core\Routing\CurrentRouteMatch;
@@ @@
   /**
    * Method called when Event occurs.
    *
-   * @param \Drupal\entity_events\Event\EntityEvent $event
+   * @param EntityEvent $event
    *   The event.
    */
   public function onEntityInsert(EntityEvent $event) {
@@ @@
     if ($entity_type === 'file') {
       $file = $entity;
       if ($file !== NULL) {
-        /** @var \Drupal\file\Entity\File $file */
+        /** @var File $file */
         $file_url = getcwd() . $file->createFileUrl();
         $config = $this->configFactory->get('virustotal.api_config');
         if ($config->isNew() === FALSE && !empty($config->getRawData())) {
@@ @@
           // Get current request to fetch client IP.
           $current_request = $this->request->getCurrentRequest();
           if ($current_request !== NULL) {
-            /** @var \Symfony\Component\HttpFoundation\Request $current_request */
+            /** @var Request $current_request */
             $client_ip = $current_request->getClientIp();
           }
           $report_entity->setIpAddress($client_ip);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


11) modules/contrib/virustotal/src/EventSubscriber/VirusTotalFileDeleteSubscriber.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\virustotal\EventSubscriber;

+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\Entity\EntityStorageException;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Routing\CurrentRouteMatch;
@@ @@
   /**
    * Method called when Event occurs.
    *
-   * @param \Drupal\entity_events\Event\EntityEvent $event
+   * @param EntityEvent $event
    *   The event.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
+   * @throws EntityStorageException
    */
   public function onEntityDelete(EntityEvent $event) {
     // TODO: Implement onEntityDelete() method.
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


12) modules/contrib/virustotal/src/Entity/VirusTotalReport.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\virustotal\Entity;

+use Drupal\Core\Entity\EntityStorageException;
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
 use Drupal\Core\Entity\EntityStorageInterface;
 use Drupal\Core\Field\BaseFieldDefinition;
 use Drupal\Core\Entity\ContentEntityBase;
@@ @@
   /**
    * Provide a functionality for updating report after first scan.
    *
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws EntityStorageException
    */
   public function updateReport() {
     $config = \Drupal::configFactory()->get('virustotal.api_config');
@@ @@
    * @return mixed
    *   Returns related file entity object.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
    */
   public function getRelatedFile() {
     $entity_id = $this->get('related_entity_file_id')->value;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


13) modules/contrib/virustotal/src/Controller/VirusTotalReportController.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\virustotal\Controller;

+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\virustotal\Entity\VirusTotalReport;
+use Drupal\file\Entity\File;
 use Drupal\Core\Ajax\AjaxResponse;
 use Drupal\Core\Ajax\OpenModalDialogCommand;
 use Drupal\Core\Config\ConfigFactoryInterface;
@@ @@
    * @param int $report_id
    *   The report id.
    *
-   * @return \Symfony\Component\HttpFoundation\RedirectResponse
+   * @return RedirectResponse
    *   Redirect current user to entity view page.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
+   * @throws EntityStorageException
    */
   public function updateReport($report_id = NULL) {
     $vt_storage = $this->entityTypeManager()->getStorage('virustotal_report');
     $report = $vt_storage->load($report_id);
-    /** @var \Drupal\virustotal\Entity\VirusTotalReport $report */
+    /** @var VirusTotalReport $report */
     if ($report !== NULL) {
       $report->updateReport();
     }
@@ @@
    * @param string $hash
    *   VT resource(file) hash.
    *
-   * @return \Drupal\Core\Ajax\AjaxResponse
+   * @return AjaxResponse
    *   Returns detailed report in a JSON format.
    */
   public function getScanInfo($hash) {
@@ @@
    * @param string $hash
    *   Resource hash string.
    *
-   * @return \Drupal\Core\Ajax\AjaxResponse
+   * @return AjaxResponse
    *   Returns AJAX response object.
    */
   public function getComments($hash) {
@@ @@
    * @param string $ip_address
    *   Client IP Address.
    *
-   * @return \Drupal\Core\Ajax\AjaxResponse
+   * @return AjaxResponse
    *   Returns AJAX response object.
    */
   public function getIpInfo($ip_address) {
@@ @@
    * @param string $fid
    *   File id.
    *
-   * @return \Symfony\Component\HttpFoundation\RedirectResponse
+   * @return RedirectResponse
    *   Redirect response object.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
    */
   public function removeFile($fid = '') {
     $file_storage = $this->entityTypeManager()->getStorage('file');
     $file = $file_storage->load($fid);
-    /** @var \Drupal\file\Entity\File $file */
+    /** @var File $file */
     if ($file !== NULL) {
       $filename = $file->getFilename();
       try {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


 [OK] 13 files have been changed by Rector                                      


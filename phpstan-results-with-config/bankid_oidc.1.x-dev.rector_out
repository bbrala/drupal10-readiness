modules/contrib/bankid_oidc/bankid_oidc.module
modules/contrib/bankid_oidc/src/BankIdAuth.php
modules/contrib/bankid_oidc/src/BankIdAuthInterface.php
modules/contrib/bankid_oidc/src/Controller/LoginController.php
modules/contrib/bankid_oidc/src/Form/ConfigForm.php
modules/contrib/bankid_oidc/tests/Controller/LoginControllerTest.php

5 files with changes
====================

1) modules/contrib/bankid_oidc/tests/Controller/LoginControllerTest.php:23

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
   }
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/bankid_oidc/src/Controller/LoginController.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\bankid_oidc\Controller;

+use Drupal\Core\Config\ImmutableConfig;
+use Drupal\externalauth\ExternalAuthInterface;
+use BankID\OAuth2\Client\Token\AccessToken;
+use Symfony\Component\HttpFoundation\Session\SessionInterface;
 use BankID\OAuth2\Client\Provider\BankIdProvider;
 use Drupal\bankid_oidc\BankIdAuthInterface;
 use Drupal\Core\Controller\ControllerBase;
@@ @@
   protected const SESSION_OAUTH_STATE_NAME = 'bankid_oidc_state';

   /**
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $moduleConfig;

   /**
-   * @var \Psr\Log\LoggerInterface
+   * @var LoggerInterface
    */
   protected $logger;

   /**
-   * @var \Drupal\externalauth\ExternalAuthInterface
+   * @var ExternalAuthInterface
    */
   protected $userAuth;

   /**
-   * @var \BankID\OAuth2\Client\Provider\BankIdProvider
+   * @var BankIdProvider
    */
   protected $oauthClient;

@@ @@
    * @param string|null $name
    *  Optional: Return only 1 config item.
    *
-   * @return \Drupal\Core\Config\ImmutableConfig|mixed
+   * @return ImmutableConfig|mixed
    */
   protected function getConfig(string $name = NULL) {
     if (!$this->moduleConfig) {
@@ @@
     $response->addCacheableDependency($destination);
     try {
       $grant_options = ['code' => $code];
-      /** @var \BankID\OAuth2\Client\Token\AccessToken $accessToken */
+      /** @var AccessToken $accessToken */
       $accessToken = $this->oauthClient()
         ->getAccessToken('authorization_code', $grant_options);
     }
@@ @@
   /**
    * Ensures that the 'state' matches in both session and request query.
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The request to validate.
    *
    * @return bool
@@ @@
   /**
    * Sets the 'state' code for a given session (will start a new one if required).
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The request for the session.
    * @param string $state_code
    *   The 'state' to save in the session.
@@ @@
   protected function setSessionState(Request $request, string $state_code): void {
     $session = $request->getSession();
     if (!$session) {
-      /** @var \Symfony\Component\HttpFoundation\Session\SessionInterface $session */
+      /** @var SessionInterface $session */
       $session = \Drupal::service('session');
       $request->setSession($session);
       $session->start();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/bankid_oidc/src/BankIdAuthInterface.php:14

    ---------- begin diff ----------
@@ @@
   /**
    * Returns the oAuth client for BankID.
    *
-   * @return \BankID\OAuth2\Client\Provider\BankIdProvider
+   * @return BankIdProvider
    */
   public function oauthClient(): BankIdProvider;

@@ @@
   /**
    * Handles the authentication of a user, identified by an access token.
    *
-   * @param \BankID\OAuth2\Client\Token\AccessToken $accessToken
+   * @param AccessToken $accessToken
    *
-   * @return \Drupal\user\UserInterface
+   * @return UserInterface
    */
   public function authenticate(AccessToken $accessToken): UserInterface;
 }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


4) modules/contrib/bankid_oidc/src/BankIdAuth.php:19

    ---------- begin diff ----------
@@ @@
 class BankIdAuth implements BankIdAuthInterface {

   /**
-   * @var \BankID\OAuth2\Client\Provider\BankIdProvider
+   * @var BankIdProvider
    */
   protected $oauthClient;

   /**
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;

   /**
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $config;

   /**
-   * @var \Psr\Log\LoggerInterface
+   * @var LoggerInterface
    */
   protected $logger;

@@ @@
   /**
    * The externalauth.externalauth service.
    *
-   * @var \Drupal\externalauth\ExternalAuthInterface
+   * @var ExternalAuthInterface
    */
   protected $authService;

@@ @@
   /**
    * Constructs an BankIdAuth service.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *  The config.factory service
-   * @param \Psr\Log\LoggerInterface $logger
+   * @param LoggerInterface $logger
    *  The logger.channel.bankid_oidc service
-   * @param \Drupal\user\UserDataInterface $user_data
+   * @param UserDataInterface $user_data
    *  The user.data service.
-   * @param \Drupal\externalauth\ExternalAuthInterface $externalauth
+   * @param ExternalAuthInterface $externalauth
    *   The externalauth.externalauth service.
    */
   public function __construct(
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


5) modules/contrib/bankid_oidc/bankid_oidc.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Form\FormStateInterface;
 use Drupal\Core\Url;

 /**
@@ @@
  */
 function bankid_oidc_form_user_login_form_alter(
   &$form,
-  \Drupal\Core\Form\FormStateInterface $form_state,
+  FormStateInterface $form_state,
   $form_id
 ) {
   // Get all non form-api elements
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


 [OK] 5 files have been changed by Rector                                       


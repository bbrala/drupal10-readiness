modules/contrib/groupmediaplus/groupmediaplus.module
modules/contrib/groupmediaplus/modules/groupmediaplus_upload/groupmediaplus_upload.module
modules/contrib/groupmediaplus/modules/groupmediaplus_upload/src/Hooks.php
modules/contrib/groupmediaplus/modules/groupmediaplus_upload/src/SubmitStatus.php
modules/contrib/groupmediaplus/src/EventSubscriber/EntityBrowserSubscriber.php
modules/contrib/groupmediaplus/src/GroupIdTools.php
modules/contrib/groupmediaplus/src/GroupMediaPlus.php
modules/contrib/groupmediaplus/src/Plugin/views/argument_default/GroupIdsFromNodePath.php
modules/contrib/groupmediaplus/tests/src/Functional/AdminPageTest.php

5 files with changes
====================

1) modules/contrib/groupmediaplus/tests/src/Functional/AdminPageTest.php:32

    ---------- begin diff ----------
@@ @@
   public function testAdminPage() {
     $this->drupalLogin($this->rootUser);
     $this->drupalGet('admin');
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);

     // Ensure that the test is not marked as risky because of no assertions.
     // see https://gitlab.com/weitzman/drupal-test-traits/-/commit/82bf5059908f9073b3468cb7313960da72176d9a
    ----------- end diff -----------

Applied rules:
 * AssertResponseRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


2) modules/contrib/groupmediaplus/src/Plugin/views/argument_default/GroupIdsFromNodePath.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\groupmediaplus\Plugin\views\argument_default;

+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\groupmediaplus\GroupIdTools;
 use Drupal\token\Token;
@@ @@

   /**
    * @inheritDoc
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public function buildOptionsForm(&$form, FormStateInterface $form_state) {
     parent::buildOptionsForm($form, $form_state);
@@ @@
   /**
    * {@inheritdoc}
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public function getArgument() {
     $groupIds = GroupIdTools::getAndSpreadGroupIds('Get views argument');
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/groupmediaplus/src/GroupMediaPlus.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\groupmediaplus;

+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
 use Drupal\Core\Entity\ContentEntityFormInterface;
 use Drupal\Core\Entity\ContentEntityInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ @@

   /**
    * @param $form
-   * @param \Drupal\Core\Form\FormStateInterface $formState
+   * @param FormStateInterface $formState
    * @param $formId
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function hookFormAlter(&$form, FormStateInterface $formState, $formId) {
     if (
@@ @@
    * 1: Add group IDs from form state to widget.
    *
    * @param $element
-   * @param \Drupal\Core\Form\FormStateInterface $formState
+   * @param FormStateInterface $formState
    * @param $widgetContext
    */
   public static function transferGroupIdsFromFormStateToWidget(&$element, FormStateInterface $formState, &$widgetContext) {
@@ @@
       // Media library.
       // @todo We should not mess with this internal class. Sigh.
       elseif ($isMediaLibraryWidget) {
-        /** @var \Drupal\media_library\MediaLibraryState $mediaLibraryState */
+        /** @var MediaLibraryState $mediaLibraryState */
         $mediaLibraryState->set('groupmediaplus_group_ids', $groupIds);
         GroupIdTools::log('FormStateToWidget: Set media_library state');
       }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


4) modules/contrib/groupmediaplus/src/GroupIdTools.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\groupmediaplus;

+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\KeyValueStore\KeyValueStoreExpirableInterface;
+use Symfony\Component\Routing\RouterInterface;
+use Drupal\group\Entity\GroupContentInterface;
+use Drupal\group\Entity\GroupContentTypeInterface;
+use Drupal\Core\Entity\EntityTypeInterface;
 use Drupal\Component\Render\FormattableMarkup;
 use Drupal\Core\Entity\ContentEntityInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ @@
    * @todo Refactor this conceptually.
    *
    * @param $debugTitle
-   * @param \Drupal\Core\Form\FormStateInterface|null $formState
+   * @param FormStateInterface|null $formState
    * @param null $form
    *
    * @return mixed|null|string[]
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function getAndSpreadGroupIds($debugTitle, FormStateInterface $formState = NULL, &$form = NULL) {
     self::log("$debugTitle - Get&spread group IDs");
@@ @@

   /**
    * @return null|string[]
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function getGroupIdsFromOriginalPathQueryParameter() {
     $ids = self::extractGroupIdsFromPath(\Drupal::request()->query->get('original_path'));
@@ @@

   /**
    * @return null|string[]
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function getGroupIdsFromRefererHeader() {
     $ids = self::extractGroupIdsFromPath(\Drupal::request()->headers->get('referer'));
@@ @@
   public static function getGroupIdsFromEntityBrowserState() {
     $uuid = \Drupal::request()->query->get('uuid');
     if ($uuid) {
-      /** @var \Drupal\Core\KeyValueStore\KeyValueStoreExpirableInterface $selectionStorage */
+      /** @var KeyValueStoreExpirableInterface $selectionStorage */
       $selectionStorage = \Drupal::service('entity_browser.selection_storage');
       $data = $selectionStorage->get($uuid);
       $ids = $data['widget_context']['groupmediaplus_group_ids'] ?? NULL;
@@ @@
    *
    * @return string[]|null
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function extractGroupIdsFromPath($path, $entityTypeIds = NULL) {
     $ids = NULL;

     if ($path) {
-      /** @var \Symfony\Component\Routing\RouterInterface $router */
+      /** @var RouterInterface $router */
       $router = \Drupal::service('router.no_access_checks');
       try {
         $parameters = $router->match($path);
@@ @@
   /**
    * Extract group IDs from route match.
    *
-   * @param \Drupal\Core\Routing\RouteMatchInterface|null $routeMatch
+   * @param RouteMatchInterface|null $routeMatch
    *
    * @return string[]|null
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   protected static function extractGroupIdsFromRouteMatch(RouteMatchInterface $routeMatch = NULL) {
     if (!$routeMatch) {
@@ @@
    *
    * @return string[]|null
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   protected static function extractGroupIdsFromRouteParameters(array $parameters, array $entityTypeIds = NULL) {
     $ids = NULL;
@@ @@
   /**
    * 2: Get group ID from (popup!) form state (or Referer =:-()
    *
-   * @param \Drupal\Core\Form\FormStateInterface $formState
+   * @param FormStateInterface $formState
    *
    * @return string[]|null
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function getGroupIdsFromFormState(FormStateInterface $formState = NULL) {
     if (!$formState) {
@@ @@
   /**
    * Get entity group IDs, keyed by group ID.
    *
-   * @param \Drupal\Core\Entity\ContentEntityInterface $entity
+   * @param ContentEntityInterface $entity
    *
    * @return array
    */
@@ @@
       return NULL;
     }
     $groupIds = [];
-    /** @var \Drupal\group\Entity\GroupContentInterface $groupContent */
+    /** @var GroupContentInterface $groupContent */
     foreach (GroupContent::loadByEntity($entity) as $groupContent) {
       $groupId = $groupContent->getGroup()->id();
       $groupIds[$groupId] = $groupId;
@@ @@
   public static function setGroupIdsToEntityBrowserState($groupIds) {
     $uuid = \Drupal::request()->query->get('uuid');
     if ($uuid) {
-      /** @var \Drupal\Core\KeyValueStore\KeyValueStoreExpirableInterface $selectionStorage */
+      /** @var KeyValueStoreExpirableInterface $selectionStorage */
       $selectionStorage = \Drupal::service('entity_browser.selection_storage');
       $data = $selectionStorage->get($uuid);
       $data['widget_context']['groupmediaplus_group_ids'] = $groupIds;
@@ @@
   }

   /**
-   * @param \Drupal\Core\Form\FormStateInterface $formState
+   * @param FormStateInterface $formState
    * @param $groupIds
    */
   public static function setGroupIdsToFormState(FormStateInterface $formState = NULL, $groupIds) {
@@ @@
    *
    * @return array
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function groupContentEntityTypeOptions() {
     $entityTypeIds = [];
-    /** @var \Drupal\group\Entity\GroupContentTypeInterface $groupContentType */
+    /** @var GroupContentTypeInterface $groupContentType */
     foreach (GroupContentType::loadMultiple() as $groupContentType) {
       $entityTypeId = $groupContentType->getContentPlugin()->getEntityTypeId();
-      /** @var \Drupal\Core\Entity\EntityTypeInterface $entityType */
+      /** @var EntityTypeInterface $entityType */
       $entityType = \Drupal::entityTypeManager()->getDefinition($entityTypeId);
       $entityTypeIds[$entityTypeId] = $entityType->getLabel();
     }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


5) modules/contrib/groupmediaplus/modules/groupmediaplus_upload/src/Hooks.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\groupmediaplus_upload;

+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\Entity\EntityStorageException;
+use Drupal\group\Entity\GroupContentTypeInterface;
 use Drupal\Core\Entity\EntityInterface;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\group\Entity\Group;
@@ @@
    * it in the state api.
    * Hopefully something better will happen meanwhile in core.
    *
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
+   * @throws PluginNotFoundException
    */
   public static function hookFormAlter(&$form, FormStateInterface $formState, $formId) {
     $groupIds = $formState->get('groupmediaplus_group_ids');
@@ @@
   /**
    * Implements hook_entity_insert().
    *
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws EntityStorageException
    */
   public static function hookEntityInsert(EntityInterface $entity) {
     if ($entity instanceof MediaInterface && ($formState = SubmitStatus::getFormState())) {
@@ @@
   /**
    * Submit media group content.
    *
-   * @param \Drupal\media\MediaInterface $media
-   * @param \Drupal\Core\Form\FormStateInterface $formState
+   * @param MediaInterface $media
+   * @param FormStateInterface $formState
    *
-   * @throws \Drupal\Core\Entity\EntityStorageException
+   * @throws EntityStorageException
    */
   public static function submitMedia(MediaInterface $media, FormStateInterface $formState) {
     $groupIds = $formState->get('groupmediaplus_group_ids');
@@ @@
    *
    * @todo Move to utility class.
    *
-   * @param \Drupal\Core\Entity\EntityInterface $entity
+   * @param EntityInterface $entity
    *   The entity.
-   * @param \Drupal\group\Entity\GroupInterface $group
+   * @param GroupInterface $group
    *   The group.
    *
-   * @return \Drupal\group\Entity\GroupContentTypeInterface|null
+   * @return GroupContentTypeInterface|null
    *   The (unique) group content type, or null.
    */
   protected static function getApplicableGroupContentType(EntityInterface $entity, GroupInterface $group) {
-    /** @var \Drupal\group\Entity\GroupContentTypeInterface $groupContentType */
+    /** @var GroupContentTypeInterface $groupContentType */
     foreach (GroupContentType::loadByEntityTypeId($entity->getEntityTypeId()) as $groupContentType) {
       if (
         $groupContentType->getGroupTypeId() === $group->getGroupType()->id()
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


 [OK] 5 files have been changed by Rector                                       


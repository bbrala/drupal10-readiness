diff --git a/oauth2_rs.info.yml b/oauth2_rs.info.yml
index 3e3c08b..9c680ab 100644
--- a/oauth2_rs.info.yml
+++ b/oauth2_rs.info.yml
@@ -1,8 +1,7 @@
 name: 'OAuth2 Resource server'
 type: module
 description: 'Drupal OAuth2 Resource server implementation for identity provider.'
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.1 || ^10
 package: Authentication
 configure: oauth2_rs.token.settings
 dependepcies:
diff --git a/src/Annotation/AuthorizationValidator.php b/src/Annotation/AuthorizationValidator.php
index 6a29be5..a050415 100644
--- a/src/Annotation/AuthorizationValidator.php
+++ b/src/Annotation/AuthorizationValidator.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\oauth2_rs\Annotation;
 
+use Drupal\Core\Annotation\Translation;
 use Drupal\Component\Annotation\Plugin;
 
 /**
@@ -27,7 +28,7 @@ class AuthorizationValidator extends Plugin {
   /**
    * The label of the plugin.
    *
-   * @var \Drupal\Core\Annotation\Translation
+   * @var Translation
    *
    * @ingroup plugin_translatable
    */
diff --git a/src/Authentication/Provider/JWTAuthenticationProvider.php b/src/Authentication/Provider/JWTAuthenticationProvider.php
index 2cd9988..d6a1c33 100644
--- a/src/Authentication/Provider/JWTAuthenticationProvider.php
+++ b/src/Authentication/Provider/JWTAuthenticationProvider.php
@@ -2,6 +2,11 @@
 
 namespace Drupal\oauth2_rs\Authentication\Provider;
 
+use Drupal\Core\Config\ImmutableConfig;
+use Drupal\oauth2_rs\Service\UserAuthManager;
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Core\Entity\EntityStorageException;
 use Drupal\consumers\Entity\Consumer;
 use Drupal\Core\Authentication\AuthenticationProviderInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
@@ -30,28 +35,28 @@ class JWTAuthenticationProvider implements AuthenticationProviderInterface {
   /**
    * The config factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;
 
   /**
    * The entity type manager.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * Config.
    *
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $config;
 
   /**
    * Resource server.
    *
-   * @var \Drupal\oauth2_rs\Server\ResourceServerInterface
+   * @var ResourceServerInterface
    */
   protected $resourceServer;
 
@@ -65,21 +70,21 @@ class JWTAuthenticationProvider implements AuthenticationProviderInterface {
   /**
    * User Auth manager.
    *
-   * @var \Drupal\oauth2_rs\Service\UserAuthManager
+   * @var UserAuthManager
    */
   protected $userAuthManager;
 
   /**
    * Language manager.
    *
-   * @var \Drupal\Core\Language\LanguageManagerInterface
+   * @var LanguageManagerInterface
    */
   protected $languageManager;
 
   /**
    * Current request.
    *
-   * @var \Symfony\Component\HttpFoundation\Request|null
+   * @var Request|null
    */
   protected $currentRequest;
 
@@ -100,19 +105,19 @@ class JWTAuthenticationProvider implements AuthenticationProviderInterface {
   /**
    * Constructs a HTTP basic authentication provider object.
    *
-   * @param \Drupal\oauth2_rs\Server\ResourceServerInterface $resource_server
+   * @param ResourceServerInterface $resource_server
    *   The resource server object.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
-   * @param \Drupal\oauth2_rs\PageCache\OauthRequestPolicyInterface $page_cache_request_policy
+   * @param OauthRequestPolicyInterface $page_cache_request_policy
    *   The page cache request policy.
-   * @param \Drupal\oauth2_rs\Service\UserAuthManagerInterface $user_auth_manager
+   * @param UserAuthManagerInterface $user_auth_manager
    *   User Auth manager.
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   Config factory.
-   * @param \Drupal\Core\Language\LanguageManagerInterface $language_manager
+   * @param LanguageManagerInterface $language_manager
    *   Language Manager.
-   * @param \Symfony\Component\HttpFoundation\RequestStack $request_stack
+   * @param RequestStack $request_stack
    *   Request Stack.
    */
   public function __construct(
@@ -146,10 +151,10 @@ class JWTAuthenticationProvider implements AuthenticationProviderInterface {
   /**
    * {@inheritdoc}
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @throws \Drupal\Core\Entity\EntityStorageException
-   * @throws \League\OAuth2\Server\Exception\OAuthServerException
+   * @throws InvalidPluginDefinitionException
+   * @throws PluginNotFoundException
+   * @throws EntityStorageException
+   * @throws OAuthServerException
    */
   public function authenticate(Request $request) {
     // Update the request with the OAuth information.
diff --git a/src/Authentication/TokenAuthUser.php b/src/Authentication/TokenAuthUser.php
index e50d716..85ef6dc 100644
--- a/src/Authentication/TokenAuthUser.php
+++ b/src/Authentication/TokenAuthUser.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\oauth2_rs\Authentication;
 
+use Drupal\user\RoleStorageInterface;
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
 use Drupal\consumers\Entity\Consumer;
 use Drupal\Core\Entity\EntityStorageInterface;
 use Drupal\Core\Entity\EntityTypeInterface;
@@ -21,35 +23,35 @@ class TokenAuthUser implements TokenAuthUserInterface {
   /**
    * The decorator subject.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $user;
 
   /**
    * The bearer token.
    *
-   * @var \Lcobucci\JWT\Token
+   * @var Token
    */
   protected $token;
 
   /**
    * The activated consumer instance.
    *
-   * @var \Drupal\consumers\Entity\Consumer
+   * @var Consumer
    */
   protected $consumer;
 
   /**
    * Constructs a TokenAuthUser object.
    *
-   * @param \Drupal\Core\Session\AccountInterface $account
+   * @param AccountInterface $account
    *   User Account.
-   * @param \Lcobucci\JWT\Token $token
+   * @param Token $token
    *   The underlying token.
-   * @param \Drupal\consumers\Entity\Consumer $consumer
+   * @param Consumer $consumer
    *   Consumer object related with given User role.
    *
-   * @throws \League\OAuth2\Server\Exception\OAuthServerException
+   * @throws OAuthServerException
    *   When there is no user.
    */
   public function __construct(AccountInterface $account, Token $token, Consumer $consumer) {
@@ -105,13 +107,13 @@ class TokenAuthUser implements TokenAuthUserInterface {
   /**
    * Returns the role storage object.
    *
-   * @return \Drupal\user\RoleStorageInterface
+   * @return RoleStorageInterface
    *   The role storage object.
    *
-   * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
+   * @throws InvalidPluginDefinitionException
    */
   protected function getRoleStorage() {
-    /** @var \Drupal\user\RoleStorageInterface $storage */
+    /** @var RoleStorageInterface $storage */
     $storage = \Drupal::entityTypeManager()->getStorage('user_role');
     return $storage;
   }
@@ -320,7 +322,7 @@ class TokenAuthUser implements TokenAuthUserInterface {
    * {@inheritdoc}
    */
   public function urlInfo($rel = 'canonical', array $options = []) {
-    return $this->user->urlInfo($rel, $options);
+    return $this->user->toUrl($rel, $options);
   }
 
   /**
@@ -334,7 +336,9 @@ class TokenAuthUser implements TokenAuthUserInterface {
    * {@inheritdoc}
    */
   public function link($text = NULL, $rel = 'canonical', array $options = []) {
-    return $this->user->link($text, $rel, $options);
+    // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+    // Please confirm that `$user` is an instance of `\Drupal\Core\Entity\EntityInterface`. Only the method name and not the class name was checked for this replacement, so this may be a false positive.
+    return $this->user->toLink($text, $rel, $options)->toString();
   }
 
   /**
diff --git a/src/Authentication/TokenAuthUserInterface.php b/src/Authentication/TokenAuthUserInterface.php
index 97829a9..0755bab 100644
--- a/src/Authentication/TokenAuthUserInterface.php
+++ b/src/Authentication/TokenAuthUserInterface.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\oauth2_rs\Authentication;
 
+use Lcobucci\JWT\Token;
+use Drupal\consumers\Entity\Consumer;
 use Drupal\user\UserInterface;
 
 /**
@@ -14,7 +16,7 @@ interface TokenAuthUserInterface extends \IteratorAggregate, UserInterface {
   /**
    * Get the token.
    *
-   * @return \Lcobucci\JWT\Token
+   * @return Token
    *   The provided OAuth2 token.
    */
   public function getToken();
@@ -22,7 +24,7 @@ interface TokenAuthUserInterface extends \IteratorAggregate, UserInterface {
   /**
    * Get the activated consumer.
    *
-   * @return \Drupal\consumers\Entity\Consumer
+   * @return Consumer
    *   The activated consumer after authentication.
    */
   public function getConsumer();
diff --git a/src/Form/Oauth2TokenSettingsForm.php b/src/Form/Oauth2TokenSettingsForm.php
index 7a751bc..369be45 100644
--- a/src/Form/Oauth2TokenSettingsForm.php
+++ b/src/Form/Oauth2TokenSettingsForm.php
@@ -20,32 +20,32 @@ class Oauth2TokenSettingsForm extends ConfigFormBase {
   /**
    * The file system checker.
    *
-   * @var \Drupal\oauth2_rs\Service\FileSystemChecker
+   * @var FileSystemChecker
    */
   protected $fileSystemChecker;
 
   /**
    * The messenger service.
    *
-   * @var \Drupal\Core\Messenger\MessengerInterface
+   * @var MessengerInterface
    */
   protected $messenger;
 
   /**
    * Authorization validator plugin manager.
    *
-   * @var \Drupal\oauth2_rs\Plugin\AuthorizationValidatorPluginManager
+   * @var AuthorizationValidatorPluginManager
    */
   protected $validatorTypeManager;
 
   /**
    * Oauth2TokenSettingsForm constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $configFactory
+   * @param ConfigFactoryInterface $configFactory
    *   The factory for configuration objects.
-   * @param \Drupal\oauth2_rs\Service\FileSystemChecker $file_system_checker
+   * @param FileSystemChecker $file_system_checker
    *   The oauth2_rs.filesystem service.
-   * @param \Drupal\Core\Messenger\MessengerInterface $messenger
+   * @param MessengerInterface $messenger
    *   The messenger service.
    */
   public function __construct(
@@ -63,7 +63,7 @@ class Oauth2TokenSettingsForm extends ConfigFormBase {
   /**
    * Creates the form.
    *
-   * @param \Symfony\Component\DependencyInjection\ContainerInterface $container
+   * @param ContainerInterface $container
    *   The container.
    *
    * @return \Drupal\oauth2_rs\Entity\Form\Oauth2TokenSettingsForm
@@ -105,7 +105,7 @@ class Oauth2TokenSettingsForm extends ConfigFormBase {
    *
    * @param array $form
    *   An associative array containing the structure of the form.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The current state of the form.
    */
   public function submitForm(array &$form, FormStateInterface $form_state) {
@@ -125,7 +125,7 @@ class Oauth2TokenSettingsForm extends ConfigFormBase {
    *
    * @param array $form
    *   An associative array containing the structure of the form.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The current state of the form.
    *
    * @return array
@@ -196,7 +196,7 @@ class Oauth2TokenSettingsForm extends ConfigFormBase {
    *
    * @param array $element
    *   The element being processed.
-   * @param \Drupal\Core\Form\FormStateInterface $form_state
+   * @param FormStateInterface $form_state
    *   The current state of the form.
    * @param array $complete_form
    *   The complete form structure.
diff --git a/src/PageCache/OauthRequestPolicyInterface.php b/src/PageCache/OauthRequestPolicyInterface.php
index 5db18d9..93f176a 100644
--- a/src/PageCache/OauthRequestPolicyInterface.php
+++ b/src/PageCache/OauthRequestPolicyInterface.php
@@ -20,7 +20,7 @@ interface OauthRequestPolicyInterface extends RequestPolicyInterface {
   /**
    * Returns a state whether the request has an OAuth2 access token.
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The incoming request object.
    *
    * @return bool
diff --git a/src/Plugin/AuthorizationValidatorPluginBase.php b/src/Plugin/AuthorizationValidatorPluginBase.php
index 29b240f..0dd1bd4 100644
--- a/src/Plugin/AuthorizationValidatorPluginBase.php
+++ b/src/Plugin/AuthorizationValidatorPluginBase.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\oauth2_rs\Plugin;
 
+use League\OAuth2\Server\CryptKey;
 use BadMethodCallException;
 use Drupal\Core\Cache\CacheBackendInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
@@ -31,7 +32,7 @@ abstract class AuthorizationValidatorPluginBase extends PluginBase implements Au
   /**
    * Public key.
    *
-   * @var \League\OAuth2\Server\CryptKey
+   * @var CryptKey
    */
   protected $publicKey;
 
@@ -54,7 +55,7 @@ abstract class AuthorizationValidatorPluginBase extends PluginBase implements Au
    *   The plugin_id for the plugin instance.
    * @param mixed $plugin_definition
    *   The plugin implementation definition.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
    */
   public function __construct(
@@ -99,10 +100,10 @@ abstract class AuthorizationValidatorPluginBase extends PluginBase implements Au
   /**
    * Get Token.
    *
-   * @param \Psr\Http\Message\ServerRequestInterface $request
+   * @param ServerRequestInterface $request
    *
-   * @return \Lcobucci\JWT\Token
-   * @throws \League\OAuth2\Server\Exception\OAuthServerException
+   * @return Token
+   * @throws OAuthServerException
    */
   public function getToken(ServerRequestInterface $request): Token {
     if ($request->hasHeader('authorization') === FALSE) {
diff --git a/src/Plugin/AuthorizationValidatorPluginManager.php b/src/Plugin/AuthorizationValidatorPluginManager.php
index c361814..3972a12 100644
--- a/src/Plugin/AuthorizationValidatorPluginManager.php
+++ b/src/Plugin/AuthorizationValidatorPluginManager.php
@@ -19,9 +19,9 @@ class AuthorizationValidatorPluginManager extends DefaultPluginManager {
    * @param \Traversable $namespaces
    *   An object that implements \Traversable which contains the root paths
    *   keyed by the corresponding namespace to look for plugin implementations.
-   * @param \Drupal\Core\Cache\CacheBackendInterface $cache_backend
+   * @param CacheBackendInterface $cache_backend
    *   Cache backend instance to use.
-   * @param \Drupal\Core\Extension\ModuleHandlerInterface $module_handler
+   * @param ModuleHandlerInterface $module_handler
    *   The module handler to invoke the alter hook with.
    */
   public function __construct(
diff --git a/src/Plugin/AuthorizationValidators/BearerTokenValidator.php b/src/Plugin/AuthorizationValidators/BearerTokenValidator.php
index 27b9015..0da6680 100644
--- a/src/Plugin/AuthorizationValidators/BearerTokenValidator.php
+++ b/src/Plugin/AuthorizationValidators/BearerTokenValidator.php
@@ -41,7 +41,7 @@ class BearerTokenValidator extends AuthorizationValidatorPluginBase {
    *   The plugin_id for the plugin instance.
    * @param mixed $plugin_definition
    *   The plugin implementation definition.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
    */
   public function __construct(
@@ -107,7 +107,7 @@ class BearerTokenValidator extends AuthorizationValidatorPluginBase {
   /**
    * Set the public key.
    *
-   * @param \League\OAuth2\Server\CryptKey $key
+   * @param CryptKey $key
    *   Public key.
    */
   public function setPublicKey(CryptKey $key) {
diff --git a/src/Plugin/AuthorizationValidators/CognitoBearerValidator.php b/src/Plugin/AuthorizationValidators/CognitoBearerValidator.php
index fc7c831..b62957b 100644
--- a/src/Plugin/AuthorizationValidators/CognitoBearerValidator.php
+++ b/src/Plugin/AuthorizationValidators/CognitoBearerValidator.php
@@ -3,6 +3,8 @@ declare(strict_types=1);
 
 namespace Drupal\oauth2_rs\Plugin\AuthorizationValidators;
 
+use CoderCat\JWKToPEM\Exception\Base64DecodeException;
+use CoderCat\JWKToPEM\Exception\JWKConverterException;
 use CoderCat\JWKToPEM\JWKConverter;
 use Drupal\Core\Cache\CacheBackendInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
@@ -40,7 +42,7 @@ class CognitoBearerValidator extends AuthorizationValidatorPluginBase {
    *   The plugin_id for the plugin instance.
    * @param mixed $plugin_definition
    *   The plugin implementation definition.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
    */
   public function __construct(
@@ -140,8 +142,8 @@ class CognitoBearerValidator extends AuthorizationValidatorPluginBase {
   /**
    * Get Public keys from cognito jwks and convert to PEMs.
    *
-   * @throws \CoderCat\JWKToPEM\Exception\Base64DecodeException
-   * @throws \CoderCat\JWKToPEM\Exception\JWKConverterException
+   * @throws Base64DecodeException
+   * @throws JWKConverterException
    */
   public function setPublicKeys() {
     // Public keys cache id.
@@ -201,10 +203,10 @@ class CognitoBearerValidator extends AuthorizationValidatorPluginBase {
   /**
    * Enrich request by the data from Token using mappings.
    *
-   * @param \Psr\Http\Message\ServerRequestInterface $request
-   * @param \Lcobucci\JWT\Token $token
+   * @param ServerRequestInterface $request
+   * @param Token $token
    *
-   * @return \Psr\Http\Message\ServerRequestInterface
+   * @return ServerRequestInterface
    */
   public function enrichRequest(ServerRequestInterface $request, Token $token): ServerRequestInterface {
     $claims = $token->claims();
@@ -236,10 +238,10 @@ class CognitoBearerValidator extends AuthorizationValidatorPluginBase {
    * Get Id Token from request. This is required for Cognito on the first
    * request.
    *
-   * @param \Psr\Http\Message\ServerRequestInterface $request
+   * @param ServerRequestInterface $request
    *
-   * @return bool|\Lcobucci\JWT\Token
-   * @throws \League\OAuth2\Server\Exception\OAuthServerException
+   * @return bool|Token
+   * @throws OAuthServerException
    */
   protected function getIdToken(ServerRequestInterface $request) {
     // If there are no IdToken in request - softly proceed with the process.
diff --git a/src/Server/ResourceServer.php b/src/Server/ResourceServer.php
index 1fd9f0c..fb8cb08 100644
--- a/src/Server/ResourceServer.php
+++ b/src/Server/ResourceServer.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\oauth2_rs\Server;
 
+use Drupal\oauth2_rs\Plugin\AuthorizationValidatorPluginManager;
 use Drupal\Component\Plugin\PluginManagerInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\oauth2_rs\AuthorizationValidators\BearerTokenValidator;
@@ -25,27 +26,27 @@ class ResourceServer implements ResourceServerInterface {
   /**
    * Http Message factory.
    *
-   * @var \Symfony\Bridge\PsrHttpMessage\HttpMessageFactoryInterface
+   * @var HttpMessageFactoryInterface
    */
   protected $messageFactory;
 
   /**
    * Authorization Validator manager.
    *
-   * @var \Drupal\oauth2_rs\Plugin\AuthorizationValidatorPluginManager
+   * @var AuthorizationValidatorPluginManager
    */
   protected $authValidatorManager;
 
   /**
    * New server instance.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   Config factory.
-   * @param \Symfony\Bridge\PsrHttpMessage\HttpMessageFactoryInterface $message_factory
+   * @param HttpMessageFactoryInterface $message_factory
    *   Message factory.
-   * @param \Drupal\Component\Plugin\PluginManagerInterface $authValidatorManager
+   * @param PluginManagerInterface $authValidatorManager
    *   Authorization Validator manager.
-   * @param \League\OAuth2\Server\AuthorizationValidators\AuthorizationValidatorInterface|null $authorization_validator
+   * @param AuthorizationValidatorInterface|null $authorization_validator
    *   Authorization bearer token validator.
    */
   public function __construct(
@@ -64,14 +65,14 @@ class ResourceServer implements ResourceServerInterface {
   /**
    * Get authorization validator.
    *
-   * @return \League\OAuth2\Server\AuthorizationValidators\AuthorizationValidatorInterface
+   * @return AuthorizationValidatorInterface
    *   Authorization validator.
    */
   protected function getAuthorizationValidator() {
     if ($this->authorizationValidator instanceof AuthorizationValidatorInterface === FALSE) {
       $validator_id = $this->config->get('validator');
       $config = $this->configFactory->get('oauth2_rs.settings.' . $validator_id);
-      /** @var \Drupal\oauth2_rs\Plugin\AuthorizationValidatorPluginManager $plugin_manager */
+      /** @var AuthorizationValidatorPluginManager $plugin_manager */
       $this->authorizationValidator = $this->authValidatorManager->createInstance($validator_id, $config->getRawData());
     }
 
diff --git a/src/Server/ResourceServerInterface.php b/src/Server/ResourceServerInterface.php
index 63b4b59..2c54ac5 100644
--- a/src/Server/ResourceServerInterface.php
+++ b/src/Server/ResourceServerInterface.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\oauth2_rs\Server;
 
+use League\OAuth2\Server\Exception\OAuthServerException;
 use Symfony\Component\HttpFoundation\Request;
 
 /**
@@ -12,13 +13,13 @@ interface ResourceServerInterface {
   /**
    * Determine the access token validity.
    *
-   * @param \Symfony\Component\HttpFoundation\Request $request
+   * @param Request $request
    *   The request object.
    *
-   * @throws \League\OAuth2\Server\Exception\OAuthServerException
+   * @throws OAuthServerException
    *   OAuth server exception.
    *
-   * @return \Symfony\Component\HttpFoundation\Request
+   * @return Request
    *   The request object augmented with the token information.
    */
   public function validateAuthenticatedRequest(Request $request);
diff --git a/src/Service/UserAuthManager.php b/src/Service/UserAuthManager.php
index c1a95cf..d1efb50 100644
--- a/src/Service/UserAuthManager.php
+++ b/src/Service/UserAuthManager.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\oauth2_rs\Service;
 
+use Drupal\Core\Config\ImmutableConfig;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Password\PasswordGeneratorInterface;
@@ -14,32 +15,32 @@ class UserAuthManager implements UserAuthManagerInterface {
   /**
    * Drupal\Core\Entity\EntityManagerInterface definition.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * Config.
    *
-   * @var \Drupal\Core\Config\ImmutableConfig
+   * @var ImmutableConfig
    */
   protected $config;
 
   /**
    * Password Generator Interface.
    *
-   * @var \Drupal\Core\Password\PasswordGeneratorInterface
+   * @var PasswordGeneratorInterface
    */
   protected $passwordGenerator;
 
   /**
    * Constructs a new UserAuthService object.
    *
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entityTypeManager
+   * @param EntityTypeManagerInterface $entityTypeManager
    *   Entity type manager.
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $configFactory
+   * @param ConfigFactoryInterface $configFactory
    *   Config factory.
-   * @param \Drupal\Core\Password\PasswordGeneratorInterface $passwordGenerator
+   * @param PasswordGeneratorInterface $passwordGenerator
    *   Password Generator Interface.
    */
   public function __construct(EntityTypeManagerInterface $entityTypeManager, ConfigFactoryInterface $configFactory) {
@@ -53,7 +54,7 @@ class UserAuthManager implements UserAuthManagerInterface {
   public function createAccount($email, $username, $role, $language = 'en') {
     $user = $this->entityTypeManager->getStorage('user')->create([]);
     // Using password generator.
-    $user->setPassword(user_password(10));
+    $user->setPassword(\Drupal::service('password_generator')->generate(10));
     $user->enforceIsNew();
     $user->setEmail($email);
     $user->setUsername($username);
diff --git a/src/Service/UserAuthManagerInterface.php b/src/Service/UserAuthManagerInterface.php
index f3f7073..0fcc1fc 100644
--- a/src/Service/UserAuthManagerInterface.php
+++ b/src/Service/UserAuthManagerInterface.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\oauth2_rs\Service;
 
+use Drupal\consumers\Entity\Consumer;
+use Drupal\Core\Session\AccountProxyInterface;
 /**
  * Interface UserAuth.
  */
@@ -13,7 +15,7 @@ interface UserAuthManagerInterface {
    * @param string $role
    *   User role.
    *
-   * @return \Drupal\consumers\Entity\Consumer
+   * @return Consumer
    *   Consumer entity related with a given role.
    */
   public function getUserConsumerByRole(string $role);
@@ -30,7 +32,7 @@ interface UserAuthManagerInterface {
    * @param string $language
    *   Language.
    *
-   * @return \Drupal\Core\Session\AccountProxyInterface
+   * @return AccountProxyInterface
    *   Account object.
    */
   public function createAccount(string $email, string $username, string $role, string $language);
diff --git a/tests/src/Functional/OauthRsTestTrait.php b/tests/src/Functional/OauthRsTestTrait.php
index f5c7986..a94d36d 100644
--- a/tests/src/Functional/OauthRsTestTrait.php
+++ b/tests/src/Functional/OauthRsTestTrait.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\oauth2_rs\Functional;
 
+use Drupal\Core\File\FileSystemInterface;
 /**
  * Trait with methods needed by tests.
  */
@@ -25,7 +26,7 @@ KcGbpUAWw/YY2it9G6iUJJ0AmKBC8yfuSBHhPTvrfwIDAQAB
 
     chmod($public_key_path, 0660);
 
-    /** @var \Drupal\Core\File\FileSystemInterface $filesystem */
+    /** @var FileSystemInterface $filesystem */
     $filesystem = \Drupal::service('file_system');
 
     $settings = $this->config('oauth2_rs.settings');
diff --git a/tests/src/Unit/Authentication/Provider/JWTAuthenticationProviderTest.php b/tests/src/Unit/Authentication/Provider/JWTAuthenticationProviderTest.php
index ece4bb3..8c3ce8b 100644
--- a/tests/src/Unit/Authentication/Provider/JWTAuthenticationProviderTest.php
+++ b/tests/src/Unit/Authentication/Provider/JWTAuthenticationProviderTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\oauth2_rs\Unit\Authentication\Provider;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Language\LanguageManagerInterface;
@@ -19,17 +20,18 @@ use Symfony\Component\HttpFoundation\RequestStack;
  */
 class JWTAuthenticationProviderTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * The authentication provider.
    *
-   * @var \Drupal\oauth2_rs\Authentication\Provider\JWTAuthenticationProvider
+   * @var JWTAuthenticationProvider
    */
   protected $provider;
 
   /**
    * The OAuth page cache request policy.
    *
-   * @var \Drupal\oauth2_rs\PageCache\OauthRequestPolicyInterface
+   * @var OauthRequestPolicyInterface
    */
   protected $oauthPageCacheRequestPolicy;
 

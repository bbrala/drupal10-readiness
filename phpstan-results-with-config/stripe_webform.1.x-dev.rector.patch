diff --git a/src/Event/StripeWebformWebhookEvent.php b/src/Event/StripeWebformWebhookEvent.php
index 411350a..0c02be7 100644
--- a/src/Event/StripeWebformWebhookEvent.php
+++ b/src/Event/StripeWebformWebhookEvent.php
@@ -2,8 +2,8 @@
 
 namespace Drupal\stripe_webform\Event;
 
+use Symfony\Contracts\EventDispatcher\Event;
 use Drupal\webform\WebformSubmissionInterface;
-use Symfony\Component\EventDispatcher\Event;
 
 /**
  * Event that is fired when a webhook related to a webform submission is received
@@ -22,7 +22,7 @@ class StripeWebformWebhookEvent extends Event {
   /**
    * Webform submission entity
    *
-   * @var \Drupal\webform\WebformSubmissionInterface
+   * @var WebformSubmissionInterface
    */
   public $webform_submission;
 
@@ -36,7 +36,7 @@ class StripeWebformWebhookEvent extends Event {
   /**
    * Constructs the object.
    *
-   * @param \Drupal\webform\WebformSubmissionInterface $entity
+   * @param WebformSubmissionInterface $entity
    *   The webform submission entity
    */
   public function __construct($type, WebformSubmissionInterface $webform_submission, \Stripe\Event $event) {
diff --git a/src/EventSubscriber/StripeWebformEventSubscriber.php b/src/EventSubscriber/StripeWebformEventSubscriber.php
index 52e95b0..8a715c0 100644
--- a/src/EventSubscriber/StripeWebformEventSubscriber.php
+++ b/src/EventSubscriber/StripeWebformEventSubscriber.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\stripe_webform\EventSubscriber;
 
+use Stripe\Customer;
+use Stripe\Error\Base;
 use Drupal\stripe_webform\Event\StripeWebformWebhookEvent;
 use Drupal\stripe\Event\StripeEvents;
 use Drupal\stripe\Event\StripeWebhookEvent;
@@ -16,28 +18,28 @@ class StripeWebformEventSubscriber implements EventSubscriberInterface {
   /**
    * The configuration object factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $config_factory;
 
   /**
    * The entity manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entity_type_manager;
 
   /**
    * The event dispatcher service.
    *
-   * @var \Symfony\Component\EventDispatcher\EventDispatcherInterface;
+   * @var EventDispatcherInterface ;
    */
   protected $event_dispatcher;
 
   /**
    * The iogger interface
    *
-   * @var \Psr\Log\LoggerInterface
+   * @var LoggerInterface
    */
   protected $logger;
 
@@ -47,7 +49,7 @@ class StripeWebformEventSubscriber implements EventSubscriberInterface {
    *
    * @param EventDispatcherInterface $dispatcher
    *   An EventDispatcherInterface instance.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager.
    */
   public function __construct(EventDispatcherInterface $dispatcher, ConfigFactoryInterface $config_factory, EntityTypeManagerInterface $entity_type_manager, LoggerInterface $logger) {
@@ -67,12 +69,12 @@ class StripeWebformEventSubscriber implements EventSubscriberInterface {
     elseif (!empty($stripe_event['data']['object']['customer'])) {
       $customer = $stripe_event['data']['object']['customer'];
       try {
-        $customer = \Stripe\Customer::retrieve($customer);
+        $customer = Customer::retrieve($customer);
 
         if (isset($customer['metadata']['webform_submission_id'])) {
           $metadata = $customer['metadata'];
         }
-      } catch (\Stripe\Error\Base $e) {
+      } catch (Base $e) {
         $this->logger->error('Stripe API Error: ' . $e->getMessage());
       }
     }
@@ -85,7 +87,7 @@ class StripeWebformEventSubscriber implements EventSubscriberInterface {
       if ($webform_submission) {
         $webhook_event = new StripeWebformWebhookEvent($stripe_event['type'], $webform_submission, $stripe_event);
         $this->event_dispatcher
-          ->dispatch(StripeWebformWebhookEvent::EVENT_NAME, $webhook_event);
+          ->dispatch($webhook_event, StripeWebformWebhookEvent::EVENT_NAME);
       }
     }
 
diff --git a/src/Plugin/WebformHandler/StripeWebformHandler.php b/src/Plugin/WebformHandler/StripeWebformHandler.php
index ba126ef..36514ff 100644
--- a/src/Plugin/WebformHandler/StripeWebformHandler.php
+++ b/src/Plugin/WebformHandler/StripeWebformHandler.php
@@ -2,6 +2,11 @@
 
 namespace Drupal\stripe_webform\Plugin\WebformHandler;
 
+use Stripe\Stripe;
+use Stripe\Customer;
+use Stripe\Charge;
+use Stripe\Subscription;
+use Stripe\Error\Base;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ -32,14 +37,14 @@ class StripeWebformHandler extends WebformHandlerBase {
     /**
    * The configuration factory.
    *
-   * @var \Drupal\Core\Config\ConfigFactoryInterface
+   * @var ConfigFactoryInterface
    */
   protected $configFactory;
 
   /**
    * The token manager.
    *
-   * @var \Drupal\webform\WebformTokenManagerInterface
+   * @var WebformTokenManagerInterface
    */
   protected $tokenManager;
 
@@ -233,7 +238,7 @@ class StripeWebformHandler extends WebformHandlerBase {
     $data = $this->tokenManager->replace($this->configuration, $webform_submission);
 
     try {
-      \Stripe\Stripe::setApiKey($config->get('apikey.' . $config->get('environment') . '.secret'));
+      Stripe::setApiKey($config->get('apikey.' . $config->get('environment') . '.secret'));
 
       $metadata = [
         'uuid' => $uuid,
@@ -256,7 +261,7 @@ class StripeWebformHandler extends WebformHandlerBase {
       if (!empty($data['stripe_customer_create'])) {
         $stripe_customer_create += Yaml::decode($data['stripe_customer_create']);
       }
-      $customer = \Stripe\Customer::create($stripe_customer_create);
+      $customer = Customer::create($stripe_customer_create);
 
       if (empty($data['plan_id'])) {
         // Charge the Customer instead of the card:
@@ -270,7 +275,7 @@ class StripeWebformHandler extends WebformHandlerBase {
           $stripe_charge_create += Yaml::decode($data['stripe_charge_create']);
         }
 
-        $charge = \Stripe\Charge::create($stripe_charge_create);
+        $charge = Charge::create($stripe_charge_create);
       }
       else {
         $stripe_subscription_create = [
@@ -282,11 +287,11 @@ class StripeWebformHandler extends WebformHandlerBase {
         if (!empty($data['stripe_subscription_create'])) {
           $stripe_subscription_create += Yaml::decode($data['stripe_subscription_create']);
         }
-        \Stripe\Subscription::create($stripe_subscription_create);
+        Subscription::create($stripe_subscription_create);
       }
     }
-    catch (\Stripe\Error\Base $e) {
-      drupal_set_message($this->t('Stripe error: %error', ['%error' => $e->getMessage()]), 'error');
+    catch (Base $e) {
+      $this->messenger()->addError($this->t('Stripe error: %error', ['%error' => $e->getMessage()]));
     }
  }
 
diff --git a/stripe_webform.info.yml b/stripe_webform.info.yml
index 156588a..efc9226 100644
--- a/stripe_webform.info.yml
+++ b/stripe_webform.info.yml
@@ -1,8 +1,7 @@
 name: 'Stripe webform'
 type: module
 description: 'Provides a stripe webform element and default handlers'
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^8 || ^9 || ^10
 package: Stripe
 dependencies:
   - stripe

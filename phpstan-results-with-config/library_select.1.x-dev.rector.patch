diff --git a/library_select.module b/library_select.module
index 29c1334..dad91b4 100644
--- a/library_select.module
+++ b/library_select.module
@@ -48,7 +48,7 @@ function library_select_options_callback() {
 function library_select_library_info_build() {
   $libraries = [];
   foreach (LibrarySelectEntity::loadMultiple() as $item) {
-    /** @var \Drupal\library_select\Entity\LibrarySelectEntity $item */
+    /** @var LibrarySelectEntity $item */
     if ($library_info = $item->libraryInfo()) {
       $libraries[$item->id()] = $library_info;
     }
@@ -71,7 +71,7 @@ function library_select_css_alter(array &$css, AttachedAssetsInterface $assets)
     return;
   }
   foreach (LibrarySelectEntity::loadMultiple() as $lib_id => $item) {
-    /** @var \Drupal\library_select\Entity\LibrarySelectEntity $item */
+    /** @var LibrarySelectEntity $item */
     $library = $item->libraryInfo();
     if (in_array("library_select/$lib_id", $libraries) && !empty($library['css'])) {
       foreach ($library['css'] as $group) {
@@ -123,7 +123,7 @@ function library_select_field_widget_form_alter(&$element, FormStateInterface $f
  *   The form element.
  * @param $input
  *   The input.
- * @param \Drupal\Core\Form\FormStateInterface $form_state
+ * @param FormStateInterface $form_state
  *   The form_state.
  */
 function library_select_file_value_callback($element, &$input, FormStateInterface $form_state) {
diff --git a/modules/library_select_context/tests/src/Functional/LoadTest.php b/modules/library_select_context/tests/src/Functional/LoadTest.php
index 48db04b..ad22a81 100644
--- a/modules/library_select_context/tests/src/Functional/LoadTest.php
+++ b/modules/library_select_context/tests/src/Functional/LoadTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\library_select_context\Functional;
 
+use Drupal\user\UserInterface;
 use Drupal\Core\Url;
 use Drupal\Tests\BrowserTestBase;
 
@@ -22,14 +23,14 @@ class LoadTest extends BrowserTestBase {
   /**
    * A user with permission to administer site configuration.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $user;
 
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->user = $this->drupalCreateUser(['administer site configuration']);
     $this->drupalLogin($this->user);
diff --git a/src/Form/LibrarySelectEntityForm.php b/src/Form/LibrarySelectEntityForm.php
index f452ab4..f454b95 100644
--- a/src/Form/LibrarySelectEntityForm.php
+++ b/src/Form/LibrarySelectEntityForm.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\library_select\Form;
 
+use Drupal\library_select\Entity\LibrarySelectEntity;
+use Drupal\Core\Asset\LibraryDiscoveryCollector;
 use Drupal\Core\Entity\EntityForm;
 use Drupal\Core\Form\FormStateInterface;
 
@@ -15,7 +17,7 @@ class LibrarySelectEntityForm extends EntityForm {
    */
   public function form(array $form, FormStateInterface $form_state) {
     $form = parent::form($form, $form_state);
-    /** @var \Drupal\library_select\Entity\LibrarySelectEntity $entity */
+    /** @var LibrarySelectEntity $entity */
     $entity = $this->entity;
     $form['label'] = [
       '#type' => 'textfield',
@@ -110,7 +112,7 @@ class LibrarySelectEntityForm extends EntityForm {
         ]));
     }
     // Clear library cache.
-    /** @var \Drupal\Core\Asset\LibraryDiscoveryCollector $libraryCollector */
+    /** @var LibraryDiscoveryCollector $libraryCollector */
     $libraryCollector = \Drupal::service('library.discovery.collector');
     $libraryCollector->clear();
     $form_state->setRedirectUrl($entity->toUrl('collection'));
diff --git a/src/LibraryFileStorage.php b/src/LibraryFileStorage.php
index 8a4af2d..b6d6b34 100644
--- a/src/LibraryFileStorage.php
+++ b/src/LibraryFileStorage.php
@@ -21,14 +21,14 @@ final class LibraryFileStorage {
   /**
    * Asset with file storage.
    *
-   * @var \Drupal\library_select\Entity\LibrarySelectEntity
+   * @var LibrarySelectEntity
    */
   protected $asset;
 
   /**
    * LibraryFileStorage constructor.
    *
-   * @param \Drupal\library_select\Entity\LibrarySelectEntity $asset
+   * @param LibrarySelectEntity $asset
    *   The library asset.
    */
   public function __construct(LibrarySelectEntity $asset) {
@@ -38,7 +38,7 @@ final class LibraryFileStorage {
   /**
    * Get file system.
    *
-   * @return \Drupal\Core\File\FileSystemInterface
+   * @return FileSystemInterface
    *   The file system.
    */
   public function getFileSystem() {
diff --git a/src/Plugin/Field/FieldFormatter/LibraryFileFormatter.php b/src/Plugin/Field/FieldFormatter/LibraryFileFormatter.php
index 94b4252..f911ce3 100644
--- a/src/Plugin/Field/FieldFormatter/LibraryFileFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/LibraryFileFormatter.php
@@ -54,9 +54,9 @@ class LibraryFileFormatter extends FileFormatterBase {
     $elements = [];
 
     foreach ($this->getEntitiesToView($items, $langcode) as $file) {
-      /** @var \Drupal\file\Entity\File $file_entity */
+      /** @var File $file_entity */
       $file_entity = ($file instanceof File) ? $file : File::load($file->fid);
-      $relativePath = file_url_transform_relative(file_create_url($file_entity->getFileUri()));
+      $relativePath = \Drupal::service('file_url_generator')->generateString($file_entity->getFileUri());
       if ($file_entity->getMimeType() === 'text/css') {
         library_select_add_css($relativePath);
       }
diff --git a/tests/src/Functional/LoadTest.php b/tests/src/Functional/LoadTest.php
index 8cda84f..f98eca9 100644
--- a/tests/src/Functional/LoadTest.php
+++ b/tests/src/Functional/LoadTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\library_select\Functional;
 
+use Drupal\user\UserInterface;
 use Drupal\Core\Url;
 use Drupal\Tests\BrowserTestBase;
 
@@ -22,14 +23,14 @@ class LoadTest extends BrowserTestBase {
   /**
    * A user with permission to administer site configuration.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $user;
 
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->user = $this->drupalCreateUser(['administer site configuration']);
     $this->drupalLogin($this->user);

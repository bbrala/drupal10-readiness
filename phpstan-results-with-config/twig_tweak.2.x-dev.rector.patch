diff --git a/src/TwigExtension.php b/src/TwigExtension.php
index fd54657..f2edc73 100644
--- a/src/TwigExtension.php
+++ b/src/TwigExtension.php
@@ -2,6 +2,9 @@
 
 namespace Drupal\twig_tweak;
 
+use Drupal\block\BlockInterface;
+use Drupal\Core\Menu\MenuLinkTreeInterface;
+use Drupal\Component\Render\MarkupInterface;
 use Drupal\Component\Utility\NestedArray;
 use Drupal\Component\Utility\Unicode;
 use Drupal\Component\Uuid\Uuid;
@@ -457,7 +460,7 @@ class TwigExtension extends AbstractExtension {
 
     $configuration += ['label_display' => BlockPluginInterface::BLOCK_LABEL_VISIBLE];
 
-    /** @var \Drupal\Core\Block\BlockPluginInterface $block_plugin */
+    /** @var BlockPluginInterface $block_plugin */
     $block_plugin = \Drupal::service('plugin.manager.block')
       ->createInstance($id, $configuration);
 
@@ -536,7 +539,7 @@ class TwigExtension extends AbstractExtension {
       ->addCacheTags($entity_type->getListCacheTags())
       ->addCacheContexts($entity_type->getListCacheContexts());
 
-    /** @var \Drupal\block\BlockInterface[] $blocks */
+    /** @var BlockInterface[] $blocks */
     foreach ($blocks as $id => $block) {
       $access = $block->access('view', NULL, TRUE);
       $cache_metadata = $cache_metadata->merge(CacheableMetadata::createFromObject($access));
@@ -708,7 +711,7 @@ class TwigExtension extends AbstractExtension {
    *   A render array for the menu.
    */
   public function drupalMenu($menu_name, $level = 1, $depth = 0, $expand = FALSE) {
-    /** @var \Drupal\Core\Menu\MenuLinkTreeInterface $menu_tree */
+    /** @var MenuLinkTreeInterface $menu_tree */
     $menu_tree = \Drupal::service('menu.link_tree');
     $parameters = $menu_tree->getCurrentRouteMenuTreeParameters($menu_name);
 
@@ -892,7 +895,7 @@ class TwigExtension extends AbstractExtension {
     if ($route = \Drupal::routeMatch()->getRouteObject()) {
       $title = \Drupal::service('title_resolver')->getTitle(\Drupal::request(), $route);
     }
-    $build['#markup'] = render($title);
+    $build['#markup'] = \Drupal::service('renderer')->render($title);
     $build['#cache']['contexts'] = ['url'];
     return $build;
   }
@@ -907,7 +910,7 @@ class TwigExtension extends AbstractExtension {
    * @param bool $check_access
    *   (optional) Indicates that access check is required.
    *
-   * @return \Drupal\Core\Url|null
+   * @return Url|null
    *   A new Url object or null if the URL is not accessible.
    *
    * @see \Drupal\Core\Url::fromUserInput()
@@ -940,7 +943,7 @@ class TwigExtension extends AbstractExtension {
    * @param bool $check_access
    *   (optional) Indicates that access check is required.
    *
-   * @return \Drupal\Core\Link|null
+   * @return Link|null
    *   A new Link object or null of the URL is not accessible.
    *
    * @see \Drupal\Core\Link::fromTextAndUrl()
@@ -1074,7 +1077,7 @@ class TwigExtension extends AbstractExtension {
       return;
     }
 
-    return file_url_transform_relative($image_style->buildUrl($path));
+    return \Drupal::service('file_url_generator')->transformRelative($image_style->buildUrl($path));
   }
 
   /**
@@ -1115,7 +1118,7 @@ class TwigExtension extends AbstractExtension {
    *   (optional) An array of filter types to skip, or an empty array (default)
    *   to skip no filter types.
    *
-   * @return \Drupal\Component\Render\MarkupInterface
+   * @return MarkupInterface
    *   The filtered text.
    *
    * @see check_markup()
@@ -1282,7 +1285,7 @@ class TwigExtension extends AbstractExtension {
    */
   public function fileUrl($input) {
     if (is_string($input)) {
-      return file_url_transform_relative(file_create_url($input));
+      return \Drupal::service('file_url_generator')->generateString($input);
     }
     if ($input instanceof EntityReferenceFieldItemListInterface) {
       $referenced_entities = $input->referencedEntities();
@@ -1345,13 +1348,13 @@ class TwigExtension extends AbstractExtension {
   /**
    * Returns the translation for the given entity.
    *
-   * @param \Drupal\Core\Entity\EntityInterface $entity
+   * @param EntityInterface $entity
    *   The entity to get the translation from.
    * @param string $langcode
    *   (optional) For which language the translation should be looked for,
    *   defaults to the current language context.
    *
-   * @return \Drupal\Core\Entity\EntityInterface
+   * @return EntityInterface
    *   The appropriate translation for the given language context.
    */
   public function entityTranslation(EntityInterface $entity, $langcode = NULL) {
diff --git a/tests/src/Functional/TwigTweakTest.php b/tests/src/Functional/TwigTweakTest.php
index 0854919..2ad6598 100644
--- a/tests/src/Functional/TwigTweakTest.php
+++ b/tests/src/Functional/TwigTweakTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\twig_tweak\Functional;
 
+use Drupal\user\RoleInterface;
 use Drupal\Core\Link;
 use Drupal\Core\Url;
 use Drupal\file\Entity\File;
@@ -45,7 +46,7 @@ class TwigTweakTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     $test_files = $this->getTestFiles('image');
@@ -181,7 +182,7 @@ class TwigTweakTest extends BrowserTestBase {
 
     // Grant require permissions and test the forms again.
     $permissions = ['create page content', 'edit any page content'];
-    /** @var \Drupal\user\RoleInterface $role */
+    /** @var RoleInterface $role */
     $role = Role::load(Role::ANONYMOUS_ID);
     $this->grantPermissions($role, $permissions);
     $this->drupalGet('/node/2');
@@ -297,7 +298,7 @@ class TwigTweakTest extends BrowserTestBase {
     $xpath = '//div[@class="tt-contextual-links" and not(div[@data-contextual-id])]';
     $this->assertByXpath($xpath);
 
-    /** @var \Drupal\user\RoleInterface $role */
+    /** @var RoleInterface $role */
     $role = Role::load(Role::ANONYMOUS_ID);
     $this->grantPermissions($role, ['access contextual links']);
     $this->drupalGet($this->getUrl());
diff --git a/tests/src/Kernel/AccessTest.php b/tests/src/Kernel/AccessTest.php
index 944fa0f..08288b9 100644
--- a/tests/src/Kernel/AccessTest.php
+++ b/tests/src/Kernel/AccessTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\twig_tweak\Kernel;
 
+use Drupal\twig_tweak\TwigExtension;
 use Drupal\block\BlockViewBuilder;
 use Drupal\block\Entity\Block;
 use Drupal\Core\Access\AccessResult;
@@ -29,14 +30,14 @@ class AccessTest extends KernelTestBase {
   /**
    * A node for testing.
    *
-   * @var \Drupal\node\NodeInterface
+   * @var NodeInterface
    */
   private $node;
 
   /**
    * The Twig extension.
    *
-   * @var \Drupal\twig_tweak\TwigExtension
+   * @var TwigExtension
    */
   private $twigExtension;
 
@@ -56,7 +57,7 @@ class AccessTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->installEntitySchema('node');

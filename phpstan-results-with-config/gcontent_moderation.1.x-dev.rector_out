modules/contrib/gcontent_moderation/gcontent_moderation.views.inc
modules/contrib/gcontent_moderation/src/Access/GroupContentModerationPermissions.php
modules/contrib/gcontent_moderation/src/Access/LatestRevisionCheck.php
modules/contrib/gcontent_moderation/src/GcontentModerationServiceProvider.php
modules/contrib/gcontent_moderation/src/GroupStateTransitionValidation.php
modules/contrib/gcontent_moderation/src/Plugin/views/filter/GroupContentRespectUnpublished.php
modules/contrib/gcontent_moderation/tests/modules/gcontent_moderation_test/src/Access/LatestRevisionCheck.php
modules/contrib/gcontent_moderation/tests/modules/gcontent_moderation_test/src/GroupStateTransitionValidation.php
modules/contrib/gcontent_moderation/tests/src/Functional/ContentModerationIntegrationTest.php
modules/contrib/gcontent_moderation/tests/src/Kernel/ContentModerationIntegrationTest.php
modules/contrib/gcontent_moderation/tests/src/Kernel/GroupContentRespectUnpublishedArgumentTest.php

9 files with changes
====================

1) modules/contrib/gcontent_moderation/tests/src/Kernel/GroupContentRespectUnpublishedArgumentTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\gcontent_moderation\Kernel\Views;

+use Drupal\group\Entity\GroupType;
+use Drupal\group\Entity\Storage\GroupContentTypeStorageInterface;
+use Drupal\workflows\WorkflowInterface;
+use Drupal\user\UserInterface;
+use Drupal\group\Entity\GroupInterface;
 use Drupal\group\Entity\Group;
 use Drupal\node\Entity\Node;
 use Drupal\Tests\content_moderation\Traits\ContentModerationTestTrait;
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp($import_test_views = FALSE) {
+  protected function setUp($import_test_views = FALSE): void {
     parent::setUp($import_test_views);

     $this->installEntitySchema('content_moderation_state');
@@ @@
     $account->save();
     $this->container->get('current_user')->setAccount($account);

-    /** @var \Drupal\group\Entity\GroupType $type */
+    /** @var GroupType $type */
     $type = $this->container->get('entity_type.manager')->getStorage('group_type')->load('default');

-    /** @var \Drupal\group\Entity\Storage\GroupContentTypeStorageInterface $storage */
+    /** @var GroupContentTypeStorageInterface $storage */
     $storage = $this->container->get('entity_type.manager')->getStorage('group_content_type');
     $storage->createFromPlugin($type, 'group_node:default')->save();
-    /** @var \Drupal\workflows\WorkflowInterface $workflow */
+    /** @var WorkflowInterface $workflow */
     $workflow = $this->container->get('entity_type.manager')->getStorage('workflow')->load('editorial');
     $workflow->getTypePlugin()->addEntityTypeAndBundle('node', 'default');
     $workflow->save();
@@ @@
     $view = Views::getView('test_moderated_group_content');
     $view->setDisplay();

-    /** @var \Drupal\user\UserInterface$user1 */
+    /** @var UserInterface $user1 */
     $user1 = $this->container->get('current_user')->getAccount();

-    /** @var \Drupal\group\Entity\GroupInterface $group1 */
+    /** @var GroupInterface $group1 */
     $group1 = Group::create([
       'type' => 'default',
       'label' => $this->randomMachineName(),
@@ @@
     ]);
     $group1->save();

-    /** @var \Drupal\node\Entity\Node $node1 */
+    /** @var Node $node1 */
     Node::create([
       'type' => 'default',
       'title' => 'Node1',
@@ @@
     );
     $node1 = current($node1);

-    /** @var \Drupal\node\Entity\Node $node2 */
+    /** @var Node $node2 */
     Node::create([
       'type' => 'default',
       'title' => 'Node2',
@@ @@
     $user2->save();
     $this->container->get('current_user')->setAccount($user2);

-    /** @var \Drupal\node\Entity\Node $node3 */
+    /** @var Node $node3 */
     Node::create([
       'type' => 'default',
       'title' => 'Node3',
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/gcontent_moderation/tests/src/Kernel/ContentModerationIntegrationTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\gcontent_moderation\Kernel;

+use Prophecy\PhpUnit\ProphecyTrait;
+use Drupal\group\Entity\GroupInterface;
+use Drupal\user\UserInterface;
+use Drupal\node\NodeInterface;
+use Drupal\workflows\WorkflowInterface;
+use Drupal\group\Entity\GroupTypeInterface;
+use Drupal\group\Entity\Storage\GroupContentTypeStorageInterface;
 use Drupal\Core\Access\AccessResultAllowed;
 use Drupal\Core\Access\AccessResultForbidden;
 use Drupal\Core\Routing\RouteMatchInterface;
@@ @@
  */
 class ContentModerationIntegrationTest extends GroupKernelTestBase {

+  use ProphecyTrait;
   use ContentTypeCreationTrait;
   use ContentModerationTestTrait;
   use NodeCreationTrait;
@@ @@
   /**
    * A group.
    *
-   * @var \Drupal\group\Entity\GroupInterface
+   * @var GroupInterface
    */
   protected $group;

@@ @@
   /**
    * A group member.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $groupMember;

@@ @@
   /**
    * A group node.
    *
-   * @var \Drupal\node\NodeInterface
+   * @var NodeInterface
    */
   protected $groupNode;

@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     $this->installEntitySchema('content_moderation_state');
@@ @@
     $this->createEditorialWorkflow();

     // Enable workflow.
-    /** @var \Drupal\workflows\WorkflowInterface $workflow */
+    /** @var WorkflowInterface $workflow */
     $workflow = $this->entityTypeManager->getStorage('workflow')->load('editorial');
     $workflow->getTypePlugin()->addEntityTypeAndBundle('node', 'article');
     $workflow->save();
@@ @@
       'view latest version',
       'view unpublished group_node:article entity',
     ];
-    /** @var \Drupal\group\Entity\GroupTypeInterface $type */
+    /** @var GroupTypeInterface $type */
     $type = $this->entityTypeManager->getStorage('group_type')->load('default');
     $type->getMemberRole()->grantPermissions($member_permissions)->save();

     // Enable node content.
-    /** @var \Drupal\group\Entity\Storage\GroupContentTypeStorageInterface $storage */
+    /** @var GroupContentTypeStorageInterface $storage */
     $storage = $this->entityTypeManager->getStorage('group_content_type');
     $storage->createFromPlugin($type, 'group_node:article')->save();

@@ @@
     $access_check = $this->container->get('access_check.latest_revision');

     // By default there should be no access granted.
-    /** @var \Symfony\Component\Routing\Route $route */
+    /** @var Route $route */
     $route = $this->prophesize(Route::class);
     $route->getOption('_content_moderation_entity_type')->willReturn('node');
     // This option is checked by the testing decorator.
     // @see \Drupal\group_test_content_moderation\Access\LatestRevisionCheck::access
     $route->getOption('_explicit_deny')->willReturn(FALSE);
-    /** @var \Drupal\Core\Routing\RouteMatchInterface $route_match */
+    /** @var RouteMatchInterface $route_match */
     $route_match = $this->prophesize(RouteMatchInterface::class);
     $route_match->getParameter('node')->willReturn($this->groupNode);
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/gcontent_moderation/tests/src/Functional/ContentModerationIntegrationTest.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\Tests\gcontent_moderation\Functional;

+use Drupal\group\Entity\GroupInterface;
+use Drupal\user\UserInterface;
+use Drupal\group\Entity\GroupTypeInterface;
+use Drupal\group\Entity\Storage\GroupContentTypeStorageInterface;
+use Drupal\workflows\WorkflowInterface;
 use Drupal\Tests\content_moderation\Traits\ContentModerationTestTrait;
 use Drupal\Tests\group\Functional\GroupBrowserTestBase;
 use InvalidArgumentException;
@@ @@
   /**
    * A group for testing purposes.
    *
-   * @var \Drupal\group\Entity\GroupInterface
+   * @var GroupInterface
    */
   protected $group;

@@ @@
   /**
    * A normal group member.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $groupMember;

@@ @@
   /**
    * A admin group member.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $groupAdmin;

@@ @@
   /**
    * A non-group member.
    *
-   * @var \Drupal\user\UserInterface
+   * @var UserInterface
    */
   protected $nonGroupMember;

@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     // Create the editorial workflow.
@@ @@
       'view own unpublished group_node:article entity',
       'view latest version',
     ];
-    /** @var \Drupal\group\Entity\GroupTypeInterface $type */
+    /** @var GroupTypeInterface $type */
     $type = $this->entityTypeManager->getStorage('group_type')->load('default');
     $type->getMemberRole()->grantPermissions($member_permissions)->save();

@@ @@

     // Add the article content type to the group type, and enable workflow.
     $this->createContentType(['type' => 'article']);
-    /** @var \Drupal\group\Entity\Storage\GroupContentTypeStorageInterface $storage */
+    /** @var GroupContentTypeStorageInterface $storage */
     $storage = $this->entityTypeManager->getStorage('group_content_type');
     $storage->createFromPlugin($type, 'group_node:article')->save();
-    /** @var \Drupal\workflows\WorkflowInterface $workflow */
+    /** @var WorkflowInterface $workflow */
     $workflow = $this->entityTypeManager->getStorage('workflow')->load('editorial');
     $workflow->getTypePlugin()->addEntityTypeAndBundle('node', 'article');
     $workflow->save();
@@ @@
       'moderation_state[0][state]' => 'published',
     ];
     try {
-      $this->drupalPostForm(NULL, $edit, t('Save'));
+      $this->submitForm($edit, t('Save'));
     }
     catch (InvalidArgumentException $exception) {
       $expectedException = TRUE;
@@ @@
     $edit = [
       'moderation_state[0][state]' => 'draft',
     ];
-    $this->drupalPostForm(NULL, $edit, t('Save'));
+    $this->submitForm($edit, t('Save'));
     $this->drupalGet($node->toUrl('edit-form'));
-    $this->drupalPostForm(NULL, ['title[0][value]' => 'New draft'], t('Save'));
+    $this->submitForm(['title[0][value]' => 'New draft'], t('Save'));
     $this->assertSession()->statusCodeEquals(200);

     // The group admin should have access.
@@ @@
     $edit = [
       'moderation_state[0][state]' => 'published',
     ];
-    $this->drupalPostForm(NULL, $edit, t('Save'));
+    $this->submitForm($edit, t('Save'));
     $this->assertSession()->statusCodeEquals(200);

   }
    ----------- end diff -----------

Applied rules:
 * UiHelperTraitDrupalPostFormRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/gcontent_moderation/tests/modules/gcontent_moderation_test/src/GroupStateTransitionValidation.php:17

    ---------- begin diff ----------
@@ @@
   /**
    * The inner service.
    *
-   * @var \Drupal\content_moderation\StateTransitionValidationInterface
+   * @var StateTransitionValidationInterface
    */
   protected $inner;

@@ @@
   /**
    * The moderation information service.
    *
-   * @var \Drupal\content_moderation\ModerationInformationInterface
+   * @var ModerationInformationInterface
    */
   protected $moderationInformation;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/gcontent_moderation/tests/modules/gcontent_moderation_test/src/Access/LatestRevisionCheck.php:22

    ---------- begin diff ----------
@@ @@
   /**
    * Constructs the service decorator.
    *
-   * @param \Drupal\Core\Routing\Access\AccessInterface $inner
+   * @param AccessInterface $inner
    *   The inner service.
    */
   public function __construct(AccessInterface $inner) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector


6) modules/contrib/gcontent_moderation/src/Plugin/views/filter/GroupContentRespectUnpublished.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\gcontent_moderation\Plugin\views\filter;

+use Drupal\group\Plugin\views\argument\GroupId;
+use Drupal\group\Entity\GroupInterface;
+use Drupal\gnode\Plugin\GroupContentEnabler\GroupNode;
 use Drupal\Core\Entity\ContentEntityStorageInterface;
 use Drupal\group\Plugin\GroupContentEnablerManagerInterface;
 use Drupal\views\Plugin\views\filter\FilterPluginBase;
@@ @@
   /**
    * The group storage.
    *
-   * @var \Drupal\Core\Entity\ContentEntityStorageInterface
+   * @var ContentEntityStorageInterface
    */
   protected $groupStorage;

@@ @@
   /**
    * The group content enabler plugin manager.
    *
-   * @var \Drupal\group\Plugin\GroupContentEnablerManagerInterface
+   * @var GroupContentEnablerManagerInterface
    */
   protected $groupContentEnabler;

@@ @@
       return;
     }

-    /** @var \Drupal\group\Plugin\views\argument\GroupId $groupIdPlugin */
+    /** @var GroupId $groupIdPlugin */
     $groupId = NULL;
     $groupIdPlugin = $argument['gid'];
     if ($groupIdPlugin->getPluginId() === 'group_id') {
@@ @@
       return;
     }

-    /** @var \Drupal\group\Entity\GroupInterface $group */
+    /** @var GroupInterface $group */
     $group = $this->groupStorage->load($groupId);
     if (!$group) {
       $this->query->addWhereExpression(
@@ @@
     }

     $nodeTypes = [];
-    /** @var \Drupal\gnode\Plugin\GroupContentEnabler\GroupNode $plugin */
+    /** @var GroupNode $plugin */
     foreach ($this->groupContentEnabler->getAll() as $plugin) {
       $pluginDefinition = $plugin->getPluginDefinition();
       if ($pluginDefinition['entity_type_id'] === 'node') {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/gcontent_moderation/src/GroupStateTransitionValidation.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\gcontent_moderation;

+use Drupal\group\Entity\GroupInterface;
+use Drupal\group\Entity\GroupContentInterface;
+use Drupal\workflows\TransitionInterface;
 use Drupal\content_moderation\ModerationInformationInterface;
 use Drupal\content_moderation\StateTransitionValidation;
 use Drupal\content_moderation\StateTransitionValidationInterface;
@@ @@
   /**
    * The content moderation state transition validation service.
    *
-   * @var \Drupal\content_moderation\StateTransitionValidationInterface
+   * @var StateTransitionValidationInterface
    */
   protected $inner;

@@ @@
   /**
    * The entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
   /**
    * The moderation information service.
    *
-   * @var \Drupal\content_moderation\ModerationInformationInterface
+   * @var ModerationInformationInterface
    */
   protected $moderationInformation;

@@ @@
   /**
    * The route match service.
    *
-   * @var \Drupal\Core\Routing\RouteMatchInterface
+   * @var RouteMatchInterface
    */
   protected $currentRouteMatch;

@@ @@
   /**
    * The group content enabler plugin manager.
    *
-   * @var \Drupal\group\Plugin\GroupContentEnablerManagerInterface
+   * @var GroupContentEnablerManagerInterface
    */
   protected $groupContentEnablerManager;

@@ @@
   /**
    * Constructs the group state transition validation object.
    *
-   * @param \Drupal\content_moderation\StateTransitionValidationInterface $inner
+   * @param StateTransitionValidationInterface $inner
    *   The content moderation state transition validation service.
-   * @param \Drupal\content_moderation\ModerationInformationInterface $moderation_information
+   * @param ModerationInformationInterface $moderation_information
    *   The moderation information service.
-   * @param \Drupal\Core\Routing\RouteMatchInterface $route_match
+   * @param RouteMatchInterface $route_match
    *   The current route match service.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
-   * @param \Drupal\group\Plugin\GroupContentEnablerManagerInterface $group_content_enabler_manager
+   * @param GroupContentEnablerManagerInterface $group_content_enabler_manager
    *   The group content enabler plugin manager.
    */
   public function __construct(StateTransitionValidationInterface $inner, ModerationInformationInterface $moderation_information, RouteMatchInterface $route_match, EntityTypeManagerInterface $entity_type_manager, GroupContentEnablerManagerInterface $group_content_enabler_manager) {
@@ @@
       return $this->inner->getValidTransitions($entity, $user);
     }

-    /** @var \Drupal\group\Entity\GroupInterface[] $groups */
+    /** @var GroupInterface[] $groups */
     $groups = [];
     foreach ($group_contents as $group_content) {
-      /** @var \Drupal\group\Entity\GroupContentInterface $group_content */
+      /** @var GroupContentInterface $group_content */
       $group = $group_content->getGroup();
       $groups[$group->id()] = $group;
     }
@@ @@
   /**
    * Create a plugin ID based on an entity.
    *
-   * @param \Drupal\Core\Entity\ContentEntityInterface $entity
+   * @param ContentEntityInterface $entity
    *   The entity to get the Plugin for.
    *
    * @return string
@@ @@
   /**
    * Run the permissions checks against this set of groups.
    *
-   * @param \Drupal\Core\Session\AccountInterface $user
+   * @param AccountInterface $user
    *   The user to check access to transitions for.
-   * @param \Drupal\Core\Entity\ContentEntityInterface $entity
+   * @param ContentEntityInterface $entity
    *   The moderated entity.
    * @param array $groups
    *   The groups the entity belongs to.
    *
-   * @return \Drupal\workflows\TransitionInterface[]
+   * @return TransitionInterface[]
    *   Array of valid transitions.
    */
   public function allowedTransitions(AccountInterface $user, ContentEntityInterface $entity, array $groups) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


8) modules/contrib/gcontent_moderation/src/Access/LatestRevisionCheck.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\gcontent_moderation\Access;

+use Drupal\Core\Access\AccessResultInterface;
+use Drupal\group\Entity\GroupContentInterface;
 use Drupal\Core\Access\AccessResult;
 use Drupal\Core\Access\AccessResultNeutral;
 use Drupal\Core\Entity\ContentEntityInterface;
@@ @@
   /**
    * The entity type manager service.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;

@@ @@
   /**
    * Constructs the group latest revision check object.
    *
-   * @param \Drupal\Core\Routing\Access\AccessInterface $inner
+   * @param AccessInterface $inner
    *   The inner service.
-   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
+   * @param EntityTypeManagerInterface $entity_type_manager
    *   The entity type manager service.
    */
   public function __construct(AccessInterface $inner, EntityTypeManagerInterface $entity_type_manager) {
@@ @@
   /**
    * Determine group-specific access to the latest revision.
    *
-   * @param \Drupal\Core\Entity\ContentEntityInterface $entity
+   * @param ContentEntityInterface $entity
    *   The entity to check.
-   * @param \Drupal\Core\Session\AccountInterface $account
+   * @param AccountInterface $account
    *   The user to check access for.
    *
-   * @return \Drupal\Core\Access\AccessResultInterface
+   * @return AccessResultInterface
    *   Returns allowed access if the entity belongs to a group, and the user
    *   has both the 'view latest version' and the
    *   'view unpublished PLUGIN_ID entity' permission in a group it belongs to.
@@ @@
       return $access;
     }

-    /** @var \Drupal\group\Entity\GroupContentInterface $group_content */
+    /** @var GroupContentInterface $group_content */
     foreach ($group_contents as $group_content) {
       $group = $group_content->getGroup();
       $access = $access->orIf(AccessResult::allowedIf(
@@ @@
   /**
    * Copy of content moderation's protected method.
    *
-   * @param \Symfony\Component\Routing\Route $route
+   * @param Route $route
    *   The route to check against.
-   * @param \Drupal\Core\Routing\RouteMatchInterface $route_match
+   * @param RouteMatchInterface $route_match
    *   The parametrized route.
    *
-   * @return \Drupal\Core\Entity\ContentEntityInterface
+   * @return ContentEntityInterface
    *   returns the Entity in question.
    *
    * @throws \Exception
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


9) modules/contrib/gcontent_moderation/src/Access/GroupContentModerationPermissions.php:23

    ---------- begin diff ----------
@@ @@
     $perms = [];

     // Generate group permissions for all group types.
-    /** @var \Drupal\workflows\WorkflowInterface $workflow */
+    /** @var WorkflowInterface $workflow */
     foreach (Workflow::loadMultipleByType('content_moderation') as $workflow) {
       $perms += $this->buildPermissions($workflow);
     }
@@ @@
   /**
    * Returns a list of group permissions for a given profile type.
    *
-   * @param \Drupal\workflows\WorkflowInterface $workflow
+   * @param WorkflowInterface $workflow
    *   The profile type.
    *
    * @return array
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector


 [OK] 9 files have been changed by Rector                                       


diff --git a/csvimport-deprecated/src/ImportSmallads.php b/csvimport-deprecated/src/ImportSmallads.php
index c3f8757..0366e1f 100644
--- a/csvimport-deprecated/src/ImportSmallads.php
+++ b/csvimport-deprecated/src/ImportSmallads.php
@@ -7,11 +7,13 @@
  */
 namespace Drupal\smallads_import;
 
+use Drupal\Core\Form\FormBase;
+use Drupal\Core\Url;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\Core\Language\Language;
 use GuzzleHttp;
 
-class ImportSmallads extends \Drupal\Core\Form\FormBase {
+class ImportSmallads extends FormBase {
 
   private $database;
 
@@ -105,7 +107,7 @@ class ImportSmallads extends \Drupal\Core\Form\FormBase {
       '#value' => 'import',
       '#weight' => 4
     );
-    $form['#redirect'] = \Drupal\Core\Url::fromRoute('entity.smallad.collection');
+    $form['#redirect'] = Url::fromRoute('entity.smallad.collection');
     return $form;
   }
 
@@ -147,7 +149,9 @@ class ImportSmallads extends \Drupal\Core\Form\FormBase {
     foreach ($incoming_terms as $key => $term) {
       $incoming_terms[$key] = trim($term);
     }
-    $all_terms = db_query("SELECT LOWER(name) FROM {taxonomy_term_data}")->fetchCol();
+    // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+    // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+    $all_terms = \Drupal::database()->query("SELECT LOWER(name) FROM {taxonomy_term_data}")->fetchCol();
     $new_terms = array_diff(array_unique($incoming_terms), $all_terms);
 
     if (count($new_terms)) {
@@ -168,7 +172,9 @@ class ImportSmallads extends \Drupal\Core\Form\FormBase {
     $rows = $this->loadCsv($form_state);
 
     //get the terms so we can lookup the ids
-    $all_terms = db_query("
+    // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+    // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+    $all_terms = \Drupal::database()->query("
       SELECT d.tid, d.vid, d.name, LOWER(d.name) as term_name, v.name, v.machine_name
       FROM {taxonomy_term_data} d
       LEFT JOIN {taxonomy_vocabulary} v ON d.vid = v.vid
@@ -224,10 +230,9 @@ class ImportSmallads extends \Drupal\Core\Form\FormBase {
       }
       node_save($node);
       if (array_key_exists('created', $row)) {
-        db_query(
-          "UPDATE {node} SET changed = :changed where nid = $node->nid",
-          array('changed' => is_numeric($row['created']) ? $row['created'] : strtotime($row['created']))
-        );
+        // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+        // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+        \Drupal::database()->query("UPDATE {node} SET changed = :changed where nid = $node->nid", array('changed' => is_numeric($row['created']) ? $row['created'] : strtotime($row['created'])));
       }
       $imported++;
     }
diff --git a/modules/smallads_group/src/SmalladGroupAccessControlHandler.php b/modules/smallads_group/src/SmalladGroupAccessControlHandler.php
index de9a9fe..337c7b4 100644
--- a/modules/smallads_group/src/SmalladGroupAccessControlHandler.php
+++ b/modules/smallads_group/src/SmalladGroupAccessControlHandler.php
@@ -26,16 +26,16 @@ class SmalladGroupAccessControlHandler extends EntityAccessControlHandler implem
   protected $groupContext;
 
   /**
-   * @var \Drupal\Core\Entity\EntityTypeManager
+   * @var EntityTypeManager
    */
   protected $entityTypeManager;
 
   /**
    * Constructs a NodeAccessControlHandler object.
    *
-   * @param \Drupal\Core\Entity\EntityTypeInterface $entity_type
+   * @param EntityTypeInterface $entity_type
    * @param \Drupal\group\Context\GroupRouteContext $group_context
-   * @param \Drupal\Core\Entity\EntityTypeManager $entity_type_manager
+   * @param EntityTypeManager $entity_type_manager
    */
   public function __construct(EntityTypeInterface $entity_type, GroupRouteContext $group_context, EntityTypeManager $entity_type_manager) {
     parent::__construct($entity_type);
diff --git a/modules/smallads_index/smallads_index.module b/modules/smallads_index/smallads_index.module
index 4ca5f98..a4971d7 100644
--- a/modules/smallads_index/smallads_index.module
+++ b/modules/smallads_index/smallads_index.module
@@ -1,5 +1,8 @@
 <?php
 
+use Psr\Http\Message\ResponseInterface;
+use Drupal\Core\Form\FormStateInterface;
+use function GuzzleHttp\json_encode;
 use Drupal\smallads\Entity\Smallad;
 use Drupal\smallads\Entity\SmalladInterface;
 use \GuzzleHttp\Psr7\Response;
@@ -71,7 +74,7 @@ function smallads_index_to_solItem(SmalladInterface $smallad) {
     'keywords' => taxonomy_implode_tags($smallad->categories->referencedEntities()),
     'created' => $smallad->getCreatedTime(),
     'expires' => $smallad->expires->value,
-    'image' => ($smallad->image && $smallad->image->entity) ? substr(file_url_transform_relative(file_create_url($smallad->image->entity->getFileUri())), 1) : '',
+    'image' => ($smallad->image && $smallad->image->entity) ? substr(\Drupal::service('file_url_generator')->generateString($smallad->image->entity->getFileUri()), 1) : '',
     'scope' => $smallad->scope->value,
     'location' => $smallad->coordinates->value,
     'directexchange' => (int)$smallad->directexchange->value,
@@ -124,11 +127,11 @@ function smalladIndex($type) {
  * @param string $url
  * @param string $body
  *
- * @return Psr\Http\Message\ResponseInterface
+ * @return ResponseInterface
  */
 function smallads_index_http_request($method, $url, $body = '') : Response {
   if ($key = \Drupal::config('smallads_index.settings')->get('apikey')) {
-    $options['body'] = GuzzleHttp\json_encode($body);
+    $options['body'] = json_encode($body);
     $options['headers'] = [
       'Content-Type' => 'application/json',
       'apikey' => $key
@@ -142,13 +145,13 @@ function smallads_index_http_request($method, $url, $body = '') : Response {
     catch(\Exception $e)  {
       $message = 'No response from '.SMALLAD_INDEX_URL;
       trigger_error($message, E_USER_ERROR);
-      $response = new \GuzzleHttp\Psr7\Response(404, [], NULL, NULL, $message);
+      $response = new Response(404, [], NULL, NULL, $message);
     }
   }
   else {
     \Drupal::moduleHandler()->loadInstall('smallads_index', 'install');
     \Drupal::messenger()->addStatus(strtoupper($method) ." to /$url cannot run without APIkey");
-    $response = new \GuzzleHttp\Psr7\Response(403, [], NULL, NULL, 'No apikey given');
+    $response = new Response(403, [], NULL, NULL, 'No apikey given');
   }
   return $response;
 }
@@ -156,7 +159,7 @@ function smallads_index_http_request($method, $url, $body = '') : Response {
 /**
  * Implements hook_form_FORM_ID_alter().
  */
-function smallads_index_form_smallads_config_form_alter(&$form, Drupal\Core\Form\FormStateInterface $form_state) {
+function smallads_index_form_smallads_config_form_alter(&$form, FormStateInterface $form_state) {
   $form['solsearch'] = [
     '#title' => 'SolSearch',
     '#description' => t('Web service for global offers & wants.'),
diff --git a/modules/smallads_index/src/Form.php b/modules/smallads_index/src/Form.php
index 72a8905..059d8da 100644
--- a/modules/smallads_index/src/Form.php
+++ b/modules/smallads_index/src/Form.php
@@ -2,6 +2,9 @@
 
 namespace Drupal\smallads_index;
 
+use Symfony\Component\HttpFoundation\Request;
+use Drupal\Core\Link;
+use Drupal\Core\Render\Markup;
 use Drupal\Core\Form\FormBase;
 use Drupal\Core\Form\FormStateInterface;
 use Symfony\Component\DependencyInjection\ContainerInterface;
@@ -13,7 +16,7 @@ use Drupal\Core\Session\AccountProxy;
 class Form extends FormBase {
 
   /**
-   * @var Symfony\Component\HttpFoundation\Request
+   * @var Request
    */
   private $request;
 
@@ -132,7 +135,7 @@ class Form extends FormBase {
     return $form;
   }
 
-  function submitForm(array &$form, \Drupal\Core\Form\FormStateInterface $form_state) {
+  function submitForm(array &$form, FormStateInterface $form_state) {
     //save the search settings
     $prefs = [
       'radius' => $form_state->getValue('radius'),
@@ -224,7 +227,7 @@ class Form extends FormBase {
           'icon_anchor' => ['x' => 24, 'y' => 32],//not supported yet in leaflet module Beta1
           'popup_anchor' => ['x' => 16, 'y' => 0],
         ],
-        'popup' => \Drupal\Core\Link::fromTextAndUrl($result->title, $dest)->toString() . '<br>'.$result->body,
+        'popup' => Link::fromTextAndUrl($result->title, $dest)->toString() . '<br>'.$result->body,
         'leaflet_id' => $result->id
       ];
     }
@@ -249,9 +252,9 @@ class Form extends FormBase {
         $snippet = $this->t(
             '@snippet<strong>Keywords</strong>: @words<br />on %site',
             [
-              '@snippet' => $body ? \Drupal\Core\Render\Markup::create($body.'<br \>') : '',
+              '@snippet' => $body ? Markup::create($body.'<br \>') : '',
               '@words' => $result->keywords,
-              '%site' => \Drupal\Core\Link::fromTextAndUrl($result->name, Url::fromUri($result->url))->toString()
+              '%site' => Link::fromTextAndUrl($result->name, Url::fromUri($result->url))->toString()
             ]
         );
         $hits[] = [
diff --git a/modules/smallads_index/src/Plugin/Search/SmalladIndexSearch.php b/modules/smallads_index/src/Plugin/Search/SmalladIndexSearch.php
index 72ee364..c3df66a 100644
--- a/modules/smallads_index/src/Plugin/Search/SmalladIndexSearch.php
+++ b/modules/smallads_index/src/Plugin/Search/SmalladIndexSearch.php
@@ -31,49 +31,49 @@ class SmalladIndexSearch extends ConfigurableSearchPluginBase implements Accessi
   /**
    * A database connection object.
    *
-   * @var \Drupal\Core\Database\Connection
+   * @var Connection
    */
   protected $database;
 
   /**
    * An entityType manager object.
    *
-   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
+   * @var EntityTypeManagerInterface
    */
   protected $entityTypeManager;
 
   /**
    * A module manager object.
    *
-   * @var \Drupal\Core\Extension\ModuleHandlerInterface
+   * @var ModuleHandlerInterface
    */
   protected $moduleHandler;
 
   /**
    * A config object for 'search.settings'.
    *
-   * @var \Drupal\Core\Config\Config
+   * @var Config
    */
   protected $searchSettings;
 
   /**
    * The language manager.
    *
-   * @var \Drupal\Core\Language\LanguageManagerInterface
+   * @var LanguageManagerInterface
    */
   protected $languageManager;
 
   /**
    * The Drupal account to use for checking for access to advanced search.
    *
-   * @var \Drupal\Core\Session\AccountInterface
+   * @var AccountInterface
    */
   protected $account;
 
   /**
    * The Renderer service to format the username and node.
    *
-   * @var \Drupal\Core\Render\RendererInterface
+   * @var RendererInterface
    */
   protected $renderer;
 
@@ -211,7 +211,7 @@ class SmalladIndexSearch extends ConfigurableSearchPluginBase implements Accessi
    * This method can assume that $this->isSearchExecutable() has already been
    * checked and returned TRUE.
    *
-   * @return \Drupal\Core\Database\StatementInterface|null
+   * @return StatementInterface|null
    *   Results from search query execute() method, or NULL if the search
    *   failed.
    */
@@ -223,7 +223,7 @@ class SmalladIndexSearch extends ConfigurableSearchPluginBase implements Accessi
   /**
    * Prepares search results for rendering.
    *
-   * @param \Drupal\Core\Database\StatementInterface $found
+   * @param StatementInterface $found
    *   Results found from a successful search query execute() method.
    *
    * @return array
diff --git a/modules/smallads_index/src/RouteSubscriber.php b/modules/smallads_index/src/RouteSubscriber.php
index 6ca0fad..93a25bd 100644
--- a/modules/smallads_index/src/RouteSubscriber.php
+++ b/modules/smallads_index/src/RouteSubscriber.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\smallads_index;
 
+use Drupal\smallads\Entity\SmalladType;
+use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Routing\RouteSubscriberBase;
 use Symfony\Component\Routing\Route;
 use Symfony\Component\Routing\RouteCollection;
@@ -16,11 +18,11 @@ use Symfony\Component\Routing\RouteCollection;
 class RouteSubscriber extends RouteSubscriberBase {
 
   /**
-   * @var Drupal\smallads\Entity\SmalladType[]
+   * @var SmalladType[]
    */
   private $smalladTypes;
 
-  function __construct(\Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager) {
+  function __construct(EntityTypeManagerInterface $entity_type_manager) {
     $this->smalladTypes = $entity_type_manager->getStorage('smallad_type')->loadMultiple();
   }
 
diff --git a/smallads.install b/smallads.install
index dce386e..c67bfe2 100644
--- a/smallads.install
+++ b/smallads.install
@@ -1,5 +1,8 @@
 <?php
 
+use Drupal\user\Entity\Role;
+use Drupal\Core\Field\BaseFieldDefinition;
+use Drupal\views\Entity\View;
 /**
  * @file
  * Hooks for installing the smallads module.
@@ -40,7 +43,7 @@ function smallads_uninstall() {
 
 
 function smallads_update_8001(){
-  foreach (\Drupal\user\Entity\Role::loadMultiple() as $role) {
+  foreach (Role::loadMultiple() as $role) {
     if ($role->hasPermission('post ad')) {
       $role->revokePermission('post ad')->grantpermission('post smallad')->save();
     }
@@ -54,7 +57,7 @@ function smallads_update_8001(){
  * Standardise the language field.
  */
 function smallads_update_8002() {
-  $definition = Drupal\Core\Field\BaseFieldDefinition::create('language')
+  $definition = BaseFieldDefinition::create('language')
     ->setLabel(t('Language'))
     ->setDisplayOptions('view', [
       'region' => 'hidden',
@@ -84,9 +87,9 @@ function smallads_update_9000() {
  * Remove the views 'scope' filter.
  */
 function smallads_update_9001() {
-  foreach (\Drupal\views\Entity\View::loadMultiple() as $view) {
+  foreach (View::loadMultiple() as $view) {
     $save = 0;
-    /** @var \Drupal\views\Entity\View $view */
+    /** @var View $view */
     $displays = $view->get('display');
     foreach ($displays as $display_id => $display) {
       $display = &$view->getDisplay($display_id);
@@ -168,4 +171,4 @@ function smallads_update_9005() {
   $v['display']['my_ads']['id'] = 'my_ads';
   $config->setData($v);
   $config->save();
-}
\ No newline at end of file
+}
diff --git a/smallads.module b/smallads.module
index aa10bf3..8728abb 100644
--- a/smallads.module
+++ b/smallads.module
@@ -1,5 +1,6 @@
 <?php
 
+use Drupal\Core\Entity\EntityInterface;
 /**
  * @file
  *
@@ -260,7 +261,7 @@ function smallads_cron() {
   // Find out how to filter by relative dates.
   $smids = \Drupal::entityTypeManager()->getStorage('smallad')->getQuery()
     // Actually the date is stored as dd-mm-yyyy.
-    ->condition('expires', gmdate('Y-m-d', REQUEST_TIME), '<')
+    ->condition('expires', gmdate('Y-m-d', \Drupal::time()->getRequestTime()), '<')
     ->condition('scope', 0, '>')
     ->execute();
   $queue = \Drupal::queue('smallads_expired_mail');
@@ -530,7 +531,7 @@ function smallads_taxonomy_term_update($term) {
  * Implements hook_ENTITY_TYPE_delete().
  * Delete all the user's smallads.
  */
-function smallads_user_delete(Drupal\Core\Entity\EntityInterface $entity) {
+function smallads_user_delete(EntityInterface $entity) {
   $ads = \Drupal::entityTypeManager()
     ->getStorage('smallad')
     ->loadByProperties(['uid' => $entity->id()]);
@@ -549,4 +550,4 @@ function smallads_form_views_ui_add_handler_form_alter(&$form, $form_state) {
   if (isset($form['override']['controls']['group']['#options']['small-ad'])) {
     $form['options']['name']['#caption'] = t('N.B. It may be necessary to disable your ad-blocker to see the smallad fields.');
   }
-}
\ No newline at end of file
+}
diff --git a/src/EventSubscriber/RouteSubscriber.php b/src/EventSubscriber/RouteSubscriber.php
index 10d6246..99d358f 100644
--- a/src/EventSubscriber/RouteSubscriber.php
+++ b/src/EventSubscriber/RouteSubscriber.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\smallads\EventSubscriber;
 
+use Drupal\smallads\Entity\SmalladType;
+use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Routing\RouteSubscriberBase;
 use Symfony\Component\Routing\Route;
 use Symfony\Component\Routing\RouteCollection;
@@ -16,11 +18,11 @@ use Symfony\Component\Routing\RouteCollection;
 class RouteSubscriber extends RouteSubscriberBase {
 
   /**
-   * @var Drupal\smallads\Entity\SmalladType[]
+   * @var SmalladType[]
    */
   private $smalladTypes;
 
-  function __construct(\Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager) {
+  function __construct(EntityTypeManagerInterface $entity_type_manager) {
     $this->smalladTypes = $entity_type_manager->getStorage('smallad_type')->loadMultiple();
   }
 
diff --git a/src/Form/Config.php b/src/Form/Config.php
index 4013856..aabe96a 100644
--- a/src/Form/Config.php
+++ b/src/Form/Config.php
@@ -22,7 +22,7 @@ class Config extends ConfigFormBase {
    * @param ConfigFactoryInterface $config_factory
    * @param RouteBuilderInterface $router_builder
    */
-  function __construct(\Drupal\Core\Config\ConfigFactoryInterface $config_factory, RouteBuilderInterface $router_builder) {
+  function __construct(ConfigFactoryInterface $config_factory, RouteBuilderInterface $router_builder) {
     parent::__construct($config_factory);
     $this->routeBuilder = $router_builder;
   }
diff --git a/src/Form/SmalladEdit.php b/src/Form/SmalladEdit.php
index ee082a2..c3d32eb 100644
--- a/src/Form/SmalladEdit.php
+++ b/src/Form/SmalladEdit.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\smallads\Form;
 
+use Symfony\Component\HttpFoundation\ParameterBag;
 use Drupal\Core\Routing\RouteMatchInterface;
 use Drupal\Core\Entity\ContentEntityForm;
 use Drupal\Core\Form\FormStateInterface;
@@ -17,12 +18,12 @@ use Drupal\Component\Datetime\TimeInterface;
 class SmalladEdit extends ContentEntityForm {
 
   /**
-   * @var \Drupal\Core\Routing\RouteMatchInterface
+   * @var RouteMatchInterface
    */
   protected $routeMatch;
 
   /**
-   * @var \Symfony\Component\HttpFoundation\ParameterBag
+   * @var ParameterBag
    */
   protected $params;
 
@@ -101,7 +102,7 @@ class SmalladEdit extends ContentEntityForm {
   public function validateForm(array &$form, FormStateInterface $form_state) {
     $this->entity = parent::validateForm($form, $form_state);
     // Warn the user about the expiry date.
-    if ($this->entity->expires->value - REQUEST_TIME > 0) {// Expires in the future.
+    if ($this->entity->expires->value - \Drupal::time()->getRequestTime() > 0) {// Expires in the future.
       if ($this->entity->scope->value == SmalladInterface::SCOPE_PRIVATE) {
         $message = $this->t('If the expiry date is after now, the scope must not be private');
         $form_state->setErrorByName('scope', $message);
diff --git a/src/Form/SmalladTypeForm.php b/src/Form/SmalladTypeForm.php
index 2f6dd7d..a9c625b 100644
--- a/src/Form/SmalladTypeForm.php
+++ b/src/Form/SmalladTypeForm.php
@@ -73,7 +73,7 @@ class SmalladTypeForm extends EntityForm {
     $smallad_type = $this->entity;
     $smallad_type->save();
 
-    $form_state->setRedirectUrl($smallad_type->urlInfo('collection'));
+    $form_state->setRedirectUrl($smallad_type->toUrl('collection'));
     // If the plural has changed we need to rebuild the menu.
     \Drupal::service('router.builder')->rebuild();
   }
diff --git a/src/Plugin/Block/AddAdBlock.php b/src/Plugin/Block/AddAdBlock.php
index c2e3983..1b7c9ac 100644
--- a/src/Plugin/Block/AddAdBlock.php
+++ b/src/Plugin/Block/AddAdBlock.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\smallads\Plugin\Block;
 
+use Drupal\Core\Form\FormBuilderInterface;
 use Drupal\smallads\Entity\SmalladType;
 use Drupal\Core\Access\AccessResult;
 use Drupal\Core\Block\BlockBase;
@@ -24,7 +25,7 @@ class AddAdBlock extends BlockBase implements ContainerFactoryPluginInterface {
   /**
    * The form builder service.
    *
-   * @var \Drupal\Core\Form\FormBuilderInterface
+   * @var FormBuilderInterface
    */
   protected $formBuilder;
 
diff --git a/src/Plugin/Derivative/SmalladMenuLink.php b/src/Plugin/Derivative/SmalladMenuLink.php
index 2d6e5bb..4b185f5 100644
--- a/src/Plugin/Derivative/SmalladMenuLink.php
+++ b/src/Plugin/Derivative/SmalladMenuLink.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\smallads\Plugin\Derivative;
 
+use Drupal\Core\Entity\EntityType;
 use Drupal\Core\Plugin\Discovery\ContainerDeriverInterface;
 use Drupal\Component\Plugin\Derivative\DeriverBase;
 use Symfony\Component\DependencyInjection\ContainerInterface;
@@ -36,7 +37,7 @@ class SmalladMenuLink extends DeriverBase implements ContainerDeriverInterface {
   public function getDerivativeDefinitions($base_plugin_definition) {
     foreach ($this->smallAdTypeStorage->loadMultiple() as $id => $type) {
       // $type seems to be untranslated for some reason
-      /** @var \Drupal\Core\Entity\EntityType $type */
+      /** @var EntityType $type */
       $this->derivatives[$id.".add_form.link"] = [
         'title' => t('Add @type', ['@type' => strtolower($type->label())]),
         'route_name' => 'entity.smallad.add_form',
diff --git a/src/Plugin/Field/FieldFormatter/TimeBeforeAfterFormatter.php b/src/Plugin/Field/FieldFormatter/TimeBeforeAfterFormatter.php
index b78876b..58c6fdc 100644
--- a/src/Plugin/Field/FieldFormatter/TimeBeforeAfterFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/TimeBeforeAfterFormatter.php
@@ -28,7 +28,7 @@ class TimeBeforeAfterFormatter extends BooleanFormatter {
     // @todo include the library
     $elements = array();
     foreach ($items as $delta => &$item) {
-      if (REQUEST_TIME > $item->value) {
+      if (\Drupal::time()->getRequestTime() > $item->value) {
         $item->value = FALSE;
         $class = 'expired';
       }
diff --git a/src/Plugin/Search/SmalladSearch.php b/src/Plugin/Search/SmalladSearch.php
index 556df65..ae44aa4 100644
--- a/src/Plugin/Search/SmalladSearch.php
+++ b/src/Plugin/Search/SmalladSearch.php
@@ -36,7 +36,7 @@ class SmalladSearch extends SearchPluginBase implements AccessibleInterface, Sea
   /**
    * A database connection object.
    *
-   * @var \Drupal\Core\Database\Connection
+   * @var Connection
    */
   protected $database;
 
@@ -49,21 +49,21 @@ class SmalladSearch extends SearchPluginBase implements AccessibleInterface, Sea
   /**
    * The language manager.
    *
-   * @var \Drupal\Core\Language\LanguageManagerInterface
+   * @var LanguageManagerInterface
    */
   protected $languageManager;
 
   /**
    * The Renderer service to format the username and node.
    *
-   * @var \Drupal\Core\Render\RendererInterface
+   * @var RendererInterface
    */
   protected $renderer;
 
   /**
    * The search index.
    *
-   * @var \Drupal\search\SearchIndexInterface
+   * @var SearchIndexInterface
    */
   protected $searchIndex;
 
@@ -182,7 +182,7 @@ class SmalladSearch extends SearchPluginBase implements AccessibleInterface, Sea
    * This method can assume that $this->isSearchExecutable() has already been
    * checked and returned TRUE.
    *
-   * @return \Drupal\Core\Database\StatementInterface|null
+   * @return StatementInterface|null
    *   Results from search query execute() method, or NULL if the search
    *   failed.
    */
@@ -254,7 +254,7 @@ class SmalladSearch extends SearchPluginBase implements AccessibleInterface, Sea
   /**
    * Prepares search results for rendering.
    *
-   * @param \Drupal\Core\Database\StatementInterface $found
+   * @param StatementInterface $found
    *   Results found from a successful search query execute() method.
    *
    * @return array
diff --git a/src/SmalladListBuilder.php b/src/SmalladListBuilder.php
index 2fa5888..1c150ec 100644
--- a/src/SmalladListBuilder.php
+++ b/src/SmalladListBuilder.php
@@ -22,27 +22,27 @@ class SmalladListBuilder extends EntityListBuilder {
   /**
    * The date formatter service.
    *
-   * @var \Drupal\Core\Datetime\DateFormatter
+   * @var DateFormatter
    */
   protected $dateFormatter;
 
   /**
    * The redirect destination service.
    *
-   * @var \Drupal\Core\Routing\RedirectDestinationInterface
+   * @var RedirectDestinationInterface
    */
   protected $redirectDestination;
 
   /**
    * Constructs a new SmalladListBuilder object.
    *
-   * @param \Drupal\Core\Entity\EntityTypeInterface $entity_type
+   * @param EntityTypeInterface $entity_type
    *   The entity type definition.
-   * @param \Drupal\Core\Entity\EntityStorageInterface $storage
+   * @param EntityStorageInterface $storage
    *   The entity storage class.
-   * @param \Drupal\Core\Datetime\DateFormatter $date_formatter
+   * @param DateFormatter $date_formatter
    *   The date formatter service.
-   * @param \Drupal\Core\Routing\RedirectDestinationInterface $redirect_destination
+   * @param RedirectDestinationInterface $redirect_destination
    *   The redirect destination service.
    */
   public function __construct(EntityTypeInterface $entity_type, EntityStorageInterface $storage, DateFormatter $date_formatter, RedirectDestinationInterface $redirect_destination) {
@@ -117,7 +117,7 @@ class SmalladListBuilder extends EntityListBuilder {
     $row['scope'] = $scopeMap[$entity->scope->value];
     $row['type'] = $entity->type->entity->label();
     $row['title'] = $entity->title->value;
-    $row['changed'] = $this->dateFormatter->formatInterval(REQUEST_TIME - $entity->changed->value);
+    $row['changed'] = $this->dateFormatter->formatInterval(\Drupal::time()->getRequestTime() - $entity->changed->value);
 
     return $row + parent::buildRow($entity);
   }

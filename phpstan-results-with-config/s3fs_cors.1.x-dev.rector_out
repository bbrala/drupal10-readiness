modules/contrib/s3fs_cors/s3fs_cors.install
modules/contrib/s3fs_cors/s3fs_cors.module
modules/contrib/s3fs_cors/s3fs_cors.post_update.php
modules/contrib/s3fs_cors/src/Controller/AjaxController.php
modules/contrib/s3fs_cors/src/Element/S3CorsFile.php
modules/contrib/s3fs_cors/src/Element/S3fsCorsFile.php
modules/contrib/s3fs_cors/src/Form/S3fsCorsAdminForm.php
modules/contrib/s3fs_cors/src/Plugin/Field/FieldFormatter/S3fsCorsGenericFileFormatter.php
modules/contrib/s3fs_cors/src/Plugin/Field/FieldType/S3CorsFileItem.php
modules/contrib/s3fs_cors/src/Plugin/Field/FieldType/S3fsCorsFileItem.php
modules/contrib/s3fs_cors/src/Plugin/Field/FieldWidget/S3fsCorsFileWidget.php
modules/contrib/s3fs_cors/src/Plugin/Field/FieldWidget/S3fsCorsImageWidget.php

6 files with changes
====================

1) modules/contrib/s3fs_cors/src/Form/S3fsCorsAdminForm.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\s3fs_cors\Form;

+use Aws\S3\S3ClientInterface;
+use Drupal\s3fs\S3fsException;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Form\ConfigFormBase;
 use Drupal\Core\Form\FormStateInterface;
@@ @@
   /**
    * S3 Client Interface.
    *
-   * @var \Aws\S3\S3ClientInterface
+   * @var S3ClientInterface
    */
   private $s3Client;

@@ @@
   /**
    * S3fsCorsAdminForm constructor.
    *
-   * @param \Drupal\Core\Config\ConfigFactoryInterface $config_factory
+   * @param ConfigFactoryInterface $config_factory
    *   The config factory interface.
-   * @param \Drupal\s3fs\S3fsServiceInterface $s3fs
+   * @param S3fsServiceInterface $s3fs
    *   The S3fs service interface.
    *
-   * @throws \Drupal\s3fs\S3fsException
+   * @throws S3fsException
    *   The S3fs exception.
    */
   public function __construct(ConfigFactoryInterface $config_factory, S3fsServiceInterface $s3fs) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/s3fs_cors/src/Element/S3fsCorsFile.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\s3fs_cors\Element;

+use Drupal\s3fs\S3fsServiceInterface;
 use Aws\Credentials\CredentialProvider;
 use Aws\Credentials\Credentials;
 use Aws\Sts\StsClient;
@@ @@

     // Create an S3 client using the provider. This should use the Instance
     // Profile provider if this code is running in an AWS instance.
-    /** @var \Drupal\s3fs\S3fsServiceInterface $s3fs */
+    /** @var S3fsServiceInterface $s3fs */
     $s3fs = \Drupal::service('s3fs');
     $client = $s3fs->getAmazonS3Client($config->get());
     $creds = $client->getCredentials()->wait();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/s3fs_cors/src/Controller/AjaxController.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\s3fs_cors\Controller;

+use Aws\S3\S3ClientInterface;
+use Drupal\Core\File\MimeType\MimeTypeGuesser;
+use Drupal\Core\Logger\LoggerChannelInterface;
+use Symfony\Component\Mime\MimeTypesInterface;
+use Drupal\s3fs\S3fsException;
 use Drupal\Core\Controller\ControllerBase;
 use Drupal\Core\Database\Connection;
 use Drupal\Core\File\FileSystemInterface;
@@ @@
 use Drupal\s3fs\S3fsServiceInterface;
 use Drupal\s3fs\StreamWrapper\S3fsStream;
 use Symfony\Component\DependencyInjection\ContainerInterface;
-use Symfony\Component\HttpFoundation\File\MimeType\MimeTypeGuesserInterface;
 use Symfony\Component\HttpFoundation\JsonResponse;

 /**
@@ @@
   /**
    * S3 Client Interface.
    *
-   * @var \Aws\S3\S3ClientInterface
+   * @var S3ClientInterface
    */
   protected $s3Client;

@@ @@
   /**
    * Database connection.
    *
-   * @var \Drupal\Core\Database\Connection
+   * @var Connection
    */
   protected $database;

@@ @@
   /**
    * Mime Type Guesser Interface.
    *
-   * @var \Drupal\Core\File\MimeType\MimeTypeGuesser
+   * @var MimeTypeGuesser
    */
   protected $mimeType;

@@ @@
   /**
    * Logger Channel Interface.
    *
-   * @var \Drupal\Core\Logger\LoggerChannelInterface
+   * @var LoggerChannelInterface
    */
   protected $logger;

@@ @@
   /**
    * AjaxController constructor.
    *
-   * @param \Drupal\s3fs\S3fsServiceInterface $s3fs
+   * @param S3fsServiceInterface $s3fs
    *   The S3fs service interface.
-   * @param \Drupal\Core\Database\Connection $database
+   * @param Connection $database
    *   The Drupal database connection service.
-   * @param \Symfony\Component\HttpFoundation\File\MimeType\MimeTypeGuesserInterface $mimeType
+   * @param MimeTypesInterface $mimeType
    *   The mime type guesser service.
-   * @param \Drupal\Core\Logger\LoggerChannelFactoryInterface $loggerFactory
+   * @param LoggerChannelFactoryInterface $loggerFactory
    *   The core logger factory service.
    *
-   * @throws \Drupal\s3fs\S3fsException
+   * @throws S3fsException
    *   The S3fs exception.
    */
-  public function __construct(S3fsServiceInterface $s3fs, Connection $database, MimeTypeGuesserInterface $mimeType, LoggerChannelFactoryInterface $loggerFactory) {
+  public function __construct(S3fsServiceInterface $s3fs, Connection $database, MimeTypesInterface $mimeType, LoggerChannelFactoryInterface $loggerFactory) {
     $s3_config = $this->config('s3fs.settings')->get();
     $this->s3Client = $s3fs->getAmazonS3Client($s3_config);
     $this->database = $database;
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * RenameClassRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/s3fs_cors/s3fs_cors.post_update.php:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Entity\EntityTypeManager;
 /**
  * @file
  * Post update functions.
@@ @@
   $public_folder = 's3://' . ($config->get('public_folder') ?: 's3fs-public');
   $private_folder = 's3://' . ($config->get('private_folder') ?: 's3fs-private');
   if (!isset($sandbox['progress'])) {
-    /** @var \Drupal\Core\Entity\EntityTypeManager $entity_type_manager */
+    /** @var EntityTypeManager $entity_type_manager */
     $entity_type_manager = \Drupal::service('entity_type.manager');
     $storage_handler = $entity_type_manager->getStorage('file');
     $public_ids = $storage_handler
@@ @@
   }
   $ids = array_slice($sandbox['ids'], $sandbox['progress'], Settings::get('entity_update_batch_size', 50));

-  /** @var \Drupal\file\Entity\File $file */
+  /** @var File $file */
   foreach (File::loadMultiple($ids) as $file) {
     $file->setFileUri(str_replace([$public_folder, $private_folder], ['public:/', 'private:/'], $file->getFileUri()));
     $file->save();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


5) modules/contrib/s3fs_cors/s3fs_cors.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\field\Entity\FieldConfig;
+use Drupal\field\Entity\FieldStorageConfig;
 /**
  * @file
  * Allow uploading of files directly to AmazonS3 via the browser using CORS.
@@ @@
   foreach ($form['#fields'] as $field) {
     $field_definition = $field_definitions[$field];
     if ($field_definition instanceof FieldConfigInterface) {
-      /** @var \Drupal\field\Entity\FieldConfig $field_definition */
+      /** @var FieldConfig $field_definition */
       $field_type = $field_definition->get('field_type');
       if ($field_type == 'file' || $field_type == 'image') {
-        /** @var \Drupal\field\Entity\FieldStorageConfig $field_storage */
+        /** @var FieldStorageConfig $field_storage */
         $field_storage = $field_definition->getFieldStorageDefinition();
         $uri_scheme = $field_storage->getSetting('uri_scheme');
         if ($uri_scheme == 's3' ||
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


6) modules/contrib/s3fs_cors/s3fs_cors.install:34

    ---------- begin diff ----------
@@ @@
       continue;
     }

-    /** @var \Drupal\field\Entity\FieldConfig $field */
+    /** @var FieldConfig $field */
     foreach ($fields as $field) {
       $new_field = $field->toArray();
       $new_field['field_type'] = 's3fs_cors_file';
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


 [OK] 6 files have been changed by Rector                                       


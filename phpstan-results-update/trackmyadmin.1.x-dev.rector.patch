diff --git a/src/EventSubscriber/Subscriber.php b/src/EventSubscriber/Subscriber.php
index 05252b6..604924e 100644
--- a/src/EventSubscriber/Subscriber.php
+++ b/src/EventSubscriber/Subscriber.php
@@ -2,9 +2,9 @@
 
 namespace Drupal\trackmyadmin\EventSubscriber;
 
+use Symfony\Component\HttpKernel\Event\RequestEvent;
 use Symfony\Component\HttpFoundation\RedirectResponse;
 use Symfony\Component\HttpKernel\KernelEvents;
-use Symfony\Component\HttpKernel\Event\GetResponseEvent;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
 use Drupal\Core\Session\AccountInterface;
 use Drupal\Core\Path\CurrentPathStack;
@@ -68,7 +68,7 @@ class Subscriber implements EventSubscriberInterface {
    *
    * @see Symfony\Component\HttpKernel\KernelEvents
    */
-  public function performRedirection(GetResponseEvent $event) {
+  public function performRedirection(RequestEvent $event) {
     $trackmyadmin_form_path = '/trackmyadmin/capture_details';
     $roles = $this->currentUser->getRoles();
     // Let us force to provide the details in order to proceed any further.
diff --git a/src/QueryHelper.php b/src/QueryHelper.php
index c739d47..1434ebe 100644
--- a/src/QueryHelper.php
+++ b/src/QueryHelper.php
@@ -228,7 +228,7 @@ class QueryHelper {
     // Create the directory if needed.
     if ($this->fileSystem->prepareDirectory($download_folder, FileSystemInterface::CREATE_DIRECTORY)) {
       $file_name = 'TrackMyAdminData_' . date('m-d-Y_H_i', time()) . '.csv';
-      $file_path = file_create_url('public://trackmyadmin/' . $file_name);
+      $file_path = \Drupal::service('file_url_generator')->generateAbsoluteString('public://trackmyadmin/' . $file_name);
       $fileObject = fopen($download_folder . '/' . $file_name, 'a');
       $data = $this->fetchValues('entire_data');
       if (!empty($data)) {

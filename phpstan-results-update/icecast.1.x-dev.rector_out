modules/contrib/icecast/yp/src/Controller/YpController.php
modules/contrib/icecast/yplog/src/Entity/YpLog.php
modules/contrib/icecast/yplog/src/Plugin/views/wizard/YpLog.php
modules/contrib/icecast/yplog/src/Routing/YpLogHtmlRouteProvider.php
modules/contrib/icecast/yplog/src/YpLogAccessControlHandler.php
modules/contrib/icecast/yplog/src/YpLogInterface.php
modules/contrib/icecast/yplog/src/YpLogListBuilder.php
modules/contrib/icecast/yplog/src/YpLogStorageSchema.php
modules/contrib/icecast/yplog/src/YpLogViewsData.php
modules/contrib/icecast/yplog/tests/src/Functional/YpLogTest.php
modules/contrib/icecast/yplog/yplog.module
modules/contrib/icecast/yp/src/Entity/YpStream.php
modules/contrib/icecast/yp/src/Form/YpAdminSettings.php
modules/contrib/icecast/yp/src/Plugin/Field/FieldFormatter/ListenLinkFormatter.php
modules/contrib/icecast/yp/src/Plugin/views/wizard/YpStream.php
modules/contrib/icecast/yp/src/Routing/YpStreamHtmlRouteProvider.php
modules/contrib/icecast/yp/src/YpStreamAccessControlHandler.php
modules/contrib/icecast/yp/src/YpStreamInterface.php
modules/contrib/icecast/yp/src/YpStreamListBuilder.php
modules/contrib/icecast/yp/src/YpStreamStorageSchema.php
modules/contrib/icecast/yp/src/YpStreamViewsData.php
modules/contrib/icecast/yp/tests/src/Functional/YpTest.php
modules/contrib/icecast/yp/yp.module

3 files with changes
====================

1) modules/contrib/icecast/yplog/yplog.module:10

    ---------- begin diff ----------
@@ @@
 function yplog_cron(): void {
   // In the event that multiple streams have the same listen URL, they will be
   // summed together.
-  \Drupal::database()->delete('yp_log')->condition('timestamp', strval(REQUEST_TIME - (60 * 60 * 24 * 30)), '<')->execute();
-  \Drupal::database()->query('INSERT INTO {yp_log} (listen_url, listeners, timestamp) SELECT listen_url, SUM(listeners), :timestamp FROM {yp_stream} GROUP BY listen_url', [':timestamp' => REQUEST_TIME]);
+  \Drupal::database()->delete('yp_log')->condition('timestamp', strval(\Drupal::time()->getRequestTime() - (60 * 60 * 24 * 30)), '<')->execute();
+  \Drupal::database()->query('INSERT INTO {yp_log} (listen_url, listeners, timestamp) SELECT listen_url, SUM(listeners), :timestamp FROM {yp_stream} GROUP BY listen_url', [':timestamp' => \Drupal::time()->getRequestTime()]);
 }
    ----------- end diff -----------

Applied rules:
 * RequestTimeConstRector
 * ArgumentRemoverRector


2) modules/contrib/icecast/yp/yp.module:8

    ---------- begin diff ----------
@@ @@
  * Cleanup stale YP entries (not touched within past five minutes).
  */
 function yp_cron(): void {
-  \Drupal::database()->delete('yp_stream')->condition('last_touch', strval(REQUEST_TIME - 300), '<')->execute();
+  \Drupal::database()->delete('yp_stream')->condition('last_touch', strval(\Drupal::time()->getRequestTime() - 300), '<')->execute();
 }
    ----------- end diff -----------

Applied rules:
 * RequestTimeConstRector
 * ArgumentRemoverRector


3) modules/contrib/icecast/yp/src/Controller/YpController.php:50

    ---------- begin diff ----------
@@ @@
       throw new AccessDeniedHttpException();
     }
     $this->response = new Response();
-    $this->fields['last_touch'] = REQUEST_TIME;
+    $this->fields['last_touch'] = \Drupal::time()->getRequestTime();
     $this->sid = is_string($request->get('sid')) ? (int) $request->get('sid') : NULL;
     $this->request = $request;
     $this->$action();
    ----------- end diff -----------

Applied rules:
 * RequestTimeConstRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


 [OK] 3 files have been changed by Rector                                       


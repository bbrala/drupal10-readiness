diff --git a/cs_adaptive_image.module b/cs_adaptive_image.module
index 38f43d3..bf35886 100644
--- a/cs_adaptive_image.module
+++ b/cs_adaptive_image.module
@@ -165,7 +165,7 @@ function cs_adaptive_image_field_formatter_view($entity_type, $entity, $field, $
   foreach ($items as $delta => $item) {
     if (isset($link_file)) {
       $uri = array(
-        'path' => file_create_url($item['uri']),
+        'path' => \Drupal::service('file_url_generator')->generateAbsoluteString($item['uri']),
         'options' => array(),
       );
     }
@@ -194,7 +194,7 @@ function cs_adaptive_image_field_formatter_view($entity_type, $entity, $field, $
  * Preprocess function for theme_cs_adaptive_image_formatter().
  */
 function cs_adaptive_image_preprocess_cs_adaptive_image_formatter(&$variables) {
-  drupal_add_js(drupal_get_path('module', 'cs_adaptive_image') . '/cs_adaptive_image.js', 'file');
+  drupal_add_js(\Drupal::service('extension.list.module')->getPath('cs_adaptive_image') . '/cs_adaptive_image.js', 'file');
 }
 
 /**

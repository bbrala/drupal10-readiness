diff --git a/modules/simple_sitemap_views/src/EventSubscriber/ArgumentCollector.php b/modules/simple_sitemap_views/src/EventSubscriber/ArgumentCollector.php
index fc63255..8bea31a 100755
--- a/modules/simple_sitemap_views/src/EventSubscriber/ArgumentCollector.php
+++ b/modules/simple_sitemap_views/src/EventSubscriber/ArgumentCollector.php
@@ -2,8 +2,8 @@
 
 namespace Drupal\simple_sitemap_views\EventSubscriber;
 
+use Symfony\Component\HttpKernel\Event\TerminateEvent;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
-use Symfony\Component\HttpKernel\Event\PostResponseEvent;
 use Drupal\simple_sitemap_views\SimpleSitemapViews;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Symfony\Component\HttpKernel\KernelEvents;
@@ -62,10 +62,10 @@ class ArgumentCollector implements EventSubscriberInterface {
   /**
    * Collect information about views arguments.
    *
-   * @param \Symfony\Component\HttpKernel\Event\PostResponseEvent $event
+   * @param \Symfony\Component\HttpKernel\Event\TerminateEvent $event
    *   Object of event after a response was sent.
    */
-  public function onTerminate(PostResponseEvent $event) {
+  public function onTerminate(TerminateEvent $event) {
     // Only successful requests are interesting.
     // Collect information about arguments only if views support is enabled.
     if (!$event->getResponse()->isSuccessful() || !$this->sitemapViews->isEnabled()) {
diff --git a/modules/simple_sitemap_views/tests/src/Functional/SimpleSitemapViewsTestBase.php b/modules/simple_sitemap_views/tests/src/Functional/SimpleSitemapViewsTestBase.php
index 9bfb923..62caedd 100644
--- a/modules/simple_sitemap_views/tests/src/Functional/SimpleSitemapViewsTestBase.php
+++ b/modules/simple_sitemap_views/tests/src/Functional/SimpleSitemapViewsTestBase.php
@@ -57,7 +57,7 @@ abstract class SimpleSitemapViewsTestBase extends SimplesitemapTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->sitemapViews = $this->container->get('simple_sitemap.views');
diff --git a/src/Controller/SimplesitemapController.php b/src/Controller/SimplesitemapController.php
index 524287f..e25b552 100644
--- a/src/Controller/SimplesitemapController.php
+++ b/src/Controller/SimplesitemapController.php
@@ -75,7 +75,7 @@ class SimplesitemapController extends ControllerBase {
   public function getSitemapXsl() {
 
     // Read the XSL content from the file.
-    $module_path = drupal_get_path('module', 'simple_sitemap');
+    $module_path = \Drupal::service('extension.list.module')->getPath('simple_sitemap');
     $xsl_content = file_get_contents($module_path . '/xsl/simple_sitemap.xsl');
 
     // Replace custom tokens in the XSL content with appropriate values.
diff --git a/src/Form/SimplesitemapSitemapsForm.php b/src/Form/SimplesitemapSitemapsForm.php
index 7a8d98a..a2e3bf8 100644
--- a/src/Form/SimplesitemapSitemapsForm.php
+++ b/src/Form/SimplesitemapSitemapsForm.php
@@ -121,7 +121,7 @@ class SimplesitemapSitemapsForm extends SimplesitemapFormBase {
         '#percent' => $percent,
         '#message' => $this->t('@indexed out of @total queue items have been processed.<br>Each sitemap variant is published after all of its items have been processed.', ['@indexed' => $indexed_count, '@total' => $total_count]),
       ];
-      $form['simple_sitemap_settings']['status']['progress']['bar']['#markup'] = render($index_progress);
+      $form['simple_sitemap_settings']['status']['progress']['bar']['#markup'] = \Drupal::service('renderer')->render($index_progress);
     }
     else {
       $form['simple_sitemap_settings']['status']['progress']['bar']['#markup'] = '<div class="description">' . $this->t('There are no items to be indexed.') . '</div>';
diff --git a/tests/src/Functional/SimplesitemapTestBase.php b/tests/src/Functional/SimplesitemapTestBase.php
index c3fe6c1..7c4396f 100644
--- a/tests/src/Functional/SimplesitemapTestBase.php
+++ b/tests/src/Functional/SimplesitemapTestBase.php
@@ -78,7 +78,7 @@ abstract class SimplesitemapTestBase extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->generator = $this->container->get('simple_sitemap.generator');

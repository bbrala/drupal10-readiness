diff --git a/file_attributes.info.yml b/file_attributes.info.yml
index 476dc27..a99417c 100644
--- a/file_attributes.info.yml
+++ b/file_attributes.info.yml
@@ -1,5 +1,5 @@
 name: 'File attributes'
 type: module
 description: 'Allow add attributes to file url.'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: 'File'
diff --git a/file_attributes.module b/file_attributes.module
index d7afc4c..f713b5e 100644
--- a/file_attributes.module
+++ b/file_attributes.module
@@ -79,7 +79,7 @@ function  template_preprocess_file_attributes_link(&$variables) {
   }
   $file_entity = $file instanceof File ? $file : File::load($file->fid);
 
-  $url = file_create_url($file_entity->getFileUri());
+  $url = \Drupal::service('file_url_generator')->generateAbsoluteString($file_entity->getFileUri());
   $variables['#cache']['contexts'][] = 'url.site';
   $mime_type = $file
     ->getMimeType();

diff --git a/src/Form/MpbxSettingsForm.php b/src/Form/MpbxSettingsForm.php
index 4bdbb67..c5871ff 100644
--- a/src/Form/MpbxSettingsForm.php
+++ b/src/Form/MpbxSettingsForm.php
@@ -280,7 +280,7 @@ class MpbxSettingsForm extends ConfigFormBase {
 
     if ($form_state->getValue('marker')) {
       $marker = Media::load($form_state->getValue('marker'));
-      $marker_url = file_create_url($marker->field_media_image->entity->getFileUri());
+      $marker_url = \Drupal::service('file_url_generator')->generateAbsoluteString($marker->field_media_image->entity->getFileUri());
 
       $this->configFactory->getEditable(static::SETTINGS)
         ->set('marker.id', $form_state->getValue('marker'))
diff --git a/tests/src/Functional/MpbxTest.php b/tests/src/Functional/MpbxTest.php
index deddbef..5d05538 100644
--- a/tests/src/Functional/MpbxTest.php
+++ b/tests/src/Functional/MpbxTest.php
@@ -28,7 +28,7 @@ class MpbxTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->drupalLogin($this->rootUser);

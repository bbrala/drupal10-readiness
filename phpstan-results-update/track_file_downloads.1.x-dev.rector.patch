diff --git a/tests/src/Functional/TrackFileDownloadsFunctionalTest.php b/tests/src/Functional/TrackFileDownloadsFunctionalTest.php
index 2d35b36..9dd1142 100644
--- a/tests/src/Functional/TrackFileDownloadsFunctionalTest.php
+++ b/tests/src/Functional/TrackFileDownloadsFunctionalTest.php
@@ -88,7 +88,7 @@ class TrackFileDownloadsFunctionalTest extends BrowserTestBase {
     /** @var \Drupal\track_file_downloads\Entity\FileTrackerInterface $tracker */
     $tracker = reset($entities);
     $this->assertDownloadCount(0, $tracker->id());
-    $url = Url::fromUri(file_create_url($tracker->getFile()->getFileUri()));
+    $url = \Drupal::service('file_url_generator')->generate($tracker->getFile()->getFileUri());
     $this->drupalGet($url);
     $this->assertDownloadCount(1, $tracker->id());
     $this->grantPermissions(Role::load(RoleInterface::AUTHENTICATED_ID), ['skip file tracking']);
diff --git a/track_file_downloads.info.yml b/track_file_downloads.info.yml
index 4aef3b6..355e34b 100644
--- a/track_file_downloads.info.yml
+++ b/track_file_downloads.info.yml
@@ -1,6 +1,6 @@
 name: Track File Downloads
 type: module
 description: Tracks private file downloads.
-core_version_requirement: ^9
+core_version_requirement: ^9.3 || ^10
 dependencies:
   - drupal:file

diff --git a/src/CronJobListBuilder.php b/src/CronJobListBuilder.php
index e6e9c72..8d4f993 100644
--- a/src/CronJobListBuilder.php
+++ b/src/CronJobListBuilder.php
@@ -37,8 +37,8 @@ class CronJobListBuilder extends DraggableListBuilder {
    */
   public function buildRow(EntityInterface $entity) {
     /* @var \Drupal\ultimate_cron\CronJobInterface $entity */
-    $icon = drupal_get_path('module', 'ultimate_cron') . '/icons/hourglass.png';
-    $behind_icon = ['#prefix' => ' ', '#theme' => 'image', '#uri' => file_create_url($icon), '#title' => t('Job is behind schedule!')];
+    $icon = \Drupal::service('extension.list.module')->getPath('ultimate_cron') . '/icons/hourglass.png';
+    $behind_icon = ['#prefix' => ' ', '#theme' => 'image', '#uri' => \Drupal::service('file_url_generator')->generateAbsoluteString($icon), '#title' => t('Job is behind schedule!')];
 
     $log_entry = $entity->loadLatestLogEntry();
     $row['label'] = $entity->label();
diff --git a/src/CronPluginMultiple.php b/src/CronPluginMultiple.php
index ca8f9d5..c94a8f8 100644
--- a/src/CronPluginMultiple.php
+++ b/src/CronPluginMultiple.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\ultimate_cron;
 
-class CronPluginMultiple extends \Drupal\ultimate_cron\CronPlugin {
+class CronPluginMultiple extends CronPlugin {
   static public $multiple = TRUE;
 
   /**
diff --git a/src/Form/SchedulerSettingsForm.php b/src/Form/SchedulerSettingsForm.php
index c9bdc71..e4e5053 100644
--- a/src/Form/SchedulerSettingsForm.php
+++ b/src/Form/SchedulerSettingsForm.php
@@ -69,7 +69,7 @@ class SchedulerSettingsForm extends ConfigFormBase {
       '#collapsed' => TRUE,
     );
     $form['crontab']['rules_help']['info'] = array(
-      '#markup' => file_get_contents(drupal_get_path('module', 'ultimate_cron') . '/help/rules.html'),
+      '#markup' => file_get_contents(\Drupal::service('extension.list.module')->getPath('ultimate_cron') . '/help/rules.html'),
     );
 
     // Settings for Simple scheduler.
diff --git a/src/Launcher/LauncherBase.php b/src/Launcher/LauncherBase.php
index f83f695..743570e 100644
--- a/src/Launcher/LauncherBase.php
+++ b/src/Launcher/LauncherBase.php
@@ -67,7 +67,7 @@ abstract class LauncherBase extends CronPlugin implements LauncherInterface {
    * {@inheritdoc}
    */
   public function formatRunning(CronJobInterface $job) {
-    $file = drupal_get_path('module', 'ultimate_cron') . '/icons/hourglass.png';
+    $file = \Drupal::service('extension.list.module')->getPath('ultimate_cron') . '/icons/hourglass.png';
     $status = ['#theme' => 'image', '#uri' => $file];
     $title = t('running');
     return array($status, $title);
@@ -77,7 +77,7 @@ abstract class LauncherBase extends CronPlugin implements LauncherInterface {
    * {@inheritdoc}
    */
   public function formatUnfinished(CronJobInterface $job) {
-    $file = drupal_get_path('module', 'ultimate_cron') . '/icons/lock_open.png';
+    $file = \Drupal::service('extension.list.module')->getPath('ultimate_cron') . '/icons/lock_open.png';
     $status = ['#theme' => 'image', '#uri' => $file];
     $title = t('unfinished but not locked?');
     return array($status, $title);
diff --git a/src/Plugin/ultimate_cron/Logger/CacheLogger.php b/src/Plugin/ultimate_cron/Logger/CacheLogger.php
index a97070c..4a7b304 100644
--- a/src/Plugin/ultimate_cron/Logger/CacheLogger.php
+++ b/src/Plugin/ultimate_cron/Logger/CacheLogger.php
@@ -116,7 +116,7 @@ class CacheLogger extends LoggerBase implements ContainerFactoryPluginInterface
 
     $settings = $this->getConfiguration();
 
-    $expire = $settings['timeout'] != Cache::PERMANENT ? REQUEST_TIME + $settings['timeout'] : $settings['timeout'];
+    $expire = $settings['timeout'] != Cache::PERMANENT ? \Drupal::time()->getRequestTime() + $settings['timeout'] : $settings['timeout'];
 
     $this->cache->set('uc-name:' . $log_entry->name, $log_entry->lid, $expire);
     $this->cache->set('uc-lid:' . $log_entry->lid, $log_entry->getData(), $expire);
diff --git a/src/Plugin/ultimate_cron/Scheduler/Crontab.php b/src/Plugin/ultimate_cron/Scheduler/Crontab.php
index 1795ad5..7592b1b 100644
--- a/src/Plugin/ultimate_cron/Scheduler/Crontab.php
+++ b/src/Plugin/ultimate_cron/Scheduler/Crontab.php
@@ -41,7 +41,7 @@ class Crontab extends SchedulerBase {
   public function formatLabelVerbose(CronJob $job) {
     $parsed = '';
     $next_schedule = NULL;
-    $time = REQUEST_TIME;
+    $time = \Drupal::time()->getRequestTime();
     $skew = $this->getSkew($job);
     foreach ($this->configuration['rules'] as $rule) {
       $cron = CronRule::factory($rule, $time, $skew);
@@ -83,7 +83,7 @@ class Crontab extends SchedulerBase {
     );
 
     $form['rules_help']['info'] = array(
-      '#markup' => file_get_contents(drupal_get_path('module', 'ultimate_cron') . '/help/rules.html'),
+      '#markup' => file_get_contents(\Drupal::service('extension.list.module')->getPath('ultimate_cron') . '/help/rules.html'),
     );
 
     $form['catch_up'] = array(
@@ -179,7 +179,7 @@ class Crontab extends SchedulerBase {
       $time = $cron->getNextSchedule();
       $next_schedule = is_null($next_schedule) || $time < $next_schedule ? $time : $next_schedule;
     }
-    $behind = REQUEST_TIME - $next_schedule;
+    $behind = \Drupal::time()->getRequestTime() - $next_schedule;
 
     return $behind > $this->configuration['catch_up'] ? $behind : FALSE;
   }
diff --git a/src/ProxyClass/UltimateCron.php b/src/ProxyClass/UltimateCron.php
index ec959a6..874d9f4 100644
--- a/src/ProxyClass/UltimateCron.php
+++ b/src/ProxyClass/UltimateCron.php
@@ -2,15 +2,18 @@
 
 namespace Drupal\ultimate_cron\ProxyClass {
 
+    use Drupal\Core\CronInterface;
+    use Drupal\Core\DependencyInjection\DependencySerializationTrait;
+    use Symfony\Component\DependencyInjection\ContainerInterface;
     /**
      * Provides a proxy class for \Drupal\ultimate_cron\UltimateCron.
      *
      * @see \Drupal\Component\ProxyBuilder
      */
-    class UltimateCron implements \Drupal\Core\CronInterface
+    class UltimateCron implements CronInterface
     {
 
-        use \Drupal\Core\DependencyInjection\DependencySerializationTrait;
+        use DependencySerializationTrait;
 
         /**
          * The id of the original proxied service.
@@ -41,7 +44,7 @@ namespace Drupal\ultimate_cron\ProxyClass {
          * @param string $drupal_proxy_original_service_id
          *   The service ID of the original service.
          */
-        public function __construct(\Symfony\Component\DependencyInjection\ContainerInterface $container, $drupal_proxy_original_service_id)
+        public function __construct(ContainerInterface $container, $drupal_proxy_original_service_id)
         {
             $this->container = $container;
             $this->drupalProxyOriginalServiceId = $drupal_proxy_original_service_id;
diff --git a/src/TaggedSettings.php b/src/TaggedSettings.php
index 4cae649..db90283 100644
--- a/src/TaggedSettings.php
+++ b/src/TaggedSettings.php
@@ -15,6 +15,6 @@ class TaggedSettings extends Settings {
    * Only valid for jobs tagged with the proper tag.
    */
   public function isValid($job = NULL) {
-    return $job ? in_array($this->name, $job->hook['tags']) : \Drupal\ultimate_cron\parent::isValid();
+    return $job ? in_array($this->name, $job->hook['tags']) : parent::isValid();
   }
 }
diff --git a/tests/src/Functional/CronJobFormTest.php b/tests/src/Functional/CronJobFormTest.php
index 5c0d131..b01e87c 100644
--- a/tests/src/Functional/CronJobFormTest.php
+++ b/tests/src/Functional/CronJobFormTest.php
@@ -61,16 +61,16 @@ class CronJobFormTest extends BrowserTestBase {
 
     // Cron Jobs overview.
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertResponse('200');
+    $this->assertSession()->statusCodeEquals('200');
 
     // Check for the default schedule message in Job list.
-    $this->assertText('Every 15 min');
+    $this->assertSession()->pageTextContains('Every 15 min');
     // Check for the Last Run default value.
-    $this->assertText('Never');
+    $this->assertSession()->pageTextContains('Never');
 
     // Start editing added job.
     $this->drupalGet('admin/config/system/cron/jobs/manage/' . $this->jobId);
-    $this->assertResponse('200');
+    $this->assertSession()->statusCodeEquals('200');
 
     // Set new cron job configuration and save the old job name.
     $job = CronJob::load($this->jobId);
@@ -79,39 +79,39 @@ class CronJobFormTest extends BrowserTestBase {
     $edit = array('title' => $this->jobName);
 
     // Save the new job.
-    $this->drupalPostForm(NULL, $edit, t('Save'));
+    $this->submitForm($edit, t('Save'));
     // Assert the edited Job hasn't run yet.
-    $this->assertText('Never');
+    $this->assertSession()->pageTextContains('Never');
     // Assert messenger service message for successful updated job.
-    $this->assertText(t('job @name has been updated.', array('@name' => $this->jobName)));
+    $this->assertSession()->pageTextContains(t('job @name has been updated.', array('@name' => $this->jobName)));
 
     // Run the Jobs.
     $this->cronRun();
 
     // Assert the cron jobs have been run by checking the time.
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertText(\Drupal::service('date.formatter')->format(\Drupal::state()->get('system.cron_last'), 'short'), 'Created Cron jobs have been run.');
+    $this->assertSession()->pageTextContains(\Drupal::service('date.formatter')->format(\Drupal::state()->get('system.cron_last'), 'short'));
 
     // Check that all jobs have been run.
-    $this->assertNoText("Never");
+    $this->assertSession()->pageTextNotContains("Never");
 
     // Assert cron job overview for recently updated job.
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertNoText($old_job_name);
-    $this->assertText($this->jobName);
+    $this->assertSession()->pageTextNotContains($old_job_name);
+    $this->assertSession()->pageTextContains($this->jobName);
 
     // Change time when cron runs, check the 'Scheduled' label is updated.
     $this->clickLink(t('Edit'));
-    $this->drupalPostForm(NULL, ['scheduler[configuration][rules][0]' => '0+@ */6 * * *'], t('Save'));
-    $this->assertText('Every 6 hours');
+    $this->submitForm(['scheduler[configuration][rules][0]' => '0+@ */6 * * *'], t('Save'));
+    $this->assertSession()->pageTextContains('Every 6 hours');
 
     // Test disabling a job.
     $this->clickLink(t('Disable'), 0);
-    $this->assertText('This cron job will no longer be executed.');
-    $this->drupalPostForm(NULL, NULL, t('Disable'));
+    $this->assertSession()->pageTextContains('This cron job will no longer be executed.');
+    $this->submitForm(NULL, t('Disable'));
 
     // Assert messenger service message for successful disabled job.
-    $this->assertText(t('Disabled cron job @name.', array('@name' => $this->jobName)));
+    $this->assertSession()->pageTextContains(t('Disabled cron job @name.', array('@name' => $this->jobName)));
     $this->drupalGet('admin/config/system/cron/jobs');
     $this->assertFieldByXPath('//table/tbody/tr[1]/td[6]', 'Disabled');
     $this->assertFieldByXPath('//table/tbody/tr[1]/td[8]/div/div/ul/li[1]/a', 'Enable');
@@ -119,13 +119,13 @@ class CronJobFormTest extends BrowserTestBase {
 
     // Test enabling a job.
     $this->clickLink(t('Enable'), 0);
-    $this->assertText('This cron job will be executed again.');
-    $this->drupalPostForm(NULL, NULL, t('Enable'));
+    $this->assertSession()->pageTextContains('This cron job will be executed again.');
+    $this->submitForm(NULL, t('Enable'));
 
     // Assert messenger service message for successful enabled job.
-    $this->assertText(t('Enabled cron job @name.', array('@name' => $this->jobName)));
+    $this->assertSession()->pageTextContains(t('Enabled cron job @name.', array('@name' => $this->jobName)));
     $this->drupalGet('admin/config/system/cron/jobs');
-    $expected_checkmark_image_url = file_url_transform_relative(file_create_url('core/misc/icons/73b355/check.svg'));
+    $expected_checkmark_image_url = \Drupal::service('file_url_generator')->generateString('core/misc/icons/73b355/check.svg');
     $this->assertEquals($expected_checkmark_image_url, $this->xpath('//table/tbody/tr[1]/td[6]/img')[0]->getAttribute('src'));
     $this->assertFieldByXPath('//table/tbody/tr[1]/td[8]/div/div/ul/li[1]/a', 'Run');
 
@@ -133,7 +133,8 @@ class CronJobFormTest extends BrowserTestBase {
     $edit = array(
       'status' => FALSE,
     );
-    $this->drupalPostForm('admin/config/system/cron/jobs/manage/' . $this->jobId, $edit, t('Save'));
+    $this->drupalGet('admin/config/system/cron/jobs/manage/' . $this->jobId);
+    $this->submitForm($edit, t('Save'));
     $this->assertFieldByXPath('//table/tbody/tr[1]/td[6]', 'Disabled');
     $this->assertFieldByXPath('//table/tbody/tr[1]/td[8]/div/div/ul/li[1]/a', 'Enable');
     $this->assertNoFieldByXPath('//table/tbody/tr[1]/td[8]/div/div/ul/li[1]/a', 'Run');
@@ -142,7 +143,8 @@ class CronJobFormTest extends BrowserTestBase {
     $edit = array(
       'status' => TRUE,
     );
-    $this->drupalPostForm('admin/config/system/cron/jobs/manage/' . $this->jobId, $edit, t('Save'));
+    $this->drupalGet('admin/config/system/cron/jobs/manage/' . $this->jobId);
+    $this->submitForm($edit, t('Save'));
     $this->assertEquals($expected_checkmark_image_url, $this->xpath('//table/tbody/tr[1]/td[6]/img')[0]->getAttribute('src'));
     $this->assertFieldByXPath('//table/tbody/tr[1]/td[8]/div/div/ul/li[1]/a', 'Run');
 
@@ -153,18 +155,19 @@ class CronJobFormTest extends BrowserTestBase {
     $job_configuration = array(
       'scheduler[id]' => 'crontab',
     );
-    $this->drupalPostForm(NULL, $job_configuration, t('Save'));
-    $this->drupalPostForm('admin/config/system/cron/jobs/manage/' . $this->jobId, ['scheduler[configuration][rules][0]' => '0+@ * * * *'], t('Save'));
-    $this->assertText('0+@ * * * *');
+    $this->submitForm($job_configuration, t('Save'));
+    $this->drupalGet('admin/config/system/cron/jobs/manage/' . $this->jobId);
+    $this->submitForm(['scheduler[configuration][rules][0]' => '0+@ * * * *'], t('Save'));
+    $this->assertSession()->pageTextContains('0+@ * * * *');
 
     // Try editing the rule to an invalid one.
     $this->clickLink('Edit');
-    $this->drupalPostForm(NULL, ['scheduler[configuration][rules][0]' => '*//15+@ *-2 * * *'], t('Save'));
-    $this->assertText('Rule is invalid');
-    $this->assertTitle('Edit job | Drupal');
+    $this->submitForm(['scheduler[configuration][rules][0]' => '*//15+@ *-2 * * *'], t('Save'));
+    $this->assertSession()->pageTextContains('Rule is invalid');
+    $this->assertSession()->titleEquals('Edit job | Drupal');
 
     // Assert that there is no Delete link on the details page.
-    $this->assertNoLink('Delete');
+    $this->assertSession()->linkNotExists('Delete');
 
     // Force a job to be invalid by changing the callback.
     $job = CronJob::load($this->jobId);
@@ -178,10 +181,10 @@ class CronJobFormTest extends BrowserTestBase {
 
     // Test deleting a job (only possible if invalid cron job).
     $this->clickLink(t('Delete'), 0);
-    $this->drupalPostForm(NULL, NULL, t('Delete'));
-    $this->assertText(t('The cron job @name has been deleted.', array('@name' => $job->label())));
+    $this->submitForm(NULL, t('Delete'));
+    $this->assertSession()->pageTextContains(t('The cron job @name has been deleted.', array('@name' => $job->label())));
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertNoText($job->label());
+    $this->assertSession()->pageTextNotContains($job->label());
 
     $job = CronJob::load('ultimate_cron_cron');
 
@@ -194,11 +197,11 @@ class CronJobFormTest extends BrowserTestBase {
     $xpath = $this->xpath('//tbody/tr[@class="odd"]/td');
     $start_time = \Drupal::service('date.formatter')->format($log_entry->start_time, 'custom', 'Y-m-d H:i:s');
     $end_time = \Drupal::service('date.formatter')->format($log_entry->end_time, 'custom', 'Y-m-d H:i:s');
-    $this->assertEqual($xpath[1]->getText(), $start_time);
-    $this->assertEqual($xpath[2]->getText(), $end_time);
+    $this->assertEquals($xpath[1]->getText(), $start_time);
+    $this->assertEquals($xpath[2]->getText(), $end_time);
     // The message logged depends on timing, do not hardcode that.
-    $this->assertEqual($xpath[3]->getText(), $log_entry->message ?: $log_entry->formatInitMessage());
-    $this->assertEqual($xpath[4]->getText(), '00:00');
+    $this->assertEquals($xpath[3]->getText(), $log_entry->message ?: $log_entry->formatInitMessage());
+    $this->assertEquals($xpath[4]->getText(), '00:00');
 
     // Assert queue cron jobs.
     $this->config('ultimate_cron.settings')
@@ -207,12 +210,12 @@ class CronJobFormTest extends BrowserTestBase {
 
     \Drupal::service('ultimate_cron.discovery')->discoverCronJobs();
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertText('Queue: Broken queue test');
+    $this->assertSession()->pageTextContains('Queue: Broken queue test');
 
     $this->drupalGet('admin/config/system/cron/jobs/manage/ultimate_cron_queue_cron_queue_test_broken_queue');
-    $this->assertFieldByName('title', 'Queue: Broken queue test');
-    $this->drupalPostForm(NULL, [], 'Save');
-    $this->assertText('job Queue: Broken queue test has been updated.');
+    $this->assertSession()->fieldValueEquals('title', 'Queue: Broken queue test');
+    $this->submitForm([], 'Save');
+    $this->assertSession()->pageTextContains('job Queue: Broken queue test has been updated.');
   }
 
 }
diff --git a/tests/src/Functional/CronJobInstallTest.php b/tests/src/Functional/CronJobInstallTest.php
index f89dd34..78558e8 100644
--- a/tests/src/Functional/CronJobInstallTest.php
+++ b/tests/src/Functional/CronJobInstallTest.php
@@ -44,19 +44,19 @@ class CronJobInstallTest extends BrowserTestBase {
     // Check default modules
     \Drupal::service('module_installer')->install(array('field'));
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertText('Purges deleted Field API data');
-    $this->assertText('Cleanup (caches, batch, flood, temp-files, etc.)');
-    $this->assertNoText('Deletes temporary files');
+    $this->assertSession()->pageTextContains('Purges deleted Field API data');
+    $this->assertSession()->pageTextContains('Cleanup (caches, batch, flood, temp-files, etc.)');
+    $this->assertSession()->pageTextNotContains('Deletes temporary files');
 
     // Install new module.
     \Drupal::service('module_installer')->install(array('file'));
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertText('Deletes temporary files');
+    $this->assertSession()->pageTextContains('Deletes temporary files');
 
     // Uninstall new module.
     \Drupal::service('module_installer')->uninstall(array('file'));
     $this->drupalGet('admin/config/system/cron/jobs');
-    $this->assertNoText('Deletes temporary files');
+    $this->assertSession()->pageTextNotContains('Deletes temporary files');
   }
 
   /**
@@ -64,8 +64,8 @@ class CronJobInstallTest extends BrowserTestBase {
    */
   public function testRequirements() {
     $element = ultimate_cron_requirements('runtime')['cron_jobs'];
-    $this->assertEqual($element['value'], t("Cron is running properly."));
-    $this->assertEqual($element['severity'], REQUIREMENT_OK);
+    $this->assertEquals($element['value'], t("Cron is running properly."));
+    $this->assertEquals($element['severity'], REQUIREMENT_OK);
 
 
     $values = array(
@@ -93,15 +93,15 @@ class CronJobInstallTest extends BrowserTestBase {
       ->execute();
 
     // Check run counter, at this point there should be 0 run.
-    $this->assertEqual(1, \Drupal::state()->get('ultimate_cron.cron_run_counter'), 'Job has run once.');
+    $this->assertEquals(1, \Drupal::state()->get('ultimate_cron.cron_run_counter'), 'Job has run once.');
     $this->assertNotEmpty($job->isBehindSchedule(), 'Job is behind schedule.');
 
     $element = ultimate_cron_requirements('runtime')['cron_jobs'];
-    $this->assertEqual($element['value'], '1 job is behind schedule', '"1 job is behind schedule." is displayed');
-    $this->assertEqual($element['description']['#markup'], 'Some jobs are behind their schedule. Please check if <a href="' .
+    $this->assertEquals($element['value'], '1 job is behind schedule', '"1 job is behind schedule." is displayed');
+    $this->assertEquals($element['description']['#markup'], 'Some jobs are behind their schedule. Please check if <a href="' .
       Url::fromRoute('system.cron', ['key' => \Drupal::state()->get('system.cron_key')])->toString() .
       '">Cron</a> is running properly.', 'Description is correct.');
-    $this->assertEqual($element['severity'], REQUIREMENT_WARNING, 'Severity is of level "Error"');
+    $this->assertEquals($element['severity'], REQUIREMENT_WARNING, 'Severity is of level "Error"');
   }
 
 }
diff --git a/tests/src/Functional/LoggerWebTest.php b/tests/src/Functional/LoggerWebTest.php
index 1b27455..6e1066a 100644
--- a/tests/src/Functional/LoggerWebTest.php
+++ b/tests/src/Functional/LoggerWebTest.php
@@ -44,7 +44,7 @@ class LoggerWebTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->user = $this->createUser([
       'administer ultimate cron',
@@ -66,8 +66,8 @@ class LoggerWebTest extends BrowserTestBase {
 
     // Check that the error message is displayed in its log page.
     $this->drupalGet('admin/config/system/cron/jobs/logs/ultimate_cron_logger_test_cron');
-    $this->assertRaw('/core/misc/icons/e32700/error.svg');
-    $this->assertRaw('<em class="placeholder">Exception</em>: Test cron exception in <em class="placeholder">ultimate_cron_logger_test_cron()</em> (line');
+    $this->assertSession()->responseContains('/core/misc/icons/e32700/error.svg');
+    $this->assertSession()->responseContains('<em class="placeholder">Exception</em>: Test cron exception in <em class="placeholder">ultimate_cron_logger_test_cron()</em> (line');
   }
 
   /**
@@ -84,8 +84,8 @@ class LoggerWebTest extends BrowserTestBase {
 
     // Check that the error message is displayed in its log page.
     $this->drupalGet('admin/config/system/cron/jobs/logs/ultimate_cron_logger_test_cron');
-    $this->assertRaw('/core/misc/icons/e32700/error.svg');
-    $this->assertRaw('Call to undefined function call_to_undefined_function');
+    $this->assertSession()->responseContains('/core/misc/icons/e32700/error.svg');
+    $this->assertSession()->responseContains('Call to undefined function call_to_undefined_function');
 
     // Empty the logfile, our fatal errors are expected.
     $filename = DRUPAL_ROOT . '/' . $this->siteDirectory . '/error.log';
@@ -107,7 +107,7 @@ class LoggerWebTest extends BrowserTestBase {
     $xpath = $this->xpath('//table/tbody/tr/td[4]');
     // The last 2 chars from xpath are not related to the message.
     $this->assertTrue(strlen(substr($xpath[0]->getText(), 0, -2)) == 5000);
-    $this->assertRaw('This is a v…');
+    $this->assertSession()->responseContains('This is a v…');
   }
 
   /**
@@ -122,8 +122,8 @@ class LoggerWebTest extends BrowserTestBase {
 
     // Check that the error message is displayed in its log page.
     $this->drupalGet('admin/config/system/cron/jobs/logs/ultimate_cron_logger_test_cron');
-    $this->assertRaw('/core/misc/icons/e29700/warning.svg');
-    $this->assertRaw('This is a warning message');
+    $this->assertSession()->responseContains('/core/misc/icons/e29700/warning.svg');
+    $this->assertSession()->responseContains('This is a warning message');
   }
 
 
@@ -136,8 +136,8 @@ class LoggerWebTest extends BrowserTestBase {
 
     // Check that the error message is displayed in its log page.
     $this->drupalGet('admin/config/system/cron/jobs/logs/ultimate_cron_logger_test_cron');
-    $this->assertRaw('/core/misc/icons/73b355/check.svg');
-    $this->assertText('Launched in thread 1');
+    $this->assertSession()->responseContains('/core/misc/icons/73b355/check.svg');
+    $this->assertSession()->pageTextContains('Launched in thread 1');
   }
 
   /**
diff --git a/tests/src/Kernel/CronJobKernelTest.php b/tests/src/Kernel/CronJobKernelTest.php
index 2124810..49fec4a 100644
--- a/tests/src/Kernel/CronJobKernelTest.php
+++ b/tests/src/Kernel/CronJobKernelTest.php
@@ -19,7 +19,7 @@ class CronJobKernelTest extends KernelTestBase {
    */
   public static $modules = array('system', 'ultimate_cron');
 
-  protected function setup() {
+  protected function setup(): void {
     parent::setUp();
 
     $this->installSchema('ultimate_cron', [
diff --git a/tests/src/Kernel/CronJobTest.php b/tests/src/Kernel/CronJobTest.php
index fdea092..2602a19 100644
--- a/tests/src/Kernel/CronJobTest.php
+++ b/tests/src/Kernel/CronJobTest.php
@@ -15,7 +15,7 @@ class CronJobTest extends KernelTestBase {
 
   public static $modules = array('ultimate_cron');
 
-  public function setup() {
+  public function setup(): void {
     parent::setUp();
 
     $this->installSchema('ultimate_cron', array(
diff --git a/tests/src/Kernel/UltimateCronQueueTest.php b/tests/src/Kernel/UltimateCronQueueTest.php
index 39cbfb8..ccda849 100644
--- a/tests/src/Kernel/UltimateCronQueueTest.php
+++ b/tests/src/Kernel/UltimateCronQueueTest.php
@@ -23,7 +23,7 @@ class UltimateCronQueueTest extends CronQueueTest {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     module_load_install('ultimate_cron');
     ultimate_cron_install();
@@ -58,7 +58,7 @@ class UltimateCronQueueTest extends CronQueueTest {
     // @see \Drupal\Core\Cron::processQueues()
     $this->connection->update('queue')
       ->condition('name', 'cron_queue_test_exception')
-      ->fields(['expire' => REQUEST_TIME - 1])
+      ->fields(['expire' => \Drupal::time()->getRequestTime() - 1])
       ->execute();
 
     // Has to be manually called for Ultimate Cron.
diff --git a/ultimate_cron.api.php b/ultimate_cron.api.php
index 8f3e7d7..62c0050 100644
--- a/ultimate_cron.api.php
+++ b/ultimate_cron.api.php
@@ -73,7 +73,7 @@ function hook_cronapi() {
   $items['example_my_cron_job_1'] = array(
     'title' => t('This is my cron job #1'),
     'file' => 'example.jobs.inc',
-    'file path' => drupal_get_path('module', 'example') . '/cron',
+    'file path' => \Drupal::service('extension.list.module')->getPath('example') . '/cron',
     'callback' => 'example_my_cron_job_callback',
     'callback arguments' => array('cronjob1'),
     'enabled' => FALSE,
diff --git a/ultimate_cron.module b/ultimate_cron.module
index 1503578..ca62bbf 100755
--- a/ultimate_cron.module
+++ b/ultimate_cron.module
@@ -1,4 +1,6 @@
 <?php
+use Drupal\Core\Routing\RouteMatchInterface;
+use Drupal\Core\Database\Database;
 /**
  * @file
  * Ultimate Cron. Extend cron functionality in Drupal.
@@ -159,7 +161,7 @@ function ultimate_cron_hook_info() {
  * Implements hook_help().
  *
  */
-function ultimate_cron_help($route_name, \Drupal\Core\Routing\RouteMatchInterface $route_match) {
+function ultimate_cron_help($route_name, RouteMatchInterface $route_match) {
   switch ($route_name) {
     case 'help.page.ultimate_cron':
       // Return a line-break version of the module README.
@@ -256,5 +258,5 @@ function _ultimate_cron_multi_column_sort($a, $b) {
  *   Connection target.
  */
 function _ultimate_cron_get_transactional_safe_connection() {
-  return !\Drupal::config('ultimate_cron.settings')->get('bypass_transactional_safe_connection') && \Drupal\Core\Database\Database::getConnection()->inTransaction() ? 'ultimate_cron' : 'default';
+  return !\Drupal::config('ultimate_cron.settings')->get('bypass_transactional_safe_connection') && Database::getConnection()->inTransaction() ? 'ultimate_cron' : 'default';
 }

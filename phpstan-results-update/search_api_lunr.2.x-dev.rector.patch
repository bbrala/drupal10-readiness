diff --git a/src/Plugin/search_api/backend/LunrBackend.php b/src/Plugin/search_api/backend/LunrBackend.php
index 429507f..68df065 100644
--- a/src/Plugin/search_api/backend/LunrBackend.php
+++ b/src/Plugin/search_api/backend/LunrBackend.php
@@ -210,7 +210,7 @@ class LunrBackend extends BackendPluginBase implements PluginFormInterface {
     foreach (range(0, $this->getIndexFileLimit()) as $index_file) {
       $candidate_file = sprintf('%s/index-%d.json', $base_path, $index_file);
       if (file_exists($candidate_file)) {
-        $files[] = file_create_url($candidate_file);
+        $files[] = \Drupal::service('file_url_generator')->generateAbsoluteString($candidate_file);
       }
     }
     return $files;
diff --git a/tests/src/Functional/LunrSettingsEndpointTest.php b/tests/src/Functional/LunrSettingsEndpointTest.php
index 308c054..026865d 100644
--- a/tests/src/Functional/LunrSettingsEndpointTest.php
+++ b/tests/src/Functional/LunrSettingsEndpointTest.php
@@ -34,7 +34,7 @@ class LunrSettingsEndpointTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->createServerIndex();
   }
diff --git a/tests/src/FunctionalJavascript/LunrSearchTest.php b/tests/src/FunctionalJavascript/LunrSearchTest.php
index 976ebf9..1034947 100644
--- a/tests/src/FunctionalJavascript/LunrSearchTest.php
+++ b/tests/src/FunctionalJavascript/LunrSearchTest.php
@@ -45,7 +45,7 @@ class LunrSearchTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->index = $this->createServerIndex();
diff --git a/tests/src/Kernel/LunrIndexingTest.php b/tests/src/Kernel/LunrIndexingTest.php
index e4756f1..82d8358 100644
--- a/tests/src/Kernel/LunrIndexingTest.php
+++ b/tests/src/Kernel/LunrIndexingTest.php
@@ -41,7 +41,7 @@ class LunrIndexingTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->installSchema('search_api', ['search_api_item']);
diff --git a/tests/src/Unit/JsonContentIndexTest.php b/tests/src/Unit/JsonContentIndexTest.php
index ea4dacd..931acdf 100644
--- a/tests/src/Unit/JsonContentIndexTest.php
+++ b/tests/src/Unit/JsonContentIndexTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\search_api_lunr\Unit;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\File\FileSystem;
 use Drupal\Core\Site\Settings;
 use Drupal\Core\StreamWrapper\StreamWrapperManagerInterface;
@@ -16,6 +17,7 @@ use Psr\Log\LoggerInterface;
  */
 class JsonContentIndexTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * Flex the index.
    */
diff --git a/tests/src/Unit/PageAttachmentsTest.php b/tests/src/Unit/PageAttachmentsTest.php
index dfdac89..ccdad4e 100644
--- a/tests/src/Unit/PageAttachmentsTest.php
+++ b/tests/src/Unit/PageAttachmentsTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\search_api_lunr\Unit;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Entity\ContentEntityStorageInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\search_api\DataType\DataTypeInterface;
@@ -20,6 +21,7 @@ use Prophecy\Argument;
  */
 class PageAttachmentsTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * @covers ::attachments
    */

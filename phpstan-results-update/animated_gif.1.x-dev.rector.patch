diff --git a/animated_gif.info.yml b/animated_gif.info.yml
index ee73709..926bf5a 100644
--- a/animated_gif.info.yml
+++ b/animated_gif.info.yml
@@ -1,5 +1,5 @@
 name: 'Animated GIF'
 type: module
 description: 'Allows you to render animated GIFs without image style.'
-core_version_requirement: ^8.8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: 'Media'
diff --git a/src/Plugin/Field/FieldFormatter/AnimatedGifImageUrlFormatter.php b/src/Plugin/Field/FieldFormatter/AnimatedGifImageUrlFormatter.php
index b526f11..48e8a30 100644
--- a/src/Plugin/Field/FieldFormatter/AnimatedGifImageUrlFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/AnimatedGifImageUrlFormatter.php
@@ -40,7 +40,7 @@ class AnimatedGifImageUrlFormatter extends ImageUrlFormatter {
 
       if ($image->getMimeType() === 'image/gif' && AnimatedGifUtility::isAnAnimatedGif($image_uri)) {
         // No image style is wanted for animated gifs.
-        $url = file_url_transform_relative(file_create_url($image_uri));
+        $url = \Drupal::service('file_url_generator')->generateString($image_uri);
         $elements[$delta]['#markup'] = $url;
       }
     }
diff --git a/tests/src/Kernel/AnimatedGifImageFormatterTest.php b/tests/src/Kernel/AnimatedGifImageFormatterTest.php
index 2b5a672..6ed0f05 100644
--- a/tests/src/Kernel/AnimatedGifImageFormatterTest.php
+++ b/tests/src/Kernel/AnimatedGifImageFormatterTest.php
@@ -149,17 +149,17 @@ class AnimatedGifImageFormatterTest extends FieldKernelTestBase {
     $renderer = $this->container->get('renderer');
 
     $output = $renderer->renderRoot($build[$this->fieldName][0]);
-    $this->assertStringContainsString(file_url_transform_relative(file_create_url($animatedGifFile->getFileUri())), (string) $output);
+    $this->assertStringContainsString(\Drupal::service('file_url_generator')->generateString($animatedGifFile->getFileUri()), (string) $output);
 
     $output = $renderer->renderRoot($build[$this->fieldName][1]);
-    $this->assertStringNotContainsString(file_url_transform_relative(file_create_url($notAnimatedGifFile->getFileUri())), (string) $output);
+    $this->assertStringNotContainsString(\Drupal::service('file_url_generator')->generateString($notAnimatedGifFile->getFileUri()), (string) $output);
 
     $image_style = $this->entityTypeManager
       ->getStorage('image_style')
       ->load('medium');
 
     // For non animated gifs, Url should be with image style Url.
-    $this->assertStringContainsString(file_url_transform_relative($image_style->buildUrl($notAnimatedGifFile->getFileUri())), htmlspecialchars_decode((string) $output));
+    $this->assertStringContainsString(\Drupal::service('file_url_generator')->transformRelative($image_style->buildUrl($notAnimatedGifFile->getFileUri())), htmlspecialchars_decode((string) $output));
   }
 
 }
diff --git a/tests/src/Traits/AnimatedGifTestTrait.php b/tests/src/Traits/AnimatedGifTestTrait.php
index 51f95b5..cf4eceb 100644
--- a/tests/src/Traits/AnimatedGifTestTrait.php
+++ b/tests/src/Traits/AnimatedGifTestTrait.php
@@ -42,7 +42,7 @@ trait AnimatedGifTestTrait {
    */
   protected function getTestFile(string $fileName, string $fileUri): FileInterface {
     // Copy the source file to public directory.
-    $source = drupal_get_path('module', 'animated_gif');
+    $source = \Drupal::service('extension.list.module')->getPath('animated_gif');
     $source .= '/tests/images/' . $fileName;
     $this->fileSystem->copy($source, $fileUri, FileSystemInterface::EXISTS_REPLACE);
 

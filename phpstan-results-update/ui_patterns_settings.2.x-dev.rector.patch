diff --git a/tests/src/Functional/UiPatternsSettingsRenderTest.php b/tests/src/Functional/UiPatternsSettingsRenderTest.php
index de83dde..f0322d0 100644
--- a/tests/src/Functional/UiPatternsSettingsRenderTest.php
+++ b/tests/src/Functional/UiPatternsSettingsRenderTest.php
@@ -95,14 +95,16 @@ class UiPatternsSettingsRenderTest extends BrowserTestBase {
     $edit = [
       'ds_layout' => 'pattern_foo_settings',
     ];
-    $this->drupalPostForm('/admin/structure/types/manage/article/display', $edit, 'Save');
+    $this->drupalGet('/admin/structure/types/manage/article/display');
+    $this->submitForm($edit, 'Save');
 
     // Fill settings.
     $edit = [];
     foreach ($mappings as $key => $mapping) {
       $edit['layout_configuration[pattern][settings]' . $key] = $mapping['input'];
     }
-    $this->drupalPostForm('/admin/structure/types/manage/article/display', $edit, 'Save');
+    $this->drupalGet('/admin/structure/types/manage/article/display');
+    $this->submitForm($edit, 'Save');
 
     // Check values.
     $this->drupalGet('/node/' . $created_node->id());
diff --git a/ui_patterns_settings.module b/ui_patterns_settings.module
index 892238c..bb9d0a6 100644
--- a/ui_patterns_settings.module
+++ b/ui_patterns_settings.module
@@ -1,5 +1,6 @@
 <?php
 
+use Drupal\media_library\MediaLibraryUiBuilder;
 /**
  * @file
  * Contains ui_patterns_settings.module.
@@ -33,7 +34,7 @@ function ui_patterns_settings_build_media_edit_button($media_id) {
     'media_library_edit_entity_id' => $media_id,
   ];
   $edit_url = Url::fromUserInput(str_replace('{media}', $media_id, $edit_template) . '?' . UrlHelper::buildQuery($edit_url_query_params));
-  $dialog_options = \Drupal\media_library\MediaLibraryUiBuilder::dialogOptions();
+  $dialog_options = MediaLibraryUiBuilder::dialogOptions();
   return [
     '#type' => 'link',
     '#title' => '',

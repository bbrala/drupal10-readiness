diff --git a/src/Plugin/CKEditorPlugin/Snippet.php b/src/Plugin/CKEditorPlugin/Snippet.php
index a7f05b5..236b89e 100644
--- a/src/Plugin/CKEditorPlugin/Snippet.php
+++ b/src/Plugin/CKEditorPlugin/Snippet.php
@@ -23,7 +23,7 @@ class Snippet extends CKEditorPluginBase implements CKEditorPluginConfigurableIn
    * {@inheritdoc}
    */
   public function getFile() {
-    return drupal_get_path('module', 'snippet_manager') . '/js/plugins/snippet/plugin.js';
+    return \Drupal::service('extension.list.module')->getPath('snippet_manager') . '/js/plugins/snippet/plugin.js';
   }
 
   /**
@@ -48,7 +48,7 @@ class Snippet extends CKEditorPluginBase implements CKEditorPluginConfigurableIn
    * {@inheritdoc}
    */
   public function getButtons() {
-    $module_path = drupal_get_path('module', 'snippet_manager');
+    $module_path = \Drupal::service('extension.list.module')->getPath('snippet_manager');
     return [
       'snippet' => [
         'label' => $this->t('Snippet'),
diff --git a/src/Plugin/SnippetVariable/File.php b/src/Plugin/SnippetVariable/File.php
index bb770ed..8a689f5 100644
--- a/src/Plugin/SnippetVariable/File.php
+++ b/src/Plugin/SnippetVariable/File.php
@@ -118,7 +118,7 @@ class File extends SnippetVariableBase implements SnippetAwareInterface {
         }
         else {
           $build['file'] = [
-            '#markup' => file_create_url($file->getFileUri()),
+            '#markup' => \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()),
           ];
         }
         $build['file']['#cache']['tags'] = $file->getCacheTags();
diff --git a/src/SnippetViewBuilder.php b/src/SnippetViewBuilder.php
index 4e878ac..11fc1ad 100644
--- a/src/SnippetViewBuilder.php
+++ b/src/SnippetViewBuilder.php
@@ -103,7 +103,7 @@ class SnippetViewBuilder implements EntityViewBuilderInterface, EntityHandlerInt
 
     $value = $this->view($snippet);
     // Render the snippet immediately to calculate render time.
-    $build['content']['#value'] = (string) render($value);
+    $build['content']['#value'] = (string) \Drupal::service('renderer')->render($value);
 
     $render_time = Timer::read('snippet');
 
diff --git a/tests/src/Functional/BlockVariableTest.php b/tests/src/Functional/BlockVariableTest.php
index 7a26b00..186b86f 100644
--- a/tests/src/Functional/BlockVariableTest.php
+++ b/tests/src/Functional/BlockVariableTest.php
@@ -27,7 +27,8 @@ class BlockVariableTest extends TestBase {
       'plugin_id' => 'block:system_branding_block',
       'name' => 'branding',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
     // Check default form appearance.
@@ -43,7 +44,7 @@ class BlockVariableTest extends TestBase {
       'configuration[label_display]' => TRUE,
       'configuration[block_branding][use_site_name]' => FALSE,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     $this->assertXpath('//main//table/tbody/tr/td[position() = 1]/a[@href = "#snippet-edit-form" and text() = "branding"]');
@@ -51,7 +52,7 @@ class BlockVariableTest extends TestBase {
     $edit = [
       'template[value]' => '<div class="snippet-block">{{ branding }}</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->click('//table//td[position() = 4]//a[text() = "Edit"]');
 
@@ -73,7 +74,8 @@ class BlockVariableTest extends TestBase {
       'configuration[label_display]' => FALSE,
       'configuration[block_branding][use_site_name]' => TRUE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/branding/edit', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/variable/branding/edit');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet($this->snippetUrl);
     $this->assertNoXpath('//h2[text() = "Foo"]');
diff --git a/tests/src/Functional/ConditionVariableTest.php b/tests/src/Functional/ConditionVariableTest.php
index 5fb33b7..070b161 100644
--- a/tests/src/Functional/ConditionVariableTest.php
+++ b/tests/src/Functional/ConditionVariableTest.php
@@ -30,18 +30,20 @@ class ConditionVariableTest extends TestBase {
       'plugin_id' => 'condition:request_path',
       'name' => 'node_page',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
     $edit = [
       'configuration[condition][pages]' => '/node',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/node_page/edit', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/node_page/edit');
+    $this->submitForm($edit, 'Save');
 
     $edit = [
       'template[value]' => "{% if node_page %}Foo{% else %}Bar{% endif %}",
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     // @todo make it work with cache contexts.
     drupal_flush_all_caches();
@@ -58,7 +60,8 @@ class ConditionVariableTest extends TestBase {
     $edit = [
       'configuration[condition][negate]' => TRUE,
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/node_page/edit', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/node_page/edit');
+    $this->submitForm($edit, 'Save');
 
     drupal_flush_all_caches();
     $this->drupalGet('node');
diff --git a/tests/src/Functional/DisplayVariantTest.php b/tests/src/Functional/DisplayVariantTest.php
index d62ae8b..164cb8d 100644
--- a/tests/src/Functional/DisplayVariantTest.php
+++ b/tests/src/Functional/DisplayVariantTest.php
@@ -25,7 +25,7 @@ class DisplayVariantTest extends TestBase {
       'display_variant[status]' => TRUE,
       'display_variant[admin_label]' => 'Foo',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertXpath($prefix . '//input[@name="display_variant[status]" and @checked]');
 
     $template = implode([
@@ -37,16 +37,18 @@ class DisplayVariantTest extends TestBase {
     $edit = [
       'template[value]' => $template,
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/template', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/template');
+    $this->submitForm($edit, 'Save');
 
     // -- Display variant title variable.
     $edit = [
       'plugin_id' => 'display_variant:title',
       'name' => 'title',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertXpath('//form[contains(text(),"This plugin has no configurable options.")]');
-    $this->drupalPostForm(NULL, [], 'Save');
+    $this->submitForm([], 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     // -- Display variant main variable.
@@ -54,9 +56,10 @@ class DisplayVariantTest extends TestBase {
       'plugin_id' => 'display_variant:main_content',
       'name' => 'main',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertXpath('//form[contains(text(),"This plugin has no configurable options.")]');
-    $this->drupalPostForm(NULL, [], 'Save');
+    $this->submitForm([], 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     // -- Check display variant definition.
diff --git a/tests/src/Functional/EntityFormVariableTest.php b/tests/src/Functional/EntityFormVariableTest.php
index ce05690..b1d7b28 100644
--- a/tests/src/Functional/EntityFormVariableTest.php
+++ b/tests/src/Functional/EntityFormVariableTest.php
@@ -25,7 +25,7 @@ class EntityFormVariableTest extends TestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->createContentType(['name' => 'Page', 'type' => 'page']);
 
@@ -48,20 +48,20 @@ class EntityFormVariableTest extends TestBase {
       'plugin_id' => 'entity_form:node',
       'name' => 'node_form',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save and continue');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
     $edit = [
       'configuration[bundle]' => 'page',
       'configuration[form_mode]' => 'default',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     $edit = [
       'template[value]' => '<div class="snippet-node-form">{{ node_form }}</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('<front>');
     $this->assertXpath('//div[@class="snippet-node-form"]/form[@id = "node-page-form"]');
@@ -69,7 +69,7 @@ class EntityFormVariableTest extends TestBase {
       'title[0][value]' => 'Foo',
       'body[0][value]' => 'Foo',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage(new FM('Page %title has been created.', ['%title' => 'Foo']));
   }
 
diff --git a/tests/src/Functional/EntityVariableTest.php b/tests/src/Functional/EntityVariableTest.php
index af9ab84..66a59df 100644
--- a/tests/src/Functional/EntityVariableTest.php
+++ b/tests/src/Functional/EntityVariableTest.php
@@ -24,7 +24,7 @@ class EntityVariableTest extends TestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->createContentType(['type' => 'page']);
     $this->drupalCreateNode(['title' => 'Foo', 'body' => 'foo_content']);
@@ -49,20 +49,21 @@ class EntityVariableTest extends TestBase {
       'plugin_id' => 'entity:node',
       'name' => 'node',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
     $edit = [
       'configuration[entity_id]' => 'Bar',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage('The variable has been updated.');
     $this->assertXpath('//main//table/tbody/tr/td[position() = 1]/a[@href="#snippet-edit-form" and text() = "node"]');
 
     $edit = [
       'template[value]' => '<div class="snippet-node">{{ node }}</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     // -- Check specified node in the snippet.
     $this->drupalGet('node/1');
@@ -86,7 +87,8 @@ class EntityVariableTest extends TestBase {
     // We need to publish the node temporarily because entity reference widget
     // would not allow to submit the form.
     $node->setPublished()->save();
-    $this->drupalPostForm($edit_variable_url, $edit, 'Save');
+    $this->drupalGet($edit_variable_url);
+    $this->submitForm($edit, 'Save');
     $node->setUnpublished()->save();
 
     // Check whether the node returns back to the snippet.
@@ -98,7 +100,8 @@ class EntityVariableTest extends TestBase {
     $edit = [
       'configuration[entity_id]' => '',
     ];
-    $this->drupalPostForm($edit_variable_url, $edit, 'Save');
+    $this->drupalGet($edit_variable_url);
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('node/1');
     $this->assertSnippetNode('Foo');
@@ -114,12 +117,14 @@ class EntityVariableTest extends TestBase {
     $edit = [
       'configuration[entity_id]' => 'Bar',
     ];
-    $this->drupalPostForm($edit_variable_url, $edit, 'Save');
+    $this->drupalGet($edit_variable_url);
+    $this->submitForm($edit, 'Save');
     $edit = [
       'configuration[entity_id]' => 'Bar',
       'configuration[view_mode]' => 'teaser',
     ];
-    $this->drupalPostForm($edit_variable_url, $edit, 'Save');
+    $this->drupalGet($edit_variable_url);
+    $this->submitForm($edit, 'Save');
     $this->assertXpath('//a[text()="Read more"]');
 
     // -- Remove the node and make sure it does not cause any exceptions.
@@ -131,7 +136,8 @@ class EntityVariableTest extends TestBase {
     $edit = [
       'configuration[entity_id]' => 'Foo',
     ];
-    $this->drupalPostForm($edit_variable_url, $edit, 'Save');
+    $this->drupalGet($edit_variable_url);
+    $this->submitForm($edit, 'Save');
     $this->click('//a[text()="Edit content item"]');
     $this->assertPageTitle('<em>Edit page</em> Foo');
 
@@ -140,11 +146,12 @@ class EntityVariableTest extends TestBase {
       'configuration[entity_id]' => 'Foo',
       'configuration[render_mode]' => 'fields',
     ];
-    $this->drupalPostForm($edit_variable_url, $edit, 'Save');
+    $this->drupalGet($edit_variable_url);
+    $this->submitForm($edit, 'Save');
     $edit = [
       'template[value]' => '<div class="snippet-node">{{ node.body }}</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     // Only node body should appear now.
     $this->assertNoXpath('//*[text()="Foo"]');
diff --git a/tests/src/Functional/FormVariableTest.php b/tests/src/Functional/FormVariableTest.php
index 0918f6c..bc4af0c 100644
--- a/tests/src/Functional/FormVariableTest.php
+++ b/tests/src/Functional/FormVariableTest.php
@@ -17,16 +17,17 @@ class FormVariableTest extends TestBase {
       'plugin_id' => 'form:user_login',
       'name' => 'user_login_form',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
-    $this->drupalPostForm(NULL, [], 'Save');
+    $this->submitForm([], 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     $edit = [
       'template[value]' => '<div class="snippet-form">{{ user_login_form }}</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->drupalGet($this->snippetUrl);
 
     $this->assertXpath('//div[@class="snippet-form"]/form//input[@type="submit" and @value="Log in"]');
diff --git a/tests/src/Functional/LayoutTest.php b/tests/src/Functional/LayoutTest.php
index 342360d..4b24009 100644
--- a/tests/src/Functional/LayoutTest.php
+++ b/tests/src/Functional/LayoutTest.php
@@ -29,23 +29,25 @@ class LayoutTest extends TestBase {
     $edit = [
       'layout[status]' => TRUE,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertXpath($prefix . '//input[@name="layout[status]" and @checked]');
 
     $edit = [
       'template[value]' => '{{ sidebar }}{{ main }}',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/template', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/template');
+    $this->submitForm($edit, 'Save');
 
     // -- Create sidebar variable.
     $edit = [
       'plugin_id' => 'layout_region',
       'name' => 'sidebar',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertXpath('//label[text()="Label"]/next::input[@name="configuration[label]" and @value="Sidebar"]');
     $this->assertXpath('//label[text()="Weight"]/next::input[@name="configuration[weight]" and @value="0"]');
-    $this->drupalPostForm(NULL, [], 'Save');
+    $this->submitForm([], 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     // -- Create main variable.
@@ -53,14 +55,15 @@ class LayoutTest extends TestBase {
       'plugin_id' => 'layout_region',
       'name' => 'main',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertXpath('//label[text()="Label"]/next::input[@name="configuration[label]" and @value="Main"]');
     $this->assertXpath('//label[text()="Weight"]/next::input[@name="configuration[weight]" and @value="0"]');
     $edit = [
       'configuration[label]' => 'Main content',
       'configuration[weight]' => 10,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     // -- Set default region.
@@ -80,7 +83,7 @@ class LayoutTest extends TestBase {
     $edit = [
       'layout[default_region]' => 'main',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertXpath('//input[@name="layout[default_region]" and @value="main" and @checked]');
 
     // -- Check layout definition.
diff --git a/tests/src/Functional/MenuVariableTest.php b/tests/src/Functional/MenuVariableTest.php
index 3a3a404..679dc8b 100644
--- a/tests/src/Functional/MenuVariableTest.php
+++ b/tests/src/Functional/MenuVariableTest.php
@@ -18,22 +18,25 @@ class MenuVariableTest extends TestBase {
     $edit = [
       'template[value]' => '<div class="snippet-content">{{ test_menu }}</div>',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/template', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/template');
+    $this->submitForm($edit, 'Save');
 
     // Create menu variable.
     $edit = [
       'plugin_id' => 'menu:snippet_manager_test',
       'name' => 'test_menu',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
     $this->assertPageTitle(new FM('Edit variable %name', ['%name' => 'test_menu']));
 
     $this->assertXpath('//form/div/label[. = "Initial visibility level"]/../select[@name = "configuration[level]"]/option[@value = "1" and @selected = "selected"]');
     $this->assertXpath('//form/div/label[. = "Number of levels to display"]/../select[@name = "configuration[depth]"]/option[@value = "0" and @selected = "selected" and . = "Unlimited"]');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/test_menu/edit');
 
     // Test default menu configuration.
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/test_menu/edit', [], 'Save');
+    $this->submitForm([], 'Save');
 
     $this->assertXpath('//td/a[@data-drupal-selector = "snippet-variable" and . = "test_menu"]');
 
@@ -53,7 +56,8 @@ class MenuVariableTest extends TestBase {
     $edit = [
       'configuration[level]' => 2,
     ];
-    $this->drupalPostForm('/admin/structure/snippet/alpha/edit/variable/test_menu/edit', $edit, 'Save');
+    $this->drupalGet('/admin/structure/snippet/alpha/edit/variable/test_menu/edit');
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('/admin/structure/snippet/alpha');
     $this->assertXpath('//div[@class = "snippet-content"]/ul[@class = "menu"]/li/a[. = "Link 2"]/../ul[@class = "menu"]/li/a[. = "Link 3"]');
 
@@ -62,7 +66,8 @@ class MenuVariableTest extends TestBase {
       'configuration[level]' => 1,
       'configuration[depth]' => 1,
     ];
-    $this->drupalPostForm('/admin/structure/snippet/alpha/edit/variable/test_menu/edit', $edit, 'Save');
+    $this->drupalGet('/admin/structure/snippet/alpha/edit/variable/test_menu/edit');
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('/admin/structure/snippet/alpha');
     $this->assertXpath('//div[@class = "snippet-content"]/ul[@class = "menu"]/li[not(ul)]/a[. = "Link 1"]');
   }
diff --git a/tests/src/Functional/MiniSnippetVariableTest.php b/tests/src/Functional/MiniSnippetVariableTest.php
index 7162954..05a8243 100644
--- a/tests/src/Functional/MiniSnippetVariableTest.php
+++ b/tests/src/Functional/MiniSnippetVariableTest.php
@@ -17,19 +17,20 @@ class MiniSnippetVariableTest extends TestBase {
       'plugin_id' => 'mini_snippet',
       'name' => 'ms',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
     $edit = [
       'configuration[template]' => '{{ 7 * 7 }}',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage('The variable has been updated.');
 
     $edit = [
       'template[value]' => '<div class="mini_snippet">-= {{ ms }} =-</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->drupalGet($this->snippetUrl);
 
     $this->assertXpath('//div[@class="mini_snippet" and text() = "-= 49 =-"]');
diff --git a/tests/src/Functional/MissingVariablePluginTest.php b/tests/src/Functional/MissingVariablePluginTest.php
index 541b2c0..ce61391 100644
--- a/tests/src/Functional/MissingVariablePluginTest.php
+++ b/tests/src/Functional/MissingVariablePluginTest.php
@@ -31,7 +31,8 @@ class MissingVariablePluginTest extends TestBase {
       'plugin_id' => 'view:' . $view_name,
       'name' => 'who_s_online',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
+    $this->submitForm($edit, 'Save and continue');
 
     $this->drupalGet("admin/structure/snippet/alpha/edit");
 
@@ -50,9 +51,10 @@ class MissingVariablePluginTest extends TestBase {
     $this->drupalGet('admin/structure/snippet/alpha/edit/template');
     $this->assertWarningMessage($warning_message);
     $this->assertXpath(sprintf('//table//td[text() = "view:%s - missing"]', $view_name));
+    $this->drupalGet("admin/structure/snippet/alpha/edit/variable/$view_name/delete");
 
     // Make sure the variable still can be deleted.
-    $this->drupalPostForm("admin/structure/snippet/alpha/edit/variable/$view_name/delete", [], 'Delete');
+    $this->submitForm([], 'Delete');
     $this->assertStatusMessage('The variable has been removed.');
   }
 
diff --git a/tests/src/Functional/SnippetBlockTest.php b/tests/src/Functional/SnippetBlockTest.php
index 8d8890d..ca2f81b 100644
--- a/tests/src/Functional/SnippetBlockTest.php
+++ b/tests/src/Functional/SnippetBlockTest.php
@@ -38,7 +38,7 @@ class SnippetBlockTest extends TestBase {
     $edit = [
       'block[status]' => TRUE,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertXpath($prefix . '//input[@name = "block[status]" and @checked]');
 
     // Check if the block appears on block administration page.
@@ -49,7 +49,8 @@ class SnippetBlockTest extends TestBase {
     $edit = [
       'block[name]' => 'Example',
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->assertXpath($prefix . '//input[@name = "block[name]" and @value = "Example"]');
 
     // Check if block admin name has been changed.
@@ -61,7 +62,8 @@ class SnippetBlockTest extends TestBase {
       'settings[label]' => 'Beer',
       'region' => 'sidebar_first',
     ];
-    $this->drupalPostForm(sprintf('admin/structure/block/add/snippet:%s/classy', $this->snippetId), $edit, 'Save block');
+    $this->drupalGet(sprintf('admin/structure/block/add/snippet:%s/classy', $this->snippetId));
+    $this->submitForm($edit, 'Save block');
 
     $active_block_xpath = implode([
       '//div[contains(@class, "region-sidebar-first")]',
@@ -75,7 +77,8 @@ class SnippetBlockTest extends TestBase {
     $edit = [
       'block[status]' => FALSE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/block/library/classy');
     $this->assertSession()->elementNotExists('xpath', '//td[. = "Example"]');
@@ -91,7 +94,8 @@ class SnippetBlockTest extends TestBase {
     $edit = [
       'block[status]' => TRUE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
 
     // Broken block can be cached.
     \Drupal::service('cache_tags.invalidator')->invalidateTags(['block_view']);
@@ -113,7 +117,8 @@ class SnippetBlockTest extends TestBase {
     \Drupal::service('cache_tags.invalidator')->invalidateTags(['block_view']);
     $this->drupalGet(NULL);
     $this->assertXpath($active_block_xpath);
-    $this->drupalPostForm(sprintf('admin/structure/snippet/%s/delete', $this->snippetId), [], 'Delete');
+    $this->drupalGet(sprintf('admin/structure/snippet/%s/delete', $this->snippetId));
+    $this->submitForm([], 'Delete');
     $this->drupalGet('admin/structure/block/library/classy');
     $this->assertSession()->elementNotExists('xpath', '//td[. = "Example"]');
     $this->assertXpath($missing_block_xpath);
diff --git a/tests/src/Functional/SnippetCssTest.php b/tests/src/Functional/SnippetCssTest.php
index 563b7d3..55eff0b 100644
--- a/tests/src/Functional/SnippetCssTest.php
+++ b/tests/src/Functional/SnippetCssTest.php
@@ -30,7 +30,7 @@ class SnippetCssTest extends TestBase {
       'css[status]' => TRUE,
       'css[value]' => '.test {color: pink}',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage(new FM('Snippet %label has been updated.', ['%label' => $this->snippetLabel]));
 
     // Make sure the form values have been updated.
@@ -41,7 +41,7 @@ class SnippetCssTest extends TestBase {
     $this->click('//form//a[.="Open file" and @class="button" and @target="_blank"]');
     $file_url = $this->getUrl();
     $snippet_id_hash = Crypt::hashBase64($this->snippetId);
-    $this->assertRegExp(sprintf('#^http://.*/files/snippet/%s.css\?.{6}$#', $snippet_id_hash), $file_url);
+    $this->assertMatchesRegularExpression(sprintf('#^http://.*/files/snippet/%s.css\?.{6}$#', $snippet_id_hash), $file_url);
     $this->assertSession()->responseContains('.test {color: pink}');
 
     // Check that the CSS file is attached to the snippet.
@@ -53,7 +53,8 @@ class SnippetCssTest extends TestBase {
     $edit = [
       'css[status]' => FALSE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/css', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/css');
+    $this->submitForm($edit, 'Save');
     $this->assertSession()->linkNotExists('Open file');
     $this->drupalGet($file_url);
     $this->assertSession()->statusCodeEquals(404);
diff --git a/tests/src/Functional/SnippetFormTest.php b/tests/src/Functional/SnippetFormTest.php
index a3a028a..88c112e 100644
--- a/tests/src/Functional/SnippetFormTest.php
+++ b/tests/src/Functional/SnippetFormTest.php
@@ -51,7 +51,7 @@ class SnippetFormTest extends TestBase {
       'page[access][type]' => 'permission',
       'page[access][permission]' => 'administer modules',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->assertSession()->addressEquals("admin/structure/snippet/$snippet_id/edit");
     $this->assertPageTitle(new FM('Edit %label', ['%label' => $snippet_label]));
@@ -80,7 +80,7 @@ class SnippetFormTest extends TestBase {
     $this->assertXpath('//form[contains(., "This action cannot be undone.")]');
     $this->assertXpath('//form//a[.="Cancel"]');
     $this->assertXpath('//form//a[contains(@href, "/admin/structure/snippet") and .="Cancel"]');
-    $this->drupalPostForm(NULL, [], 'Delete');
+    $this->submitForm([], 'Delete');
     $this->assertStatusMessage(new FM('The snippet %label has been deleted.', ['%label' => $this->snippetLabel]));
     $this->assertSession()->elementNotExists('xpath', sprintf('//a[contains(., "%s")]', $this->snippetLabel));
     $this->assertSession()->addressEquals('admin/structure/snippet');
@@ -95,15 +95,16 @@ class SnippetFormTest extends TestBase {
       'plugin_id' => 'text',
       'name' => 'foo',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/snippet');
     $this->click(sprintf('//td[.="%s"]/../td//ul[@class="dropbutton"]/li/a[.="Duplicate"]', $this->snippetLabel));
     $this->assertPageTitle('Duplicate snippet');
     $this->assertXpath(sprintf('//input[@name = "label" and @value = "Duplicate of %s"]', $this->snippetLabel));
-    $this->drupalPostForm(NULL, ['id' => $this->snippetId], 'Duplicate');
+    $this->submitForm(['id' => $this->snippetId], 'Duplicate');
     $this->assertErrorMessage('The machine-readable name is already in use. It must be unique.');
-    $this->drupalPostForm(NULL, ['id' => sprintf('duplicate_of_%s', $this->snippetId)], 'Duplicate');
+    $this->submitForm(['id' => sprintf('duplicate_of_%s', $this->snippetId)], 'Duplicate');
 
     // Check configuration form.
     $this->assertPageTitle(new FM('Edit %label', ['%label' => 'Duplicate of ' . $this->snippetLabel]));
diff --git a/tests/src/Functional/SnippetJsTest.php b/tests/src/Functional/SnippetJsTest.php
index 9f0d07b..dd294dc 100644
--- a/tests/src/Functional/SnippetJsTest.php
+++ b/tests/src/Functional/SnippetJsTest.php
@@ -32,7 +32,7 @@ class SnippetJsTest extends TestBase {
       'js[preprocess]' => FALSE,
       'js[value]' => 'alert(123);',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertStatusMessage(new FM('Snippet %label has been updated.', ['%label' => $this->snippetLabel]));
 
     // Make sure the form values have been updated.
@@ -43,7 +43,7 @@ class SnippetJsTest extends TestBase {
     // Check if the JS file has been created.
     $this->click('//form//a[.="Open file" and @class="button" and @target="_blank"]');
     $file_url = $this->getUrl();
-    $this->assertRegExp(sprintf('#^http://.*/files/snippet/%s.js\?.{6}$#', $snippet_id_hash), $file_url);
+    $this->assertMatchesRegularExpression(sprintf('#^http://.*/files/snippet/%s.js\?.{6}$#', $snippet_id_hash), $file_url);
     $this->assertSession()->responseContains('alert(123);');
 
     // Check that the JS file is attached to the snippet.
@@ -54,7 +54,8 @@ class SnippetJsTest extends TestBase {
     $edit = [
       'js[status]' => FALSE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/js', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/js');
+    $this->submitForm($edit, 'Save');
     $this->assertSession()->linkNotExists('Open file');
     $this->drupalGet($file_url);
     $this->assertSession()->statusCodeEquals(404);
diff --git a/tests/src/Functional/SnippetPageTest.php b/tests/src/Functional/SnippetPageTest.php
index 3659e05..5c3b105 100644
--- a/tests/src/Functional/SnippetPageTest.php
+++ b/tests/src/Functional/SnippetPageTest.php
@@ -22,7 +22,7 @@ class SnippetPageTest extends TestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->createContentType(['type' => 'page']);
     $this->drupalCreateNode(['title' => 'Foo', 'body' => 'foo_content']);
@@ -102,7 +102,8 @@ class SnippetPageTest extends TestBase {
       'page[status]' => TRUE,
       'page[path]' => 'zoo',
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
 
     // -- Test page link on overview page.
     $this->drupalGet($this->snippetEditUrl);
@@ -116,7 +117,8 @@ class SnippetPageTest extends TestBase {
     $edit = [
       'page[title]' => 'Bar',
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('zoo');
     $this->assertPageTitle('Bar');
 
@@ -124,7 +126,8 @@ class SnippetPageTest extends TestBase {
     $edit = [
       'page[display_variant]' => 'snippet_display_variant:qux',
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('zoo');
     $this->assertXpath('//div[@class="qux-wrapper"]/div[@class="snippet-test" and text()="9"]');
 
@@ -132,7 +135,8 @@ class SnippetPageTest extends TestBase {
     $edit = [
       'page[theme]' => 'bartik',
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('zoo');
     $this->assertSession()->responseContains('core/themes/bartik/css/print.css');
 
@@ -142,7 +146,8 @@ class SnippetPageTest extends TestBase {
       'page[title]' => '',
       'page[display_variant]' => NULL,
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('node/1');
     // The page title comes from the node.
     $this->assertPageTitle('Foo');
@@ -152,16 +157,18 @@ class SnippetPageTest extends TestBase {
     $edit = [
       'template[value]' => '<div class="node-body">{{ node.body[0] }}</div>',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/template', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/template');
+    $this->submitForm($edit, 'Save');
     $edit = [
       'plugin_id' => 'entity:node',
       'name' => 'node',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/variable/add', $edit, 'Save and continue');
+    $this->drupalGet($this->snippetEditUrl . '/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $edit = [
       'configuration[render_mode]' => 'fields',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('node/1');
     $this->assertXpath('//div[@class="node-body"]/p[text()="foo_content"]');
 
@@ -172,7 +179,8 @@ class SnippetPageTest extends TestBase {
       'page[access][type]' => 'permission',
       'page[access][permission]' => 'access site reports',
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('zoo');
     $this->assertSession()->statusCodeEquals(403);
@@ -187,7 +195,8 @@ class SnippetPageTest extends TestBase {
       'page[access][type]' => 'role',
       'page[access][role][anonymous]' => TRUE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('zoo');
     $this->assertSession()->statusCodeEquals(403);
 
@@ -195,7 +204,8 @@ class SnippetPageTest extends TestBase {
       'page[access][type]' => 'role',
       'page[access][role][authenticated]' => TRUE,
     ];
-    $this->drupalPostForm($this->snippetEditUrl, $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl);
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('zoo');
     $this->assertSession()->statusCodeEquals(200);
   }
diff --git a/tests/src/Functional/SnippetTemplateTest.php b/tests/src/Functional/SnippetTemplateTest.php
index 817d365..a7a325f 100644
--- a/tests/src/Functional/SnippetTemplateTest.php
+++ b/tests/src/Functional/SnippetTemplateTest.php
@@ -30,7 +30,8 @@ class SnippetTemplateTest extends TestBase {
       'template[value]' => '<div class="snippet-test">{{ 3 + 4 }}</div>',
       'template[format]' => 'snippet_manager_test_basic_format',
     ];
-    $this->drupalPostForm($this->snippetEditUrl . '/template', $edit, 'Save');
+    $this->drupalGet($this->snippetEditUrl . '/template');
+    $this->submitForm($edit, 'Save');
 
     $this->assertStatusMessage(new FormattableMarkup('Snippet %label has been updated.', ['%label' => $this->snippetLabel]));
 
diff --git a/tests/src/Functional/SnippetUiTest.php b/tests/src/Functional/SnippetUiTest.php
index d7ed6a9..dbc9bc9 100644
--- a/tests/src/Functional/SnippetUiTest.php
+++ b/tests/src/Functional/SnippetUiTest.php
@@ -50,7 +50,7 @@ class SnippetUiTest extends TestBase {
       'plugin_id' => 'text',
       'name' => 'bar',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save and continue');
+    $this->submitForm($edit, 'Save and continue');
 
     $this->assertPageTitle(new FM('Edit variable %variable', ['%variable' => $edit['name']]));
     $this->assertSession()->addressEquals('/admin/structure/snippet/alpha/edit/variable/bar/edit');
@@ -90,7 +90,7 @@ class SnippetUiTest extends TestBase {
     $this->assertPageTitle(new FM('Are you sure you want to delete the variable %variable?', ['%variable' => 'foo']));
     $this->assertSession()->pageTextContains('This action cannot be undone.');
     $this->assertXpath('//a[text() = "Cancel" and contains(@href, "/admin/structure/snippet/alpha/edit")]');
-    $this->drupalPostForm(NULL, [], 'Delete');
+    $this->submitForm([], 'Delete');
     $this->assertStatusMessage('The variable has been removed.');
     $this->assertSession()->addressEquals('/admin/structure/snippet/alpha/edit/template');
     $this->assertXpath('//table//td[text() = "Variables are not configured yet."]');
diff --git a/tests/src/Functional/TemplateLoaderTest.php b/tests/src/Functional/TemplateLoaderTest.php
index aa5596b..a51370b 100644
--- a/tests/src/Functional/TemplateLoaderTest.php
+++ b/tests/src/Functional/TemplateLoaderTest.php
@@ -19,14 +19,16 @@ class TemplateLoaderTest extends TestBase {
       'page[status]' => TRUE,
       'page[path]' => '/foo',
     ];
-    $this->drupalPostForm('admin/structure/snippet/add', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/add');
+    $this->submitForm($edit, 'Save');
 
     $edit = [
       'template[value]' => sprintf('<div class="snippet-base">{%% include "@snippet/%s" %%}</div>', $this->snippetId),
       'template[format]' => 'snippet_manager_test_basic_format',
     ];
+    $this->drupalGet('admin/structure/snippet/base/edit/template');
 
-    $this->drupalPostForm('admin/structure/snippet/base/edit/template', $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/snippet/base');
     $this->assertXpath('//div[@class="snippet-base"]/div[@class="snippet-test" and .="9"]');
diff --git a/tests/src/Functional/TestBase.php b/tests/src/Functional/TestBase.php
index b892b4e..3e1c5a8 100644
--- a/tests/src/Functional/TestBase.php
+++ b/tests/src/Functional/TestBase.php
@@ -62,7 +62,7 @@ abstract class TestBase extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Collect permissions.
diff --git a/tests/src/Functional/TextVariableTest.php b/tests/src/Functional/TextVariableTest.php
index d79cf29..5931cc2 100644
--- a/tests/src/Functional/TextVariableTest.php
+++ b/tests/src/Functional/TextVariableTest.php
@@ -17,8 +17,9 @@ class TextVariableTest extends TestBase {
       'plugin_id' => 'text',
       'name' => 'beer',
     ];
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
 
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->submitForm($edit, 'Save and continue');
 
     $this->assertXpath('//select[@name="configuration[content][format]"]/option[@value="snippet_manager_test_basic_format" and @selected="selected"]');
     $this->assertXpath('//select[@name="configuration[content][format]"]/option[@value="snippet_manager_test_restricted_format"]');
@@ -27,12 +28,12 @@ class TextVariableTest extends TestBase {
       'configuration[content][value]' => '<p>Dark</p><span>Light</span>',
       'configuration[content][format]' => 'snippet_manager_test_basic_format',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $edit = [
       'template[value]' => '<div class="snippet-content">-={{ beer }}=-</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/snippet/alpha');
 
@@ -43,7 +44,8 @@ class TextVariableTest extends TestBase {
     $edit = [
       'configuration[content][format]' => 'snippet_manager_test_restricted_format',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/beer/edit', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/beer/edit');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/snippet/alpha');
 
diff --git a/tests/src/Functional/UrlVariableTest.php b/tests/src/Functional/UrlVariableTest.php
index 308ac97..7d0cc44 100644
--- a/tests/src/Functional/UrlVariableTest.php
+++ b/tests/src/Functional/UrlVariableTest.php
@@ -20,14 +20,15 @@ class UrlVariableTest extends TestBase {
       'plugin_id' => 'url',
       'name' => 'url',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
+    $this->submitForm($edit, 'Save and continue');
 
     $this->assertStatusMessage('The variable has been created.');
 
     $edit = [
       'configuration[path]' => '/' . $path,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->assertStatusMessage('The variable has been updated.');
 
@@ -37,7 +38,8 @@ class UrlVariableTest extends TestBase {
     $edit = [
       'template[value]' => '<div class="snippet-url">{{ url }}</div>',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/template', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/template');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/snippet/alpha');
     $this->assertXpath(sprintf('//div[@class="snippet-url" and text() = "%s"]', base_path() . $path));
@@ -47,12 +49,13 @@ class UrlVariableTest extends TestBase {
       'plugin_id' => 'url',
       'name' => 'wrong_url',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
+    $this->submitForm($edit, 'Save and continue');
 
     $edit = [
       'configuration[path]' => $path,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
     $this->assertErrorMessage('The path should begin with "/".');
 
     // Make sure that empty path does not produce PHP exception.
diff --git a/tests/src/Functional/ViewVariableTest.php b/tests/src/Functional/ViewVariableTest.php
index 84ea532..3c08fad 100644
--- a/tests/src/Functional/ViewVariableTest.php
+++ b/tests/src/Functional/ViewVariableTest.php
@@ -33,18 +33,19 @@ class ViewVariableTest extends TestBase {
       'plugin_id' => 'view:who_s_online',
       'name' => 'who_s_online',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/add', $edit, 'Save and continue');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/add');
+    $this->submitForm($edit, 'Save and continue');
     $this->assertStatusMessage('The variable has been created.');
 
     $edit = [
       'configuration[display]' => 'default',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $edit = [
       'template[value]' => '<div class="snippet-content">{{ who_s_online }}</div>',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Save');
+    $this->submitForm($edit, 'Save');
 
     $this->drupalGet('admin/structure/snippet/alpha');
 
@@ -56,7 +57,8 @@ class ViewVariableTest extends TestBase {
     $edit = [
       'configuration[display]' => 'who_s_online_block',
     ];
-    $this->drupalPostForm('admin/structure/snippet/alpha/edit/variable/who_s_online/edit', $edit, 'Save');
+    $this->drupalGet('admin/structure/snippet/alpha/edit/variable/who_s_online/edit');
+    $this->submitForm($edit, 'Save');
     $this->drupalGet('admin/structure/snippet/alpha');
 
     $this->assertXpath(sprintf($xpath, 'view-display-id-who_s_online_block'));
diff --git a/tests/src/Kernel/SnippetFilterTest.php b/tests/src/Kernel/SnippetFilterTest.php
index 209f923..823868c 100644
--- a/tests/src/Kernel/SnippetFilterTest.php
+++ b/tests/src/Kernel/SnippetFilterTest.php
@@ -23,7 +23,7 @@ class SnippetFilterTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
     $this->installConfig(['filter']);
     $values = [
diff --git a/tests/src/Unit/LocalTasksTest.php b/tests/src/Unit/LocalTasksTest.php
index ee52ce4..8962459 100644
--- a/tests/src/Unit/LocalTasksTest.php
+++ b/tests/src/Unit/LocalTasksTest.php
@@ -14,7 +14,7 @@ class LocalTasksTest extends LocalTaskIntegrationTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     // drupal_get_path() is not allowed here.
     $module_path = substr(__DIR__, strlen($this->root) + 1) . '/../../..';

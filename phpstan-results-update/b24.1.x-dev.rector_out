modules/contrib/b24/b24.api.php
modules/contrib/b24/modules/b24_commerce/src/Form/MappingForm.php
modules/contrib/b24/modules/b24_user/src/Form/UserExportBatchForm.php
modules/contrib/b24/b24.install
modules/contrib/b24/b24.module
modules/contrib/b24/modules/b24_commerce/b24_commerce.api.php
modules/contrib/b24/modules/b24_commerce/b24_commerce.module
modules/contrib/b24/modules/b24_commerce/src/Event/B24CommerceEvent.php
modules/contrib/b24/modules/b24_commerce/src/EventSubscriber/B24CommerceSubscriber.php
modules/contrib/b24/modules/b24_commerce/src/Form/ProductExportBatchForm.php
modules/contrib/b24/modules/b24_user/src/Form/UserImportBatchForm.php
modules/contrib/b24/modules/b24_user/src/Service/UserManager.php
modules/contrib/b24/modules/b24_commerce/src/Form/SettingsForm.php
modules/contrib/b24/modules/b24_utm/b24_utm.module
modules/contrib/b24/modules/b24_webform/b24_webform.module
modules/contrib/b24/modules/b24_webform/src/Form/SettingsForm.php
modules/contrib/b24/modules/b24_commerce/src/Plugin/Derivative/DynamicMappingTasks.php
modules/contrib/b24/modules/b24_commerce/src/Routing/B24CommerceRoutes.php
modules/contrib/b24/modules/b24_commerce/src/Service/CatalogManager.php
modules/contrib/b24/src/Controller/Auth.php
modules/contrib/b24/modules/b24_contact/b24_contact.module
modules/contrib/b24/modules/b24_contact/src/Form/SettingsForm.php
modules/contrib/b24/src/Event/B24Event.php
modules/contrib/b24/src/Form/CredentialsForm.php
modules/contrib/b24/src/Form/DefaultSettingsForm.php
modules/contrib/b24/modules/b24_user/b24_user.module
modules/contrib/b24/src/Service/RestManager.php
modules/contrib/b24/modules/b24_user/src/EventSubscriber/B24UserEventSubscriber.php
modules/contrib/b24/modules/b24_user/src/Form/MappingForm.php
modules/contrib/b24/modules/b24_user/src/Form/SettingsForm.php

9 files with changes
====================

1) modules/contrib/b24/modules/b24_commerce/src/EventSubscriber/B24CommerceSubscriber.php:20

    ---------- begin diff ----------
@@ @@
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
 use Symfony\Component\EventDispatcher\EventDispatcherInterface;
 use Drupal\state_machine\Event\WorkflowTransitionEvent;
-use Symfony\Component\HttpKernel\Event\FilterResponseEvent;
-use Symfony\Component\HttpKernel\Event\GetResponseEvent;
 use Symfony\Component\HttpKernel\KernelEvents;
 use Drupal\Core\Extension\ModuleHandler;

@@ @@
       ])->execute();

     $event = new B24CommerceEvent($order, 'deal', $deal);
-    $this->dispatcher->dispatch(B24CommerceEvent::ENTITY_INSERT, $event);
+    $this->dispatcher->dispatch($event, B24CommerceEvent::ENTITY_INSERT);
     $this->updateProducts($order, 'deal', $deal);
     return $deal ?? NULL;
   }
@@ @@
     $this->moduleHandler->alter('b24_commerce_data', $fields, $context);
     $ext_id = $this->restManager->addLead($fields);
     $event = new B24CommerceEvent($order, 'lead', $ext_id);
-    $this->dispatcher->dispatch(B24CommerceEvent::ENTITY_INSERT, $event);
+    $this->dispatcher->dispatch($event, B24CommerceEvent::ENTITY_INSERT);
     if ($ext_id) {
       $hash = $this->getHash($fields);
       $this->database->insert('b24_reference')
@@ @@
     }
     $this->updateProducts($order);
     $event = new B24CommerceEvent($order, 'lead', $update);
-    $this->dispatcher->dispatch(B24CommerceEvent::ENTITY_UPDATE, $event);
+    $this->dispatcher->dispatch($event, B24CommerceEvent::ENTITY_UPDATE);
     return $update;
   }

@@ @@
       $this->moduleHandler->alter('b24_commerce_data', $fields, $context);
       $contact_id = $this->restManager->addContact($fields);
       $event = new B24CommerceEvent($order, 'contact', $contact_id);
-      $this->dispatcher->dispatch(B24CommerceEvent::ENTITY_INSERT, $event);
+      $this->dispatcher->dispatch($event, B24CommerceEvent::ENTITY_INSERT);
     }
     if ($this->moduleHandler->moduleExists('b24_user')) {
       $this->configFactory->getEditable('b24_user.settings')->set('enabled', $user_enabled);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * RenameClassRector
 * MakeDispatchFirstArgumentEventRector
 * WrapReturnRector


2) modules/contrib/b24/modules/b24_commerce/src/Event/B24CommerceEvent.php:2

    ---------- begin diff ----------
@@ @@
 namespace Drupal\b24_commerce\Event;

 use Drupal\commerce_order\Entity\OrderInterface;
-use Symfony\Component\EventDispatcher\Event;

 /**
  * todo: we have lack information about B24 response here which makes this event not so useful as I wanted.
@@ @@
  *
  * @see \Drupal\commerce_order\Event\OrderEvents
  */
-class B24CommerceEvent extends Event {
+class B24CommerceEvent extends \Symfony\Contracts\EventDispatcher\Event {

   /**
    * Name of the event fired after adding a new Bitrix24 entity.
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * RenameClassRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


3) modules/contrib/b24/modules/b24_commerce/b24_commerce.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\commerce_order\Entity\OrderItemInterface;
+use Drupal\commerce_product\Entity\Product;
 use Drupal\Core\Entity\EntityInterface;
 use Drupal\taxonomy\Entity\Term;
 /**
@@ @@
 /**
  * Implements hook_entity_insert().
  */
-function b24_commerce_commerce_order_item_insert(Drupal\commerce_order\Entity\OrderItemInterface $item) {
+function b24_commerce_commerce_order_item_insert(OrderItemInterface $item) {
   return _b24_commerce_update_products($item);
 }

@@ @@
 /**
  * Implements hook_entity_insert().
  */
-function b24_commerce_commerce_order_item_update(Drupal\commerce_order\Entity\OrderItemInterface $item) {
+function b24_commerce_commerce_order_item_update(OrderItemInterface $item) {
   return _b24_commerce_update_products($item);
 }

@@ @@
 /**
  * Implements hook_entity_insert().
  */
-function b24_commerce_commerce_order_item_delete(Drupal\commerce_order\Entity\OrderItemInterface $item) {
+function b24_commerce_commerce_order_item_delete(OrderItemInterface $item) {
   return _b24_commerce_update_products($item);
 }

@@ @@
  * @param \Drupal\commerce_order\Entity\OrderItemInterface $item
  * @return mixed
  */
-function _b24_commerce_update_products(Drupal\commerce_order\Entity\OrderItemInterface $item) {
+function _b24_commerce_update_products(OrderItemInterface $item) {
   $order = $item->getOrder();
   return $order ? \Drupal::service('b24_commerce.event_subscriber')->updateProducts($order) : FALSE;
 }
@@ @@
 /**
  * Implements hook_ENTITY_TYPE_delete().
  */
-function b24_commerce_commerce_product_delete(Drupal\commerce_product\Entity\Product $entity) {
+function b24_commerce_commerce_product_delete(Product $entity) {
   $variations = $entity->get('variations')->getValue();
   foreach ($variations as $variation) {
     \Drupal::service('b24.rest_manager')->deleteProduct($variation['target_id'], TRUE);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


4) modules/contrib/b24/modules/b24_commerce/src/Form/ProductExportBatchForm.php:226

    ---------- begin diff ----------
@@ @@
         ->setInitMessage($this->t('Initializing.'))
         ->setProgressMessage($this->t('Completed @current of @total.'))
         ->setErrorMessage($this->t('An error has occurred.'))
-        ->setFile(drupal_get_path('module', 'b24_commerce') . '/src/Form/ProductExportBatchForm.php');
+        ->setFile(\Drupal::service('extension.list.module')->getPath('b24_commerce') . '/src/Form/ProductExportBatchForm.php');

       $stores = array_filter($form_state->getValue('stores'));
       $stores = array_keys($stores);
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


5) modules/contrib/b24/src/Service/RestManager.php:226

    ---------- begin diff ----------
@@ @@
         ]
       );
       $event = new B24Event($b24_entity_name, 'insert', $response);
-      $this->eventDispatcher->dispatch(B24Event::ENTITY_INSERT, $event);
+      $this->eventDispatcher->dispatch($event, B24Event::ENTITY_INSERT);
     }
     return $ext_id;
   }
@@ @@
     $this->moduleHandler->alter('b24_push', $fields, $context);
     $response = $this->get("crm.{$b24_entity_name}.update", ['id' => $id,'fields' => $fields, 'params' => $params]);
     $event = new B24Event($b24_entity_name, 'update', $response);
-    $this->eventDispatcher->dispatch(B24Event::ENTITY_UPDATE, $event);
+    $this->eventDispatcher->dispatch($event, B24Event::ENTITY_UPDATE);
     return $response;
   }

@@ @@
     }
     $response = $this->get("crm.{$b24_entity_name}.delete", ['id' => $id]);
     $event = new B24Event($b24_entity_name, 'delete', $response);
-    $this->eventDispatcher->dispatch(B24Event::ENTITY_DELETE, $event);
+    $this->eventDispatcher->dispatch($event, B24Event::ENTITY_DELETE);
     $result = $response['result'] ?? FALSE;
     return $result;
   }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * MakeDispatchFirstArgumentEventRector
 * WrapReturnRector


6) modules/contrib/b24/src/Event/B24Event.php:1

    ---------- begin diff ----------
@@ @@

 namespace Drupal\b24\Event;

-use Symfony\Component\EventDispatcher\Event;
-
 /**
  * Defines the Bitrix24 entity event.
  */
-class B24Event extends Event {
+class B24Event extends \Symfony\Contracts\EventDispatcher\Event {

   /**
    * Name of the event fired after adding a new Bitrix24 entity.
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * RenameClassRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


7) modules/contrib/b24/modules/b24_webform/b24_webform.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\webform\Entity\WebformSubmission;
 /**
  * @file
  * Contains b24_webform.module.
@@ @@
 /**
  * Implements hook_ENTITY_TYPE_insert().
  */
-function b24_webform_webform_submission_insert(Drupal\webform\Entity\WebformSubmission $submission) {
+function b24_webform_webform_submission_insert(WebformSubmission $submission) {
   $webform = $submission->getWebform();
   $config = \Drupal::config('b24_webform.settings');
   if ($config->get("{$webform->id()}.status")) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


8) modules/contrib/b24/modules/b24_user/src/Form/UserImportBatchForm.php:121

    ---------- begin diff ----------
@@ @@
       ->setInitMessage($this->t('Initializing users import.'))
       ->setProgressMessage($this->t('Completed @current of @total.'))
       ->setErrorMessage($this->t('An error has occurred.'))
-      ->setFile(drupal_get_path('module', 'b24_user') . '/src/Form/UserImportBatchForm.php');
+      ->setFile(\Drupal::service('extension.list.module')->getPath('b24_user') . '/src/Form/UserImportBatchForm.php');

     $this->existingUsers = $this->userManager->getExistingUsers();
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


9) modules/contrib/b24/modules/b24_user/src/Form/UserExportBatchForm.php:104

    ---------- begin diff ----------
@@ @@
       ->setInitMessage($this->t('Initializing.'))
       ->setProgressMessage($this->t('Completed @current of @total.'))
       ->setErrorMessage($this->t('An error has occurred.'))
-      ->setFile(drupal_get_path('module', 'b24_user') . '/src/Form/UserExportBatchForm.php');
+      ->setFile(\Drupal::service('extension.list.module')->getPath('b24_user') . '/src/Form/UserExportBatchForm.php');

     $this->existingUsers = $this->userManager->getExistingUsers();
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


 [OK] 9 files have been changed by Rector                                       


modules/contrib/file_version/file_version.api.php
modules/contrib/file_version/file_version.install
modules/contrib/file_version/file_version.module
modules/contrib/file_version/src/FileVersion.php
modules/contrib/file_version/src/FileVersionInterface.php
modules/contrib/file_version/src/Form/SettingsForm.php
modules/contrib/file_version/tests/src/Kernel/FileTest.php
modules/contrib/file_version/tests/src/Kernel/FileVersionTestBase.php
modules/contrib/file_version/tests/src/Kernel/ImageStyleTest.php

2 files with changes
====================

1) modules/contrib/file_version/tests/src/Kernel/ImageStyleTest.php:62

    ---------- begin diff ----------
@@ @@

     $this->config('file_version.settings')->set('extensions_whitelist', 'doc')->save();
     $image_url = $this->imageStyle->buildUrl($image_uri);
-    $doc_url = file_create_url($doc_uri);
-    $pdf_url = file_create_url($pdf_uri);
+    $doc_url = \Drupal::service('file_url_generator')->generateAbsoluteString($doc_uri);
+    $pdf_url = \Drupal::service('file_url_generator')->generateAbsoluteString($pdf_uri);

     $this->assertTrue($this->urlHasQueryParam($image_url), 'Image style has File Version when extensions whitelist is set: single value.');
     $this->assertTrue($this->urlHasQueryParam($image_url, 'itok'), 'Image style has itok when extensions whitelist is set: single value.');
@@ @@

     $this->config('file_version.settings')->set('extensions_whitelist', 'doc, xml')->save();
     $image_url = $this->imageStyle->buildUrl($image_uri);
-    $doc_url = file_create_url($doc_uri);
-    $pdf_url = file_create_url($pdf_uri);
+    $doc_url = \Drupal::service('file_url_generator')->generateAbsoluteString($doc_uri);
+    $pdf_url = \Drupal::service('file_url_generator')->generateAbsoluteString($pdf_uri);

     $this->assertTrue($this->urlHasQueryParam($image_url), 'Image style has File Version when extensions whitelist is set: list.');
     $this->assertTrue($this->urlHasQueryParam($image_url, 'itok'), 'Image style has itok when extensions whitelist is set: list.');
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


2) modules/contrib/file_version/tests/src/Kernel/FileTest.php:31

    ---------- begin diff ----------
@@ @@
     $token = \Drupal::service('file_version')->getFileVersionToken($uri);
     $uri .= '?fv=' . $token;

-    $url = file_create_url($uri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);

     $query = parse_url($url, PHP_URL_QUERY);
     $fv_count = substr_count($query, 'fv=');
@@ @@
    */
   public function testAbsoluteUrl() {
     $uri = 'http://example.com/myfile.doc';
-    $url = file_create_url($uri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
     $this->assertTrue($this->isUrlAbsolute($url), 'Absolute URL keeps absolute.');
     $this->assertTrue($this->urlHasQueryParam($url), 'Absolute URL has File Version');
   }
@@ @@
    */
   public function testSchemeUri() {
     $scheme_uri = 'public://myfile.doc';
-    $url = file_create_url($scheme_uri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($scheme_uri);
     $this->assertTrue($this->isUrlAbsolute($url), 'Scheme URI is converted to absolute URL.');
     $this->assertTrue($this->urlHasQueryParam($url), 'Scheme URI has File Version');
   }
@@ @@
    */
   public function testRelativeUrl() {
     $relative_uri = 'modules/custom/mymodule/myfile.doc';
-    $url = file_create_url($relative_uri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($relative_uri);
     $this->assertTrue($this->isUrlAbsolute($url), 'Relative URL is converted to absolute URL.');
     $this->assertTrue($this->urlHasQueryParam($url), 'Relative URL has File Version');
   }
@@ @@
    */
   public function testRootRelativeUrl() {
     $root_relative_uri = '/modules/custom/mymodule/myfile.doc';
-    $url = file_create_url($root_relative_uri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($root_relative_uri);
     $this->assertTrue(strpos($url, $root_relative_uri) === 0, 'Root relative URL keeps root relative.');
     $this->assertTrue($this->urlHasQueryParam($url), 'Root relative URL has File Version');
   }
@@ @@
     $custom_query_parameter = 'jv';
     $this->config('file_version.settings')->set('get_parameter_name', $custom_query_parameter)->save();
     $uri = 'http://example.com/myfile.doc';
-    $url = file_create_url($uri);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
     $this->assertTrue($this->urlHasQueryParam($url, $custom_query_parameter), 'URL works with custom query parameter.');
   }

@@ @@
     $pdf_uri = 'http://example.com/myfile.pdf';

     $this->config('file_version.settings')->set('extensions_blacklist', 'doc')->save();
-    $doc_url = file_create_url($doc_uri);
-    $pdf_url = file_create_url($pdf_uri);
+    $doc_url = \Drupal::service('file_url_generator')->generateAbsoluteString($doc_uri);
+    $pdf_url = \Drupal::service('file_url_generator')->generateAbsoluteString($pdf_uri);
     $this->assertFalse($this->urlHasQueryParam($doc_url), "Blacklisted extension doesn't have File Version: single value.");
     $this->assertTrue($this->urlHasQueryParam($pdf_url), 'Other extensions have File Version: single value.');

     $this->config('file_version.settings')->set('extensions_blacklist', 'doc, xml')->save();
-    $doc_url = file_create_url($doc_uri);
-    $pdf_url = file_create_url($pdf_uri);
+    $doc_url = \Drupal::service('file_url_generator')->generateAbsoluteString($doc_uri);
+    $pdf_url = \Drupal::service('file_url_generator')->generateAbsoluteString($pdf_uri);
     $this->assertFalse($this->urlHasQueryParam($doc_url), "Blacklisted extension doesn't have File Version: list.");
     $this->assertTrue($this->urlHasQueryParam($pdf_url), 'Other extensions have File Version: list.');
   }
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


 [OK] 2 files have been changed by Rector                                       


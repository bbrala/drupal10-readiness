modules/contrib/contact_ajax/contact_ajax.module
modules/contrib/contact_ajax/tests/src/FunctionalJavascript/ContactAjaxTest.php

1 file with changes
===================

1) modules/contrib/contact_ajax/tests/src/FunctionalJavascript/ContactAjaxTest.php:129

    ---------- begin diff ----------
@@ @@
     // 8.2.x added the message field, which is by default empty. Conditionally
     // submit it if the field can be found.
     $this->drupalGet('admin/structure/contact/add');
-    if ($this->xpath($this->constructFieldXpath('name', 'message'))) {
+    if ($this->xpath($this->getSession()->getPage()->findField('message'))) {
       $edit['message'] = $message;
     }

@@ @@
     // First submit the common configs. Because 'id' fields and ajax
     // 'advanced settings' are not available until this first step is done, we
     // can't submit all at once.
-    $this->drupalPostForm(NULL, $common, t('Save'));
+    $this->submitForm($common, t('Save'));

     // Open the advanced settings.
     $this->click('#edit-advanced summary');
@@ @@
     $assert->waitForElementVisible('css', '[name="id"]');

     // Post the full form.
-    $this->drupalPostForm(NULL, $common + $edit, t('Save'));
+    $this->submitForm($common + $edit, t('Save'));

     $assert->pageTextContains(t('Contact form test_label has been added.'));
   }
@@ @@
     // Send form reload the same form.
     $form_id = 'test_id';
     $this->drupalGet('contact/' . $form_id);
-    $this->drupalPostForm(NULL, $edit, t('Send message'));
+    $this->submitForm($edit, t('Send message'));
     $assert->assertWaitOnAjaxRequest();
     $assert->pageTextContains('Your message has been sent.', '[OK] Your message has been sent.');

@@ @@
     // Submit form reload custom message.
     $form_id = 'test_custom_message_id';
     $this->drupalGet('contact/' . $form_id);
-    $this->drupalPostForm(NULL, $edit, t('Send message'));
+    $this->submitForm($edit, t('Send message'));
     $assert->assertWaitOnAjaxRequest();
     $assert->pageTextContains('test ajax message', '[OK] test ajax message.');

@@ @@
     // Send form reload another node.
     $form_id = 'test_node_content';
     $this->drupalGet('contact/' . $form_id);
-    $this->drupalPostForm(NULL, $edit, t('Send message'));
+    $this->submitForm($edit, t('Send message'));
     $assert->assertWaitOnAjaxRequest();
     $assert->pageTextContains('test ajax title', '[OK] test ajax title');

@@ @@
     $form_id = 'test_load_other_element';
     $this->drupalGet('contact/' . $form_id);
     $assert->responseContains('id="ajax-contact-prefix"', '[OK] ajax prefix wrapper added');
-    $this->drupalPostForm(NULL, $edit, t('Send message'));
+    $this->submitForm($edit, t('Send message'));
     $assert->assertWaitOnAjaxRequest();
     $assert->pageTextContains('Your message has been sent.', '[OK] Your message has been sent.');
     $assert->responseNotContains('<form', '[OK] Form has been removed.');
@@ @@
     unset($edit['name']);
     $form_id = 'test_load_with_validation_errors';
     $this->drupalGet('contact/' . $form_id);
-    $this->drupalPostForm(NULL, $edit, t('Send message'));
+    $this->submitForm($edit, t('Send message'));
     $assert->assertWaitOnAjaxRequest();
     $assert->pageTextContains('Your name field is required.', '[OK] test render with form errors.');
   }
    ----------- end diff -----------

Applied rules:
 * ConstructFieldXpathRector
 * UiHelperTraitDrupalPostFormRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


 [OK] 1 file has been changed by Rector                                         


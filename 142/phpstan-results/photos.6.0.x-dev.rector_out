modules/contrib/photos/photos.install
modules/contrib/photos/photos_access/photos_access.install
modules/contrib/photos/src/Entity/PhotosImage.php
modules/contrib/photos/src/PhotosUploadInterface.php
modules/contrib/photos/tests/src/Functional/AddPhotosAlbumImageTest.php
modules/contrib/photos/src/PhotosViewsData.php
modules/contrib/photos/src/Plugin/Block/PhotosInformation.php
modules/contrib/photos/photos_access/photos_access.module
modules/contrib/photos/src/Plugin/Field/FieldFormatter/PhotosAlbumCoverImageFormatter.php
modules/contrib/photos/photos.module
modules/contrib/photos/src/Plugin/Field/FieldFormatter/PhotosAlbumFormatter.php
modules/contrib/photos/tests/src/Kernel/CreatePhotosAlbumTest.php
modules/contrib/photos/src/Plugin/Field/FieldFormatter/PhotosImageMediaFieldFormatter.php
modules/contrib/photos/tests/src/Unit/PhotosAlbumTest.php
modules/contrib/photos/src/Plugin/Filter/PhotosFilter.php
modules/contrib/photos/src/Plugin/Search/PhotosImageSearch.php
modules/contrib/photos/src/Entity/PhotosRouteProvider.php
modules/contrib/photos/src/Form/PhotosAdminLegacySettingsForm.php
modules/contrib/photos/src/Form/PhotosAdminSettingsForm.php
modules/contrib/photos/src/Plugin/media/Source/Photos.php
modules/contrib/photos/src/Plugin/migrate/destination/Photos.php
modules/contrib/photos/src/Plugin/migrate/destination/PhotosComment.php
modules/contrib/photos/src/Plugin/migrate/destination/PhotosCount.php
modules/contrib/photos/src/Plugin/migrate/destination/PhotosImage.php
modules/contrib/photos/src/Plugin/migrate/source/Photos.php
modules/contrib/photos/src/Plugin/migrate/source/PhotosComment.php
modules/contrib/photos/src/Plugin/migrate/source/PhotosCount.php
modules/contrib/photos/src/Plugin/migrate/source/PhotosImage.php
modules/contrib/photos/src/Form/PhotosAdminStructureForm.php
modules/contrib/photos/src/Plugin/views/field/PhotosImageCover.php
modules/contrib/photos/photos_access/src/Controller/DefaultController.php
modules/contrib/photos/src/Form/PhotosDirectoryImportForm.php
modules/contrib/photos/photos_access/src/Form/PhotosAccessPasswordForm.php
modules/contrib/photos/photos_access/src/Plugin/migrate/destination/PhotosAccess.php
modules/contrib/photos/photos_access/src/Plugin/migrate/destination/PhotosAccessUser.php
modules/contrib/photos/photos_access/src/Plugin/migrate/source/PhotosAccess.php
modules/contrib/photos/src/Plugin/views/field/PhotosImageSetCover.php
modules/contrib/photos/photos_access/src/Plugin/migrate/source/PhotosAccessUser.php
modules/contrib/photos/src/Routing/PhotosRouteSubscriber.php
modules/contrib/photos/photos_access/src/Plugin/views/access/PhotosAccess.php
modules/contrib/photos/photos_access/tests/src/Functional/PhotosAccessTest.php
modules/contrib/photos/src/Form/PhotosImageAddForm.php
modules/contrib/photos/src/Form/PhotosImageDeleteForm.php
modules/contrib/photos/photos.post_update.php
modules/contrib/photos/src/Form/PhotosImageEditForm.php
modules/contrib/photos/src/Form/PhotosMediaLibraryForm.php
modules/contrib/photos/src/Form/PhotosUploadForm.php
modules/contrib/photos/src/Controller/PhotosAlbumController.php
modules/contrib/photos/src/Controller/PhotosEditController.php
modules/contrib/photos/src/Controller/PhotosImageViewController.php
modules/contrib/photos/src/Controller/PhotosLegacyAlbumViewController.php
modules/contrib/photos/src/PhotosAccessControlHandler.php
modules/contrib/photos/src/PhotosAlbum.php
modules/contrib/photos/src/Controller/PhotosLegacyImageViewController.php
modules/contrib/photos/src/Controller/PhotosRearrangeController.php
modules/contrib/photos/src/PhotosImageFile.php
modules/contrib/photos/src/Controller/PhotosStatisticsUpdateController.php
modules/contrib/photos/src/PhotosImageInterface.php
modules/contrib/photos/src/PhotosImageListBuilder.php
modules/contrib/photos/src/PhotosImageStorage.php
modules/contrib/photos/src/PhotosImageStorageInterface.php
modules/contrib/photos/src/PhotosImageStorageSchema.php
modules/contrib/photos/src/PhotosUpload.php

8 files with changes
====================

1) modules/contrib/photos/tests/src/Kernel/CreatePhotosAlbumTest.php:30

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     $this->installConfig(['system']);
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/photos/tests/src/Functional/AddPhotosAlbumImageTest.php:50

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     // Create user with permissions to edit own photos.
     $this->account = $this->drupalCreateUser([
@@ @@
     $album->save();

     // Get test image file.
-    $testPhotoUri = drupal_get_path('module', 'photos') . '/tests/images/photos-test-picture.jpg';
+    $testPhotoUri = \Drupal::service('extension.list.module')->getPath('photos') . '/tests/images/photos-test-picture.jpg';
     $fileSystem = \Drupal::service('file_system');

     // Post image upload form.
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/photos/photos.module:966

    ---------- begin diff ----------
@@ @@
       if (!file_exists($styleUri)) {
         $style->createDerivative($uri, $styleUri);
       }
-      $url = file_create_url($styleUri);
+      $url = \Drupal::service('file_url_generator')->generateAbsoluteString($styleUri);
     }

     // Render image view.
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ArgumentRemoverRector


4) modules/contrib/photos/photos.install:326

    ---------- begin diff ----------
@@ @@
     $all_created = TRUE;
     // Only create if the photos view doesn't exist and views is enabled.
     if (!View::load('photos')) {
-      $config_path = drupal_get_path('module', 'photos') . '/config/optional/views.view.photos.yml';
+      $config_path = \Drupal::service('extension.list.module')->getPath('photos') . '/config/optional/views.view.photos.yml';
       $data = Yaml::parseFile($config_path);
       \Drupal::configFactory()->getEditable('views.view.photos')->setData($data)->save(TRUE);
     }
@@ @@
     }
     // Album view.
     if (!View::load('photos_album')) {
-      $config_path = drupal_get_path('module', 'photos') . '/config/optional/views.view.photos_album.yml';
+      $config_path = \Drupal::service('extension.list.module')->getPath('photos') . '/config/optional/views.view.photos_album.yml';
       $data = Yaml::parseFile($config_path);
       \Drupal::configFactory()->getEditable('views.view.photos_album')->setData($data)->save(TRUE);
     }
@@ @@
     }
     // Album list view.
     if (!View::load('photos_album_list')) {
-      $config_path = drupal_get_path('module', 'photos') . '/config/optional/views.view.photos_album_list.yml';
+      $config_path = \Drupal::service('extension.list.module')->getPath('photos') . '/config/optional/views.view.photos_album_list.yml';
       $data = Yaml::parseFile($config_path);
       \Drupal::configFactory()->getEditable('views.view.photos_album_list')->setData($data)->save(TRUE);
     }
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector


5) modules/contrib/photos/photos_access/tests/src/Functional/PhotosAccessTest.php:65

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     // Create admin user and adjust photos admin settings. This user will also
@@ @@
     // Get test image file.
     /** @var \Drupal\Core\File\FileSystemInterface $fileSystem */
     $fileSystem = \Drupal::service('file_system');
-    $testImageFile = drupal_get_path('module', 'photos') . '/tests/images/photos-test-picture.jpg';
+    $testImageFile = \Drupal::service('extension.list.module')->getPath('photos') . '/tests/images/photos-test-picture.jpg';
     // Add image to album.
     $edit = [
       'files[images_0]' => $fileSystem->realpath($testImageFile),
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/photos/photos_access/photos_access.module:154

    ---------- begin diff ----------
@@ @@
           $form['photos_privacy']['viewremove'][$u['target_id']] = [
             '#type' => 'checkbox',
             '#default_value' => isset($node->viewremove[$u['target_id']]) ? $node->viewremove[$u['target_id']] : '',
-            '#title' => t('Delete: @name', ['@name' => render($u['username'])]),
+            '#title' => t('Delete: @name', ['@name' => \Drupal::service('renderer')->render($u['username'])]),
             '#prefix' => '<div id="photos-access-remove"' . $classes . '>',
             '#suffix' => '</div>',
           ];
@@ @@
           $form['photos_privacy']['updateremove'][$u['target_id']] = [
             '#type' => 'checkbox',
             '#default_value' => isset($node->updateremove[$u['target_id']]) ? $node->updateremove[$u['target_id']] : '',
-            '#title' => t('Delete: @name', ['@name' => render($u['username'])]),
+            '#title' => t('Delete: @name', ['@name' => \Drupal::service('renderer')->render($u['username'])]),
             '#prefix' => '<div id="photos_access_updateremove" class="photos-access-update-remove">',
             '#suffix' => '</div>',
           ];
@@ @@
           $new_uri = str_replace($old_file_wrapper, $file_wrapper, $file->getFileUri());
           $dirname = $file_system->dirname($new_uri);
           $file_system->prepareDirectory($dirname, FileSystemInterface::CREATE_DIRECTORY);
-          file_move($file, $new_uri);
+          \Drupal::service('file.repository')->move($file, $new_uri);
           // Clear image page cache.
           $cache_tags[] = 'photos:image:' . $fid;
         }
@@ @@
             $new_uri = str_replace($old_file_wrapper, $file_wrapper, $file->getFileUri());
             $dirname = $file_system->dirname($new_uri);
             $file_system->prepareDirectory($dirname, FileSystemInterface::CREATE_DIRECTORY);
-            file_move($file, $new_uri);
+            \Drupal::service('file.repository')->move($file, $new_uri);
           }
         }
       }
    ----------- end diff -----------

Applied rules:
 * FileMoveRector
 * RenderRector
 * ArgumentRemoverRector


7) modules/contrib/photos/src/PhotosUpload.php:490

    ---------- begin diff ----------
@@ @@
               break;
             }
             $path = $this->fileSystem->createFilename($image['name'], $this->path($scheme));
-            if ($temp_file = file_save_data($zip->getFromIndex($x), $path)) {
+            if ($temp_file = \Drupal::service('file.repository')->writeData($zip->getFromIndex($x), $path)) {
               // Update file values.
               $temp_file->album_id = $params['album_id'];
               $temp_file->nid = $params['nid'];
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * ArgumentRemoverRector
 * WrapReturnRector


8) modules/contrib/photos/src/PhotosImageFile.php:150

    ---------- begin diff ----------
@@ @@
     $style->createDerivative($uri, $destination);

     // Return URL.
-    return file_create_url($destination);
+    return \Drupal::service('file_url_generator')->generateAbsoluteString($destination);
   }

   /**
@@ @@
         $image_url = ImageStyle::load($style_name)->buildUrl($uri);
       }
       else {
-        $image_url = file_create_url($uri);
+        $image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
       }
     }
     else {
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ArgumentRemoverRector
 * WrapReturnRector


 [OK] 8 files have been changed by Rector                                       


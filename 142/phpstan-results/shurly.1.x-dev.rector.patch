diff --git a/shurly_service/shurly_service.module b/shurly_service/shurly_service.module
index 40ab2ed..c89a0b2 100644
--- a/shurly_service/shurly_service.module
+++ b/shurly_service/shurly_service.module
@@ -138,6 +138,6 @@ function shurly_api_key_form_submit($form, &$form_state) {
 function shurly_service_views_api() {
   return [
     'api' => 3,
-    'path' => drupal_get_path('module', 'shurly_service') . '/views',
+    'path' => \Drupal::service('extension.list.module')->getPath('shurly_service') . '/views',
   ];
 }
diff --git a/src/ShurlySubscriber.php b/src/ShurlySubscriber.php
index 6ec5913..5b148fc 100644
--- a/src/ShurlySubscriber.php
+++ b/src/ShurlySubscriber.php
@@ -2,10 +2,10 @@
 
 namespace Drupal\shurly;
 
+use Symfony\Component\HttpKernel\Event\RequestEvent;
 use Drupal\Core\Url;
 use Symfony\Component\HttpFoundation\RedirectResponse;
 use Symfony\Component\HttpKernel\KernelEvents;
-use Symfony\Component\HttpKernel\Event\GetResponseEvent;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
 
 class ShurlySubscriber implements EventSubscriberInterface {
@@ -18,7 +18,7 @@ class ShurlySubscriber implements EventSubscriberInterface {
     return $events;
   }
 
-  public function shurlyOnRespond(GetResponseEvent $event) {
+  public function shurlyOnRespond(RequestEvent $event) {
     $path = \Drupal::service('path.current')->getPath();
     $current_path = str_replace("/", "", $path);
 

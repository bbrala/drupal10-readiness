diff --git a/modules/mimemail_example/tests/src/Functional/ExampleMailTest.php b/modules/mimemail_example/tests/src/Functional/ExampleMailTest.php
index c5a1e44..9ee2ad5 100644
--- a/modules/mimemail_example/tests/src/Functional/ExampleMailTest.php
+++ b/modules/mimemail_example/tests/src/Functional/ExampleMailTest.php
@@ -40,7 +40,7 @@ class ExampleMailTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Create our test users.
diff --git a/src/Form/AdminForm.php b/src/Form/AdminForm.php
index f8b4049..249bc0d 100644
--- a/src/Form/AdminForm.php
+++ b/src/Form/AdminForm.php
@@ -124,7 +124,7 @@ class AdminForm extends ConfigFormBase {
     $theme = $this->themeHandler->getDefault();
     // @todo Searching the path is not what we want - this is how it was done
     // in D7, but that's not how assets should be handled in D8.
-    $mailstyle = drupal_get_path('theme', $theme) . '/mail.css';
+    $mailstyle = \Drupal::service('extension.list.theme')->getPath($theme) . '/mail.css';
     // Disable site style sheets including option if found.
     if (is_file($mailstyle)) {
       $config->set('sitestyle', FALSE);
diff --git a/src/Utility/MimeMailFormatHelper.php b/src/Utility/MimeMailFormatHelper.php
index 2e1f063..ed3444f 100644
--- a/src/Utility/MimeMailFormatHelper.php
+++ b/src/Utility/MimeMailFormatHelper.php
@@ -345,7 +345,7 @@ class MimeMailFormatHelper {
     // to an email message.
     static $files = [];
 
-    /** @var \Symfony\Component\HttpFoundation\File\MimeType\MimeTypeGuesserInterface $mime_type_guesser */
+    /** @var \Symfony\Component\Mime\MimeTypesInterface $mime_type_guesser */
     $mime_type_guesser = \Drupal::service('file.mime_type.guesser');
 
     /** @var \Drupal\Core\File\FileSystemInterface $file_system */
@@ -380,7 +380,7 @@ class MimeMailFormatHelper {
         }
         // The $url is a non-local URI that needs to be converted to a URL.
         else {
-          $file = $file_system->realpath($url) ? $file_system->realpath($url) : file_create_url($url);
+          $file = $file_system->realpath($url) ? $file_system->realpath($url) : \Drupal::service('file_url_generator')->generateAbsoluteString($url);
         }
       }
     }
@@ -477,7 +477,7 @@ class MimeMailFormatHelper {
       if ($is_image) {
         if ($to_link) {
           // Exclude images from embedding if needed.
-          $url = file_create_url($url);
+          $url = \Drupal::service('file_url_generator')->generateAbsoluteString($url);
           $url = str_replace(' ', '%20', $url);
         }
         else {
@@ -573,7 +573,7 @@ class MimeMailFormatHelper {
     // Control variable to avoid boundary collision.
     static $part_num = 0;
 
-    /** @var \Symfony\Component\HttpFoundation\File\MimeType\MimeTypeGuesserInterface $mime_type_guesser */
+    /** @var \Symfony\Component\Mime\MimeTypesInterface $mime_type_guesser */
     $mime_type_guesser = \Drupal::service('file.mime_type.guesser');
 
     /** @var \Drupal\Component\Datetime\TimeInterface $time */
diff --git a/tests/src/Functional/MimeMailWebTest.php b/tests/src/Functional/MimeMailWebTest.php
index 2e79218..cf42b12 100644
--- a/tests/src/Functional/MimeMailWebTest.php
+++ b/tests/src/Functional/MimeMailWebTest.php
@@ -37,7 +37,7 @@ class MimeMailWebTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Create admin user.
diff --git a/tests/src/Kernel/MimeMailFormatHelperTest.php b/tests/src/Kernel/MimeMailFormatHelperTest.php
index 9441659..d971215 100644
--- a/tests/src/Kernel/MimeMailFormatHelperTest.php
+++ b/tests/src/Kernel/MimeMailFormatHelperTest.php
@@ -50,7 +50,7 @@ class MimeMailFormatHelperTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     // Sets up an anonymous and two authenticated users.
     $this->adminUser = $this->setUpCurrentUser([

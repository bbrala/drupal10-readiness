diff --git a/improvements.module b/improvements.module
index 7e26fda..73d0686 100644
--- a/improvements.module
+++ b/improvements.module
@@ -165,7 +165,7 @@ function improvements_page_attachments(array &$page): void {
 
   // Add to js info about current and default themes.
   $page['#attached']['drupalSettings']['path']['currentThemePath'] = \Drupal::service('theme.manager')->getActiveTheme()->getPath();
-  $page['#attached']['drupalSettings']['path']['defaultThemePath'] = drupal_get_path('theme', \Drupal::config('system.theme')->get('default'));
+  $page['#attached']['drupalSettings']['path']['defaultThemePath'] = \Drupal::service('extension.list.theme')->getPath(\Drupal::config('system.theme')->get('default'));
 
   improvements_form_tracking_submit_page_attachments($page);
   improvements_build_time_page_attachments($page);
@@ -178,7 +178,7 @@ function improvements_library_info_alter(array &$libraries, string $extension):
   static $improvements_assets_path;
 
   if (!$improvements_assets_path) {
-    $improvements_assets_path = '/' . drupal_get_path('module', 'improvements') . '/assets/';
+    $improvements_assets_path = '/' . \Drupal::service('extension.list.module')->getPath('improvements') . '/assets/';
   }
 
   // core
diff --git a/includes/improvements.form.inc b/includes/improvements.form.inc
index c64949b..0c7c86d 100644
--- a/includes/improvements.form.inc
+++ b/includes/improvements.form.inc
@@ -27,7 +27,7 @@ function improvements_form_library_info_alter(array &$libraries, string $extensi
   static $improvements_assets_path;
 
   if (!$improvements_assets_path) {
-    $improvements_assets_path = '/' . drupal_get_path('module', 'improvements') . '/assets/';
+    $improvements_assets_path = '/' . \Drupal::service('extension.list.module')->getPath('improvements') . '/assets/';
   }
 
   // core
diff --git a/src/ImprovementsEventSubscriber.php b/src/ImprovementsEventSubscriber.php
index 2978fc3..0bec496 100644
--- a/src/ImprovementsEventSubscriber.php
+++ b/src/ImprovementsEventSubscriber.php
@@ -24,7 +24,7 @@ class ImprovementsEventSubscriber implements EventSubscriberInterface {
   /**
    * KernelEvents::VIEW event callback.
    *
-   * @param \Symfony\Component\HttpKernel\Event\GetResponseForControllerResultEvent|\Symfony\Component\HttpKernel\Event\ViewEvent $event
+   * @param \Symfony\Component\HttpKernel\Event\ViewEvent|\Symfony\Component\HttpKernel\Event\ViewEvent $event
    * @todo Remove \Symfony\Component\HttpKernel\Event\GetResponseForControllerResultEvent after Drupal 8 support end
    */
   public function onKernelView($event): void {
@@ -52,7 +52,7 @@ class ImprovementsEventSubscriber implements EventSubscriberInterface {
   /**
    * KernelEvents::RESPONSE event callback.
    *
-   * @param \Symfony\Component\HttpKernel\Event\FilterResponseEvent|\Symfony\Component\HttpKernel\Event\ResponseEvent $event
+   * @param \Symfony\Component\HttpKernel\Event\ResponseEvent|\Symfony\Component\HttpKernel\Event\ResponseEvent $event
    * @todo Remove \Symfony\Component\HttpKernel\Event\FilterResponseEvent after Drupal 8 support end
    */
   public function onKernelResponse($event): void {
diff --git a/src/Plugin/Field/FieldFormatter/ExtendedImageFormatter.php b/src/Plugin/Field/FieldFormatter/ExtendedImageFormatter.php
index b18c470..1b21015 100644
--- a/src/Plugin/Field/FieldFormatter/ExtendedImageFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/ExtendedImageFormatter.php
@@ -133,7 +133,7 @@ class ExtendedImageFormatter extends ImageFormatterBase {
           $image_link_url = $image_link_style->buildUrl($file->getFileUri());
         }
         else {
-          $image_link_url = file_create_url($file->getFileUri());
+          $image_link_url = \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri());
         }
 
         $image_link_url = Url::fromUri($image_link_url);
diff --git a/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeFormatter.php b/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeFormatter.php
index 3df9694..3f2b89f 100644
--- a/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeFormatter.php
@@ -208,10 +208,10 @@ class ImageWithMobileAlternativeFormatter extends FormatterBase {
       $url = $image_style->buildUrl($path);
     }
     else {
-      $url = file_create_url($path);
+      $url = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
     }
 
-    return file_url_transform_relative($url);
+    return \Drupal::service('file_url_generator')->transformRelative($url);
   }
 
 }
diff --git a/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeOneFieldFormatter.php b/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeOneFieldFormatter.php
index b4f9440..5189ebf 100644
--- a/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeOneFieldFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/ImageWithMobileAlternativeOneFieldFormatter.php
@@ -189,10 +189,10 @@ class ImageWithMobileAlternativeOneFieldFormatter extends FormatterBase {
       $url = $image_style->buildUrl($path);
     }
     else {
-      $url = file_create_url($path);
+      $url = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
     }
 
-    return file_url_transform_relative($url);
+    return \Drupal::service('file_url_generator')->transformRelative($url);
   }
 
 }

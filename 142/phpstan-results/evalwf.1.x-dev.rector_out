modules/contrib/evalwf/evalwf.install
modules/contrib/evalwf/src/Form/EvalWFForm.php
modules/contrib/evalwf/evalwf.module
modules/contrib/evalwf/src/Controller/EvalWFConfigListBuilder.php
modules/contrib/evalwf/src/Controller/EvalWFController.php
modules/contrib/evalwf/src/Plugin/WebformHandler/EvalWFWebformHandler.php
modules/contrib/evalwf/src/Controller/EvalWFEvaluationListBuilder.php
modules/contrib/evalwf/src/Controller/EvalWFListBuilder.php
modules/contrib/evalwf/src/Entity/EvalWF.php
modules/contrib/evalwf/src/Entity/EvalWFConfig.php
modules/contrib/evalwf/src/Entity/EvalWFEvaluation.php
modules/contrib/evalwf/src/Form/EvalWFConfigForm.php
modules/contrib/evalwf/src/Form/EvalWFDeleteForm.php
modules/contrib/evalwf/src/Form/EvalWFEvaluationForm.php

9 files with changes
====================

1) modules/contrib/evalwf/src/Plugin/WebformHandler/EvalWFWebformHandler.php:25

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Plugin\WebformHandler;

+use Drupal\Core\Url;
+use Drupal\Core\Link;
 use Drupal\webform\Plugin\WebformHandlerBase;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\webform\WebformSubmissionInterface;
@@ @@
     $form['evalwf']['setup'] = [
       '#type' => 'link',
       '#title' => $this->t('Add/Manage EvalWF settings'),
-      '#url' => \Drupal\Core\Url::fromRoute( 'entity.evalwf.withpath.settings_form', ['webform' => $wfid] ),
+      '#url' => Url::fromRoute( 'entity.evalwf.withpath.settings_form', ['webform' => $wfid] ),
       '#attributes' => ['target' => '_blank'],
     ];

@@ @@
     $form['evalwf']['chsettings'] = [
       '#type' => 'link',
       '#title' => 'Change this settings',
-      '#url' => \Drupal\Core\Url::fromRoute( 'entity.webform.settings_confirmation', ['webform' => $wfid] ),
+      '#url' => Url::fromRoute( 'entity.webform.settings_confirmation', ['webform' => $wfid] ),
       '#attributes' => ['target' => '_blank'],
     ];

@@ @@
       if (!in_array( explode('://', trim($curl) )[0],['http','https']) && !in_array( explode(':/', trim($curl) )[0],['internal'])) {
         $curl = 'internal:/' . $curl;
       }
-      $url = \Drupal\Core\Url::fromUri( $curl )->setAbsolute(TRUE)->setOption( 'attributes', array( 'target' => '_blank' ));
+      $url = Url::fromUri( $curl )->setAbsolute(TRUE)->setOption( 'attributes', array( 'target' => '_blank' ));

       \Drupal::messenger()->addMessage(
-        \Drupal\Core\Link::fromTextAndUrl('Open confirmation url', $url )
+        Link::fromTextAndUrl('Open confirmation url', $url )
       );
     }

     // evalwf/[webform:id]/[webform_submission:sid]
-    $target = \Drupal\Core\Url::fromRoute('evalwf.withpath.content', [
+    $target = Url::fromRoute('evalwf.withpath.content', [
         'webform' => $wfid, 'webform_submission' => $sid
       ])->setAbsolute(TRUE)->toString();
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


2) modules/contrib/evalwf/src/Form/EvalWFForm.php:26

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Form;

+use Drupal\webform\Entity\Webform;
+use Drupal\Core\Url;
 use Drupal\Core\Entity\EntityForm;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ @@
           '#markup' => t('Please select webform for evaluation settings:').'<br>',
         ];
         foreach($wfids as $key => $value ) {
-          $wf = \Drupal\webform\Entity\Webform::load($key);
+          $wf = Webform::load($key);
           $query = \Drupal::entityQuery('evalwf')->condition('webform_id', $key);
           $entitys = $query->execute();
           $row[$key]= array(
@@ @@
             'webform_id' => array(
               '#type' => 'link',
               '#title' => $value,
-              '#url' => ( in_array($key, $this->error_elements_list) ) ? \Drupal\Core\Url::fromRoute('entity.webform.collection') :
-                \Drupal\Core\Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $key,] ),
+              '#url' => ( in_array($key, $this->error_elements_list) ) ? Url::fromRoute('entity.webform.collection') :
+                Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $key,] ),
             ),
             'description' => array(
               '#type' => 'markup',
@@ @@
           $form['webform']['chsettings'] = [
             '#type' => 'link',
             '#title' => 'Change this settings',
-            '#url' => \Drupal\Core\Url::fromRoute( 'entity.webform.settings_confirmation', ['webform' => $myentity->webform_id] ),
+            '#url' => Url::fromRoute( 'entity.webform.settings_confirmation', ['webform' => $myentity->webform_id] ),
             '#attributes' => ['target' => '_blank'],
           ];

@@ @@
            $form['webform']['chhandler'] = [
              '#type' => 'link',
              '#title' => 'Change handler settings',
-             '#url' => \Drupal\Core\Url::fromRoute( 'entity.webform.handlers', ['webform' => $myentity->webform_id] ),
+             '#url' => Url::fromRoute( 'entity.webform.handlers', ['webform' => $myentity->webform_id] ),
              '#attributes' => ['target' => '_blank'],
            ];
            // if not handlerkey and confirmation_url not eq 'evalwf/[webform:id]/[webform_submission:sid]' may warn user?!
@@ @@

     $this->error_elements_list = [];
     foreach($wfids as $key => $value ) {
-      $webform = \Drupal\webform\Entity\Webform::load($key);
+      $webform = Webform::load($key);
       $webform_elements = $webform->getElementsDecoded();

       $this->elements_list = [];
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


3) modules/contrib/evalwf/src/Form/EvalWFEvaluationForm.php:26

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Form;

+use Drupal\evalwf\Entity\EvalWF;
+use Drupal\Core\Url;
+use Drupal\webform\entity\WebformSubmission;
 use Drupal\Core\Entity\EntityForm;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ @@
       // TODO: run evaluation without emailing / maybe show results
       $resultform = $mycontroller->content( $wf, $wfs, true );

-      $evaluation = \Drupal\evalwf\Entity\EvalWF::LoadEntityByWebformID( $wf->id() );
+      $evaluation = EvalWF::LoadEntityByWebformID( $wf->id() );

       if ($evaluation) {
         if ($resultform && !empty($evaluation->elements_data)) {
@@ @@
           $button = array(
             '#type' => 'link',
             '#title' => t('View'),
-            '#url' => \Drupal\Core\Url::fromRoute('entity.evalwf_evaluation.view_form', [ 'evalwf_evaluation' => $target[2] ] ),
+            '#url' => Url::fromRoute('entity.evalwf_evaluation.view_form', [ 'evalwf_evaluation' => $target[2] ] ),
           );
           \Drupal::messenger()->addMessage( t('The selected submission has evaluated...') );
           \Drupal::messenger()->addMessage( $button );
@@ @@
         $button = array(
           '#type' => 'link',
           '#title' => t('Add evaluation settings'),
-          '#url' => \Drupal\Core\Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $wf->id(),] ),
+          '#url' => Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $wf->id(),] ),
         );
         \Drupal::messenger()->addMessage(
           t('No Evaluation was set to this webform... Please add evaluation settings first...'),
@@ @@

     foreach ( $submissions as $key => $value) {
       if (!in_array($key,$evaluations)) {
-        $webform_submission = \Drupal\webform\entity\WebformSubmission::load($key);
+        $webform_submission = WebformSubmission::load($key);
         $form['submissions'][$key] = [
           'id' => [ '#type' => 'markup', '#markup' => $value, ],
           'webform' => [ '#type' => 'markup', '#markup' => $webform_submission->bundle(), ],
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


4) modules/contrib/evalwf/src/Entity/EvalWF.php:23

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Entity;

+use Drupal\webform\Entity\Webform;
 use Drupal\Core\Config\Entity\ConfigEntityBase;
 use Drupal\Core\Config\Entity\ConfigEntityInterface;
 use Drupal\Core\Form\FormStateInterface;
@@ @@
    *    @returns array - the (modified) conditions settings table
    */
   public function CreateConditionsTable( FormStateInterface $form_state, $op ) {
-    $webform = \Drupal\webform\Entity\Webform::load($this->webform_id);
+    $webform = Webform::load($this->webform_id);
     $webform_elements = $webform->getElementsDecoded();
     $e = $this->getelementslist($webform_elements);
     $e = array_merge( array( '' => '' , 'AllTotal' => 'Total points' ), $e );
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


5) modules/contrib/evalwf/src/Controller/EvalWFListBuilder.php:23

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Controller;

+use Drupal\Core\Url;
 use Drupal\Core\Config\Entity\ConfigEntityListBuilder;
 use Drupal\Core\Entity\EntityInterface;

@@ @@
         'data' => array(
           '#type' => 'link',
           '#title' => count($res),
-          '#url' => \Drupal\Core\Url::fromRoute('entity.evalwf_evaluation.collection'),
+          '#url' => Url::fromRoute('entity.evalwf_evaluation.collection'),
         )
       )
       : '');
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


6) modules/contrib/evalwf/src/Controller/EvalWFEvaluationListBuilder.php:23

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Controller;

+use Drupal\user\Entity\User;
 use Drupal\Core\Config\Entity\ConfigEntityListBuilder;
 use Drupal\Core\Entity\EntityInterface;
 use Drupal\wevform\WebformSubmissionListBuilder;
@@ @@
       $row['sent'] = $entity->sent;
       $row['sentt'] = $entity->sentto;
       $row['timestamp'] = $entity->timestamp;
-      $row['uid'] = \Drupal\user\Entity\User::load($entity->uid)->getAccountName();
+      $row['uid'] = User::load($entity->uid)->getAccountName();
       return $row + parent::buildRow($entity);
     }
     else {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


7) modules/contrib/evalwf/src/Controller/EvalWFController.php:30

    ---------- begin diff ----------
@@ @@

 namespace Drupal\evalwf\Controller;

+use Symfony\Component\HttpFoundation\RedirectResponse;
 use Drupal\evalwf\Entity\EvalWF;
 use Drupal\evalwf\Entity\EvalWFEvaluation;
 use Drupal\webform\Entity\Webform;
@@ @@
         $conditions = $this->getConditionsData( array_merge( array('AllTotal' => $result['points']), $result['elements_points']));
         if ($conditions) {
           $conditions[0]['title'] = t('Continue').' >>>';
-          $conditions[0]['url'] = \Drupal\Core\Url::fromUri($conditions[0]['url'])->setAbsolute(TRUE)->toString();
+          $conditions[0]['url'] = Url::fromUri($conditions[0]['url'])->setAbsolute(TRUE)->toString();
         }

         $elements = $this->buildelementstree(
@@ @@
             $button = array(
               '#type' => 'link',
               '#title' => t('Edit element settings'),
-              '#url' => \Drupal\Core\Url::fromRoute('entity.evalwf.settings_form.elements', ['webform' => $this->wfid,] ),
+              '#url' => Url::fromRoute('entity.evalwf.settings_form.elements', ['webform' => $this->wfid,] ),
             );
             \Drupal::messenger()->addMessage(
               t('Evaluation settings of this webform haven\'t completed yet. Please fill and save Elements settings page...'),
@@ @@

       if ($this->entity->directjump && (!$isadmin)) {
         $conditions = unserialize($evaluation->conditions_data);
-        $responseurl = \Drupal\Core\Url::fromUri($conditions[0]['url'])->setAbsolute(TRUE)->toString();
+        $responseurl = Url::fromUri($conditions[0]['url'])->setAbsolute(TRUE)->toString();
         if ( \Drupal::VERSION >= "9" ) {
           $response = new TrustedRedirectResponse( $responseurl, '302');
         }
@@ @@
         else {
           // Drupal 8 has an error with TrustedRedirectResponse
           // this way external urls not supported for directjump
-          if (\Drupal\Core\Url::fromUri($conditions[0]['url'])->setAbsolute(TRUE)->isExternal()) {
+          if (Url::fromUri($conditions[0]['url'])->setAbsolute(TRUE)->isExternal()) {
             return $conditions_form;
           }
-          $response = new \Symfony\Component\HttpFoundation\RedirectResponse( $responseurl, '302');
+          $response = new RedirectResponse( $responseurl, '302');
         }
         return $response;
       }
@@ @@
         $button = array(
           '#type' => 'link',
           '#title' => t('Add evaluation settings'),
-          '#url' => \Drupal\Core\Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' =>  $this->wfid,] ),
+          '#url' => Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' =>  $this->wfid,] ),
         );
         \Drupal::messenger()->addMessage(
           t('No Evaluation was set to this webform... Please add evaluation settings first...'),
@@ @@
         $css = file_get_contents( $cssfile );
       }
       else {
-        $cssfile = $_SERVER['DOCUMENT_ROOT'] . base_path() . drupal_get_path('module', 'evalwf') . '/css/evalwf-resultpage-theme.css';
+        $cssfile = $_SERVER['DOCUMENT_ROOT'] . base_path() . \Drupal::service('extension.list.module')->getPath('evalwf') . '/css/evalwf-resultpage-theme.css';
         if (file_exists($cssfile)) {
           $css = file_get_contents( $cssfile );
         }
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector
 * WrapReturnRector


8) modules/contrib/evalwf/evalwf.module:0

    ---------- begin diff ----------
@@ @@
 <?php
+use Drupal\Core\Entity\EntityInterface;
+use Drupal\Core\Url;
+use Drupal\Core\Routing\RouteMatchInterface;
+use Drupal\Core\Form\FormStateInterface;
 /**
 *    This file is part of EvalWF Module - Automatic evaluation of forms was made by webform module.
 *    Copyright (C) 2020  University of Szeged
@@ @@
 *   @param entity    - the current EntityInterface
 *   @return array    - operations of different type of entities
 */
-function evalwf_entity_operation(\Drupal\Core\Entity\EntityInterface $entity) {
+function evalwf_entity_operation(EntityInterface $entity) {
   $operations = array();
   $entity_typeid = $entity->getEntityTypeId();

@@ @@
     case 'evalwf':
       $operations['edit'] = array(
         'title' => t('Edit Settings'),
-        'url' => \Drupal\Core\Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $entity->webform_id] ),
+        'url' => Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $entity->webform_id] ),
         'weight' => 40,
       );
       $operations['add'] = array(
         'title' => t('Add Evaluation'),
-        'url' => \Drupal\Core\Url::fromRoute('entity.evalwf.add_form'),
+        'url' => Url::fromRoute('entity.evalwf.add_form'),
         'weight' => 50,
       );
       $operations['export'] = array(
         'title' => t('Export Settings'),
-        'url' => \Drupal\Core\Url::fromRoute('config.export_single', ['config_type' => 'evalwf', 'config_name' => $entity->id ] ),
+        'url' => Url::fromRoute('config.export_single', ['config_type' => 'evalwf', 'config_name' => $entity->id ] ),
         'weight' => 50,
       );
       break;
@@ @@
     case 'evalwf_evaluation':
       $operations['view'] = array(
         'title' => t('View'),
-        'url' => \Drupal\Core\Url::fromRoute('entity.evalwf_evaluation.view_form', ['evalwf_evaluation' => $entity->id] ),
+        'url' => Url::fromRoute('entity.evalwf_evaluation.view_form', ['evalwf_evaluation' => $entity->id] ),
         'weight' => 40,
       );
       break;
@@ @@
     case 'webform':
       $operations['evaluation'] = array(
         'title' => t('Set Evaluation'),
-        'url' => \Drupal\Core\Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $entity->id()] ),
+        'url' => Url::fromRoute('entity.evalwf.withpath.settings_form', ['webform' => $entity->id()] ),
         'weight' => 50,
       );
       break;
@@ @@
     case 'webform_submission':
       $operations['evaluate'] = array(
         'title' => t('Evaluate'),
-        'url' => \Drupal\Core\Url::fromRoute('evalwf.withpath.content', ['webform' => $entity->bundle(), 'webform_submission' => $entity->id()] ),
+        'url' => Url::fromRoute('evalwf.withpath.content', ['webform' => $entity->bundle(), 'webform_submission' => $entity->id()] ),
         'weight' => 50,
       );
       break;
@@ @@
 *    @param route_name
 *    @param route_match
 */
-function evalwf_help($route_name, \Drupal\Core\Routing\RouteMatchInterface $route_match) {
+function evalwf_help($route_name, RouteMatchInterface $route_match) {
   switch ($route_name) {
     case 'help.page.evalwf':
-      $modulepath = base_path() . drupal_get_path('module', 'evalwf');
+      $modulepath = base_path() . \Drupal::service('extension.list.module')->getPath('evalwf');
       $help  = '<p>'.  t('This module can make automatic form evaulation which was made by webform module.');
       $help .= '<BR>'. t('Just create your evaluation for that form. When user fills the form, this modul evaluate it with your eval options.') .'</p>';
       $help .= '<details><summary>'. t('Creating a from with Webform') .'</summary>';
@@ @@
 *    @param form       - the current Form object
 *    @param form_state - the current FormStateInterface object
 */
-function evalwf_form_evalwf_conditions_settings_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
+function evalwf_form_evalwf_conditions_settings_form_alter(&$form, FormStateInterface $form_state, $form_id) {
   $elements = $form_state->getUserInput();
   $myentity = $form_state->getFormObject()->getEntity();

@@ @@
 *    @param form       - the current Form object
 *    @param form_state - the current FormStateInterface object
 */
-function evalwf_form_evalwf_evaluation_list_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
+function evalwf_form_evalwf_evaluation_list_form_alter(&$form, FormStateInterface $form_state, $form_id) {
   $form['filter_table'][0]['filter']['#value'] = (
     isset($form_state->getUserInput()['filter_table'][0]['filter']) ? $form_state->getUserInput()['filter_table'][0]['filter'] : null
   );
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ArgumentRemoverRector


9) modules/contrib/evalwf/evalwf.install:42

    ---------- begin diff ----------
@@ @@
   $query = \Drupal::entityQuery('evalwf');
   $entities = $query->execute();
   foreach ($entities as $eid) {
-    $entity = entity_load('evalwf',$eid);
+    $entity = \Drupal::service('entity_type.manager')->getStorage('evalwf')->load($eid);
     $conditions = unserialize($entity->conditions_data);
     foreach ($conditions['table'] as &$row) {
       $url = ( isset($row['url']) ? $row['url'] : ( isset($row['elseurl']) ? $row['elseurl'] : null) );
    ----------- end diff -----------

Applied rules:
 * EntityLoadRector
 * ArgumentRemoverRector


 [OK] 9 files have been changed by Rector                                       


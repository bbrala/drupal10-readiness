diff --git a/src/Controller/DefaultController.php b/src/Controller/DefaultController.php
index 94c09fb..ce0ff69 100644
--- a/src/Controller/DefaultController.php
+++ b/src/Controller/DefaultController.php
@@ -39,7 +39,7 @@ class DefaultController extends ControllerBase {
     }
 
     $filename = $filename . '.zip';
-    $tmp_file = file_save_data('', 'private://' . $filename);
+    $tmp_file = \Drupal::service('file.repository')->writeData('', 'private://' . $filename);
     $tmp_file->status = 0;
     $tmp_file->save();
 
diff --git a/webform_submission_files_download.info.yml b/webform_submission_files_download.info.yml
index 9b012c3..4403c6d 100644
--- a/webform_submission_files_download.info.yml
+++ b/webform_submission_files_download.info.yml
@@ -1,6 +1,5 @@
 name: 'Webform Submission Files Download'
 type: module
 description: 'Allow to download files attached to a single submission'
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: 'webform'
diff --git a/webform_submission_files_download.module b/webform_submission_files_download.module
index e3207d1..6b6d888 100644
--- a/webform_submission_files_download.module
+++ b/webform_submission_files_download.module
@@ -1,5 +1,7 @@
 <?php
 
+use Drupal\Core\Entity\EntityInterface;
+use Drupal\Core\Url;
 /**
  * Implements hook_requirements().
  */
@@ -20,13 +22,13 @@ function webform_submission_files_download_requirements($phase) {
 /**
  * Implements hook_entity_operation().
  */
-function webform_submission_files_download_entity_operation(\Drupal\Core\Entity\EntityInterface $entity) {
+function webform_submission_files_download_entity_operation(EntityInterface $entity) {
   $operations = array();
 
   if($entity->getEntityTypeId() == 'webform_submission') {
     $operations['files_download'] = array(
       'title' => t('Files download'),
-      'url' => \Drupal\Core\Url::fromRoute('entity.webform_submission.files_download', ['webform'=> $entity->webform_id->target_id, 'webform_submission'=>$entity->id()]),
+      'url' => Url::fromRoute('entity.webform_submission.files_download', ['webform'=> $entity->webform_id->target_id, 'webform_submission'=>$entity->id()]),
       'weight' => 50,
     );
   }

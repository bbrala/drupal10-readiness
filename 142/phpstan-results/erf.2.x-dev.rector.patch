diff --git a/modules/erf_commerce/src/Plugin/Field/FieldWidget/RenderedVariationReferenceWidget.php b/modules/erf_commerce/src/Plugin/Field/FieldWidget/RenderedVariationReferenceWidget.php
index c616457..d820e76 100644
--- a/modules/erf_commerce/src/Plugin/Field/FieldWidget/RenderedVariationReferenceWidget.php
+++ b/modules/erf_commerce/src/Plugin/Field/FieldWidget/RenderedVariationReferenceWidget.php
@@ -174,7 +174,7 @@ class RenderedVariationReferenceWidget extends OptionsButtonsWidget implements C
 
     foreach ($targets as $target) {
       $gen_view = $view_builder->view($target, $this->getSetting('variation_view_mode'), $target->language()->getId());
-      $element['#options'][$target->id()] = render($gen_view);
+      $element['#options'][$target->id()] = \Drupal::service('renderer')->render($gen_view);
     }
 
     return $element;
diff --git a/src/Entity/Registration.php b/src/Entity/Registration.php
index 9c6398f..abdefde 100644
--- a/src/Entity/Registration.php
+++ b/src/Entity/Registration.php
@@ -104,7 +104,7 @@ class Registration extends ContentEntityBase implements RegistrationInterface {
           // If no user, create and save a new one.
           if (!$user_account) {
             $user_account = $this->entityTypeManager()->getStorage('user')->create();
-            $user_account->setPassword(user_password(20));
+            $user_account->setPassword(\Drupal::service('password_generator')->generate(20));
             $user_account->enforceIsNew();
             $user_account->setEmail($participant->mail->value);
             $user_account->setUsername($participant->mail->value);

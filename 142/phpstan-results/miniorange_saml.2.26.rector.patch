diff --git a/src/Controller/miniorange_samlController.php b/src/Controller/miniorange_samlController.php
index ae6a584..b91b113 100755
--- a/src/Controller/miniorange_samlController.php
+++ b/src/Controller/miniorange_samlController.php
@@ -152,7 +152,7 @@ class miniorange_samlController extends ControllerBase {
         // Create user if not already present.
         if ( $account == NULL ) {
 
-            $random_password = user_password(8);
+            $random_password = \Drupal::service('password_generator')->generate(8);
 
             $new_user = [
                 'name' => $response['username'],
diff --git a/src/MetadataReader.php b/src/MetadataReader.php
index 506099b..8edb0d9 100755
--- a/src/MetadataReader.php
+++ b/src/MetadataReader.php
@@ -14,7 +14,7 @@ class MetadataReader{
 
 		foreach ($entityDescriptors as $entityDescriptor) {
 			$idpSSODescriptor = Utilities::xpQuery($entityDescriptor, './saml_metadata:IDPSSODescriptor');
-			
+
 			if(isset($idpSSODescriptor) && !empty($idpSSODescriptor)){
 				array_push($this->identityProviders,new IdentityProviders($entityDescriptor));
 			}
diff --git a/src/Utilities.php b/src/Utilities.php
index fd1ec56..96fb8a8 100755
--- a/src/Utilities.php
+++ b/src/Utilities.php
@@ -150,7 +150,7 @@ class Utilities {
         <h4 class="mo_ns_image1">Looking for a Drupal ' . $mo_module . '?</h4>
             <tr class="mo_ns_row">
                 <th class="mo_ns_image1"><img
-                            src="'.$base_url . '/' . drupal_get_path("module", "miniorange_saml") . '/includes/images/'.$mo_image.'"
+                            src="'.$base_url . '/' . \Drupal::service('extension.list.module')->getPath("miniorange_saml") . '/includes/images/'.$mo_image.'"
                             alt="miniOrange icon" height=10% width=35%>
                 <br>
                         <h4>Drupal ' . $mo_module . '</h4>

diff --git a/nexx_integration.install b/nexx_integration.install
index 074322b..cc349c7 100644
--- a/nexx_integration.install
+++ b/nexx_integration.install
@@ -45,7 +45,7 @@ function nexx_integration_schema() {
  * Implements hook_install().
  */
 function nexx_integration_install() {
-  $source = drupal_get_path('module', 'nexx_integration') . '/images/icons';
+  $source = \Drupal::service('extension.list.module')->getPath('nexx_integration') . '/images/icons';
   $destination = \Drupal::config('media.settings')->get('icon_base_uri');
   $file_system = \Drupal::service('file_system');
   $file_system->prepareDirectory($destination, FileSystemInterface::CREATE_DIRECTORY | FileSystemInterface::MODIFY_PERMISSIONS);
diff --git a/src/Controller/OmniaController.php b/src/Controller/OmniaController.php
index 9160392..fd63f2a 100644
--- a/src/Controller/OmniaController.php
+++ b/src/Controller/OmniaController.php
@@ -562,7 +562,7 @@ class OmniaController extends ControllerBase {
       if ($destination_directory) {
         // Import file.
         $this->fileSystem->prepareDirectory($destination_directory, FileSystemInterface::CREATE_DIRECTORY | FileSystemInterface::MODIFY_PERMISSIONS);
-        $thumbnail = file_save_data(file_get_contents($thumb_uri), $destination_file, FileSystemInterface::EXISTS_REPLACE);
+        $thumbnail = \Drupal::service('file.repository')->writeData(file_get_contents($thumb_uri), $destination_file, FileSystemInterface::EXISTS_REPLACE);
         // Add this file to thumbnail field of the nexx media entity.
         $thumbnail_entity->$thumbnail_upload_field->appendItem([
           'target_id' => $thumbnail->id(),
diff --git a/tests/src/Functional/NexxIntegrationVideoTest.php b/tests/src/Functional/NexxIntegrationVideoTest.php
index e3fc212..806d3d2 100644
--- a/tests/src/Functional/NexxIntegrationVideoTest.php
+++ b/tests/src/Functional/NexxIntegrationVideoTest.php
@@ -355,15 +355,16 @@ class NexxIntegrationVideoTest extends BrowserTestBase {
     if ($bundle_path !== NULL) {
       $bundle_path = "$bundle_path/fields/add-field";
     }
+    $this->drupalGet($bundle_path);
 
     // First step: 'Add field' page.
-    $this->drupalPostForm($bundle_path, $initial_edit, $this->t('Save and continue'));
+    $this->submitForm($initial_edit, $this->t('Save and continue'));
 
     // Second step: 'Storage settings' form.
-    $this->drupalPostForm(NULL, $storage_edit, $this->t('Save field settings'));
+    $this->submitForm($storage_edit, $this->t('Save field settings'));
 
     // Third step: 'Field settings' form.
-    $this->drupalPostForm(NULL, $field_edit, $this->t('Save settings'));
+    $this->submitForm($field_edit, $this->t('Save settings'));
   }
 
 }
diff --git a/tests/src/FunctionalJavascript/NexxTestTrait.php b/tests/src/FunctionalJavascript/NexxTestTrait.php
index 490158e..4ea6f80 100644
--- a/tests/src/FunctionalJavascript/NexxTestTrait.php
+++ b/tests/src/FunctionalJavascript/NexxTestTrait.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\nexx_integration\FunctionalJavascript;
 
+use function GuzzleHttp\json_decode;
 use Drupal\Core\Url;
 use Drupal\taxonomy\Entity\Vocabulary;
 use Drupal\taxonomy\Entity\Term;
@@ -257,7 +258,7 @@ trait NexxTestTrait {
       ],
     ]);
 
-    $responseBody = \GuzzleHttp\json_decode($response->getBody()->getContents());
+    $responseBody = json_decode($response->getBody()->getContents());
     return $responseBody;
   }
 

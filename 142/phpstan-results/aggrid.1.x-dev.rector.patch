diff --git a/includes/aggrid.install.update.inc b/includes/aggrid.install.update.inc
index 3dce1df..750c97d 100644
--- a/includes/aggrid.install.update.inc
+++ b/includes/aggrid.install.update.inc
@@ -12,7 +12,7 @@ use Symfony\Component\Yaml\Yaml;
 function aggrid_update_8001()
 {
   
-  $file_path = drupal_get_path('module', 'aggrid') . '/config/install/aggrid.general.yml';
+  $file_path = \Drupal::service('extension.list.module')->getPath('aggrid') . '/config/install/aggrid.general.yml';
   
   $file_contents = file_get_contents($file_path);
   $ymldata = Yaml::parse($file_contents);
diff --git a/src/Plugin/Field/FieldFormatter/HtmlFormatterType.php b/src/Plugin/Field/FieldFormatter/HtmlFormatterType.php
index b17464d..df3d469 100644
--- a/src/Plugin/Field/FieldFormatter/HtmlFormatterType.php
+++ b/src/Plugin/Field/FieldFormatter/HtmlFormatterType.php
@@ -229,17 +229,17 @@ class HtmlFormatterType extends FormatterBase {
         
       }
       else {
-        
+
         if ($items[$delta]->value == '' || $items[$delta]->value == '{}') {
           $aggridValue = $aggridDefault['default']->rowData;
         }
         else {
           $aggridValue = json_decode($items[$delta]->value);
         }
-        
+
         $pinnedTopRowData = @$aggridDefault['addOptions']->pinnedTopRowData;
         $pinnedBottomRowData = @$aggridDefault['addOptions']->pinnedBottomRowData;
-        
+
         $aggridRowSettings = $aggridDefault['aggridRowSettings'];
 
         // Set complimentary suppression variable
@@ -309,31 +309,31 @@ class HtmlFormatterType extends FormatterBase {
 
         // Close up the headers and start on data rows.
         $table_render .= '</thead><tbody>';
-        
+
         // Pinned Top Row Settings.
         $pinnedTopRowSettings[][][] = "";
         $pinnedTopRowSettings = $aggridConfigHelpers->getRowSettings($aggridRowSettings, $headers, $pinnedTopRowData, 't-');
-        
+
         // Pinned Top Rows.
         $table_render .= $this->createAggridRowData($pinnedTopRowSettings, $columns, $headers, $pinnedTopRowData);
 
         // (Data) Row Settings.
         $rowSettings = $aggridConfigHelpers->getRowSettings($aggridRowSettings, $headers, $rowData, '');
-        
+
         // Data rows.
         $table_render .= $this->createAggridRowData($rowSettings, $columns, $headers, $rowData);
         // Set the row suppression from after the actual rowData is run
         $rowSuppression = $this->rowSuppression;
-        
+
         // Pinned Bottom Row Settings.
         $pinnedBottomRowSettings = $aggridConfigHelpers->getRowSettings($aggridRowSettings, $headers, $pinnedBottomRowData, 'b-');
-        
+
         // Pinned Bottom Rows.
         $table_render .= $this->createAggridRowData($pinnedBottomRowSettings, $columns, $headers, $pinnedBottomRowData);
-        
+
         // Close up the table.
         $table_render .= '</tbody></table>';
-        
+
         $elements[$delta]['container'] = [
           '#theme' => 'aggrid_table',
           '#title' => $this->fieldDefinition->label(),
@@ -349,7 +349,7 @@ class HtmlFormatterType extends FormatterBase {
             ],
           ],
         ];
-        
+
         /*
          * Putting this code to the side for now. They're currently working on multiple headers
          * for the '#type' => 'table'
diff --git a/src/Plugin/diff/Field/AggridFieldBuilder.php b/src/Plugin/diff/Field/AggridFieldBuilder.php
index 856600c..e472e46 100644
--- a/src/Plugin/diff/Field/AggridFieldBuilder.php
+++ b/src/Plugin/diff/Field/AggridFieldBuilder.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\aggrid\Plugin\diff\Field;
 
+use Drupal\aggrid\Entity\Aggrid;
 use Drupal\aggrid\Entity;
 use Drupal\diff\FieldDiffBuilderBase;
 use Drupal\Core\Field\FieldItemListInterface;
@@ -30,7 +31,7 @@ class AggridFieldBuilder extends FieldDiffBuilderBase {
       // Compare text formats.
       $aggridValue = json_decode($values['value']);
 
-      $aggridEntity = Entity\Aggrid::load($values['aggrid_id']);
+      $aggridEntity = Aggrid::load($values['aggrid_id']);
       $aggridDefault = json_decode($aggridEntity->get('aggridDefault'));
 
       $columns = [];
diff --git a/tests/src/Functional/AggridTableReferenceTest.php b/tests/src/Functional/AggridTableReferenceTest.php
index 5f33340..c1e43a9 100644
--- a/tests/src/Functional/AggridTableReferenceTest.php
+++ b/tests/src/Functional/AggridTableReferenceTest.php
@@ -58,7 +58,7 @@ class AggridTableReferenceTest extends BrowserTestBase {
 
     // - Under "Reference" select "other".
     // - Choose a label and click continue.
-    $this->drupalPostForm(NULL, [
+    $this->submitForm([
       'new_storage_type' => 'entity_reference',
       'field_name' => 'aggrid',
       'label' => 'ag-Grid',
@@ -66,7 +66,7 @@ class AggridTableReferenceTest extends BrowserTestBase {
     $assert->statusCodeEquals(200);
 
     // - Under configuration select "aggrid".
-    $this->drupalPostForm(NULL, [
+    $this->submitForm([
       'settings[target_type]' => 'aggrid',
     ], 'Save field settings');
     $assert->statusCodeEquals(200);
@@ -77,7 +77,8 @@ class AggridTableReferenceTest extends BrowserTestBase {
     $aggrid = Aggrid::loadMultiple();
     /* @var aggrid \Drupal\aggrid\Entity\Aggrid */
     $aggrid = reset($aggrid);
-    $this->drupalPostForm(Url::fromRoute('node.add', ['node_type' => $type->id()]), [
+    $this->drupalGet(Url::fromRoute('node.add', ['node_type' => $type->id()]));
+    $this->submitForm([
       'title[0][value]' => 'title',
       'field_aggrid[0][target_id]' => $aggrid->label(),
     ], 'Save');
diff --git a/tests/src/Functional/AggridTest.php b/tests/src/Functional/AggridTest.php
index 76a1e6e..3fcb694 100644
--- a/tests/src/Functional/AggridTest.php
+++ b/tests/src/Functional/AggridTest.php
@@ -102,16 +102,12 @@ class AggridTest extends BrowserTestBase {
     $this->clickLink('Add ag-Grid Config Entity');
     $aggrid_label = 'Test AG Table';
     $aggrid_machine_name = 'test_ag_table';
-    $this->drupalPostForm(
-      NULL,
-      [
-        'label' => $aggrid_label,
-        'id' => $aggrid_machine_name,
-        'aggridDefault' => '{}',
-        'addOptions' => '{}',
-      ],
-      'Save'
-    );
+    $this->submitForm([
+      'label' => $aggrid_label,
+      'id' => $aggrid_machine_name,
+      'aggridDefault' => '{}',
+      'addOptions' => '{}',
+    ], 'Save');
 
     // 4) Verify that our test ag table appears when we edit it.
     $this->drupalGet('/admin/structure/aggrid/' . $aggrid_machine_name .'/edit');
@@ -124,48 +120,41 @@ class AggridTest extends BrowserTestBase {
     $this->clickLink('Add ag-Grid Config Entity');
     $aggrid_machine_name = 'test_ag_table';
     $aggrid_label = 'Test AG Table';
-    $this->drupalPostForm(
-      NULL,
-      [
-        'label' => $aggrid_label,
-        'id' => $aggrid_machine_name,
-        'aggridDefault' => '{}',
-        'addOptions' => '{}',
-      ],
-      'Save'
-    );
+    $this->submitForm([
+      'label' => $aggrid_label,
+      'id' => $aggrid_machine_name,
+      'aggridDefault' => '{}',
+      'addOptions' => '{}',
+    ], 'Save');
     $this->drupalGet('/admin/structure/aggrid');
     $assert->pageTextContains($aggrid_label);
     $assert->pageTextContains($aggrid_machine_name);
+    $this->drupalGet(Url::fromRoute('entity.aggrid.add_form'));
 
     // Try to re-submit the same ag test, and verify that we see an error
     // message and not a PHP error.
-    $this->drupalPostForm(
-      Url::fromRoute('entity.aggrid.add_form'),
-      [
-        'label' => $aggrid_label,
-        'id' => $aggrid_machine_name,
-        'aggridDefault' => '{}',
-        'addOptions' => '{}',
-      ],
-      'Save'
-    );
+    $this->submitForm([
+      'label' => $aggrid_label,
+      'id' => $aggrid_machine_name,
+      'aggridDefault' => '{}',
+      'addOptions' => '{}',
+    ], 'Save');
     $assert->pageTextContains('The machine-readable name is already in use.');
 
     // 6) Verify that required links are present on respective paths.
     $this->drupalGet(Url::fromRoute('entity.aggrid.collection'));
-    $this->assertLinkByHref('/admin/structure/aggrid/add');
-    $this->assertLinkByHref('/admin/structure/aggrid/test_ag_table/edit');
-    $this->assertLinkByHref('/admin/structure/aggrid/test_ag_table/delete');
+    $this->assertSession()->linkByHrefExists('/admin/structure/aggrid/add');
+    $this->assertSession()->linkByHrefExists('/admin/structure/aggrid/test_ag_table/edit');
+    $this->assertSession()->linkByHrefExists('/admin/structure/aggrid/test_ag_table/delete');
 
     // Verify links on Add ag-Grid.
     $this->drupalGet('/admin/structure/aggrid/add');
-    $this->assertLinkByHref('/admin/structure/aggrid');
+    $this->assertSession()->linkByHrefExists('/admin/structure/aggrid');
 
     // Verify links on Edit ag-Grid.
     $this->drupalGet('/admin/structure/aggrid/test_ag_table/edit');
-    $this->assertLinkByHref('/admin/structure/aggrid/test_ag_table/delete');
-    $this->assertLinkByHref('/admin/structure/aggrid');
+    $this->assertSession()->linkByHrefExists('/admin/structure/aggrid/test_ag_table/delete');
+    $this->assertSession()->linkByHrefExists('/admin/structure/aggrid');
 
     // Verify links on Delete ag-Grid.
     $this->drupalGet('/admin/structure/aggrid/test_ag_table/delete');

diff --git a/src/Element/JQueryColorpickerElement.php b/src/Element/JQueryColorpickerElement.php
index 07147ae..20194ff 100644
--- a/src/Element/JQueryColorpickerElement.php
+++ b/src/Element/JQueryColorpickerElement.php
@@ -112,7 +112,7 @@ class JQueryColorpickerElement extends FormElement {
 
     // Since we know the background, we can then get the URL of it to pass to
     // the javascript function.
-    $background_url = file_create_url('vendor://jaypan/jquery-colorpicker/images/' . $background);
+    $background_url = \Drupal::service('file_url_generator')->generateAbsoluteString('vendor://jaypan/jquery-colorpicker/images/' . $background);
 
     // Next we determine what the default value for the form element is. This
     // will also be passed to the javascript function.
diff --git a/tests/src/Unit/Element/JQueryColorpickerTest.php b/tests/src/Unit/Element/JQueryColorpickerTest.php
index 3fc2873..a410f4c 100644
--- a/tests/src/Unit/Element/JQueryColorpickerTest.php
+++ b/tests/src/Unit/Element/JQueryColorpickerTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Test\jquery_colorpicker\Element;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Form\FormStateInterface;
 use Drupal\Tests\UnitTestCase;
 use Drupal\jquery_colorpicker\Element\JQueryColorpickerElement;
@@ -12,7 +13,7 @@ use Drupal\jquery_colorpicker\Element\JQueryColorpickerElement;
  */
 class JQueryColorpickerTest extends UnitTestCase {
 
-  use \Prophecy\PhpUnit\ProphecyTrait;
+  use ProphecyTrait;
   /**
    * @covers ::valueCallback
    *

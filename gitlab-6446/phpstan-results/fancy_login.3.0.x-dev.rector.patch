diff --git a/fancy_login.module b/fancy_login.module
index 81b807c..312a735 100644
--- a/fancy_login.module
+++ b/fancy_login.module
@@ -188,7 +188,7 @@ function fancy_login_form_alter(array &$form, FormStateInterface $form_state, $f
         'callback' => 'fancy_login_user_login_block_ajax_callback',
       ];
 
-      $form['actions']['submit-' . REQUEST_TIME] = $form['actions']['submit'];
+      $form['actions']['submit-' . \Drupal::time()->getRequestTime()] = $form['actions']['submit'];
       unset($form['actions']['submit']);
     }
   }
@@ -238,7 +238,7 @@ function fancy_login_form_alter(array &$form, FormStateInterface $form_state, $f
         'callback' => 'fancy_login_user_pass_ajax_callback',
       ];
 
-      $form['actions']['submit-' . REQUEST_TIME] = $form['actions']['submit'];
+      $form['actions']['submit-' . \Drupal::time()->getRequestTime()] = $form['actions']['submit'];
       unset($form['actions']['submit']);
     }
   }
@@ -259,7 +259,7 @@ function fancy_login_theme() {
  * Implements hook_preprocess_ssl_icon().
  */
 function fancy_login_preprocess_ssl_icon(&$variables) {
-  $variables['file_url'] = file_create_url(drupal_get_path('module', 'fancy_login') . '/images/https.png');
+  $variables['file_url'] = \Drupal::service('file_url_generator')->generateAbsoluteString(\Drupal::service('extension.list.module')->getPath('fancy_login') . '/images/https.png');
   $variables['alt'] = t('Secure Login');
   $variables['title'] = t('This login is SSL protected');
 }
diff --git a/src/Ajax/FancyLoginLoadFormCommand.php b/src/Ajax/FancyLoginLoadFormCommand.php
index 6ce08c0..929f83c 100644
--- a/src/Ajax/FancyLoginLoadFormCommand.php
+++ b/src/Ajax/FancyLoginLoadFormCommand.php
@@ -29,7 +29,7 @@ class FancyLoginLoadFormCommand implements CommandInterface {
   public function render() {
     return [
       'command' => 'fancyLoginLoadFormCommand',
-      'form' => render($this->form),
+      'form' => \Drupal::service('renderer')->render($this->form),
     ];
   }
 
diff --git a/tests/src/FunctionalJavascript/FancyLoginJavascriptTest.php b/tests/src/FunctionalJavascript/FancyLoginJavascriptTest.php
index 4e82474..e214590 100644
--- a/tests/src/FunctionalJavascript/FancyLoginJavascriptTest.php
+++ b/tests/src/FunctionalJavascript/FancyLoginJavascriptTest.php
@@ -31,7 +31,7 @@ class FancyLoginJavascriptTest extends FancyLoginJavascriptTestBase
 		$node = $this->createNode(['title' => 'Article 1', 'type' => 'article']);
 		$anonymous_role = Role::load('anonymous');
 		$this->grantPermissions($anonymous_role, ['access content']);
-		$this->drupalGet(drupal_get_path('module', 'fancy_login') . '/js/fancy_login.js');
+		$this->drupalGet(\Drupal::service('extension.list.module')->getPath('fancy_login') . '/js/fancy_login.js');
 		$this->assertStatusCodeEquals(200);
 		$this->drupalGet('/node/1');
 		$this->assertStatusCodeEquals(200);

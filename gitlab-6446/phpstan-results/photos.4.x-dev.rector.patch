diff --git a/photos_access/photos_access.module b/photos_access/photos_access.module
index 5829395..f0b4fef 100644
--- a/photos_access/photos_access.module
+++ b/photos_access/photos_access.module
@@ -268,7 +268,7 @@ function photos_access_move_files($node, $public = TRUE) {
     $old_file_wrapper = \Drupal::service('stream_wrapper_manager')->getScheme($uri) . '://';
     if ($old_file_wrapper <> $file_wrapper) {
       $new_uri = str_replace($old_file_wrapper, $file_wrapper, $uri);
-      file_move($file, $new_uri);
+      \Drupal::service('file.repository')->move($file, $new_uri);
       if ($new_scheme == 'public') {
         $pathinfo = pathinfo($uri);
         $ext = strtolower($pathinfo['extension']);
diff --git a/src/PhotosImage.php b/src/PhotosImage.php
index 57746fd..63995ad 100644
--- a/src/PhotosImage.php
+++ b/src/PhotosImage.php
@@ -136,7 +136,7 @@ class PhotosImage {
     $style->createDerivative($uri, $destination);
 
     // Return URL.
-    $url = file_create_url($destination);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($destination);
     return $url;
   }
 
@@ -153,7 +153,7 @@ class PhotosImage {
         $image_url = ImageStyle::load($style_name)->buildUrl($uri);
       }
       else {
-        $image_url = file_create_url($uri);
+        $image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
       }
     }
     else {
diff --git a/src/PhotosUpload.php b/src/PhotosUpload.php
index a0bb207..284e6a4 100644
--- a/src/PhotosUpload.php
+++ b/src/PhotosUpload.php
@@ -193,7 +193,7 @@ class PhotosUpload {
           $ext = end($filename_parts);
           if (in_array($ext, $type)) {
             $path = \Drupal::service('file_system')->createFilename(PhotosUpload::rename($image['name'], $ext), PhotosUpload::path($scheme, '', $account));
-            if ($temp_file = file_save_data($zip->getFromIndex($x), $path)) {
+            if ($temp_file = \Drupal::service('file.repository')->writeData($zip->getFromIndex($x), $path)) {
               // Update file values.
               $temp_file->pid = $value->pid;
               $temp_file->nid = $value->nid;
diff --git a/tests/src/Functional/AddPhotosAlbumImageTest.php b/tests/src/Functional/AddPhotosAlbumImageTest.php
index dcb8583..61f9539 100644
--- a/tests/src/Functional/AddPhotosAlbumImageTest.php
+++ b/tests/src/Functional/AddPhotosAlbumImageTest.php
@@ -42,7 +42,7 @@ class AddPhotosAlbumImageTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     // Create user with permissions to edit own photos.
     $this->account = $this->drupalCreateUser([
@@ -67,7 +67,7 @@ class AddPhotosAlbumImageTest extends BrowserTestBase {
     $album->save();
 
     // Get test image file.
-    $testPhotoUri = drupal_get_path('module', 'photos') . '/tests/images/photos-test-picture.jpg';
+    $testPhotoUri = \Drupal::service('extension.list.module')->getPath('photos') . '/tests/images/photos-test-picture.jpg';
     $fileSystem = \Drupal::service('file_system');
 
     // Post image upload form.
@@ -76,7 +76,8 @@ class AddPhotosAlbumImageTest extends BrowserTestBase {
       'title_0' => 'Test photo title',
       'des_0' => 'Test photos description',
     ];
-    $this->drupalPostForm('node/' . $album->id() . '/photos', $edit, 'Confirm upload');
+    $this->drupalGet('node/' . $album->id() . '/photos');
+    $this->submitForm($edit, 'Confirm upload');
 
     // Get album images.
     $photosAlbum = new PhotosAlbum($album->id());
@@ -91,7 +92,7 @@ class AddPhotosAlbumImageTest extends BrowserTestBase {
     $edit = [
       'title' => 'Test new title',
     ];
-    $this->drupalPostForm(NULL, $edit, 'Confirm changes');
+    $this->submitForm($edit, 'Confirm changes');
 
     // Confirm that image title has been updated.
     $photosImage = new PhotosImage($imageFid);
diff --git a/tests/src/Kernel/CreatePhotosAlbumTest.php b/tests/src/Kernel/CreatePhotosAlbumTest.php
index 86b0133..b0757c0 100644
--- a/tests/src/Kernel/CreatePhotosAlbumTest.php
+++ b/tests/src/Kernel/CreatePhotosAlbumTest.php
@@ -31,7 +31,7 @@ class CreatePhotosAlbumTest extends EntityKernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->installConfig(['system']);

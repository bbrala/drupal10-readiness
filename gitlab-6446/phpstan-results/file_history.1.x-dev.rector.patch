diff --git a/src/Element/FileHistory.php b/src/Element/FileHistory.php
index 6fa71ca..8895de3 100644
--- a/src/Element/FileHistory.php
+++ b/src/Element/FileHistory.php
@@ -446,7 +446,7 @@ class FileHistory extends FormElement {
     $scheme = \Drupal::service('stream_wrapper_manager')->getScheme($path);
 
     if ($scheme == 'public') {
-      $filepath = file_create_url($path);
+      $filepath = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
       return Url::fromUri($filepath);
     }
     else {
@@ -491,7 +491,7 @@ class FileHistory extends FormElement {
         $file_data_for_validation = [
           'file_original_name' => $uploaded_file->getClientOriginalName(),
           'file_original_extension' => $uploaded_file->getClientOriginalExtension(),
-          'file_size' => $uploaded_file->getClientSize(),
+          'file_size' => $uploaded_file->getSize(),
           'file_path' => $uploaded_file->getRealPath(),
         ];
 
@@ -520,7 +520,7 @@ class FileHistory extends FormElement {
       // If validation pass, we save file.
       $destination = isset($element['#upload_location']) ? $element['#upload_location'] : NULL;
 
-      \Drupal::service('file_system')->prepareDirectory($destination, \Drupal\Core\File\FileSystemInterface::CREATE_DIRECTORY);
+      \Drupal::service('file_system')->prepareDirectory($destination, FileSystemInterface::CREATE_DIRECTORY);
 
       if (!$files = file_save_upload($upload_name, $element['#upload_validators'], $destination)) {
         \Drupal::logger('file')->notice('The file upload failed. %upload', ['%upload' => $upload_name]);

diff --git a/modules/entity_hierarchy_breadcrumb/tests/src/Functional/BreadcrumbFunctionalTest.php b/modules/entity_hierarchy_breadcrumb/tests/src/Functional/BreadcrumbFunctionalTest.php
index f1876c5..f736693 100644
--- a/modules/entity_hierarchy_breadcrumb/tests/src/Functional/BreadcrumbFunctionalTest.php
+++ b/modules/entity_hierarchy_breadcrumb/tests/src/Functional/BreadcrumbFunctionalTest.php
@@ -42,7 +42,7 @@ class BreadcrumbFunctionalTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
     $this->additionalSetup();
diff --git a/modules/entity_hierarchy_breadcrumb/tests/src/Kernel/BreadcrumbTest.php b/modules/entity_hierarchy_breadcrumb/tests/src/Kernel/BreadcrumbTest.php
index 259e393..93eb142 100644
--- a/modules/entity_hierarchy_breadcrumb/tests/src/Kernel/BreadcrumbTest.php
+++ b/modules/entity_hierarchy_breadcrumb/tests/src/Kernel/BreadcrumbTest.php
@@ -43,7 +43,7 @@ class BreadcrumbTest extends EntityHierarchyKernelTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
     $user = $this->createUser([], ['view test entity']);
     $this->container->get('account_switcher')->switchTo($user);
diff --git a/modules/entity_hierarchy_microsite/entity_hierarchy_microsite.api.php b/modules/entity_hierarchy_microsite/entity_hierarchy_microsite.api.php
index 033003d..3612f7a 100644
--- a/modules/entity_hierarchy_microsite/entity_hierarchy_microsite.api.php
+++ b/modules/entity_hierarchy_microsite/entity_hierarchy_microsite.api.php
@@ -1,5 +1,9 @@
 <?php
 
+use Drupal\Core\Url;
+use Drupal\entity_hierarchy_microsite\Entity\MicrositeMenuItemOverrideInterface;
+use Drupal\entity_hierarchy_microsite\Plugin\Menu\MicrositeMenuItem;
+use Drupal\node\NodeInterface;
 /**
  * @file
  * Contains documentation for module APIs.
@@ -15,7 +19,7 @@
  * @param \Drupal\entity_hierarchy_microsite\Plugin\Menu\MicrositeMenuItem $menu_link
  *   The menu link plugin instance.
  */
-function hook_entity_hierarchy_microsite_menu_item_url_alter(\Drupal\Core\Url $url, \Drupal\entity_hierarchy_microsite\Entity\MicrositeMenuItemOverrideInterface $override, \Drupal\entity_hierarchy_microsite\Plugin\Menu\MicrositeMenuItem $menu_link) {
+function hook_entity_hierarchy_microsite_menu_item_url_alter(Url $url, MicrositeMenuItemOverrideInterface $override, MicrositeMenuItem $menu_link) {
   $attributes = $url->getOption('attributes');
   $attributes['class'] = [$override->some_field->value];
   $url->setOption('attributes', $attributes);
@@ -36,7 +40,7 @@ function hook_entity_hierarchy_microsite_links_alter($links) {
     }
     if (empty($link['options']['entity']) ||
       (!$node = $link['options']['entity']) ||
-      !$node instanceof \Drupal\node\NodeInterface ||
+      !$node instanceof NodeInterface ||
       $node->bundle() !== 'test') {
       continue;
     }
diff --git a/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeFunctionalTestBase.php b/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeFunctionalTestBase.php
index 961f307..cc8f9b4 100644
--- a/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeFunctionalTestBase.php
+++ b/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeFunctionalTestBase.php
@@ -36,7 +36,7 @@ abstract class MicrositeFunctionalTestBase extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->drupalPlaceBlock('local_actions_block');
     $this->drupalPlaceBlock('page_title_block', ['region' => 'content']);
diff --git a/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeLogoBrandingBlockTest.php b/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeLogoBrandingBlockTest.php
index 9dd0378..25feb88 100644
--- a/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeLogoBrandingBlockTest.php
+++ b/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeLogoBrandingBlockTest.php
@@ -14,7 +14,7 @@ class MicrositeLogoBrandingBlockTest extends MicrositeFunctionalTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->drupalPlaceBlock('entity_hierarchy_microsite_branding', [
       'field' => self::FIELD_NAME,
diff --git a/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeMenuBlockTest.php b/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeMenuBlockTest.php
index 8d8256b..f100d7c 100644
--- a/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeMenuBlockTest.php
+++ b/modules/entity_hierarchy_microsite/tests/src/Functional/MicrositeMenuBlockTest.php
@@ -14,7 +14,7 @@ class MicrositeMenuBlockTest extends MicrositeFunctionalTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->drupalPlaceBlock('entity_hierarchy_microsite_menu', [
       'field' => self::FIELD_NAME,
@@ -57,7 +57,7 @@ class MicrositeMenuBlockTest extends MicrositeFunctionalTestBase {
     foreach ($children as $child) {
       $this->assertNotEmpty($menu->find('named', ['link', $child->label()]));
       $assert->linkExists($child->label());
-      $xpath = $this->buildXPathQuery('//a[contains(@href, :href)]', [':href' => $child->toUrl()->toString()]);
+      $xpath = $this->assertSession()->buildXPathQuery('//a[contains(@href, :href)]', [':href' => $child->toUrl()->toString()]);
       $this->assertNotEmpty($menu->find('xpath', $xpath));
     }
   }
diff --git a/modules/entity_hierarchy_microsite/tests/src/Kernel/EntityHierarchyMicrositeKernelTestBase.php b/modules/entity_hierarchy_microsite/tests/src/Kernel/EntityHierarchyMicrositeKernelTestBase.php
index f09b618..6043539 100644
--- a/modules/entity_hierarchy_microsite/tests/src/Kernel/EntityHierarchyMicrositeKernelTestBase.php
+++ b/modules/entity_hierarchy_microsite/tests/src/Kernel/EntityHierarchyMicrositeKernelTestBase.php
@@ -31,7 +31,7 @@ abstract class EntityHierarchyMicrositeKernelTestBase extends EntityHierarchyKer
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installEntitySchema('node');
     $this->installEntitySchema('file');
diff --git a/modules/entity_hierarchy_workbench_access/tests/src/Kernel/EntityHierarchyWorkbenchAccessTest.php b/modules/entity_hierarchy_workbench_access/tests/src/Kernel/EntityHierarchyWorkbenchAccessTest.php
index 624c0bc..538a747 100644
--- a/modules/entity_hierarchy_workbench_access/tests/src/Kernel/EntityHierarchyWorkbenchAccessTest.php
+++ b/modules/entity_hierarchy_workbench_access/tests/src/Kernel/EntityHierarchyWorkbenchAccessTest.php
@@ -67,7 +67,7 @@ class EntityHierarchyWorkbenchAccessTest extends EntityHierarchyKernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     EntityKernelTestBase::setUp();
     $this->installEntitySchema(static::ENTITY_TYPE);
     $this->installEntitySchema('section_association');
diff --git a/tests/src/Functional/DeleteParentWarningTest.php b/tests/src/Functional/DeleteParentWarningTest.php
index b580e92..6be32c5 100644
--- a/tests/src/Functional/DeleteParentWarningTest.php
+++ b/tests/src/Functional/DeleteParentWarningTest.php
@@ -37,7 +37,7 @@ class DeleteParentWarningTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
     $this->additionalSetup();
diff --git a/tests/src/Functional/ForwardRevisionNodeValidationTest.php b/tests/src/Functional/ForwardRevisionNodeValidationTest.php
index 1304573..1ba66c0 100644
--- a/tests/src/Functional/ForwardRevisionNodeValidationTest.php
+++ b/tests/src/Functional/ForwardRevisionNodeValidationTest.php
@@ -45,7 +45,7 @@ class ForwardRevisionNodeValidationTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $content_type = $this->createContentType([
       'type' => 'article',
diff --git a/tests/src/Functional/HideWeightFieldFunctionalTest.php b/tests/src/Functional/HideWeightFieldFunctionalTest.php
index 8c6acad..266f664 100644
--- a/tests/src/Functional/HideWeightFieldFunctionalTest.php
+++ b/tests/src/Functional/HideWeightFieldFunctionalTest.php
@@ -39,7 +39,7 @@ class HideWeightFieldFunctionalTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
     $this->additionalSetup();
diff --git a/tests/src/Functional/ManageDisplayTest.php b/tests/src/Functional/ManageDisplayTest.php
index 7a15c9b..7f19063 100644
--- a/tests/src/Functional/ManageDisplayTest.php
+++ b/tests/src/Functional/ManageDisplayTest.php
@@ -42,7 +42,7 @@ class ManageDisplayTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
     $this->additionalSetup();
diff --git a/tests/src/Functional/ReorderChildrenContentModerationFunctionalTest.php b/tests/src/Functional/ReorderChildrenContentModerationFunctionalTest.php
index 47fe1c5..82f2fe3 100644
--- a/tests/src/Functional/ReorderChildrenContentModerationFunctionalTest.php
+++ b/tests/src/Functional/ReorderChildrenContentModerationFunctionalTest.php
@@ -45,7 +45,7 @@ class ReorderChildrenContentModerationFunctionalTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->placeBlock('local_tasks_block');
     $this->placeBlock('page_title_block');
@@ -102,7 +102,7 @@ class ReorderChildrenContentModerationFunctionalTest extends BrowserTestBase {
     }, $children));
 
     $this->drupalGet($this->parent->toUrl('edit-form'));
-    $this->drupalPostForm(NULL, [
+    $this->submitForm([
       'name[0][value]' => 'Parent - draft',
       'revision' => TRUE,
       'moderation_state[0][state]' => 'draft',
@@ -125,7 +125,7 @@ class ReorderChildrenContentModerationFunctionalTest extends BrowserTestBase {
     // Publish the draft and confirm we see same children.
     $this->drupalGet($this->parent->toUrl('edit-form'));
     $this->assertEquals('Current state Draft', $this->cssSelect('#edit-moderation-state-0-current')[0]->getText());
-    $this->drupalPostForm(NULL, [
+    $this->submitForm([
       'name[0][value]' => 'Parent - published',
       'revision' => TRUE,
       'moderation_state[0][state]' => 'published',
diff --git a/tests/src/Functional/ReorderChildrenFunctionalTest.php b/tests/src/Functional/ReorderChildrenFunctionalTest.php
index 6d1bf1c..7936cb4 100644
--- a/tests/src/Functional/ReorderChildrenFunctionalTest.php
+++ b/tests/src/Functional/ReorderChildrenFunctionalTest.php
@@ -45,7 +45,7 @@ class ReorderChildrenFunctionalTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
     $this->additionalSetup();
diff --git a/tests/src/Functional/ReorderChildrenWithRevisionsFunctionalTest.php b/tests/src/Functional/ReorderChildrenWithRevisionsFunctionalTest.php
index 340f315..a720571 100644
--- a/tests/src/Functional/ReorderChildrenWithRevisionsFunctionalTest.php
+++ b/tests/src/Functional/ReorderChildrenWithRevisionsFunctionalTest.php
@@ -79,7 +79,7 @@ class ReorderChildrenWithRevisionsFunctionalTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
     $this->additionalSetup();
diff --git a/tests/src/Kernel/AutocompleteHandlerTest.php b/tests/src/Kernel/AutocompleteHandlerTest.php
index 0139bb3..8b45a74 100644
--- a/tests/src/Kernel/AutocompleteHandlerTest.php
+++ b/tests/src/Kernel/AutocompleteHandlerTest.php
@@ -25,7 +25,7 @@ class AutocompleteHandlerTest extends EntityHierarchyKernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $user = $this->createUser([], ['view test entity']);
     $this->container->get('account_switcher')->switchTo($user);
diff --git a/tests/src/Kernel/EntityHierarchyKernelTestBase.php b/tests/src/Kernel/EntityHierarchyKernelTestBase.php
index 2201539..c89f05c 100644
--- a/tests/src/Kernel/EntityHierarchyKernelTestBase.php
+++ b/tests/src/Kernel/EntityHierarchyKernelTestBase.php
@@ -30,7 +30,7 @@ abstract class EntityHierarchyKernelTestBase extends EntityKernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installEntitySchema(static::ENTITY_TYPE);
     $this->setupEntityHierarchyField(static::ENTITY_TYPE, static::ENTITY_TYPE, static::FIELD_NAME);
diff --git a/tests/src/Unit/TreeRebuilderUnitTest.php b/tests/src/Unit/TreeRebuilderUnitTest.php
index ab9049c..9bc112c 100644
--- a/tests/src/Unit/TreeRebuilderUnitTest.php
+++ b/tests/src/Unit/TreeRebuilderUnitTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\entity_hierarchy\Unit;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\entity_hierarchy\Storage\TreeRebuilder;
 use Drupal\Tests\UnitTestCase;
@@ -13,6 +14,7 @@ use Drupal\Tests\UnitTestCase;
  */
 class TreeRebuilderUnitTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * Tests tree sort.
    *

diff --git a/kalastatic.info.yml b/kalastatic.info.yml
index 85d20af..1334aac 100644
--- a/kalastatic.info.yml
+++ b/kalastatic.info.yml
@@ -3,6 +3,6 @@ description: Drupal integration module for the Kalastatic prototyping and styleg
 package: Kalastatic
 
 type: module
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 configure: kalastatic.settings
 
diff --git a/kalastatic.module b/kalastatic.module
index b0f1992..d8210db 100644
--- a/kalastatic.module
+++ b/kalastatic.module
@@ -48,7 +48,7 @@ function kalastatic_library_info_build() {
  */
 function kalastatic_path_to_src_default() {
   $default_theme = \Drupal::config('system.theme')->get('default');
-  return drupal_get_path('theme', $default_theme) . '/kalastatic';
+  return \Drupal::service('extension.list.theme')->getPath($default_theme) . '/kalastatic';
 }
 
 /**
@@ -134,7 +134,7 @@ function kalastatic_prepare_field__image($field, $entity, $view_mode) {
       else {
         // There is no image style set in the config so let's reference the
         // original.
-        $image_url = file_create_url($image_uri);
+        $image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($image_uri);
       }
     }
     else {
diff --git a/src/Controller/KalastaticServer.php b/src/Controller/KalastaticServer.php
index 34c5f57..d251c46 100644
--- a/src/Controller/KalastaticServer.php
+++ b/src/Controller/KalastaticServer.php
@@ -75,7 +75,7 @@ class KalastaticServer extends ControllerBase {
     elseif (file_exists($this->getBuildPath() . '/index.html')){
       // Kalastatic seems to exist but the page that was requested doesn't so
       // let's throw a Drupal 404.
-      drupal_set_message(t('The requested page could not be found inside Kalastatic'), 'error');
+      $this->messenger()->addError(t('The requested page could not be found inside Kalastatic'));
       throw new NotFoundHttpException();
     }
     elseif ((isset($args[1]) && $args[1] == 'prototype') || (isset($args[2]) && $args[2] == 'styleguide')) {

diff --git a/core/connectors/InstapageCmsPluginDrupal7Connector.php b/core/connectors/InstapageCmsPluginDrupal7Connector.php
index a3924ac..d8004b5 100644
--- a/core/connectors/InstapageCmsPluginDrupal7Connector.php
+++ b/core/connectors/InstapageCmsPluginDrupal7Connector.php
@@ -60,9 +60,9 @@ function instapage_cms_plugin_uninstall() {
  * Drupal 7 hook. Function called to load plugin's dashboard.
  */
 function load_instapage_cms_plugin_dashboard() {
-  $jsDir = base_path() . drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/js';
-  $knockoutDir = base_path() . drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/knockout';
-  $languageFile = base_path() . drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/lang/' . InstapageCmsPluginConnector::getSelectedLanguage() . '.js';
+  $jsDir = base_path() . \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/js';
+  $knockoutDir = base_path() . \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/knockout';
+  $languageFile = base_path() . \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/lang/' . InstapageCmsPluginConnector::getSelectedLanguage() . '.js';
   $options = array(
     'scope' => 'footer',
     'group' => JS_LIBRARY,
@@ -124,7 +124,7 @@ function load_instapage_cms_plugin_dashboard() {
   drupal_add_js($jsDir . '/tabs.js', $options);
 
   $options = array('preprocess' => 'false');
-  $cssDir = drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/css';
+  $cssDir = \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/css';
   drupal_add_css($cssDir . '/mrwhite-reset.css', $options);
   drupal_add_css($cssDir . '/mrwhite-ui-kit.css', $options);
   drupal_add_css($cssDir . '/general.css', $options);
@@ -254,7 +254,7 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      db_query($sql, $args);
+      \Drupal::database()->query($sql, $args);
 
       return true;
     } catch (Exception $e) {
@@ -290,7 +290,7 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      $result = db_query($sql, $args);
+      $result = \Drupal::database()->query($sql, $args);
 
       return $result->fetchObject();
     } catch (Exception $e) {
@@ -314,7 +314,7 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      $result = db_query($sql, $args);
+      $result = \Drupal::database()->query($sql, $args);
       $resultArray = $result->fetchAll(PDO::FETCH_OBJ);
 
       if (!is_array($resultArray)) {
diff --git a/core/connectors/InstapageCmsPluginDrupal8Connector.php b/core/connectors/InstapageCmsPluginDrupal8Connector.php
index 6a9ae53..6fb6416 100644
--- a/core/connectors/InstapageCmsPluginDrupal8Connector.php
+++ b/core/connectors/InstapageCmsPluginDrupal8Connector.php
@@ -1,5 +1,7 @@
 <?php
 
+use GuzzleHttp\Cookie\CookieJar;
+use Drupal\Component\Utility\Html;
 use Drupal\Core\Database\Database as Database;
 
 /**
@@ -260,7 +262,7 @@ class InstapageCmsPluginDrupal8Connector {
 
       if (!empty($cookies)) {
         $domain = parse_url($url, PHP_URL_HOST);
-        $cookieJar = \GuzzleHttp\Cookie\CookieJar::fromArray($cookies, $domain);
+        $cookieJar = CookieJar::fromArray($cookies, $domain);
       }
 
       $client = \Drupal::httpClient();
@@ -705,7 +707,7 @@ class InstapageCmsPluginDrupal8Connector {
    * @return string Escaped HTML.
    */
   public function escapeHTML($html) {
-    return \Drupal\Component\Utility\Html::escape($html);
+    return Html::escape($html);
   }
 
   /**
diff --git a/src/EventSubscriber/InstapagePluginSubscriber.php b/src/EventSubscriber/InstapagePluginSubscriber.php
index e2d96ea..58f5dcc 100755
--- a/src/EventSubscriber/InstapagePluginSubscriber.php
+++ b/src/EventSubscriber/InstapagePluginSubscriber.php
@@ -2,10 +2,9 @@
 
 namespace Drupal\instapage_cms_plugin\EventSubscriber;
 
+use Symfony\Component\HttpKernel\Event\ResponseEvent;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
 use Symfony\Component\HttpKernel\KernelEvents;
-use Symfony\Component\HttpKernel\Event\GetResponseEvent;
-use Symfony\Component\HttpKernel\Event\FilterResponseEvent;
 
 /**
  * Class needed to display custom 404 page in Drupal 8.
@@ -28,7 +27,7 @@ class InstapagePluginSubscriber implements EventSubscriberInterface {
    *
    * @param object $event Event object.
    */
-  public function onKernelResponse(FilterResponseEvent $event) {
+  public function onKernelResponse(ResponseEvent $event) {
 
     if (!$event->isMasterRequest()) {
       return;

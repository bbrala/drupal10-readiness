diff --git a/elasticsearch_connector.module b/elasticsearch_connector.module
index fa50959..1947183 100644
--- a/elasticsearch_connector.module
+++ b/elasticsearch_connector.module
@@ -107,8 +107,8 @@ function _elasticsearch_ec_clusters_process(array $element, array &$form_state,
  */
 function _elasticsearch_ec_index_attached() {
   return array(
-    'js' => array(drupal_get_path('module', 'elasticsearch') . '/js/ec-index.js'),
-    'css' => array(drupal_get_path('module', 'elasticsearch') . '/css/ec-index.css'),
+    'js' => array(\Drupal::service('extension.list.module')->getPath('elasticsearch') . '/js/ec-index.js'),
+    'css' => array(\Drupal::service('extension.list.module')->getPath('elasticsearch') . '/css/ec-index.css'),
     'library' => array(array('system', 'ui.dialog')),
   );
 }
@@ -350,7 +350,7 @@ function elasticsearch_connector_redirect_page($cluster, $index_name) {
   // Add appropriate javascript that will be used by the parent page to fill in
   // the required data.
   if (elasticsearch_in_dialog() && isset($_GET['elasticsearch-dialog-close'])) {
-    drupal_add_js(drupal_get_path('module', 'elasticsearch') . '/js/ec-index-child.js');
+    drupal_add_js(\Drupal::service('extension.list.module')->getPath('elasticsearch') . '/js/ec-index-child.js');
     drupal_add_js(
       array(
         'elasticsearch' =>
diff --git a/src/Event/BuildIndexParamsEvent.php b/src/Event/BuildIndexParamsEvent.php
index b737ca6..4772d4b 100644
--- a/src/Event/BuildIndexParamsEvent.php
+++ b/src/Event/BuildIndexParamsEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\elasticsearch_connector\Event;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class BuildIndexParamsEvent
diff --git a/src/Event/BuildSearchParamsEvent.php b/src/Event/BuildSearchParamsEvent.php
index fb0bd03..ae80456 100644
--- a/src/Event/BuildSearchParamsEvent.php
+++ b/src/Event/BuildSearchParamsEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\elasticsearch_connector\Event;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class BuildSearchParamsEvent
diff --git a/src/Event/PrepareIndexEvent.php b/src/Event/PrepareIndexEvent.php
index 1296cba..fe30a6c 100644
--- a/src/Event/PrepareIndexEvent.php
+++ b/src/Event/PrepareIndexEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\elasticsearch_connector\Event;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class PrepareIndexEvent
diff --git a/src/Event/PrepareIndexMappingEvent.php b/src/Event/PrepareIndexMappingEvent.php
index 0cf01cb..1a97974 100644
--- a/src/Event/PrepareIndexMappingEvent.php
+++ b/src/Event/PrepareIndexMappingEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\elasticsearch_connector\Event;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class PrepareIndexMappingEvent
diff --git a/src/Event/PrepareMappingEvent.php b/src/Event/PrepareMappingEvent.php
index def819e..571b44b 100644
--- a/src/Event/PrepareMappingEvent.php
+++ b/src/Event/PrepareMappingEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\elasticsearch_connector\Event;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class PrepareMappingEvent
diff --git a/src/Event/PrepareSearchQueryEvent.php b/src/Event/PrepareSearchQueryEvent.php
index 326cc33..0ff1218 100644
--- a/src/Event/PrepareSearchQueryEvent.php
+++ b/src/Event/PrepareSearchQueryEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\elasticsearch_connector\Event;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class PrepareSearchQueryEvent
diff --git a/tests/src/Unit/ClusterManagerTest.php b/tests/src/Unit/ClusterManagerTest.php
index 32ce378..907169e 100644
--- a/tests/src/Unit/ClusterManagerTest.php
+++ b/tests/src/Unit/ClusterManagerTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Entity\EntityStorageInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\Core\State\StateInterface;
@@ -16,6 +17,7 @@ use Drupal\Tests\UnitTestCase;
  */
 class ClusterManagerTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * An instance of ClusterManager
    *
@@ -26,7 +28,7 @@ class ClusterManagerTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $state = $this->prophesize(StateInterface::class);
diff --git a/tests/src/Unit/ElasticSearch/ClientManagerTest.php b/tests/src/Unit/ElasticSearch/ClientManagerTest.php
index cb8e429..67de872 100644
--- a/tests/src/Unit/ElasticSearch/ClientManagerTest.php
+++ b/tests/src/Unit/ElasticSearch/ClientManagerTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit\ElasticSearch;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Extension\ModuleHandlerInterface;
 use Drupal\elasticsearch_connector\ElasticSearch\ClientManager;
 use Drupal\elasticsearch_connector\Entity\Cluster;
@@ -17,6 +18,7 @@ use Prophecy\Argument;
  */
 class ClientManagerTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * An instance of ClientManager
    *
@@ -27,7 +29,7 @@ class ClientManagerTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $module_handler = $this->prophesize(ModuleHandlerInterface::class);
diff --git a/tests/src/Unit/ElasticSearch/Parameters/Builder/SearchBuilderTest.php b/tests/src/Unit/ElasticSearch/Parameters/Builder/SearchBuilderTest.php
index 8f28f58..c4f25b3 100644
--- a/tests/src/Unit/ElasticSearch/Parameters/Builder/SearchBuilderTest.php
+++ b/tests/src/Unit/ElasticSearch/Parameters/Builder/SearchBuilderTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit\ElasticSearch\Parameters\Builder;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\search_api\IndexInterface;
 use Drupal\search_api\Query\QueryInterface;
 use Drupal\Tests\UnitTestCase;
@@ -14,6 +15,7 @@ use Drupal\elasticsearch_connector\ElasticSearch\Parameters\Builder\SearchBuilde
  */
 class SearchBuilderTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * An instance of the SearchBuilder class.
    *
@@ -24,7 +26,7 @@ class SearchBuilderTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $index = $this->prophesize(IndexInterface::class);
diff --git a/tests/src/Unit/ElasticSearch/Parameters/Factory/FilterFactoryTest.php b/tests/src/Unit/ElasticSearch/Parameters/Factory/FilterFactoryTest.php
index d040b81..2bbaba5 100644
--- a/tests/src/Unit/ElasticSearch/Parameters/Factory/FilterFactoryTest.php
+++ b/tests/src/Unit/ElasticSearch/Parameters/Factory/FilterFactoryTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit\ElasticSearch\Parameters\Factory;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\search_api\Query\Condition;
 use Drupal\Tests\UnitTestCase;
 use Drupal\elasticsearch_connector\ElasticSearch\Parameters\Factory\FilterFactory;
@@ -18,6 +19,7 @@ use Drupal\elasticsearch_connector\ElasticSearch\Parameters\Factory\FilterFactor
  */
 class FilterFactoryTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * @covers ::filterFromCondition
    */
diff --git a/tests/src/Unit/ElasticSearch/Parameters/Factory/MappingFactoryTest.php b/tests/src/Unit/ElasticSearch/Parameters/Factory/MappingFactoryTest.php
index 28b45c3..85a7bde 100644
--- a/tests/src/Unit/ElasticSearch/Parameters/Factory/MappingFactoryTest.php
+++ b/tests/src/Unit/ElasticSearch/Parameters/Factory/MappingFactoryTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit\ElasticSearch\Parameters\Factory;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\search_api\Item\FieldInterface;
 use Drupal\Tests\UnitTestCase;
 use Drupal\elasticsearch_connector\ElasticSearch\Parameters\Factory\MappingFactory;
@@ -13,6 +14,7 @@ use Drupal\elasticsearch_connector\ElasticSearch\Parameters\Factory\MappingFacto
  */
 class MappingFactoryTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * @covers ::mappingFromField
    */
diff --git a/tests/src/Unit/Entity/ClusterRouteProviderTest.php b/tests/src/Unit/Entity/ClusterRouteProviderTest.php
index b6ddbef..b181488 100644
--- a/tests/src/Unit/Entity/ClusterRouteProviderTest.php
+++ b/tests/src/Unit/Entity/ClusterRouteProviderTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit\Entity;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Entity\EntityTypeInterface;
 use Drupal\Tests\UnitTestCase;
 use Drupal\elasticsearch_connector\Entity\ClusterRouteProvider;
@@ -13,6 +14,7 @@ use Drupal\elasticsearch_connector\Entity\ClusterRouteProvider;
  */
 class ClusterRouteProviderTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * @covers ::getRoutes
    */
diff --git a/tests/src/Unit/Entity/IndexRouteProviderTest.php b/tests/src/Unit/Entity/IndexRouteProviderTest.php
index 454e115..c9598ac 100644
--- a/tests/src/Unit/Entity/IndexRouteProviderTest.php
+++ b/tests/src/Unit/Entity/IndexRouteProviderTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\Tests\elasticsearch_connector\Unit\Entity;
 
+use Prophecy\PhpUnit\ProphecyTrait;
 use Drupal\Core\Entity\EntityTypeInterface;
 use Drupal\Tests\UnitTestCase;
 use Drupal\elasticsearch_connector\Entity\IndexRouteProvider;
@@ -13,6 +14,7 @@ use Drupal\elasticsearch_connector\Entity\IndexRouteProvider;
  */
 class IndexRouteProviderTest extends UnitTestCase {
 
+  use ProphecyTrait;
   /**
    * @covers ::getRoutes
    */

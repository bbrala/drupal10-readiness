diff --git a/clear_base64_image.info.yml b/clear_base64_image.info.yml
index 4d84803..42bbaa9 100644
--- a/clear_base64_image.info.yml
+++ b/clear_base64_image.info.yml
@@ -1,5 +1,5 @@
 name: Clear Base64 Image
 type: module
 description: Module for converting base64 images to png or jpeg file
-core_version_requirement: ^9
+core_version_requirement: ^9.3 || ^10
 configure: clear_base64_image.manage
diff --git a/src/Controller/clear_base64_imageController.php b/src/Controller/clear_base64_imageController.php
index 1dc5d13..cd8849b 100644
--- a/src/Controller/clear_base64_imageController.php
+++ b/src/Controller/clear_base64_imageController.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\clear_base64_image\Controller;
 
+use Drupal\Core\File\FileSystemInterface;
 use Drupal\Core\Url;
 use Drupal\Core\Link;
 use Drupal\Core\Controller\ControllerBase;
@@ -101,7 +102,7 @@ class clear_base64_imageController extends ControllerBase {
     $directory = "public://". \Drupal::config('clear_base64_image.settings')->get('directory');
     $getImgType = \Drupal::config('clear_base64_image.settings')->get('type');
 
-    $file_exists = \Drupal\Core\File\FileSystemInterface::EXISTS_REPLACE;
+    $file_exists = FileSystemInterface::EXISTS_REPLACE;
 
     //Get base64 image
     $results = $this->getImgDatabase();
@@ -156,7 +157,7 @@ class clear_base64_imageController extends ControllerBase {
              //$new_file = [IF image don't have title] ? [THEN generate image with a part of base64] : [ELSE generate image with the title];
              $new_file = empty($imgTitle) ? $directory.$node->nid->value . '-' . substr($linkHref, 120, 10) . '-' . $date . '.'. $mime_type : $directory.$imgTitle.'.'. $mime_type;
              
-              file_save_data($decode, $new_file, $file_exists);
+              \Drupal::service('file.repository')->writeData($decode, $new_file, $file_exists);
               $ArrayFiles[$count][$nid] = $new_file;
               $ArrayFiles[$count]['src'] = $imgSrc;
 

diff --git a/src/Services/ActivityPubMediaCache.php b/src/Services/ActivityPubMediaCache.php
index e2b444a..1b77e3b 100644
--- a/src/Services/ActivityPubMediaCache.php
+++ b/src/Services/ActivityPubMediaCache.php
@@ -72,11 +72,11 @@ class ActivityPubMediaCache implements ActivityPubMediaCacheInterface {
           $filename = $style->buildUrl($filename);
         }
         else {
-          $filename = file_create_url($filename);
+          $filename = \Drupal::service('file_url_generator')->generateAbsoluteString($filename);
         }
       }
       else {
-        $filename = file_create_url($filename);
+        $filename = \Drupal::service('file_url_generator')->generateAbsoluteString($filename);
       }
     }
 
diff --git a/src/Services/ActivityPubUtility.php b/src/Services/ActivityPubUtility.php
index b5c049f..83a978e 100644
--- a/src/Services/ActivityPubUtility.php
+++ b/src/Services/ActivityPubUtility.php
@@ -122,9 +122,9 @@ class ActivityPubUtility implements ActivityPubUtilityInterface {
     else {
       $avatar_path = activitypub_default_avatar_path();
       if ($avatar_path == 'assets/avatar.png') {
-        $avatar_path = drupal_get_path('module', 'activitypub') . '/' . $avatar_path;
+        $avatar_path = \Drupal::service('extension.list.module')->getPath('activitypub') . '/' . $avatar_path;
       }
-      $image_url = file_create_url($avatar_path);
+      $image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($avatar_path);
     }
 
     return $image_url;
diff --git a/src/Services/Type/TypePluginBase.php b/src/Services/Type/TypePluginBase.php
index 093550b..5264c1f 100644
--- a/src/Services/Type/TypePluginBase.php
+++ b/src/Services/Type/TypePluginBase.php
@@ -245,7 +245,7 @@ abstract class TypePluginBase extends PluginBase implements TypePluginInterface,
       return $image_style->buildUrl($file->getFileUri());
     }
     else {
-      return file_create_url($file->getFileUri());
+      return \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri());
     }
   }
 

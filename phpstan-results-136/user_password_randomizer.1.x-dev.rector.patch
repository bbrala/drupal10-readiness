diff --git a/src/UserPasswordRandomizer.php b/src/UserPasswordRandomizer.php
index a94ee94..402469b 100644
--- a/src/UserPasswordRandomizer.php
+++ b/src/UserPasswordRandomizer.php
@@ -77,7 +77,7 @@ class UserPasswordRandomizer implements UserPasswordRandomizerInterface {
       else {
         // When pattern is empty we generate a random (not cryptographically
         // secure) string.
-        $newUsername = user_password(16);
+        $newUsername = \Drupal::service('password_generator')->generate(16);
       }
     } while ($countUsers($newUsername) > 0);
 
@@ -90,7 +90,7 @@ class UserPasswordRandomizer implements UserPasswordRandomizerInterface {
   public function generatePassword(UserInterface $user): string {
     // @todo Replace user_password() with password component.
     // @see https://www.drupal.org/project/drupal/issues/3153085
-    return \user_password(16);
+    return \Drupal::service('password_generator')->generate(16);
   }
 
 }
diff --git a/tests/src/Unit/RandomizerJobExecutorTest.php b/tests/src/Unit/RandomizerJobExecutorTest.php
index 2062748..6fa3c49 100644
--- a/tests/src/Unit/RandomizerJobExecutorTest.php
+++ b/tests/src/Unit/RandomizerJobExecutorTest.php
@@ -20,6 +20,7 @@ namespace Drupal\Tests\user_password_randomizer\Unit {
    */
   class RandomizerJobExecutorTest extends UnitTestCase {
 
+    use \Prophecy\PhpUnit\ProphecyTrait;
     /**
      * @covers ::execute
      */
diff --git a/user_password_randomizer.info.yml b/user_password_randomizer.info.yml
index 28e4313..99c0ecb 100644
--- a/user_password_randomizer.info.yml
+++ b/user_password_randomizer.info.yml
@@ -1,6 +1,6 @@
 name: 'User Password Randomizer'
 type: module
 description: 'Prevents password based logins by uid 1.'
-core_version_requirement: ^8.9 || ^9
+core_version_requirement: ^9.1 || ^10
 php: 7.3
 configure: user_password_randomizer.settings

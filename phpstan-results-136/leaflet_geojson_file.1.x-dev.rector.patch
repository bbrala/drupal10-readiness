diff --git a/leaflet_geojson_file.info.yml b/leaflet_geojson_file.info.yml
index 5adf162..fa53b61 100644
--- a/leaflet_geojson_file.info.yml
+++ b/leaflet_geojson_file.info.yml
@@ -1,7 +1,7 @@
 type: module
 name: Leaflet GeoJSON File
 description: 'Display and edit GeoJSON data from a file field.'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 dependencies:
   - drupal:field
   - leaflet:leaflet
diff --git a/leaflet_geojson_file.module b/leaflet_geojson_file.module
index d4c0d32..c948ad2 100644
--- a/leaflet_geojson_file.module
+++ b/leaflet_geojson_file.module
@@ -58,7 +58,7 @@ function leaflet_geojson_file_entity_insert(EntityInterface $entity) {
           $file_system = \Drupal::service('file_system');
 
           $destination = str_replace($entity->uuid(), $entity->id(), $file->getFileUri());
-          $file_new = file_move($file, $destination, FileSystemInterface::EXISTS_REPLACE);
+          $file_new = \Drupal::service('file.repository')->move($file, $destination, FileSystemInterface::EXISTS_REPLACE);
           $name = $file_system->basename($destination);
           $file_new->setFilename($name);
           $file_new->save();
diff --git a/src/LeafletGeoJsonService.php b/src/LeafletGeoJsonService.php
index e021396..69adb93 100644
--- a/src/LeafletGeoJsonService.php
+++ b/src/LeafletGeoJsonService.php
@@ -68,7 +68,7 @@ class LeafletGeoJsonService extends LeafletService {
       /** @var \Drupal\Core\Url $file_uri */
       $file_uri = Url::fromUri($file->url());
       $file_uri->setOption('query', ['v' => $entity->getRevisionId()]);
-      return file_url_transform_relative($file_uri->toUriString());
+      return \Drupal::service('file_url_generator')->transformRelative($file_uri->toUriString());
 
     }
   }
diff --git a/src/Plugin/Field/FieldWidget/LeafletGeoJsonWidget.php b/src/Plugin/Field/FieldWidget/LeafletGeoJsonWidget.php
index a06a58b..beb3743 100644
--- a/src/Plugin/Field/FieldWidget/LeafletGeoJsonWidget.php
+++ b/src/Plugin/Field/FieldWidget/LeafletGeoJsonWidget.php
@@ -226,7 +226,7 @@ class LeafletGeoJsonWidget extends FileWidget {
         $fid = $value['fids']['0'];
         /** @var \Drupal\file\Entity\File $file */
         $file = File::load($fid);
-        file_save_data($data, $file->getFileUri(), FileSystemInterface::EXISTS_REPLACE);
+        \Drupal::service('file.repository')->writeData($data, $file->getFileUri(), FileSystemInterface::EXISTS_REPLACE);
       }
       else {
         if ($form_state->getFormObject() instanceof EntityFormInterface) {
@@ -246,7 +246,7 @@ class LeafletGeoJsonWidget extends FileWidget {
           $destination = $stream_wrapper->getUri() . $directory . '/' . $entity->uuid() . '-' . $field_name . '.json';
           $dirname = $file_system->dirname($destination);
           $file_system->prepareDirectory($dirname, FileSystemInterface::CREATE_DIRECTORY);
-          $file = file_save_data($value['geojson_input'], $destination, FileSystemInterface::EXISTS_REPLACE);
+          $file = \Drupal::service('file.repository')->writeData($value['geojson_input'], $destination, FileSystemInterface::EXISTS_REPLACE);
           if ($file) {
             $values['fids'][] = $file->id();
             NestedArray::setValue($form_state->getValues(), $element['#parents'], $values);

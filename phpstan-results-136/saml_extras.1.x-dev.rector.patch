diff --git a/composer.json b/composer.json
index 4059245..10ccb0b 100644
--- a/composer.json
+++ b/composer.json
@@ -41,7 +41,7 @@
         "source": "https://git.drupalcode.org/project/saml_extras"
     },
     "require": {
-        "drupal/core": "^8 || ^9",
-        "drupal/simplesamlphp_auth": "*"
+        "drupal/simplesamlphp_auth": "*",
+        "drupal/core": "^9.3 || ^10"
     }
 }
diff --git a/saml_extras.info.yml b/saml_extras.info.yml
index 0a799ec..473ce4e 100644
--- a/saml_extras.info.yml
+++ b/saml_extras.info.yml
@@ -1,8 +1,7 @@
 name: 'SAML Extras'
 description: 'Allows you to map user fields based on SimpleSAML attributes.'
 type: 'module'
-core: '8.x'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 configure: 'saml_extras.settings'
 dependencies:
   - simplesamlphp_auth:simplesamlphp_auth
diff --git a/saml_extras.module b/saml_extras.module
index a2eda44..d14dcd8 100644
--- a/saml_extras.module
+++ b/saml_extras.module
@@ -100,7 +100,7 @@ function saml_extras_simplesamlphp_auth_user_attributes(UserInterface $account,
         $directory = 'private://users';
         \Drupal::service('file_system')->prepareDirectory($directory, FileSystemInterface::CREATE_DIRECTORY);
 
-        $file = file_save_data($data, $directory . '/' . $file_name . '.' . $ext, FileSystemInterface::EXISTS_REPLACE);
+        $file = \Drupal::service('file.repository')->writeData($data, $directory . '/' . $file_name . '.' . $ext, FileSystemInterface::EXISTS_REPLACE);
 
         $value = [
           'target_id' => $file->id(),
diff --git a/tests/src/Functional/SamlExtrasSettingsFormTest.php b/tests/src/Functional/SamlExtrasSettingsFormTest.php
index e3678eb..d291000 100644
--- a/tests/src/Functional/SamlExtrasSettingsFormTest.php
+++ b/tests/src/Functional/SamlExtrasSettingsFormTest.php
@@ -27,7 +27,7 @@ class SamlExtrasSettingsFormTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $account = $this->drupalCreateUser(['access saml extras configuration']);
     $this->drupalLogin($account);

modules/contrib/loco_translate/inc/cron_pull.inc
modules/contrib/loco_translate/inc/cron_push.inc
modules/contrib/loco_translate/loco_translate.install
modules/contrib/loco_translate/loco_translate.module
modules/contrib/loco_translate/src/Commands/PullCommand.php
modules/contrib/loco_translate/src/Commands/PushCommand.php
modules/contrib/loco_translate/src/Controller/OverviewController.php
modules/contrib/loco_translate/src/Exception/LocoApiException.php
modules/contrib/loco_translate/src/Exception/LocoTranslateException.php
modules/contrib/loco_translate/src/Form/PullForm.php
modules/contrib/loco_translate/src/Form/SettingsForm.php
modules/contrib/loco_translate/src/Loco/ApiClientFactory.php
modules/contrib/loco_translate/src/Loco/Pull.php
modules/contrib/loco_translate/src/Loco/Push.php
modules/contrib/loco_translate/src/TranslationsImport.php
modules/contrib/loco_translate/src/TwigExtension/LocoExport.php
modules/contrib/loco_translate/src/Utility.php
modules/contrib/loco_translate/tests/src/Functional/OverviewControllerTest.php
modules/contrib/loco_translate/tests/src/Functional/PullFormTest.php
modules/contrib/loco_translate/tests/src/Kernel/Cron/CronPullTest.php
modules/contrib/loco_translate/tests/src/Kernel/Cron/CronPushTest.php
modules/contrib/loco_translate/tests/src/Kernel/PullCommandTest.php
modules/contrib/loco_translate/tests/src/Kernel/TranslationsImportTest.php
modules/contrib/loco_translate/tests/src/Kernel/TranslationsTest.php
modules/contrib/loco_translate/tests/src/Kernel/TranslationsTestsBase.php
modules/contrib/loco_translate/tests/src/Unit/LocoPullTest.php
modules/contrib/loco_translate/tests/src/Unit/LocoPushTest.php
modules/contrib/loco_translate/tests/src/Unit/UtilityTest.php
modules/contrib/loco_translate/tests/src/Unit/UtilityTestBase.php

10 files with changes
=====================

1) modules/contrib/loco_translate/tests/src/Unit/UtilityTestBase.php:12

    ---------- begin diff ----------
@@ @@
  */
 abstract class UtilityTestBase extends UnitTestCase {

+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * The Utility service of Loco Translate.
    *
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


2) modules/contrib/loco_translate/tests/src/Unit/LocoPushTest.php:16

    ---------- begin diff ----------
@@ @@
  */
 class LocoPushTest extends UnitTestCase {

+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * Uploader to Loco.
    *
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ExplicitPhpErrorApiRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


3) modules/contrib/loco_translate/tests/src/Unit/LocoPullTest.php:19

    ---------- begin diff ----------
@@ @@
  */
 class LocoPullTest extends UnitTestCase {

+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * The Loco translations pull manager.
    *
    ----------- end diff -----------

Applied rules:
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ExplicitPhpErrorApiRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/loco_translate/tests/src/Kernel/TranslationsImportTest.php:46

    ---------- begin diff ----------
@@ @@
     $this->translationsImport = $this->container->get('loco_translate.translations.import');

     /** @var string $translationsPath */
-    $this->translationsPath = drupal_get_path('module', 'loco_translate_test') . DIRECTORY_SEPARATOR . 'assets';
+    $this->translationsPath = \Drupal::service('extension.list.module')->getPath('loco_translate_test') . DIRECTORY_SEPARATOR . 'assets';
   }

   /**
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ExceptionAnnotationRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ExplicitPhpErrorApiRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/loco_translate/tests/src/Kernel/PullCommandTest.php:11

    ---------- begin diff ----------
@@ @@
  */
 final class PullCommandTest extends TranslationsTestsBase {

+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * {@inheritdoc}
    */
@@ @@
    */
   public function testPull(): void {
     // Mock the Loco Response export response.
-    $data = file_get_contents(drupal_get_path('module', 'loco_translate_test') . '/responses/export-200.po');
+    $data = file_get_contents(\Drupal::service('extension.list.module')->getPath('loco_translate_test') . '/responses/export-200.po');
     $response = new Response(200, [], $data);
     $response = RawResult::fromResponse($response);
     $this->locoPull->fromLocoToDrupal('en', NULL, NULL)
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * AssertEqualsParameterToSpecificMethodsTypeRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/loco_translate/tests/src/Kernel/Cron/CronPushTest.php:16

    ---------- begin diff ----------
@@ @@
  */
 class CronPushTest extends KernelTestBase {

+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * The directory of tests .po files.
    *
@@ @@
     $this->cronConfig = \Drupal::configFactory()->getEditable('loco_translate.settings');

     /** @var string $translationsPath */
-    $this->translationsPath = drupal_get_path('module', 'loco_translate_test') . DIRECTORY_SEPARATOR . 'assets';
+    $this->translationsPath = \Drupal::service('extension.list.module')->getPath('loco_translate_test') . DIRECTORY_SEPARATOR . 'assets';

     // Save the default push configurations.
     $this->cronConfig->set('automation.push.interval', 3600)->save();
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/loco_translate/tests/src/Kernel/Cron/CronPullTest.php:20

    ---------- begin diff ----------
@@ @@
  */
 class CronPullTest extends KernelTestBase {

+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * An editable config object for access to 'loco_translate.settings'.
    *
@@ @@
    * @dataProvider goodIntervalProvider
    */
   public function testCronPullGoodInterval($langcode, $last_run, $interval) {
-    $data = file_get_contents(drupal_get_path('module', 'loco_translate_test') . '/responses/export-200.po');
+    $data = file_get_contents(\Drupal::service('extension.list.module')->getPath('loco_translate_test') . '/responses/export-200.po');
     $response = new Response(200, [], $data);
     $response = RawResult::fromResponse($response);

@@ @@
       ->set('translation.path', '')
       ->save();

-    $data = file_get_contents(drupal_get_path('module', 'loco_translate_test') . '/responses/export-200.po');
+    $data = file_get_contents(\Drupal::service('extension.list.module')->getPath('loco_translate_test') . '/responses/export-200.po');
     $response = new Response(200, [], $data);
     $response = RawResult::fromResponse($response);

@@ @@
       ->set('translation.path', '')
       ->save();

-    $data = file_get_contents(drupal_get_path('module', 'loco_translate_test') . '/responses/export-200.po');
+    $data = file_get_contents(\Drupal::service('extension.list.module')->getPath('loco_translate_test') . '/responses/export-200.po');
     $response = new Response(200, [], $data);
     $response = RawResult::fromResponse($response);
    ----------- end diff -----------

Applied rules:
 * DrupalGetPathRector
 * ExceptionAnnotationRector
 * AddProphecyTraitRector
 * RemoveDataProviderTestPrefixRector
 * ExplicitPhpErrorApiRector
 * ArgumentRemoverRector
 * RenameAnnotationRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


8) modules/contrib/loco_translate/src/Form/PullForm.php:163

    ---------- begin diff ----------
@@ @@
         }

         /** @var \Drupal\file\FileInterface $file */
-        $file = file_save_data($response->__toString(), $destination_directory);
+        $file = \Drupal::service('file.repository')->writeData($response->__toString(), $destination_directory);
         $form_state->setValue('files[' . $langcode . ']', $this->fileSystem->realPath($file->getFileUri()));
       }
       catch (\Exception $e) {
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


9) modules/contrib/loco_translate/src/Commands/PullCommand.php:94

    ---------- begin diff ----------
@@ @@
     }

     /** @var \Drupal\file\FileInterface $file */
-    $file = file_save_data($response->__toString(), $destination_directory);
+    $file = \Drupal::service('file.repository')->writeData($response->__toString(), $destination_directory);

     // Be sure the file is temporary, so will be garbage collected.
     $file->setTemporary();
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * ArgumentRemoverRector
 * PseudoNamespaceToNamespaceRector
 * WrapReturnRector
 * AddParamTypeDeclarationRector
 * ChangeMethodVisibilityRector


10) modules/contrib/loco_translate/inc/cron_pull.inc:34

    ---------- begin diff ----------
@@ @@
   }

   /** @var \Drupal\file\FileInterface $file */
-  $file = file_save_data($response->__toString(), $destination_directory);
+  $file = \Drupal::service('file.repository')->writeData($response->__toString(), $destination_directory);
   $path = $file_system->realPath($file->getFileUri());
   $report = $translations_import->fromFile($path, $langcode);
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * ArgumentRemoverRector


 [OK] 10 files have been changed by Rector                                      


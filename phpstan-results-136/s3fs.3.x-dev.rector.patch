diff --git a/src/Asset/S3fsCssOptimizer.php b/src/Asset/S3fsCssOptimizer.php
index cdae2d1..2fa6583 100644
--- a/src/Asset/S3fsCssOptimizer.php
+++ b/src/Asset/S3fsCssOptimizer.php
@@ -63,7 +63,7 @@ class S3fsCssOptimizer extends CssOptimizer {
       $url = $this->fileUrlGenerator->generateAbsoluteString($path);
     }
     else {
-      $url = file_create_url($path);
+      $url = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
     }
 
     if ($useCssjsHost && !empty($cssjsHost)) {
diff --git a/src/S3fsFileService.php b/src/S3fsFileService.php
index b0d4e15..4599e51 100644
--- a/src/S3fsFileService.php
+++ b/src/S3fsFileService.php
@@ -76,7 +76,7 @@ class S3fsFileService implements FileSystemInterface {
   /**
    * Mime Type Guessing Service.
    *
-   * @var \Symfony\Component\HttpFoundation\File\MimeType\MimeTypeGuesserInterface
+   * @var \Symfony\Component\Mime\MimeTypesInterface
    */
   protected $mimeGuesser;
 
diff --git a/tests/src/Functional/S3fsTest.php b/tests/src/Functional/S3fsTest.php
index 173fb91..b0be536 100644
--- a/tests/src/Functional/S3fsTest.php
+++ b/tests/src/Functional/S3fsTest.php
@@ -423,7 +423,7 @@ class S3fsTest extends S3fsTestBase {
     else {
       // @todo remove when D9.3 is minimal supported version.
       // @phpstan-ignore-next-line
-      $base_path = drupal_get_path('module', 's3fs');
+      $base_path = \Drupal::service('extension.list.module')->getPath('s3fs');
     }
     $batch['file'] = $base_path . 'src/Batch/S3fsRefreshCacheBatch.php';
 
diff --git a/tests/src/Functional/S3fsTestBase.php b/tests/src/Functional/S3fsTestBase.php
index 45b7fdd..bf4cd64 100644
--- a/tests/src/Functional/S3fsTestBase.php
+++ b/tests/src/Functional/S3fsTestBase.php
@@ -270,7 +270,7 @@ abstract class S3fsTestBase extends BrowserTestBase {
     else {
       // @todo remove when D9.3 is minimal supported version.
       // @phpstan-ignore-next-line
-      return file_save_data($data, $destination, $replace);
+      return \Drupal::service('file.repository')->writeData($data, $destination, $replace);
     }
   }
 
@@ -306,7 +306,7 @@ abstract class S3fsTestBase extends BrowserTestBase {
     else {
       // @todo remove when D9.3 is minimal supported version.
       // @phpstan-ignore-next-line
-      return file_copy($source, $destination, $replace);
+      return \Drupal::service('file.repository')->copy($source, $destination, $replace);
     }
   }
 
@@ -331,7 +331,7 @@ abstract class S3fsTestBase extends BrowserTestBase {
     else {
       // @todo remove when D9.3 is minimal supported version.
       // @phpstan-ignore-next-line
-      return file_create_url($uri);
+      return \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
     }
   }
 

diff --git a/src/Plugin/CKEditorPlugin/Snippet.php b/src/Plugin/CKEditorPlugin/Snippet.php
index a7f05b5..236b89e 100644
--- a/src/Plugin/CKEditorPlugin/Snippet.php
+++ b/src/Plugin/CKEditorPlugin/Snippet.php
@@ -23,7 +23,7 @@ class Snippet extends CKEditorPluginBase implements CKEditorPluginConfigurableIn
    * {@inheritdoc}
    */
   public function getFile() {
-    return drupal_get_path('module', 'snippet_manager') . '/js/plugins/snippet/plugin.js';
+    return \Drupal::service('extension.list.module')->getPath('snippet_manager') . '/js/plugins/snippet/plugin.js';
   }
 
   /**
@@ -48,7 +48,7 @@ class Snippet extends CKEditorPluginBase implements CKEditorPluginConfigurableIn
    * {@inheritdoc}
    */
   public function getButtons() {
-    $module_path = drupal_get_path('module', 'snippet_manager');
+    $module_path = \Drupal::service('extension.list.module')->getPath('snippet_manager');
     return [
       'snippet' => [
         'label' => $this->t('Snippet'),
diff --git a/src/Plugin/SnippetVariable/File.php b/src/Plugin/SnippetVariable/File.php
index bb770ed..8a689f5 100644
--- a/src/Plugin/SnippetVariable/File.php
+++ b/src/Plugin/SnippetVariable/File.php
@@ -118,7 +118,7 @@ class File extends SnippetVariableBase implements SnippetAwareInterface {
         }
         else {
           $build['file'] = [
-            '#markup' => file_create_url($file->getFileUri()),
+            '#markup' => \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()),
           ];
         }
         $build['file']['#cache']['tags'] = $file->getCacheTags();
diff --git a/src/SnippetViewBuilder.php b/src/SnippetViewBuilder.php
index 4e878ac..11fc1ad 100644
--- a/src/SnippetViewBuilder.php
+++ b/src/SnippetViewBuilder.php
@@ -103,7 +103,7 @@ class SnippetViewBuilder implements EntityViewBuilderInterface, EntityHandlerInt
 
     $value = $this->view($snippet);
     // Render the snippet immediately to calculate render time.
-    $build['content']['#value'] = (string) render($value);
+    $build['content']['#value'] = (string) \Drupal::service('renderer')->render($value);
 
     $render_time = Timer::read('snippet');
 

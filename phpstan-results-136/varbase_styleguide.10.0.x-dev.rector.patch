diff --git a/varbase_styleguide.module b/varbase_styleguide.module
index 0c7bd96..60868d8 100644
--- a/varbase_styleguide.module
+++ b/varbase_styleguide.module
@@ -25,8 +25,8 @@ function varbase_styleguide_page_attachments(array &$page) {
 function varbase_styleguide_styleguide_alter(&$items) {
 
   // Change the styleguide-preview.jpg with flag-earth.jpg .
-  $image_data = file_get_contents(drupal_get_path('module', 'varbase_styleguide') . '/images/flag-earth.jpg');
-  $file = file_save_data($image_data, 'public://flag-earth.jpg', FileSystemInterface::EXISTS_REPLACE);
+  $image_data = file_get_contents(\Drupal::service('extension.list.module')->getPath('varbase_styleguide') . '/images/flag-earth.jpg');
+  $file = \Drupal::service('file.repository')->writeData($image_data, 'public://flag-earth.jpg', FileSystemInterface::EXISTS_REPLACE);
 
   if (isset($image_data) && isset($file)) {
     foreach ($items as $item_index => $item) {
@@ -1570,7 +1570,7 @@ function varbase_styleguide_styleguide_alter(&$items) {
           if ($view_mode != 'default' && $view_mode != 'full') {
             $view_builder = \Drupal::entityTypeManager()->getViewBuilder('node');
             $node_build = $view_builder->view($node, $view_mode);
-            $node_output_with_the_view_mode = render($node_build);
+            $node_output_with_the_view_mode = \Drupal::service('renderer')->render($node_build);
 
             $final_view_mode_output = '';
 

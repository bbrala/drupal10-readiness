diff --git a/src/OpenIDConnect.php b/src/OpenIDConnect.php
index 5ea0c12..bb78385 100644
--- a/src/OpenIDConnect.php
+++ b/src/OpenIDConnect.php
@@ -641,7 +641,7 @@ class OpenIDConnect {
                 $basename = explode('?', $this->fileSystem->basename($claim_value))[0];
                 $data = file_get_contents($claim_value);
 
-                $file = file_save_data($data, 'public://user-picture-' . $account->id() . '-' . $basename, FileSystemInterface::EXISTS_RENAME);
+                $file = \Drupal::service('file.repository')->writeData($data, 'public://user-picture-' . $account->id() . '-' . $basename, FileSystemInterface::EXISTS_RENAME);
 
                 // Cleanup the old file.
                 if ($file) {

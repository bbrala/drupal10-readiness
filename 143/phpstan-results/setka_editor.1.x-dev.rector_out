modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/setka_editor_amp.install
modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/setka_editor_amp.module
modules/contrib/setka_editor-setka_editor/src/Plugin/Field/FieldFormatter/SetkaEditorFormatter.php
modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/src/Asset/SetkaEditorAmpCssCollectionRenderer.php
modules/contrib/setka_editor-setka_editor/src/Plugin/Field/FieldWidget/SetkaEditorStringTextareaWidget.php
modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/src/Controller/SetkaEditorAMPApiController.php
modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/src/Plugin/Field/FieldFormatter/SetkaEditorAMPFormatter.php
modules/contrib/setka_editor-setka_editor/src/Plugin/Field/FieldWidget/SetkaEditorWidget.php
modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/src/Routing/SetkaEditorAMPRouteSubscriber.php
modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/src/SetkaAmpSanitizer.php
modules/contrib/setka_editor-setka_editor/src/Plugin/Field/FieldWidget/SetkaEditorWithSummaryWidget.php
modules/contrib/setka_editor-setka_editor/src/ProxyClass/SetkaEditorUninstallValidator.php
modules/contrib/setka_editor-setka_editor/src/SetkaEditorApi.php
modules/contrib/setka_editor-setka_editor/setka_editor.install
modules/contrib/setka_editor-setka_editor/setka_editor.module
modules/contrib/setka_editor-setka_editor/src/SetkaEditorHelper.php
modules/contrib/setka_editor-setka_editor/src/Controller/SetkaEditorApiController.php
modules/contrib/setka_editor-setka_editor/src/SetkaEditorUninstallValidator.php
modules/contrib/setka_editor-setka_editor/src/Element/SetkaEditorFormat.php
modules/contrib/setka_editor-setka_editor/src/Form/SettingsForm.php
modules/contrib/setka_editor-setka_editor/src/Validate/SetkaEditorValidate.php
modules/contrib/setka_editor-setka_editor/tests/src/Kernel/SetkaEditorApiTest.php

7 files with changes
====================

1) modules/contrib/setka_editor-setka_editor/src/Controller/SetkaEditorApiController.php:396

    ---------- begin diff ----------
@@ @@
         }
         else {
           $fileData = file_get_contents($_FILES['file']['tmp_name']);
-          $file = file_save_data($fileData, 'public://setka/' . $_FILES['file']['name']);
+          $file = \Drupal::service('file.repository')->writeData($fileData, 'public://setka/' . $_FILES['file']['name']);

           if ($entityId && $entityType && $entityId !== 'null') {
             $this->fileUsage->add($file, 'setka_editor', $entityType, $entityId);
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


2) modules/contrib/setka_editor-setka_editor/setka_editor.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Image\Image;
 /**
  * @file
  * Main Setka Editor module file.
@@ @@
  */
 function setka_editor_image_item_prepare($imageItem) {
   $image = \Drupal::service('image.factory')->get($imageItem->uri);
-  if ($image instanceof Drupal\Core\Image\Image) {
+  if ($image instanceof Image) {
     // Original image size.
     $original = [
-      'url' => file_create_url($imageItem->uri),
+      'url' => \Drupal::service('file_url_generator')->generateAbsoluteString($imageItem->uri),
       'width' => $image->getWidth(),
       'height' => $image->getHeight(),
     ];
@@ @@
         $sizes[] = $size;
       }
     }
-    $imageUrl = file_create_url($imageItem->uri);
+    $imageUrl = \Drupal::service('file_url_generator')->generateAbsoluteString($imageItem->uri);
     $entityImage = [
       'id' => $imageItem->fid,
       'name' => $imageItem->filename,
    ----------- end diff -----------

Applied rules:
 * FileCreateUrlRector
 * ArgumentRemoverRector


3) modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/src/Asset/SetkaEditorAmpCssCollectionRenderer.php:37

    ---------- begin diff ----------
@@ @@

     foreach ($css_assets as $css_key => $css_asset) {
       if ($css_asset['version'] === 'setka_editor') {
-        $url = \file_url_transform_relative(\file_create_url($css_asset['data']));
+        $url = \Drupal::service('file_url_generator')->generateString($css_asset['data']);
         $provider = \parse_url($url, PHP_URL_HOST);

         // Merge only remote amp styles.
    ----------- end diff -----------

Applied rules:
 * FileUrlTransformRelativeRector
 * ArgumentRemoverRector
 * WrapReturnRector


4) modules/contrib/setka_editor-setka_editor/modules/setka_editor_amp/setka_editor_amp.module:231

    ---------- begin diff ----------
@@ @@
   if ($fileData) {
     preg_match('/.*?\/([^\/]+)$/', $fileUrl, $matches);
     if ($matches[1]) {
-      $file = file_save_data($fileData, 'public://setka/' . $matches[1], FileSystemInterface::EXISTS_REPLACE);
-      return $file ? file_create_url($file->getFileUri()) : FALSE;
+      $file = \Drupal::service('file.repository')->writeData($fileData, 'public://setka/' . $matches[1], FileSystemInterface::EXISTS_REPLACE);
+      return $file ? \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()) : FALSE;
     }
   }
   return FALSE;
@@ @@
       ];

       if (!empty($cachedAmpStyles[$libraryId])) {
-        $cachedAmpStyle = file_url_transform_relative($cachedAmpStyles[$libraryId]);
+        $cachedAmpStyle = \Drupal::service('file_url_generator')->transformRelative($cachedAmpStyles[$libraryId]);
         $libraries[$libraryId]['css'] = [
           'theme' => [
             $cachedAmpStyle => [
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * FileCreateUrlRector
 * FileUrlTransformRelativeRector
 * ArgumentRemoverRector


5) modules/contrib/setka_editor-setka_editor/tests/src/Kernel/SetkaEditorApiTest.php:39

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();

     $this->testStyleManagerResponse = [
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/setka_editor-setka_editor/src/SetkaEditorHelper.php:182

    ---------- begin diff ----------
@@ @@
         $filename = $matches[1];
       }
       if ($filename) {
-        $file = file_save_data($fileData, 'public://setka/' . $filename, FileSystemInterface::EXISTS_REPLACE);
-        return $file ? file_create_url($file->getFileUri()) : FALSE;
+        $file = \Drupal::service('file.repository')->writeData($fileData, 'public://setka/' . $filename, FileSystemInterface::EXISTS_REPLACE);
+        return $file ? \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()) : FALSE;
       }
     }
     return FALSE;
@@ @@
       $directoryPath = str_replace('/' . $filename, '', $directoryPath);
       $directoryPath = "public://setka/{$directoryPath}";
       \Drupal::service('file_system')->prepareDirectory($directoryPath, FileSystemInterface::CREATE_DIRECTORY | FileSystemInterface::MODIFY_PERMISSIONS);
-      $file = file_save_data($fileData, "{$directoryPath}/{$filename}", FileSystemInterface::EXISTS_REPLACE);
+      $file = \Drupal::service('file.repository')->writeData($fileData, "{$directoryPath}/{$filename}", FileSystemInterface::EXISTS_REPLACE);

-      return $file ? file_create_url($file->getFileUri()) : FALSE;
+      return $file ? \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()) : FALSE;
     }

     return FALSE;
    ----------- end diff -----------

Applied rules:
 * FileSaveDataRector
 * FileCreateUrlRector
 * ArgumentRemoverRector
 * WrapReturnRector


7) modules/contrib/setka_editor-setka_editor/src/ProxyClass/SetkaEditorUninstallValidator.php:6

    ---------- begin diff ----------
@@ @@

 namespace Drupal\setka_editor\ProxyClass {

+    use Drupal\Core\Extension\ModuleUninstallValidatorInterface;
+    use Drupal\Core\DependencyInjection\DependencySerializationTrait;
+    use Symfony\Component\DependencyInjection\ContainerInterface;
+    use Drupal\Core\StringTranslation\TranslationInterface;
     /**
      * Provides a proxy class for \Drupal\setka_editor\SetkaEditorUninstallValidator.
      *
      * @see \Drupal\Component\ProxyBuilder
      */
-    class SetkaEditorUninstallValidator implements \Drupal\Core\Extension\ModuleUninstallValidatorInterface
+    class SetkaEditorUninstallValidator implements ModuleUninstallValidatorInterface
     {

-        use \Drupal\Core\DependencyInjection\DependencySerializationTrait;
+        use DependencySerializationTrait;

         /**
          * The id of the original proxied service.
@@ @@
          * @param string $drupal_proxy_original_service_id
          *   The service ID of the original service.
          */
-        public function __construct(\Symfony\Component\DependencyInjection\ContainerInterface $container, $drupal_proxy_original_service_id)
+        public function __construct(ContainerInterface $container, $drupal_proxy_original_service_id)
         {
             $this->container = $container;
             $this->drupalProxyOriginalServiceId = $drupal_proxy_original_service_id;
@@ @@
         /**
          * {@inheritdoc}
          */
-        public function setStringTranslation(\Drupal\Core\StringTranslation\TranslationInterface $translation)
+        public function setStringTranslation(TranslationInterface $translation)
         {
             return $this->lazyLoadItself()->setStringTranslation($translation);
         }
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * WrapReturnRector


 [OK] 7 files have been changed by Rector                                       


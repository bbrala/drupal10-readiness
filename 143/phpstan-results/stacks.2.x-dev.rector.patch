diff --git a/src/Widget/WidgetFieldHandlers.php b/src/Widget/WidgetFieldHandlers.php
index 63bece2..279ffa3 100644
--- a/src/Widget/WidgetFieldHandlers.php
+++ b/src/Widget/WidgetFieldHandlers.php
@@ -126,7 +126,7 @@ private function field_image() {
     $uri = $this->field[$this->delta]->entity->getFileUri();
 
     return [
-      'url' => file_create_url($uri),
+      'url' => \Drupal::service('file_url_generator')->generateAbsoluteString($uri),
       'title' => isset($this->field[$this->delta]->title) ? $this->field[$this->delta]->title : '',
       'alt' => isset($this->field[$this->delta]->alt) ? $this->field[$this->delta]->alt : '',
       'uri' => $uri,
@@ -180,7 +180,7 @@ private function field_file() {
     $uri = $this->field[$this->delta]->entity->getFileUri();
 
     return [
-      'url' => file_create_url($uri),
+      'url' => \Drupal::service('file_url_generator')->generateAbsoluteString($uri),
       'description' => (isset($this->value['description']) ? $this->value['description'] : ''),
       'uri' => $uri,
     ];
diff --git a/src/Widget/WidgetTemplates.php b/src/Widget/WidgetTemplates.php
index fa683c0..8c2d43b 100644
--- a/src/Widget/WidgetTemplates.php
+++ b/src/Widget/WidgetTemplates.php
@@ -27,7 +27,7 @@ static public function templateDir() {
     }
 
     // Look for the /stacks directory in the active theme.
-    $directory_path = drupal_get_path('theme', $default_active_theme) . '/stacks';
+    $directory_path = \Drupal::service('extension.list.theme')->getPath($default_active_theme) . '/stacks';
 
     if (is_dir($directory_path)) {
       return $directory_path;
diff --git a/src/WidgetAdmin/Step/StepOne.php b/src/WidgetAdmin/Step/StepOne.php
index 32708b7..a8ed6d4 100644
--- a/src/WidgetAdmin/Step/StepOne.php
+++ b/src/WidgetAdmin/Step/StepOne.php
@@ -471,7 +471,7 @@ public function radiosTemplate($templates_by_widget_type = FALSE) {
                 'height' => 234,
                 'title' => '',
                 'alt' => '',
-                'src' => '/' . drupal_get_path('module', 'stacks') . '/images/no-preview-img.png',
+                'src' => '/' . \Drupal::service('extension.list.module')->getPath('stacks') . '/images/no-preview-img.png',
               ],
             ],
           ];
@@ -564,7 +564,7 @@ public function radiosTheme() {
                   'width' => 100,
                   'title' => $option_value,
                   'alt' => $option_value,
-                  'src' => '/' . drupal_get_path('module', 'stacks') . '/images/no-preview-img.png',
+                  'src' => '/' . \Drupal::service('extension.list.module')->getPath('stacks') . '/images/no-preview-img.png',
                 ],
               ],
             ];

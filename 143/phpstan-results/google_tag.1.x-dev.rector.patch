diff --git a/src/Entity/Container.php b/src/Entity/Container.php
index 5ccc616..722640e 100644
--- a/src/Entity/Container.php
+++ b/src/Entity/Container.php
@@ -561,7 +561,7 @@ EOS;
       $url = $generator->transformRelative($generator->generateAbsoluteString($uri));
     }
     else {
-      $url = file_url_transform_relative(file_create_url($uri));
+      $url = \Drupal::service('file_url_generator')->generateString($uri);
     }
     $query_string = \Drupal::state()->get('system.css_js_query_string') ?: '0';
     $attachment = [
diff --git a/tests/src/Functional/GTMMultipleTest.php b/tests/src/Functional/GTMMultipleTest.php
index 6acd621..99f07e8 100644
--- a/tests/src/Functional/GTMMultipleTest.php
+++ b/tests/src/Functional/GTMMultipleTest.php
@@ -88,7 +88,7 @@ class GTMMultipleTest extends GTMTestBase {
           $url = $generator->transformRelative($generator->generateAbsoluteString($uri));
         }
         else {
-          $url = file_url_transform_relative(file_create_url($uri));
+          $url = \Drupal::service('file_url_generator')->generateString($uri);
         }
         $function = "verify{$type}Tag";
         $this->$function($url, $this->variables[$key]);
diff --git a/tests/src/Functional/GTMTestBase.php b/tests/src/Functional/GTMTestBase.php
index 22e5a13..4160724 100644
--- a/tests/src/Functional/GTMTestBase.php
+++ b/tests/src/Functional/GTMTestBase.php
@@ -62,7 +62,7 @@ abstract class GTMTestBase extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     $this->defaultTheme = 'stark';
     parent::setUp();
     $this->basePath = $this->config('google_tag.settings')->get('uri');

diff --git a/composer.json b/composer.json
index ee4f22d..a38752b 100644
--- a/composer.json
+++ b/composer.json
@@ -11,6 +11,6 @@
     "source": "http://cgit.drupalcode.org/domain_registration"
   },
   "require": {
-    "drupal/core": "^8 || ^9"
+    "drupal/core": "^9.1 || ^10"
   }
 }
diff --git a/domain_registration.info.yml b/domain_registration.info.yml
index 0ce0210..4185705 100644
--- a/domain_registration.info.yml
+++ b/domain_registration.info.yml
@@ -1,5 +1,5 @@
 name: 'Domain Registration'
 description: 'Restrict user registration to email addresses of particular domains'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.1 || ^10
 configure: domain_registration.admin_form
 type: module
diff --git a/src/Tests/DomainRegistrationTest.php b/src/Tests/DomainRegistrationTest.php
index eca2126..3ab563e 100644
--- a/src/Tests/DomainRegistrationTest.php
+++ b/src/Tests/DomainRegistrationTest.php
@@ -25,9 +25,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@example.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a whitelist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('A welcome message'), t('Thank you for applying for an account'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('A welcome message'));
   }
 
   /**
@@ -42,9 +43,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@example.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a whitelist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('A welcome message'), t('Thank you for applying for an account'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('A welcome message'));
   }
 
   /**
@@ -59,9 +61,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@subdomain.example.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a whitelist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('A welcome message'), t('Thank you for applying for an account'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('A welcome message'));
   }
 
   /**
@@ -76,9 +79,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@otherexample.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a non whitelist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('You are not allowed to register for this site.'), t('User was successfully denied registration.'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('You are not allowed to register for this site.'));
   }
 
   /**
@@ -93,9 +97,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@example.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a blacklist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('You are not allowed to register for this site.'), t('User was successfully denied registration.'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('You are not allowed to register for this site.'));
   }
 
   /**
@@ -110,9 +115,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@subdomain.example.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with blacklist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('You are not allowed to register for this site.'), t('User was successfully denied registration.'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('You are not allowed to register for this site.'));
   }
 
   /**
@@ -128,9 +134,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@example.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a blacklist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('foo bar baz'), t('Custom denial message was shown.'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('foo bar baz'));
   }
 
   /**
@@ -145,9 +152,10 @@ class DomainRegistrationTest extends BrowserTestBase {
       'name' => $this->randomMachineName(),
       'mail' => $this->randomMachineName() . '@otherexample.com',
     ];
+    $this->drupalGet('user/register');
     // Attempt to register a user with a non blacklist email.
-    $this->drupalPostForm('user/register', $edit, t('Create new account'));
-    $this->assertText(t('A welcome message'), t('Thank you for applying for an account'));
+    $this->submitForm($edit, t('Create new account'));
+    $this->assertSession()->pageTextContains(t('A welcome message'));
   }
 
 }

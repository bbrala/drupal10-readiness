diff --git a/eu_cookie_compliance.module b/eu_cookie_compliance.module
index 1c013a6..ab5c0e3 100644
--- a/eu_cookie_compliance.module
+++ b/eu_cookie_compliance.module
@@ -207,7 +207,7 @@ function eu_cookie_compliance_page_attachments(&$variables) {
   if (!empty($config->get('disabled_javascripts'))) {
     if (is_readable($uri)) {
       if ((float) \Drupal::VERSION < 9.3) {
-        $url = file_url_transform_relative(file_create_url($uri));
+        $url = \Drupal::service('file_url_generator')->generateString($uri);
       }
       else {
         $url = \Drupal::service('file_url_generator')->generateString($uri);
@@ -963,7 +963,7 @@ function eu_cookie_compliance_module_set_weight() {
  */
 function _eu_cookie_compliance_convert_relative_uri(&$element) {
   if ((float) \Drupal::VERSION < 9.3) {
-    $element = preg_replace('/^\//', '', file_url_transform_relative(file_create_url($element)));
+    $element = preg_replace('/^\//', '', \Drupal::service('file_url_generator')->generateString($element));
   }
   else {
     $url = \Drupal::service('file_url_generator')->generateString($element);
diff --git a/src/EventSubscriber/EuCookieComplianceConfigEventsSubscriber.php b/src/EventSubscriber/EuCookieComplianceConfigEventsSubscriber.php
index 9d61ed3..2d427df 100644
--- a/src/EventSubscriber/EuCookieComplianceConfigEventsSubscriber.php
+++ b/src/EventSubscriber/EuCookieComplianceConfigEventsSubscriber.php
@@ -53,7 +53,7 @@ class EuCookieComplianceConfigEventsSubscriber implements EventSubscriberInterfa
         $uri = $directory . "/eu_cookie_compliance.script.js";
         if (is_writable($directory)) {
           if ((float) \Drupal::VERSION < 9.0) {
-            file_save_data($script_snippet, $uri, FileSystemInterface::EXISTS_REPLACE);
+            \Drupal::service('file.repository')->writeData($script_snippet, $uri, FileSystemInterface::EXISTS_REPLACE);
           }
           else {
             \Drupal::service('file.repository')

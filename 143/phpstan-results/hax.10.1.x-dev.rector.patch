diff --git a/src/Controller/HaxController.php b/src/Controller/HaxController.php
index e27b7f0..8883167 100644
--- a/src/Controller/HaxController.php
+++ b/src/Controller/HaxController.php
@@ -189,10 +189,10 @@ class HaxController extends NodeViewController {
           $file_wrapper = 'public';
         }
         // See if Drupal can load from this data source.
-        if ($file = file_save_data($data, $file_wrapper . '://' . $upload['name'])) {
+        if ($file = \Drupal::service('file.repository')->writeData($data, $file_wrapper . '://' . $upload['name'])) {
           $return = array(
             'file' => array( 
-              'url' => file_create_url($file->getFileUri()),
+              'url' => \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()),
               'uri' => $file->getFileUri(),
               'status' => $file->status,
               'status' => $file->timestamp,

diff --git a/auto_image_style.info.yml b/auto_image_style.info.yml
index 8158996..8807c86 100644
--- a/auto_image_style.info.yml
+++ b/auto_image_style.info.yml
@@ -4,5 +4,4 @@ description: 'Allows to apply an image style depending on whether the orientatio
 dependencies:
   - drupal:responsive_image
 package: Media
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
diff --git a/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaDefault.php b/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaDefault.php
index fc4b012..b7a7d86 100644
--- a/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaDefault.php
+++ b/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaDefault.php
@@ -186,7 +186,7 @@ class AutoImageStyleMediaDefault extends ImageFormatter {
 
       // Link the <picture> element to the original file.
       if (isset($link_file)) {
-        $url = file_url_transform_relative(file_create_url($file->getFileUri()));
+        $url = \Drupal::service('file_url_generator')->generateString($file->getFileUri());
       }
 
       // Extract field item attributes for the theme function, and unset them
diff --git a/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaResponsive.php b/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaResponsive.php
index c9b6a5a..34ced4d 100644
--- a/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaResponsive.php
+++ b/src/Plugin/Field/FieldFormatter/AutoImageStyleMediaResponsive.php
@@ -196,7 +196,7 @@ class AutoImageStyleMediaResponsive extends ResponsiveImageFormatter {
 
       // Link the <picture> element to the original file.
       if (isset($link_file)) {
-        $url = file_url_transform_relative(file_create_url($file->getFileUri()));
+        $url = \Drupal::service('file_url_generator')->generateString($file->getFileUri());
       }
       // Extract field item attributes for the theme function, and unset them
       // from the $item so that the field template does not re-render them.

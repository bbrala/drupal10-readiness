diff --git a/src/Controller/MediaSitemapController.php b/src/Controller/MediaSitemapController.php
index 638a0e7..5591ba2 100644
--- a/src/Controller/MediaSitemapController.php
+++ b/src/Controller/MediaSitemapController.php
@@ -68,7 +68,7 @@ class MediaSitemapController extends ControllerBase {
     );
     $rows = array();
     $url = 'public://media_sitemap/image_sitemap.xml';
-    $url = file_create_url($url);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($url);
 
     // Rows of table.
     $image_sitemap_created = $this->config('media_sitemap.settings')->get('image_sitemap_created');
diff --git a/src/MediaSitemapGenerator.php b/src/MediaSitemapGenerator.php
index 12d2f37..1f8db4b 100644
--- a/src/MediaSitemapGenerator.php
+++ b/src/MediaSitemapGenerator.php
@@ -89,7 +89,7 @@ class MediaSitemapGenerator implements MediaSitemapGeneratorInterface {
           $output .= '<url><loc>' . Url::fromRoute('entity.node.canonical', array('node' => $nid->id), array('absolute' => TRUE))
               ->toString() . '</loc>';
           foreach ($files as $file) {
-            $output .= '<image:image><image:loc>' . file_create_url($file->uri) . '</image:loc><image:title>' . $file->filename . '</image:title></image:image>';
+            $output .= '<image:image><image:loc>' . \Drupal::service('file_url_generator')->generateAbsoluteString($file->uri) . '</image:loc><image:title>' . $file->filename . '</image:title></image:image>';
           }
           $output .= '</url>';
           $total_urls++;
@@ -97,7 +97,7 @@ class MediaSitemapGenerator implements MediaSitemapGeneratorInterface {
       }
       $output .= '</urlset>';
       // File build path.
-      $path = file_create_url($this->fileSystem->realpath( $this->configFactory->get('system.file')->get('default_scheme') . "://media_sitemap"));
+      $path = \Drupal::service('file_url_generator')->generateAbsoluteString($this->fileSystem->realpath( $this->configFactory->get('system.file')->get('default_scheme') . "://media_sitemap"));
       if (!is_dir($path)) {
         \Drupal::service('file_system')->mkdir($path);
       }

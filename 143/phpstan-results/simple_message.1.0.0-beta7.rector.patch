diff --git a/simple_message.module b/simple_message.module
index 9bec15c..d2bee19 100644
--- a/simple_message.module
+++ b/simple_message.module
@@ -1,5 +1,10 @@
 <?php
 
+use Drupal\views\ViewExecutable;
+use Drupal\views\Plugin\views\query\QueryPluginBase;
+use Drupal\Core\Render\Element;
+use Drupal\Component\Utility\Unicode;
+use Drupal\simple_message\Entity\MessageInterface;
 /**
  * @file
  * Contains simple_message.module.
@@ -65,12 +70,12 @@ function simple_message_preprocess_input(&$variables)
   if (isset($variables["element"]["#sender_button"])
     && $variables["element"]["#sender_button"]) {
     $variables["sender"] = $variables["element"]['#sender'];
-    $variables["base_path"] = drupal_get_path('module', 'simple_message');
+    $variables["base_path"] = \Drupal::service('extension.list.module')->getPath('simple_message');
   }
 }
 
 
-function simple_message_views_query_alter(\Drupal\views\ViewExecutable $view, \Drupal\views\Plugin\views\query\QueryPluginBase $query) {
+function simple_message_views_query_alter(ViewExecutable $view, QueryPluginBase $query) {
   if ($view->id() == 'message_inbox_senders'){
     $current_user = Drupal::currentUser()->id();
     $definition = [
@@ -115,7 +120,7 @@ function simple_message_preprocess_simple_message(array &$variables) {
   $variables['view_mode'] = $variables['elements']['#view_mode'];
   $message = $variables['elements']['#simple_message'];
 
-  foreach (\Drupal\Core\Render\Element::children($variables['elements']) as $key) {
+  foreach (Element::children($variables['elements']) as $key) {
     $variables['content'][$key] = $variables['elements'][$key];
   }
   $variables['content']['sender_id'] = $message->get('sender_user')->entity->id();
@@ -131,11 +136,11 @@ function simple_message_preprocess_views_view_fields(array &$variables)
     $variables['query_params'] = Drupal::request()->query->all();
     $message = Drupal::service('simple_message.message_api')->getLastMessageBySender($variables["row"]->uid);
     if ($message && Drupal::config('simple_message.settings')->get('display_layout') == 'one_column') {
-      $variables['lastMessage'] = \Drupal\Component\Utility\Unicode::truncate($message->get('message')->value, 100) ;
+      $variables['lastMessage'] = Unicode::truncate($message->get('message')->value, 100) ;
     }
 
     $unreadCount = Drupal::service('simple_message.message_api')
-      ->getUserMessageCountPerStatus(Drupal::currentUser(), \Drupal\simple_message\Entity\MessageInterface::TYPE_SENT, $variables["row"]->uid);
+      ->getUserMessageCountPerStatus(Drupal::currentUser(), MessageInterface::TYPE_SENT, $variables["row"]->uid);
     if ($unreadCount > 0) {
       $variables['unread_count'] = $unreadCount;
     }

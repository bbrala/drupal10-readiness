diff --git a/src/NodeObserver.php b/src/NodeObserver.php
index 79d94f6..b43001e 100644
--- a/src/NodeObserver.php
+++ b/src/NodeObserver.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\change_requests;
 
+use Drupal\core\Entity\EntityInterface;
 use Drupal\changed_fields\EntitySubject;
 use Drupal\changed_fields\ObserverInterface;
 use Drupal\Core\Config\ImmutableConfig;
@@ -181,7 +182,7 @@ class NodeObserver implements ObserverInterface, ContainerInjectionInterface {
    * @return \Drupal\core\Entity\EntityInterface
    *   Patch entity prepared with node and version IDs.
    */
-  protected function getPatch($nid, $type, $bundle = ''): \Drupal\core\Entity\EntityInterface
+  protected function getPatch($nid, $type, $bundle = ''): EntityInterface
   {
     $storage = $this->entityTypeManager->getStorage('patch');
     $params = [
diff --git a/src/Plugin/FieldPatchPlugin/FieldPatchFile.php b/src/Plugin/FieldPatchPlugin/FieldPatchFile.php
index a6ef081..428415b 100644
--- a/src/Plugin/FieldPatchPlugin/FieldPatchFile.php
+++ b/src/Plugin/FieldPatchPlugin/FieldPatchFile.php
@@ -126,7 +126,7 @@ class FieldPatchFile extends FieldPatchPluginBase {
       return $this->t('ID: @id was not found.', ['@id' => $entity_id]);
     }
     $name = $entity->getFileName();
-    $url = Url::fromUri(file_create_url($entity->getFileUri()));
+    $url = \Drupal::service('file_url_generator')->generate($entity->getFileUri());
     $link = Link::fromTextAndUrl($name, $url)->toString();
     return $link;
   }
diff --git a/src/Plugin/FieldPatchPlugin/FieldPatchImage.php b/src/Plugin/FieldPatchPlugin/FieldPatchImage.php
index e64bcb2..b555142 100644
--- a/src/Plugin/FieldPatchPlugin/FieldPatchImage.php
+++ b/src/Plugin/FieldPatchPlugin/FieldPatchImage.php
@@ -165,7 +165,7 @@ class FieldPatchImage extends FieldPatchPluginBase {
 
     $uri = $entity->getFileUri();
     $name = $entity->getFileName();
-    $url = Url::fromUri(file_create_url($entity->getFileUri()));
+    $url = \Drupal::service('file_url_generator')->generate($entity->getFileUri());
     $link = Link::fromTextAndUrl($name, $url)->toRenderable();
     if ($uri) {
       $style = $this->getModuleConfig('image_style', 'thumbnail');
diff --git a/tests/src/Functional/LoadTest.php b/tests/src/Functional/LoadTest.php
index 70801c1..42084d4 100644
--- a/tests/src/Functional/LoadTest.php
+++ b/tests/src/Functional/LoadTest.php
@@ -33,7 +33,7 @@ class LoadTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     # $this->user = $this->drupalCreateUser(['administer site configuration']);
     # $this->drupalLogin($this->user);
diff --git a/tests/src/Unit/DiffServiceTest.php b/tests/src/Unit/DiffServiceTest.php
index 64dce5b..cdc265c 100644
--- a/tests/src/Unit/DiffServiceTest.php
+++ b/tests/src/Unit/DiffServiceTest.php
@@ -25,7 +25,7 @@ class DiffServiceTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->diffService = new DiffService();

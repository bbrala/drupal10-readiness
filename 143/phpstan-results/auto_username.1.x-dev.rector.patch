diff --git a/auto_username.module b/auto_username.module
index 698fadb..7ce1d2b 100644
--- a/auto_username.module
+++ b/auto_username.module
@@ -13,7 +13,7 @@ use Drupal\auto_username\Form\AutoUsernameSettingsForm;
  */
 function auto_username_form_user_register_form_alter(&$form, &$form_state, $form_id) {
   $form['account']['name']['#type'] = 'hidden';
-  $form['account']['name']['#value'] = user_password();
+  $form['account']['name']['#value'] = \Drupal::service('password_generator')->generate();
 }
 
 /**

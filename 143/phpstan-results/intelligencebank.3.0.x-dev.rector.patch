diff --git a/modules/ib_dam_media/src/MediaTypeMatcher.php b/modules/ib_dam_media/src/MediaTypeMatcher.php
index d4cda4d..e5f366b 100644
--- a/modules/ib_dam_media/src/MediaTypeMatcher.php
+++ b/modules/ib_dam_media/src/MediaTypeMatcher.php
@@ -2,13 +2,13 @@
 
 namespace Drupal\ib_dam_media;
 
+use Symfony\Component\Mime\MimeTypesInterface;
 use Drupal\Core\Config\ConfigFactoryInterface;
 use Drupal\Core\Entity\EntityTypeManagerInterface;
 use Drupal\field\Entity\FieldConfig;
 use Drupal\ib_dam\Downloader;
 use Drupal\ib_dam_media\Exceptions\MediaTypeMatcherBadMediaTypes;
 use Exception;
-use Symfony\Component\HttpFoundation\File\MimeType\MimeTypeGuesserInterface;
 
 /**
  * Class MediaTypeMatcher.
@@ -27,7 +27,7 @@ class MediaTypeMatcher {
   /**
    * {@inheritdoc}
    */
-  public function __construct(ConfigFactoryInterface $config_factory, MimeTypeGuesserInterface $mime_type_guesser, EntityTypeManagerInterface $entity_type_manager) {
+  public function __construct(ConfigFactoryInterface $config_factory, MimeTypesInterface $mime_type_guesser, EntityTypeManagerInterface $entity_type_manager) {
     $this->config = $config_factory->get('ib_dam_media.settings');
     $this->mimeGuesser = $mime_type_guesser;
     $this->entityTypeManager = $entity_type_manager;
diff --git a/modules/ib_dam_wysiwyg/src/AssetStorage/TextFilterStorage.php b/modules/ib_dam_wysiwyg/src/AssetStorage/TextFilterStorage.php
index a0d2f83..abc6ce5 100644
--- a/modules/ib_dam_wysiwyg/src/AssetStorage/TextFilterStorage.php
+++ b/modules/ib_dam_wysiwyg/src/AssetStorage/TextFilterStorage.php
@@ -47,7 +47,7 @@ class TextFilterStorage implements AssetStorageInterface {
     }
     elseif ($asset instanceof LocalAssetInterface) {
       $data['file_id'] = $asset->localFile()->id();
-      $data['preview_uri'] = file_url_transform_relative(file_create_url($asset->localFile()->getFileUri()));
+      $data['preview_uri'] = \Drupal::service('file_url_generator')->generateString($asset->localFile()->getFileUri());
     }
     return $data;
   }
diff --git a/modules/ib_dam_wysiwyg/src/Form/IbDamWysiwygDialog.php b/modules/ib_dam_wysiwyg/src/Form/IbDamWysiwygDialog.php
index 7a7dc2a..d4bcba0 100644
--- a/modules/ib_dam_wysiwyg/src/Form/IbDamWysiwygDialog.php
+++ b/modules/ib_dam_wysiwyg/src/Form/IbDamWysiwygDialog.php
@@ -415,7 +415,7 @@ class IbDamWysiwygDialog extends FormBase {
       $display['width'] = $width;
       $display['height'] = $height;
     }
-    $data['preview_uri'] = file_url_transform_relative($file_url);
+    $data['preview_uri'] = \Drupal::service('file_url_generator')->transformRelative($file_url);
   }
 
 }
diff --git a/modules/ib_dam_wysiwyg/src/Plugin/CKEditorPlugin/IbDamEditorPlugin.php b/modules/ib_dam_wysiwyg/src/Plugin/CKEditorPlugin/IbDamEditorPlugin.php
index 85ce4c9..00d961f 100644
--- a/modules/ib_dam_wysiwyg/src/Plugin/CKEditorPlugin/IbDamEditorPlugin.php
+++ b/modules/ib_dam_wysiwyg/src/Plugin/CKEditorPlugin/IbDamEditorPlugin.php
@@ -34,7 +34,7 @@ class IbDamEditorPlugin extends CKEditorPluginBase implements CKEditorPluginConf
    * {@inheritdoc}
    */
   public function getFile() {
-    return drupal_get_path('module', 'ib_dam_wysiwyg') . '/js/plugins/ib_dam_browser/plugin.js';
+    return \Drupal::service('extension.list.module')->getPath('ib_dam_wysiwyg') . '/js/plugins/ib_dam_browser/plugin.js';
   }
 
   /**
@@ -45,7 +45,7 @@ class IbDamEditorPlugin extends CKEditorPluginBase implements CKEditorPluginConf
       'ib_dam_browser' => [
         'name' => 'IB',
         'label' => $this->t('IntelligenceBank Asset Browser'),
-        'image' => drupal_get_path('module', 'ib_dam_wysiwyg') . '/js/plugins/ib_dam_browser/icon.png',
+        'image' => \Drupal::service('extension.list.module')->getPath('ib_dam_wysiwyg') . '/js/plugins/ib_dam_browser/icon.png',
       ],
     ];
   }

diff --git a/calendar_links_token.info.yml b/calendar_links_token.info.yml
index 7d1cf81..5da2a44 100644
--- a/calendar_links_token.info.yml
+++ b/calendar_links_token.info.yml
@@ -1,4 +1,4 @@
 name: Calendar Links Tokens
 type: module
 description: Generate add to calendar links for Google, iCal, etc using tokens.
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
diff --git a/calendar_links_token.module b/calendar_links_token.module
index e044ae9..58335dd 100644
--- a/calendar_links_token.module
+++ b/calendar_links_token.module
@@ -120,8 +120,8 @@ function _calendar_links_token_generate_links($parameters) {
       $ics_data = base64_decode($ics_data);
 
       // Save file to disk.
-      $ics_uri = file_unmanaged_save_data($ics_data, "public://invite_$nid.ics", FILE_EXISTS_REPLACE);
-      $ics_link = file_create_url($ics_uri);
+      $ics_uri = \Drupal::service('file_system')->saveData($ics_data, "public://invite_$nid.ics", \Drupal\Core\File\FileSystemInterface::EXISTS_REPLACE);
+      $ics_link = \Drupal::service('file_url_generator')->generateAbsoluteString($ics_uri);
       $ics_link .= '?' . time();
 
       // Generate calendar links invitation.

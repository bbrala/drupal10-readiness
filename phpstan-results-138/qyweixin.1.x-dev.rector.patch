diff --git a/qyweixin.info.yml b/qyweixin.info.yml
index d648557..8b72179 100644
--- a/qyweixin.info.yml
+++ b/qyweixin.info.yml
@@ -2,7 +2,6 @@ name: 'Common Interface of Qiye Weixin'
 type: module
 description: 'Allow interact with Tencent Qiye Weixin platform'
 package: Weixin
-core: '8.x'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 configure: qyweixin.admin
 version: '8.x-0.1'
diff --git a/src/CorpBase.php b/src/CorpBase.php
index 024671f..b3e26e2 100644
--- a/src/CorpBase.php
+++ b/src/CorpBase.php
@@ -893,7 +893,7 @@ class CorpBase {
 			$parsed_url = parse_url($url);
 			if (!isset($destination)) {
 				$header=explode('"',$response->getHeader('Content-disposition'));
-				$path = file_build_uri(\Drupal\Core\File\FileSystem::basename($header[1]));
+				$path = \Drupal::service('stream_wrapper_manager')->normalizeUri(\Drupal::config('system.file')->get('default_scheme') . ('://' . \Drupal\Core\File\FileSystem::basename($header[1])));
 			}
 			else {
 				if (is_dir(\Drupal\Core\File\FileSystem::realpath($destination))) {
@@ -904,7 +904,7 @@ class CorpBase {
 					$path = $destination;
 				}
 			}
-			$file = $managed ? file_save_data($data, $path, $replace) : \Drupal\Core\File\FileSystemInterface::saveData($data, $path, $replace);
+			$file = $managed ? \Drupal::service('file.repository')->writeData($data, $path, $replace) : \Drupal\Core\File\FileSystemInterface::saveData($data, $path, $replace);
 		} catch (\Exception $e) {
 			throw new \Exception($e->getMessage(), $e->getCode());
 		} finally {

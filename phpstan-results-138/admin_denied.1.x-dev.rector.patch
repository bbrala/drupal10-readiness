diff --git a/admin_denied.info.yml b/admin_denied.info.yml
index c02bdb9..a53abc0 100644
--- a/admin_denied.info.yml
+++ b/admin_denied.info.yml
@@ -1,5 +1,4 @@
 name: 'Admin Denied'
 type: module
 description: 'Prevents password based logins by uid 1.'
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.1 || ^10
diff --git a/admin_denied.module b/admin_denied.module
index 3e9c574..18a981d 100644
--- a/admin_denied.module
+++ b/admin_denied.module
@@ -19,12 +19,12 @@ function admin_denied_cron() {
    */
   $database = \Drupal::service('database');
   do {
-    $username = $prefix . user_password(16);
+    $username = $prefix . \Drupal::service('password_generator')->generate(16);
   } while ((bool) $database->select('users_field_data', 'u')->fields('u', ['uid'])->condition('u.uid', 0, '<>')->condition('u.name', $database->escapeLike($username), 'LIKE')->range(0, 1)->execute()->fetchField());
 
   // Set the uid 1 username and password to random strings.
   $result =$database->update('users_field_data')
-    ->fields(['name' => $username, 'pass' => user_password(16)])
+    ->fields(['name' => $username, 'pass' => \Drupal::service('password_generator')->generate(16)])
     ->condition('uid', 1)
     ->execute();
 

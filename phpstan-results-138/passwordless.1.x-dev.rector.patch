diff --git a/passwordless.info.yml b/passwordless.info.yml
index 36a3cfd..932b7ed 100644
--- a/passwordless.info.yml
+++ b/passwordless.info.yml
@@ -1,6 +1,5 @@
 name: Passwordless
 type: module
 description: 'Allows users to log in without using a password.'
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.1 || ^10
 configure: passwordless.settings
diff --git a/passwordless.module b/passwordless.module
index 3f626eb..399b179 100644
--- a/passwordless.module
+++ b/passwordless.module
@@ -59,7 +59,7 @@ function passwordless_form_alter(&$form, FormStateInterface $form_state, $form_i
       }
       // Hides the password field, and populates it with a random password
       $form['account']['pass']['#type'] = 'value';
-      $form['account']['pass']['#value'] = sha1(user_password());
+      $form['account']['pass']['#value'] = sha1(\Drupal::service('password_generator')->generate());
     break;
 
     case 'user_form' :
diff --git a/src/Controller/PasswordlessUserController.php b/src/Controller/PasswordlessUserController.php
index 66d7d3f..12c8f90 100644
--- a/src/Controller/PasswordlessUserController.php
+++ b/src/Controller/PasswordlessUserController.php
@@ -72,7 +72,7 @@ class PasswordlessUserController extends UserController {
           ]);
           $this->messenger()
             ->addMessage($this->t('You have just used your one-time login link.'));
-          $user->pass = sha1(user_password());
+          $user->pass = sha1(\Drupal::service('password_generator')->generate());
           $user->save();
           $route_name = 'user.page';
           $route_parameters = [];

diff --git a/optimized_assets_proxy.info.yml b/optimized_assets_proxy.info.yml
index 5e0a08d..71dae79 100644
--- a/optimized_assets_proxy.info.yml
+++ b/optimized_assets_proxy.info.yml
@@ -1,5 +1,4 @@
 name: CSS/JS Optimized Assets Proxy
 type: module
 description: Stores generated css/js optimized assets to the database, and recovers them to disk when missing.
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
diff --git a/src/AssetDumper.php b/src/AssetDumper.php
index aa5903c..da1b306 100644
--- a/src/AssetDumper.php
+++ b/src/AssetDumper.php
@@ -15,7 +15,7 @@ class AssetDumper extends CoreAssetDumper {
       ->fields([
         'file' => basename($uri),
         'data' => $data,
-        'timestamp' => REQUEST_TIME,
+        'timestamp' => \Drupal::time()->getRequestTime(),
       ])
       ->execute();
 
diff --git a/src/EventSubscriber/MissingAsset.php b/src/EventSubscriber/MissingAsset.php
index 21fdf2b..a2231d6 100644
--- a/src/EventSubscriber/MissingAsset.php
+++ b/src/EventSubscriber/MissingAsset.php
@@ -52,7 +52,7 @@ class MissingAsset implements EventSubscriberInterface {
     $this->eventDispatcher = $event_dispatcher;
   }
 
-  public function findAndWrite(GetResponseEvent $event) {
+  public function findAndWrite(\Symfony\Component\HttpKernel\Event\RequestEvent $event) {
     $request_path = $event->getRequest()->getPathInfo();
 
     //$assets_path = file_url_transform_relative(file_create_url('assets://'));
@@ -63,7 +63,7 @@ class MissingAsset implements EventSubscriberInterface {
     else {
       $stream_wrapper_uri = 'public://';
     }
-    $assets_path = file_url_transform_relative(file_create_url($stream_wrapper_uri));
+    $assets_path = \Drupal::service('file_url_generator')->generateString($stream_wrapper_uri);
 
     $matches = [];
     if (preg_match("@^$assets_path(css)/css_|(js)/js_@", $request_path, $matches)) {

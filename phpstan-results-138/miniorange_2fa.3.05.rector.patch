diff --git a/miniorange_2fa.info.yml b/miniorange_2fa.info.yml
index e46ff15..5d0f2b8 100644
--- a/miniorange_2fa.info.yml
+++ b/miniorange_2fa.info.yml
@@ -1,8 +1,7 @@
 name: 'miniOrange Second Factor Authentication'
 type: module
 package: Second Factor Authentication
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 description: 'Easily add Two Factor Authentication to protect sites from unauthorized login attempts.'
 configure: miniorange_2fa.customer_setup
 # Information added by Drupal.org packaging script on 2021-08-11
diff --git a/src/Form/MoAuthLicensing.php b/src/Form/MoAuthLicensing.php
index 41c544b..7d52d28 100755
--- a/src/Form/MoAuthLicensing.php
+++ b/src/Form/MoAuthLicensing.php
@@ -399,15 +399,15 @@ class MoAuthLicensing extends FormBase
     <h3 style="text-align: center; margin:3%;">PAYMENT METHODS</h3><hr><br><br>
     <div class="row">
     <div class="col-md-3 payment_method_inner_divs">
-        <div><img src="'.$base_url . '/' . drupal_get_path("module", "miniorange_2fa") . '/includes/images/card_payment.png" width="120" ><h4></h4></div><hr>
+        <div><img src="'.$base_url . '/' . \Drupal::service('extension.list.module')->getPath("miniorange_2fa") . '/includes/images/card_payment.png" width="120" ><h4></h4></div><hr>
         <p>If the payment is made through Credit Card/International Debit Card, the license will be created automatically once the payment is completed.</p>
     </div> 
     <div class="col-md-3 payment_method_inner_divs">
-        <div><img src="'.$base_url . '/' . drupal_get_path("module", "miniorange_2fa") . '/includes/images/bank_transfer.png" width="150" ><h4><h4></div><hr>
+        <div><img src="'.$base_url . '/' . \Drupal::service('extension.list.module')->getPath("miniorange_2fa") . '/includes/images/bank_transfer.png" width="150" ><h4><h4></div><hr>
         <p>If you want to use bank transfer for the payment then contact us at <a href="mailto:drupalsupport@xecurify.com">drupalsupport@xecurify.com</a> so that we can provide you the bank details.</p>
     </div>
     <div class="col-md-3 payment_method_inner_divs">
-        <div><img src="'.$base_url . '/' . drupal_get_path("module", "miniorange_2fa") . '/includes/images/paypal.png" width="120"><h4></h4></ iv><hr>
+        <div><img src="'.$base_url . '/' . \Drupal::service('extension.list.module')->getPath("miniorange_2fa") . '/includes/images/paypal.png" width="120"><h4></h4></ iv><hr>
         <p>Use the following PayPal ID <a href="mailto:drupalsupport@xecurify.com">drupalsupport@xecurify.com</a> for making the payment via PayPal.</p>
     </div>
     </div>
diff --git a/src/Form/authenticate_user.php b/src/Form/authenticate_user.php
index 3b1c4bb..ac577b2 100755
--- a/src/Form/authenticate_user.php
+++ b/src/Form/authenticate_user.php
@@ -492,7 +492,7 @@ class authenticate_user extends FormBase {
 
         $form['header']['#markup'] .= ('<div class="mo2f-info mo2f-text-center">'.t('A verification email is sent to your registered email.').'</div>
                   <div class="mo2f-info mo2f-text-center">'.t('We are waiting for your approval...').'</div>');
-        $image_path = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/ajax-loader-login.gif');
+        $image_path = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/ajax-loader-login.gif');
         $form['header']['#markup'] .= '<div class="mo2f-text-center"><img class="mo2f_image" src="' . $image_path . '"></div>';
 
         $form['txId'] = array(
@@ -578,7 +578,7 @@ class authenticate_user extends FormBase {
         $form['header']['#markup'] .= t('<div class="mo2f-message mo2f-message-status">' . $message . '</div>');
         $form['header']['#markup'] .= ('<div class="mo2f-info mo2f-text-center">'.t('A Push Notification has been sent to your miniOrange Authenticator App.').'</div>
                   <div class="mo2f-info mo2f-text-center">'.t('We are waiting for your approval...').'</div>');
-        $image_path = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/ajax-loader-login.gif');
+        $image_path = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/ajax-loader-login.gif');
         $form['header']['#markup'] .= '<div class="mo2f-text-center"><img class="mo2f_image" src="' . $image_path . '"></div>';
 
         $form['txId'] = array(
diff --git a/src/Form/configure_google_authenticator.php b/src/Form/configure_google_authenticator.php
index 17489f1..97a7889 100755
--- a/src/Form/configure_google_authenticator.php
+++ b/src/Form/configure_google_authenticator.php
@@ -20,10 +20,10 @@ class configure_google_authenticator extends FormBase
     public function buildForm(array $form, FormStateInterface $form_state)
     {
         global $base_url;
-        $androidAppLink = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/android-google-authenticator-app-link.png');
-        $iPhoneAppLink = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-link.png');
-        $androidAppQR = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/android-google-authenticator-app-qr.jpg');
-        $iPhoneAppQR = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-qr.jpg');
+        $androidAppLink = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/android-google-authenticator-app-link.png');
+        $iPhoneAppLink = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-link.png');
+        $androidAppQR = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/android-google-authenticator-app-qr.jpg');
+        $iPhoneAppQR = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-qr.jpg');
 
         $form['markup_library'] = array(
             '#attached' => array(
diff --git a/src/Form/configure_qrcode_authentication.php b/src/Form/configure_qrcode_authentication.php
index b63871c..7c3deb5 100755
--- a/src/Form/configure_qrcode_authentication.php
+++ b/src/Form/configure_qrcode_authentication.php
@@ -55,10 +55,10 @@ class configure_qrcode_authentication extends FormBase
             $messageHeader = t( 'Configure QR Code Authentication' );
         }
 
-        $androidAppLink = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/android-google-authenticator-app-link.png');
-        $iPhoneAppLink  = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-link.png');
-        $androidAppQR   = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/android-mo-authenticator-app-qr.jpg');
-        $iPhoneAppQR    = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/iphone-mo-authenticator-app-qr.png');
+        $androidAppLink = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/android-google-authenticator-app-link.png');
+        $iPhoneAppLink  = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-link.png');
+        $androidAppQR   = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/android-mo-authenticator-app-qr.jpg');
+        $iPhoneAppQR    = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/iphone-mo-authenticator-app-qr.png');
 
         if ( array_key_exists('txId', $input ) === FALSE ) {
             $user_email       = $custom_attribute[0]->miniorange_registered_email;
diff --git a/src/Form/miniorange_2fa_inline_registration.php b/src/Form/miniorange_2fa_inline_registration.php
index ab421a1..4f3c0d7 100755
--- a/src/Form/miniorange_2fa_inline_registration.php
+++ b/src/Form/miniorange_2fa_inline_registration.php
@@ -1033,8 +1033,8 @@ class miniorange_2fa_inline_registration extends FormBase
             $qrCode = $response->qrCode;
             $image = new FormattableMarkup('<img class="mo2f_image" src="data:image/jpg;base64, '.$qrCode.'"/>', [':src' => $qrCode]);
 
-            $iPhoneAppLink = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-link.png');
-            $androidAppLink = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/android-google-authenticator-app-link.png');
+            $iPhoneAppLink = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/iphone-google-authenticator-app-link.png');
+            $androidAppLink = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/android-google-authenticator-app-link.png');
 
             $form['actions_31'] = array(
                     '#markup' => '<div class="mo2f-modal">
diff --git a/src/Form/test_email_verification.php b/src/Form/test_email_verification.php
index 915c347..b17c9e4 100755
--- a/src/Form/test_email_verification.php
+++ b/src/Form/test_email_verification.php
@@ -74,7 +74,7 @@ class test_email_verification extends FormBase
                     '#attributes' => array( 'style' => 'padding:2% 2% 20% 2%; margin-bottom:2%' ),
                 );
                 $form['mo_test_email_verification_push_notification']['header']['#markup'] = '<br><hr><br><div class="mo2f-text-center"><div class="mo_auth_font_type">'. $divMessage .'</div><br><div class="mo_auth_font_type mo2f-text-center"><strong>'.t('We are waiting for your approval...').'</strong></div><br>';
-                $image_path = file_create_url($base_url . '/' . drupal_get_path('module', 'miniorange_2fa') . '/includes/images/ajax-loader-login.gif');
+                $image_path = \Drupal::service('file_url_generator')->generateAbsoluteString($base_url . '/' . \Drupal::service('extension.list.module')->getPath('miniorange_2fa') . '/includes/images/ajax-loader-login.gif');
                 $form['mo_test_email_verification_push_notification']['loader']['#markup'] = '<div class="mo2f-text-center"><img src="' . $image_path . '" /></div>';
 
                 /**
diff --git a/src/MoAuthUtilities.php b/src/MoAuthUtilities.php
index 4f5b699..98a527c 100755
--- a/src/MoAuthUtilities.php
+++ b/src/MoAuthUtilities.php
@@ -95,7 +95,7 @@ class MoAuthUtilities {
         $session = self::getSession();
         $session->set( 'mo_auth', array( 'status' => '1ST_FACTOR_AUTHENTICATED', 'uid' => $user_id, 'challenged' => 0, 'user_email' => $user->getEmail(), 'moResetPass' => $tmpDestination ) );
         $session->save();
-        
+
         /**
        * Login without 2FA if backdoor url is enabled and user is admin.
        */
@@ -897,7 +897,7 @@ class MoAuthUtilities {
                 <h3>'. t('Looking for a Drupal Web Security module?') .'</h3>
                     <tr class="mo_ns_row">
                         <th class="mo_ns_image1"><img
-                                    src="'.$base_url . '/' . drupal_get_path("module", "miniorange_2fa") . '/includes/images/security.jpg"
+                                    src="'.$base_url . '/' . \Drupal::service('extension.list.module')->getPath("miniorange_2fa") . '/includes/images/security.jpg"
                                     alt="security icon" height=150px width=44%>
                            <br>
                         <strong>'. t('Drupal Website Security') .'</strong>

diff --git a/composer.json b/composer.json
index d03c2fb..91f7748 100644
--- a/composer.json
+++ b/composer.json
@@ -3,6 +3,6 @@
     "description": "Enables differential serving of JavaScript.",
     "type": "drupal-module",
     "require": {
-        "drupal/core": "^8 || ^9"
+        "drupal/core": "^9.3 || ^10"
     }
 }
diff --git a/differential_serve.info.yml b/differential_serve.info.yml
index 1115640..a30b508 100644
--- a/differential_serve.info.yml
+++ b/differential_serve.info.yml
@@ -1,5 +1,4 @@
 name: 'Differential Serve'
 description: 'Enables differential serving of JavaScript.'
 type: module
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
diff --git a/src/Asset/DifferentialServeJsCollectionRenderer.php b/src/Asset/DifferentialServeJsCollectionRenderer.php
index 5fb3ddb..6af91e3 100644
--- a/src/Asset/DifferentialServeJsCollectionRenderer.php
+++ b/src/Asset/DifferentialServeJsCollectionRenderer.php
@@ -33,7 +33,7 @@ class DifferentialServeJsCollectionRenderer implements AssetCollectionRendererIn
     $elements = $this->inner->render($js_assets);
 
     foreach (array_filter($js_assets, [get_class($this), 'isDifferentiallyServed']) as $js_asset) {
-      $src = file_url_transform_relative(file_create_url($js_asset['data']));
+      $src = \Drupal::service('file_url_generator')->generateString($js_asset['data']);
 
       foreach ($elements as $key => $element) {
         if (isset($element['#attributes']['src']) && strpos($element['#attributes']['src'], $src) === 0) {
diff --git a/tests/src/Kernel/AssetMangleTest.php b/tests/src/Kernel/AssetMangleTest.php
index 4f3ce81..751a317 100644
--- a/tests/src/Kernel/AssetMangleTest.php
+++ b/tests/src/Kernel/AssetMangleTest.php
@@ -56,7 +56,7 @@ class AssetMangleTest extends KernelTestBase {
 
     $script = reset($elements);
     $this->assertTrue(isset($script->attributes()['nomodule']), 'Has "nomodule" attribute set.');
-    $this->assertRegExp('`window\._ESM||window\._dsLoad\(".+differential_serve_test/js/asset.legacy.js\b[^"]*"\)`', (string) $script, 'Script loaded inline.');
+    $this->assertMatchesRegularExpression('`window\._ESM||window\._dsLoad\(".+differential_serve_test/js/asset.legacy.js\b[^"]*"\)`', (string) $script, 'Script loaded inline.');
 
     $elements = $this->cssSelect('body > script[src*="differential_serve/js/loader.js?"]');
     $this->assertCount(1, $elements, 'Legacy loader script loaded.');

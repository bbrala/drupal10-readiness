diff --git a/src/Controller/LunrSearchController.php b/src/Controller/LunrSearchController.php
index 3ce0ac5..ad89d1b 100644
--- a/src/Controller/LunrSearchController.php
+++ b/src/Controller/LunrSearchController.php
@@ -77,15 +77,15 @@ class LunrSearchController extends ControllerBase {
 
     $build['#attached']['library'][] = 'lunr/search';
     $build['#attached']['drupalSettings']['lunr']['searchSettings'][$lunr_search->id()] = [
-      'indexPath' => file_url_transform_relative(file_create_url($lunr_search->getIndexPath()) . '?v=' . $lunr_search->getLastIndexTime()),
-      'documentPathPattern' => file_url_transform_relative(file_create_url($lunr_search->getDocumentPathPattern()) . '?v=' . $lunr_search->getLastIndexTime()),
+      'indexPath' => \Drupal::service('file_url_generator')->transformRelative(\Drupal::service('file_url_generator')->generateAbsoluteString($lunr_search->getIndexPath()) . '?v=' . $lunr_search->getLastIndexTime()),
+      'documentPathPattern' => \Drupal::service('file_url_generator')->transformRelative(\Drupal::service('file_url_generator')->generateAbsoluteString($lunr_search->getDocumentPathPattern()) . '?v=' . $lunr_search->getLastIndexTime()),
       'displayField' => $lunr_search->getDisplayField(),
       'resultsPerPage' => $lunr_search->getResultsPerPage(),
       'id' => $lunr_search->id(),
     ];
     $suffix = '?' . \Drupal::state()->get('system.css_js_query_string', '0');
-    $build['#attached']['drupalSettings']['lunr']['workerPath'] = base_path() . drupal_get_path('module', 'lunr') . '/js/search.worker.js' . $suffix;
-    $build['#attached']['drupalSettings']['lunr']['lunrPath'] = base_path() . drupal_get_path('module', 'lunr') . '/js/vendor/lunr/lunr.min.js' . $suffix;
+    $build['#attached']['drupalSettings']['lunr']['workerPath'] = base_path() . \Drupal::service('extension.list.module')->getPath('lunr') . '/js/search.worker.js' . $suffix;
+    $build['#attached']['drupalSettings']['lunr']['lunrPath'] = base_path() . \Drupal::service('extension.list.module')->getPath('lunr') . '/js/vendor/lunr/lunr.min.js' . $suffix;
 
     CacheableMetadata::createFromObject($lunr_search)->applyTo($build);
 
diff --git a/src/EventSubscriber/TomePathSubscriber.php b/src/EventSubscriber/TomePathSubscriber.php
index 7f84d5a..6dc5099 100644
--- a/src/EventSubscriber/TomePathSubscriber.php
+++ b/src/EventSubscriber/TomePathSubscriber.php
@@ -57,8 +57,8 @@ class TomePathSubscriber implements EventSubscriberInterface {
         $event->addPath(file_create_url($filename), ['language_processed' => 'language_processed']);
       }
     }
-    $event->addPath(drupal_get_path('module', 'lunr') . '/js/search.worker.js', ['language_processed' => 'language_processed']);
-    $event->addPath(drupal_get_path('module', 'lunr') . '/js/vendor/lunr/lunr.min.js', ['language_processed' => 'language_processed']);
+    $event->addPath(\Drupal::service('extension.list.module')->getPath('lunr') . '/js/search.worker.js', ['language_processed' => 'language_processed']);
+    $event->addPath(\Drupal::service('extension.list.module')->getPath('lunr') . '/js/vendor/lunr/lunr.min.js', ['language_processed' => 'language_processed']);
   }
 
   /**
diff --git a/tests/src/FunctionalJavascript/LunrSearchTest.php b/tests/src/FunctionalJavascript/LunrSearchTest.php
index 23c1320..7bbac4a 100644
--- a/tests/src/FunctionalJavascript/LunrSearchTest.php
+++ b/tests/src/FunctionalJavascript/LunrSearchTest.php
@@ -33,7 +33,7 @@ class LunrSearchTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $user = $this->drupalCreateUser(['administer lunr search']);
     $this->drupalLogin($user);

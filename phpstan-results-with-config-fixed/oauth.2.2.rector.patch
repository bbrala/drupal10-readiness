diff --git a/src/Authentication/Provider/OAuthDrupalProvider.php b/src/Authentication/Provider/OAuthDrupalProvider.php
index 09d93ea..127b7da 100644
--- a/src/Authentication/Provider/OAuthDrupalProvider.php
+++ b/src/Authentication/Provider/OAuthDrupalProvider.php
@@ -99,7 +99,7 @@ class OAuthDrupalProvider implements AuthenticationProviderInterface {
   /**
    * {@inheritdoc}
    */
-  public function handleException(GetResponseForExceptionEvent $event) {
+  public function handleException(\Symfony\Component\HttpKernel\Event\ExceptionEvent $event) {
     return FALSE;
   }
 
diff --git a/src/Form/OAuthAddConsumerForm.php b/src/Form/OAuthAddConsumerForm.php
index eafe607..d7c683b 100644
--- a/src/Form/OAuthAddConsumerForm.php
+++ b/src/Form/OAuthAddConsumerForm.php
@@ -89,8 +89,8 @@ class OAuthAddConsumerForm extends FormBase {
    * {@inheritdoc}
    */
   public function submitForm(array &$form, FormStateInterface $form_state) {
-    $consumer_key = user_password(32);
-    $consumer_secret  = user_password(32);
+    $consumer_key = \Drupal::service('password_generator')->generate(32);
+    $consumer_secret  = \Drupal::service('password_generator')->generate(32);
     $key_hash = sha1($consumer_key);
     $uid = $form_state->getValue('uid');
     $consumer = array(

diff --git a/colorbox.theme.inc b/colorbox.theme.inc
index 30fa7a5..9ee8ad1 100644
--- a/colorbox.theme.inc
+++ b/colorbox.theme.inc
@@ -132,7 +132,7 @@ function template_preprocess_colorbox_formatter(&$variables) {
     $variables['url'] = $style->buildUrl($image_uri);
   }
   else {
-    $variables['url'] = file_create_url($image_uri);
+    $variables['url'] = \Drupal::service('file_url_generator')->generateAbsoluteString($image_uri);
   }
 
   // If File Entity module is enabled, load attribute values from file entity.
diff --git a/tests/src/FunctionalJavascript/ColorboxJavascriptTest.php b/tests/src/FunctionalJavascript/ColorboxJavascriptTest.php
index fcb09ab..ad5d7f8 100644
--- a/tests/src/FunctionalJavascript/ColorboxJavascriptTest.php
+++ b/tests/src/FunctionalJavascript/ColorboxJavascriptTest.php
@@ -138,7 +138,7 @@ class ColorboxJavascriptTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->createContentType(['type' => 'page']);
     FieldStorageConfig::create([

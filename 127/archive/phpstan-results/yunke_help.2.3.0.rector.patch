diff --git a/src/EventSubscriber/toolFunRegistryRequestSubscriber.php b/src/EventSubscriber/toolFunRegistryRequestSubscriber.php
index 97e584a..26216cd 100644
--- a/src/EventSubscriber/toolFunRegistryRequestSubscriber.php
+++ b/src/EventSubscriber/toolFunRegistryRequestSubscriber.php
@@ -32,10 +32,10 @@ class toolFunRegistryRequestSubscriber implements EventSubscriberInterface {
   /**
    * 加载工具函数库.
    *
-   * @param \Symfony\Component\HttpKernel\Event\GetResponseEvent $event
+   * @param \Symfony\Component\HttpKernel\Event\RequestEvent $event
    *   The request event.
    */
-  public function onRequest(GetResponseEvent $event) {
+  public function onRequest(\Symfony\Component\HttpKernel\Event\RequestEvent $event) {
     if ($event->getRequestType() === HttpKernelInterface::MASTER_REQUEST) {
         $this->moduleHandler->loadInclude('yunke_help', 'php', 'toolFunLib');
     }
diff --git a/src/Form/MultiStepForm.php b/src/Form/MultiStepForm.php
index 610570a..cf1cd70 100644
--- a/src/Form/MultiStepForm.php
+++ b/src/Form/MultiStepForm.php
@@ -91,7 +91,7 @@ class MultiStepForm extends FormBase
     $kernel = \Drupal::service('http_kernel.basic');
     $request = \Drupal::request();
     $type = \Symfony\Component\HttpKernel\HttpKernelInterface::MASTER_REQUEST;
-    $event = new \Symfony\Component\HttpKernel\Event\GetResponseForControllerResultEvent($kernel, $request, $type, $return);
+    $event = new \Symfony\Component\HttpKernel\Event\ViewEvent($kernel, $request, $type, $return);
     \Drupal::service('event_dispatcher')->dispatch(\Symfony\Component\HttpKernel\KernelEvents::VIEW, $event);
     $response = $event->getResponse();
     $form_state->setResponse($response);
diff --git a/src/Form/TestForm.php b/src/Form/TestForm.php
index e4a5dd4..d092983 100644
--- a/src/Form/TestForm.php
+++ b/src/Form/TestForm.php
@@ -85,6 +85,6 @@ class TestForm extends FormBase
         $this->plugin->submitForm($form['subform'], $subformState);
 
         //提交父表单
-        drupal_set_message($this->t('父表单：电话为： @number', array('@number' => $form_state->getValue('phone_number'))));
+        $this->messenger()->addStatus($this->t('父表单：电话为： @number', array('@number' => $form_state->getValue('phone_number'))));
     }
 }
diff --git a/src/PluginForm.php b/src/PluginForm.php
index 89dc4f3..492d9b7 100644
--- a/src/PluginForm.php
+++ b/src/PluginForm.php
@@ -57,7 +57,7 @@ class PluginForm
     public function submitForm(array & $form, FormStateInterface $form_state)
     {
         $value = "子表单值：" . $form_state->getValue(['a', 'b', 'c1']);
-        drupal_set_message($value);
+        \Drupal::messenger()->addStatus($value);
     }
 
 }

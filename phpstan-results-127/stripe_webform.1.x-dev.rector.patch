diff --git a/src/Event/StripeWebformWebhookEvent.php b/src/Event/StripeWebformWebhookEvent.php
index 411350a..d8a9a9b 100644
--- a/src/Event/StripeWebformWebhookEvent.php
+++ b/src/Event/StripeWebformWebhookEvent.php
@@ -8,7 +8,7 @@ use Symfony\Component\EventDispatcher\Event;
 /**
  * Event that is fired when a webhook related to a webform submission is received
  */
-class StripeWebformWebhookEvent extends Event {
+class StripeWebformWebhookEvent extends \Symfony\Contracts\EventDispatcher\Event {
 
   const EVENT_NAME = StripeWebformEvents::WEBHOOK;
 
diff --git a/src/EventSubscriber/StripeWebformEventSubscriber.php b/src/EventSubscriber/StripeWebformEventSubscriber.php
index 52e95b0..937ab67 100644
--- a/src/EventSubscriber/StripeWebformEventSubscriber.php
+++ b/src/EventSubscriber/StripeWebformEventSubscriber.php
@@ -85,7 +85,7 @@ class StripeWebformEventSubscriber implements EventSubscriberInterface {
       if ($webform_submission) {
         $webhook_event = new StripeWebformWebhookEvent($stripe_event['type'], $webform_submission, $stripe_event);
         $this->event_dispatcher
-          ->dispatch(StripeWebformWebhookEvent::EVENT_NAME, $webhook_event);
+          ->dispatch($webhook_event, StripeWebformWebhookEvent::EVENT_NAME);
       }
     }
 
diff --git a/src/Plugin/WebformHandler/StripeWebformHandler.php b/src/Plugin/WebformHandler/StripeWebformHandler.php
index ba126ef..72e65d9 100644
--- a/src/Plugin/WebformHandler/StripeWebformHandler.php
+++ b/src/Plugin/WebformHandler/StripeWebformHandler.php
@@ -286,7 +286,7 @@ class StripeWebformHandler extends WebformHandlerBase {
       }
     }
     catch (\Stripe\Error\Base $e) {
-      drupal_set_message($this->t('Stripe error: %error', ['%error' => $e->getMessage()]), 'error');
+      $this->messenger()->addError($this->t('Stripe error: %error', ['%error' => $e->getMessage()]));
     }
  }
 
diff --git a/stripe_webform.info.yml b/stripe_webform.info.yml
index 156588a..efc9226 100644
--- a/stripe_webform.info.yml
+++ b/stripe_webform.info.yml
@@ -1,8 +1,7 @@
 name: 'Stripe webform'
 type: module
 description: 'Provides a stripe webform element and default handlers'
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^8 || ^9 || ^10
 package: Stripe
 dependencies:
   - stripe

diff --git a/message_subscribe_email/message_subscribe_email.install b/message_subscribe_email/message_subscribe_email.install
index ed7243a..cc1b3e9 100644
--- a/message_subscribe_email/message_subscribe_email.install
+++ b/message_subscribe_email/message_subscribe_email.install
@@ -18,7 +18,7 @@ function message_subscribe_email_install() {
   }
   else {
     // Pre-Drupal 8.8.
-    $display = entity_get_form_display('user', 'user', 'default');
+    $display = \Drupal::service('entity_display.repository')->getFormDisplay('user', 'user', 'default');
   }
   if (!$display->getComponent('message_subscribe_email')) {
     $settings = [
diff --git a/message_subscribe_email/tests/src/Functional/ViewsTest.php b/message_subscribe_email/tests/src/Functional/ViewsTest.php
index 1b0a74b..9f5a0d2 100644
--- a/message_subscribe_email/tests/src/Functional/ViewsTest.php
+++ b/message_subscribe_email/tests/src/Functional/ViewsTest.php
@@ -38,7 +38,7 @@ class ViewsTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     $this->flagService = $this->container->get('flag');
diff --git a/message_subscribe_email/tests/src/FunctionalJavascript/MessageSubscribeEmailTest.php b/message_subscribe_email/tests/src/FunctionalJavascript/MessageSubscribeEmailTest.php
index 8bed8f9..5a6a03d 100644
--- a/message_subscribe_email/tests/src/FunctionalJavascript/MessageSubscribeEmailTest.php
+++ b/message_subscribe_email/tests/src/FunctionalJavascript/MessageSubscribeEmailTest.php
@@ -40,7 +40,7 @@ class MessageSubscribeEmailTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     // Add some nodes.
diff --git a/message_subscribe_email/tests/src/Kernel/Form/AdminSettingsTest.php b/message_subscribe_email/tests/src/Kernel/Form/AdminSettingsTest.php
index c0c3f3d..0bc2bed 100644
--- a/message_subscribe_email/tests/src/Kernel/Form/AdminSettingsTest.php
+++ b/message_subscribe_email/tests/src/Kernel/Form/AdminSettingsTest.php
@@ -19,7 +19,7 @@ class AdminSettingsTest extends MessageSubscribeAdminSettingsTest {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     $this->values['message_subscribe_email_flag_prefix'] = [
diff --git a/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailNotificationsTest.php b/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailNotificationsTest.php
index 93f003b..c3c6bdb 100644
--- a/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailNotificationsTest.php
+++ b/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailNotificationsTest.php
@@ -15,7 +15,7 @@ class MessageSubscribeEmailNotificationsTest extends MessageSubscribeEmailTestBa
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     $flag = $this->flagService->getFlagById('subscribe_node');
diff --git a/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailSubscribersTest.php b/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailSubscribersTest.php
index cf22330..7790733 100644
--- a/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailSubscribersTest.php
+++ b/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailSubscribersTest.php
@@ -18,7 +18,7 @@ class MessageSubscribeEmailSubscribersTest extends MessageSubscribeEmailTestBase
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     // Opt out of default email notifications and subscribe to node 1.
diff --git a/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailTestBase.php b/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailTestBase.php
index ac88e23..16612c4 100644
--- a/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailTestBase.php
+++ b/message_subscribe_email/tests/src/Kernel/MessageSubscribeEmailTestBase.php
@@ -46,7 +46,7 @@ abstract class MessageSubscribeEmailTestBase extends MessageSubscribeTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     $this->installConfig(['message_subscribe_email']);
diff --git a/message_subscribe_email/tests/src/Unit/ManagerTest.php b/message_subscribe_email/tests/src/Unit/ManagerTest.php
index 5725359..bb99279 100644
--- a/message_subscribe_email/tests/src/Unit/ManagerTest.php
+++ b/message_subscribe_email/tests/src/Unit/ManagerTest.php
@@ -18,6 +18,7 @@ use Drupal\Tests\UnitTestCase;
  */
 class ManagerTest extends UnitTestCase {
 
+  use \Prophecy\PhpUnit\ProphecyTrait;
   /**
    * Tests the flag retrieval.
    *

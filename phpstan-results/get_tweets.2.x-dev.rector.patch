diff --git a/get_tweets.info.yml b/get_tweets.info.yml
index 09aeea6..95a51e8 100644
--- a/get_tweets.info.yml
+++ b/get_tweets.info.yml
@@ -1,6 +1,6 @@
 name: Get Tweets
 description: 'Provides functionality for import tweets in Drupal nodes.'
-core_version_requirement: ^8.8.3 || ^9
+core_version_requirement: ^9.3 || ^10
 package: Social
 type: module
 configure: get_tweets.config_form
diff --git a/src/GetTweetsBase.php b/src/GetTweetsBase.php
index 6dbe5c3..38348a1 100644
--- a/src/GetTweetsBase.php
+++ b/src/GetTweetsBase.php
@@ -301,7 +301,7 @@ class GetTweetsBase {
         $data &&
         $this->fileSystem->prepareDirectory($dir, FileSystemInterface::CREATE_DIRECTORY)
       ) {
-        $file = file_save_data($data, $dir . $path_info['basename'], FileSystemInterface::EXISTS_RENAME);
+        $file = \Drupal::service('file.repository')->writeData($data, $dir . $path_info['basename'], FileSystemInterface::EXISTS_RENAME);
         $node->set('field_tweet_local_image', $file);
       }
     }
diff --git a/tests/src/Functional/GetTweetsTest.php b/tests/src/Functional/GetTweetsTest.php
index 8103527..3bb2f64 100644
--- a/tests/src/Functional/GetTweetsTest.php
+++ b/tests/src/Functional/GetTweetsTest.php
@@ -33,7 +33,7 @@ class GetTweetsTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->user = $this->drupalCreateUser([
       'administer site configuration',
@@ -62,9 +62,10 @@ class GetTweetsTest extends BrowserTestBase {
       'consumer_key' => 'invalid',
       'consumer_secret' => 'invalid',
     ];
+    $this->drupalGet('admin/config/services/get-tweets');
 
     // Post the form.
-    $this->drupalPostForm('admin/config/services/get-tweets', $edit, t('Save configuration'));
+    $this->submitForm($edit, t('Save configuration'));
 
     $this->assertSession()->pageTextContains(t('Error: "Could not authenticate you." on query: "@query"', [
       '@query' => $test_query,

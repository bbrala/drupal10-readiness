diff --git a/file_history.info.yml b/file_history.info.yml
index c5d8946..8c1d07e 100644
--- a/file_history.info.yml
+++ b/file_history.info.yml
@@ -1,7 +1,7 @@
 name: File History
 type: module
 description: A upload/selector file form_API field_type to manage history of a configuration file
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: Form_API
 dependencies:
   - drupal:file
diff --git a/src/Element/FileHistory.php b/src/Element/FileHistory.php
index 6fa71ca..59bd64c 100644
--- a/src/Element/FileHistory.php
+++ b/src/Element/FileHistory.php
@@ -446,7 +446,7 @@ class FileHistory extends FormElement {
     $scheme = \Drupal::service('stream_wrapper_manager')->getScheme($path);
 
     if ($scheme == 'public') {
-      $filepath = file_create_url($path);
+      $filepath = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
       return Url::fromUri($filepath);
     }
     else {
@@ -491,7 +491,7 @@ class FileHistory extends FormElement {
         $file_data_for_validation = [
           'file_original_name' => $uploaded_file->getClientOriginalName(),
           'file_original_extension' => $uploaded_file->getClientOriginalExtension(),
-          'file_size' => $uploaded_file->getClientSize(),
+          'file_size' => $uploaded_file->getSize(),
           'file_path' => $uploaded_file->getRealPath(),
         ];
 

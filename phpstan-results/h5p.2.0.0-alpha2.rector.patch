diff --git a/src/Controller/H5PAJAX.php b/src/Controller/H5PAJAX.php
index 5a1937b..f6268f1 100644
--- a/src/Controller/H5PAJAX.php
+++ b/src/Controller/H5PAJAX.php
@@ -112,7 +112,7 @@ class H5PAJAX extends ControllerBase {
       ->fields($fields)
       ->execute();
 
-    $this->eventDispatcher->dispatch(FinishedEvent::FINISHED_EVENT, new FinishedEvent($fields));
+    $this->eventDispatcher->dispatch(new FinishedEvent($fields), FinishedEvent::FINISHED_EVENT);
 
     return new JsonResponse(['success' => TRUE]);
   }
diff --git a/src/Event/FinishedEvent.php b/src/Event/FinishedEvent.php
index 43eba57..6c2eee0 100644
--- a/src/Event/FinishedEvent.php
+++ b/src/Event/FinishedEvent.php
@@ -7,7 +7,7 @@ use Symfony\Component\EventDispatcher\Event;
 /**
  * Wraps a node insertion demo event for event listeners.
  */
-class FinishedEvent extends Event {
+class FinishedEvent extends \Symfony\Contracts\EventDispatcher\Event {
 
   const FINISHED_EVENT = 'h5p.finished';
 
diff --git a/src/Plugin/Field/FieldWidget/H5PUploadWidget.php b/src/Plugin/Field/FieldWidget/H5PUploadWidget.php
index d34a9d7..bfbe93e 100644
--- a/src/Plugin/Field/FieldWidget/H5PUploadWidget.php
+++ b/src/Plugin/Field/FieldWidget/H5PUploadWidget.php
@@ -66,7 +66,7 @@ class H5PUploadWidget extends H5PWidgetBase {
     $interface = H5PDrupal::getInstance('interface', $file_field);
     $h5p_path = $interface->getOption('default_path', 'h5p');
     $temporary_file_path = "public://{$h5p_path}/temp/" . uniqid('h5p-');
-    file_prepare_directory($temporary_file_path, FILE_CREATE_DIRECTORY);
+    \Drupal::service('file_system')->prepareDirectory($temporary_file_path, \Drupal\Core\File\FileSystemInterface::CREATE_DIRECTORY);
 
     // Validate file
     $files = file_save_upload($file_field, $validators, $temporary_file_path);

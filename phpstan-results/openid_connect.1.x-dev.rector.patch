diff --git a/src/OpenIDConnect.php b/src/OpenIDConnect.php
index c7323f3..1f5578d 100644
--- a/src/OpenIDConnect.php
+++ b/src/OpenIDConnect.php
@@ -631,11 +631,7 @@ class OpenIDConnect {
                 $basename = explode('?', $this->fileSystem->basename($claim_value))[0];
                 $data = file_get_contents($claim_value);
 
-                $file = file_save_data(
-                  $data,
-                  'public://user-picture-' . $account->id() . '-' . $basename,
-                  FileSystemInterface::EXISTS_RENAME
-                );
+                $file = \Drupal::service('file.repository')->writeData($data, 'public://user-picture-' . $account->id() . '-' . $basename, FileSystemInterface::EXISTS_RENAME);
 
                 // Cleanup the old file.
                 if ($file) {
diff --git a/tests/src/Unit/OpenIDConnectAuthmapTest.php b/tests/src/Unit/OpenIDConnectAuthmapTest.php
index 917778e..6a0f135 100644
--- a/tests/src/Unit/OpenIDConnectAuthmapTest.php
+++ b/tests/src/Unit/OpenIDConnectAuthmapTest.php
@@ -59,7 +59,7 @@ class OpenIDConnectAuthmapTest extends UnitTestCase {
   /**
    * {@inheritDoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->account = $this
diff --git a/tests/src/Unit/OpenIDConnectTest.php b/tests/src/Unit/OpenIDConnectTest.php
index 350bc4a..4e92208 100644
--- a/tests/src/Unit/OpenIDConnectTest.php
+++ b/tests/src/Unit/OpenIDConnectTest.php
@@ -138,7 +138,7 @@ class OpenIDConnectTest extends UnitTestCase {
   /**
    * {@inheritDoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $oldFileMock = $this->createMock(File::class);
diff --git a/tests/src/Unit/OpenIdConnectSessionTest.php b/tests/src/Unit/OpenIdConnectSessionTest.php
index 46fdb55..30e56c8 100644
--- a/tests/src/Unit/OpenIdConnectSessionTest.php
+++ b/tests/src/Unit/OpenIdConnectSessionTest.php
@@ -48,7 +48,7 @@ class OpenIdConnectSessionTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Mock the currentPath service.

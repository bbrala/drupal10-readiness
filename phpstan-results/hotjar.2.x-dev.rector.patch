diff --git a/src/SnippetBuilder.php b/src/SnippetBuilder.php
index 44b6808..a50caa3 100644
--- a/src/SnippetBuilder.php
+++ b/src/SnippetBuilder.php
@@ -142,7 +142,7 @@ class SnippetBuilder implements SnippetBuilderInterface, ContainerInjectionInter
     $query_string = $this->state->get('system.css_js_query_string') ?: '0';
     $query_string_separator = (strpos($uri, '?') !== FALSE) ? '&' : '?';
 
-    $url = file_url_transform_relative(file_create_url($uri));
+    $url = \Drupal::service('file_url_generator')->generateString($uri);
     $attachments['#attached']['html_head'][] = [
       [
         '#type' => 'html_tag',

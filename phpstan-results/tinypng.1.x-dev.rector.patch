diff --git a/composer.json b/composer.json
index fca497d..4c8b192 100644
--- a/composer.json
+++ b/composer.json
@@ -10,8 +10,8 @@
     }
   ],
   "require": {
-    "drupal/core": "^8 || ^9",
-    "tinify/tinify": "1.4.*"
+    "tinify/tinify": "1.4.*",
+    "drupal/core": "^9.3 || ^10"
   },
   "minimum-stability": "stable"
 }
diff --git a/src/TinyPng.php b/src/TinyPng.php
index 712d5a5..43ec907 100644
--- a/src/TinyPng.php
+++ b/src/TinyPng.php
@@ -101,7 +101,7 @@ class TinyPng implements TinyPngInterface, ContainerInjectionInterface {
    */
   public function setFromUrl($url) {
     $this->setApiKey();
-    $origin = file_create_url($url);
+    $origin = \Drupal::service('file_url_generator')->generateAbsoluteString($url);
     $this->tinyfySource = TinifyFromUrl($origin);
 
     return $this;
diff --git a/tinypng.info.yml b/tinypng.info.yml
index 38b2b85..fa0793f 100644
--- a/tinypng.info.yml
+++ b/tinypng.info.yml
@@ -1,6 +1,5 @@
 name: TinyPNG
 description: Provides TinyPNG integration
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 type: module
 configure: tinypng.settings.form

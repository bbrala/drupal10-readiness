diff --git a/src/Imce.php b/src/Imce.php
index 9479f81..33cc912 100644
--- a/src/Imce.php
+++ b/src/Imce.php
@@ -105,7 +105,7 @@ class Imce {
     $conf['root_url'] = preg_replace('@/(?:%2E|\.)$@i', '', file_create_url($conf['root_uri'] . '.'));
     // Convert to relative.
     if (!\Drupal::config('imce.settings')->get('abs_urls')) {
-      $conf['root_url'] = file_url_transform_relative($conf['root_url']);
+      $conf['root_url'] = \Drupal::service('file_url_generator')->transformRelative($conf['root_url']);
     }
     $conf['token'] = $user->isAnonymous() ? 'anon' : \Drupal::csrfToken()->get('imce');
     // Process folders.
diff --git a/src/Plugin/CKEditorPlugin/Imce.php b/src/Plugin/CKEditorPlugin/Imce.php
index a327687..e02d7b7 100644
--- a/src/Plugin/CKEditorPlugin/Imce.php
+++ b/src/Plugin/CKEditorPlugin/Imce.php
@@ -27,7 +27,7 @@ class Imce extends CKEditorPluginBase {
    * {@inheritdoc}
    */
   public function getFile() {
-    return drupal_get_path('module', 'imce') . '/js/plugins/ckeditor/imce.ckeditor.js';
+    return \Drupal::service('extension.list.module')->getPath('imce') . '/js/plugins/ckeditor/imce.ckeditor.js';
   }
 
   /**
@@ -51,8 +51,8 @@ class Imce extends CKEditorPluginBase {
    */
   public function getConfig(Editor $editor) {
     return [
-      'ImceImageIcon' => file_create_url($this->imageIcon()),
-      'ImceLinkIcon' => file_create_url($this->linkIcon()),
+      'ImceImageIcon' => \Drupal::service('file_url_generator')->generateAbsoluteString($this->imageIcon()),
+      'ImceLinkIcon' => \Drupal::service('file_url_generator')->generateAbsoluteString($this->linkIcon()),
     ];
   }
 
@@ -62,7 +62,7 @@ class Imce extends CKEditorPluginBase {
    * Uses the icon from drupalimage plugin.
    */
   public function imageIcon() {
-    return drupal_get_path('module', 'imce') . '/js/plugins/ckeditor/icons/imceimage.png';
+    return \Drupal::service('extension.list.module')->getPath('imce') . '/js/plugins/ckeditor/icons/imceimage.png';
   }
 
   /**
@@ -71,7 +71,7 @@ class Imce extends CKEditorPluginBase {
    * Uses the icon from drupallink plugin.
    */
   public function linkIcon() {
-    return drupal_get_path('module', 'imce') . '/js/plugins/ckeditor/icons/imcelink.png';
+    return \Drupal::service('extension.list.module')->getPath('imce') . '/js/plugins/ckeditor/icons/imcelink.png';
   }
 
 }
diff --git a/tests/src/Kernel/Plugin/KernelTestBasePlugin.php b/tests/src/Kernel/Plugin/KernelTestBasePlugin.php
index 30e5690..439d794 100644
--- a/tests/src/Kernel/Plugin/KernelTestBasePlugin.php
+++ b/tests/src/Kernel/Plugin/KernelTestBasePlugin.php
@@ -132,7 +132,7 @@ abstract class KernelTestBasePlugin extends KernelTestBase {
    *   uri.
    */
   protected function getTestFileUri() {
-    \Drupal::service('file_system')->copy(drupal_get_path('module', 'imce') . '/tests/files/ciandt.jpg', PublicStream::basePath());
+    \Drupal::service('file_system')->copy(\Drupal::service('extension.list.module')->getPath('imce') . '/tests/files/ciandt.jpg', PublicStream::basePath());
     return 'public://ciandt.jpg';
   }
 

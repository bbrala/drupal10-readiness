diff --git a/src/Form/SettingsForm.php b/src/Form/SettingsForm.php
index 43b01c4..039ed8e 100644
--- a/src/Form/SettingsForm.php
+++ b/src/Form/SettingsForm.php
@@ -32,7 +32,7 @@ class SettingsForm extends FormBase {
    * @param \Drupal\media_twig_tools\Config\MediaTwigToolsConfig $conf
    *   The media twig tools config.
    */
-  public function __construct(MediaTwigToolsConfig $conf) {
+  public function __construct(MediaTwigToolsConfig $conf, private \Drupal\media_twig_tools\Config\MediaTwigToolsConfig $mediaTwigToolsConfig) {
     $this->conf = $conf;
   }
 
@@ -41,7 +41,7 @@ class SettingsForm extends FormBase {
    */
   public static function create(ContainerInterface $container) {
     return new static(
-      $container->get(MediaTwigToolsConfig::SERVICE_NAME),
+      $this->mediaTwigToolsConfig,
     );
   }
 
diff --git a/tests/src/Unit/ImageBuilderTest.php b/tests/src/Unit/ImageBuilderTest.php
index 1d43728..ccb07fd 100644
--- a/tests/src/Unit/ImageBuilderTest.php
+++ b/tests/src/Unit/ImageBuilderTest.php
@@ -103,9 +103,7 @@ class ImageBuilderTest extends UnitTestCase {
    *   The mock.
    */
   protected function mockConfig() {
-    $conf = $this->getMockBuilder(MediaTwigToolsConfig::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $conf = $this->createMock(MediaTwigToolsConfig::class);
 
     $conf->expects($this->any())
       ->method('getDirname')
@@ -116,15 +114,11 @@ class ImageBuilderTest extends UnitTestCase {
       ->will($this->returnValue('landscape'));
 
     // Init the image style storage mock.
-    $imageStyleStorage = $this->getMockBuilder(ImageStyleStorage::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $imageStyleStorage = $this->createMock(ImageStyleStorage::class);
     $imageStyleStorage->expects($this->any())
       ->method('load')
       ->willReturnCallback(function ($id) {
-        $imageStyleMock = $this->getMockBuilder(ImageStyle::class)
-          ->disableOriginalConstructor()
-          ->getMock();
+        $imageStyleMock = $this->createMock(ImageStyle::class);
         $imageStyleMock->expects($this->any())
           ->method('id')
           ->will($this->returnValue($id));
@@ -147,9 +141,7 @@ class ImageBuilderTest extends UnitTestCase {
    */
   protected function mockFile() {
     // Define file.
-    $file = $this->getMockBuilder(File::class)
-      ->disableOriginalConstructor()
-      ->getMock();
+    $file = $this->createMock(File::class);
     $file->expects($this->any())
       ->method('id')
       ->will($this->returnValue(1));

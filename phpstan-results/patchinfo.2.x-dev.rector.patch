diff --git a/patchinfo.module b/patchinfo.module
index 6469483..b25156c 100644
--- a/patchinfo.module
+++ b/patchinfo.module
@@ -324,7 +324,7 @@ function patchinfo_theme($existing, $type, $theme, $path) {
  * Implements hook_theme_registry_alter().
  */
 function patchinfo_theme_registry_alter(&$theme_registry) {
-  $module_path = drupal_get_path('module', 'patchinfo');
+  $module_path = \Drupal::service('extension.list.module')->getPath('patchinfo');
 
   if (isset($theme_registry['update_report'])) {
     // Replace template location for update report with our own templates
diff --git a/tests/src/Functional/PatchInfoTest.php b/tests/src/Functional/PatchInfoTest.php
index 43c8f23..8c8441d 100644
--- a/tests/src/Functional/PatchInfoTest.php
+++ b/tests/src/Functional/PatchInfoTest.php
@@ -49,7 +49,7 @@ class PatchInfoTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->users['patchinfo'] = $this->drupalCreateUser([
@@ -170,8 +170,9 @@ class PatchInfoTest extends BrowserTestBase {
 
     // Exclude modules.
     $edit['patchinfo_exclude_from_update_check'] = 'test_info_source' . "\r\n" . 'test_theme_mixed_sources' . "\r\n" . 'test_composer_source';
-    $this->drupalPostForm('admin/reports/updates/settings', $edit, t('Save configuration'));
-    $this->assertResponse(200);
+    $this->drupalGet('admin/reports/updates/settings');
+    $this->submitForm($edit, t('Save configuration'));
+    $this->assertSession()->statusCodeEquals(200);
     $this->assertSession()->pageTextContains('test_info_source');
     $this->assertSession()->pageTextContains('test_composer_source');
     $this->assertSession()->pageTextContains('test_theme_mixed_sources');
@@ -203,8 +204,9 @@ class PatchInfoTest extends BrowserTestBase {
 
     // Exclude no modules.
     $edit['patchinfo_exclude_from_update_check'] = NULL;
-    $this->drupalPostForm('admin/reports/updates/settings', $edit, t('Save configuration'));
-    $this->assertResponse(200);
+    $this->drupalGet('admin/reports/updates/settings');
+    $this->submitForm($edit, t('Save configuration'));
+    $this->assertSession()->statusCodeEquals(200);
     $this->assertSession()->pageTextNotContains('test_info_source');
     $this->assertSession()->pageTextNotContains('test_composer_source');
     $this->assertSession()->pageTextNotContains('test_theme_mixed_sources');

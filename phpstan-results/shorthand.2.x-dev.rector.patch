diff --git a/shorthand.info.yml b/shorthand.info.yml
index 862bf23..abcd827 100755
--- a/shorthand.info.yml
+++ b/shorthand.info.yml
@@ -1,7 +1,7 @@
 name: Shorthand
 type: module
 description: A module that allows the publishing of Shorthand stories directly to Drupal.
-core_version_requirement: ^8.8 | ^9
+core_version_requirement: ^9.3 || ^10
 package: Other
 
 dependencies:
diff --git a/shorthand.module b/shorthand.module
index b9e54e2..abcf7b2 100755
--- a/shorthand.module
+++ b/shorthand.module
@@ -33,7 +33,7 @@ function shorthand_preprocess_html(&$variables) {
     ($story = \Drupal::routeMatch()->getParameter('shorthand_story')) &&
     ($story instanceof ShorthandStoryInterface)
   ) {
-    $files_url = file_create_url($story->getShorthandStoryFilesStorageUri());
+    $files_url = \Drupal::service('file_url_generator')->generateAbsoluteString($story->getShorthandStoryFilesStorageUri());
     $node_url = $story->toUrl()->setAbsolute()->toString();
     $html_head = $story->get('head')->value;
     if (strpos($html_head, 'amphtml') !== FALSE) {
diff --git a/src/Entity/ShorthandStory.php b/src/Entity/ShorthandStory.php
index b8c0f12..3cffe1b 100755
--- a/src/Entity/ShorthandStory.php
+++ b/src/Entity/ShorthandStory.php
@@ -171,7 +171,7 @@ class ShorthandStory extends RevisionableContentEntityBase implements ShorthandS
     // tag with the new local path
     $thumb = $this->thumbnail->value;
     if(empty($thumb) || strpos($thumb, '{Shorthand Local}/') !== false){
-      $assets_path = file_create_url($this->getShorthandStoryFilesStorageUri());
+      $assets_path = \Drupal::service('file_url_generator')->generateAbsoluteString($this->getShorthandStoryFilesStorageUri());
       $thumb = str_replace('{Shorthand Local}/', $assets_path.'/assets/', $thumb);
       $this->thumbnail->value = $thumb;
     }
@@ -489,8 +489,8 @@ class ShorthandStory extends RevisionableContentEntityBase implements ShorthandS
    *   storage path.
    */
   protected function fixStoryContentPaths($content, $external_assets) {
-    $absolute_assets_path = file_create_url($this->getShorthandStoryFilesStorageUri());
-    $assets_path = file_url_transform_relative($absolute_assets_path);
+    $absolute_assets_path = \Drupal::service('file_url_generator')->generateAbsoluteString($this->getShorthandStoryFilesStorageUri());
+    $assets_path = \Drupal::service('file_url_generator')->transformRelative($absolute_assets_path);
     if (!$external_assets) {
       $content = str_replace('./assets/', $assets_path . '/assets/', $content);
     }

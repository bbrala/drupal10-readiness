diff --git a/gitinfo.module b/gitinfo.module
index 3d55704..d1db0b6 100644
--- a/gitinfo.module
+++ b/gitinfo.module
@@ -41,8 +41,8 @@ function gitinfo_cron() {
   $interval = $config->get('interval');
   $interval = !empty($interval) ? $interval : 0;
   $next_execution = \Drupal::state()->get('gitinfo.next_execution', 0);
-  if ($interval && REQUEST_TIME >= $next_execution) {
-    \Drupal::state()->set('gitinfo.next_execution', REQUEST_TIME + $interval);
+  if ($interval && \Drupal::time()->getRequestTime() >= $next_execution) {
+    \Drupal::state()->set('gitinfo.next_execution', \Drupal::time()->getRequestTime() + $interval);
     if (\Drupal::moduleHandler()->moduleExists('basic_auth')) {
       // Generate the report by visiting the page.
       $uri = Url::fromRoute('gitinfo.report', [], ['absolute' => TRUE])->toString();
diff --git a/src/Controller/GitinfoController.php b/src/Controller/GitinfoController.php
index aa157d9..7019eb3 100644
--- a/src/Controller/GitinfoController.php
+++ b/src/Controller/GitinfoController.php
@@ -744,7 +744,7 @@ class GitinfoController extends ControllerBase {
                 '#list_type' => 'ul',
                 '#items' => $items,
               ];
-              $resultsList = render($resultsList);
+              $resultsList = \Drupal::service('renderer')->render($resultsList);
               $logMessage = $this->t("@action<br />@operationMessage @typeMessage on the following projects:<br />@resultsList", [
                 '@action' => $action,
                 '@operationMessage' => $operationMessage,
@@ -807,7 +807,7 @@ class GitinfoController extends ControllerBase {
       '#list_type' => 'ul',
       '#items' => $items,
     ] : NULL;
-    $metadata = render($metadata);
+    $metadata = \Drupal::service('renderer')->render($metadata);
     // Log the report results.
     switch ($severity) {
       case 'error':

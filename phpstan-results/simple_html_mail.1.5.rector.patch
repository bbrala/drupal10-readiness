diff --git a/simple_html_mail.info.yml b/simple_html_mail.info.yml
index 846e6a8..3bfd022 100644
--- a/simple_html_mail.info.yml
+++ b/simple_html_mail.info.yml
@@ -1,8 +1,7 @@
 name: Simple HTML mail
 description: Sending HTML templated mails
 type: module
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: Mail
 configure: simple_html_mail.settings
 dependencies:
diff --git a/simple_html_mail.install b/simple_html_mail.install
index 560ae96..a5ff309 100644
--- a/simple_html_mail.install
+++ b/simple_html_mail.install
@@ -9,7 +9,7 @@ function simple_html_mail_install() {
 
   $data = file_get_contents('modules/contrib/simple_html_mail/images/email-logo.png');
 
-  $file_info = file_save_data($data, 'public://email-logo.png', FileSystemInterface::EXISTS_REPLACE);
+  $file_info = \Drupal::service('file.repository')->writeData($data, 'public://email-logo.png', FileSystemInterface::EXISTS_REPLACE);
 
   $config->set('image', [$file_info->id()])->save(TRUE);
 }
diff --git a/simple_html_mail.module b/simple_html_mail.module
index 08387c6..febe4b8 100644
--- a/simple_html_mail.module
+++ b/simple_html_mail.module
@@ -22,7 +22,7 @@ function simple_html_mail_send($params) {
       if ($params['body'] instanceof Markup) {
         $params['body'] = $params['body']->__toString();
       } elseif (isset($params['body']['#theme'])) {
-        $params['body'] = render($params['body'])->__toString();
+        $params['body'] = \Drupal::service('renderer')->render($params['body'])->__toString();
       }
       reroute_email_mail_alter($params);
       // Return back Markup object so that HTML is rendered.
@@ -47,7 +47,7 @@ function simple_html_mail_send($params) {
   $params['site_name'] = $from_name;
   $params['header_slogan'] = $mail_config->get('header_slogan');
   $params['footer_text'] = $mail_config->get('footer_text');
-  $params['image'] = isset($image_uri) ? file_create_url($image_uri) : '';
+  $params['image'] = isset($image_uri) ? \Drupal::service('file_url_generator')->generateAbsoluteString($image_uri) : '';
 
   $html = [
     '#theme' => 'simple_html_mail',
@@ -147,7 +147,7 @@ function simple_html_mail_mail_alter(&$message) {
       'site_name' => $site_config->get('name'),
       'header_slogan' => $mail_config->get('header_slogan'),
       'footer_text' => $mail_config->get('footer_text'),
-      'image' => isset($image_uri) ? file_create_url($image_uri) : '',
+      'image' => isset($image_uri) ? \Drupal::service('file_url_generator')->generateAbsoluteString($image_uri) : '',
     ];
 
     $body = [

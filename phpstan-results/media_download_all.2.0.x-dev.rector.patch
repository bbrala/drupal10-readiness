diff --git a/media_download_all.info.yml b/media_download_all.info.yml
index 56b8f56..b2f4b72 100644
--- a/media_download_all.info.yml
+++ b/media_download_all.info.yml
@@ -1,8 +1,7 @@
 name: Media Download All
 type: module
 description: This module will provide field formatter and block plugin for downloading all media files associated with an entity.
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 package: Media
 dependencies:
   - drupal:media
diff --git a/src/Plugin/Archiver/Zip.php b/src/Plugin/Archiver/Zip.php
index 29dadd7..bd6ab99 100644
--- a/src/Plugin/Archiver/Zip.php
+++ b/src/Plugin/Archiver/Zip.php
@@ -78,7 +78,7 @@ class Zip extends BaseZip {
     $file_name = $fid . ' - ' . $file->label();
     $uri = $file->getFileUri();
     if ($this->isAliyunOssSchema($uri)) {
-      $url = file_create_url($uri);
+      $url = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
       $this->zip->addFromString($file_name, file_get_contents($url));
       return $this;
     }
diff --git a/tests/src/Functional/MdaFormatterTest.php b/tests/src/Functional/MdaFormatterTest.php
index f31270c..d7f7cf1 100644
--- a/tests/src/Functional/MdaFormatterTest.php
+++ b/tests/src/Functional/MdaFormatterTest.php
@@ -166,7 +166,7 @@ class MdaFormatterTest extends BrowserTestBase {
     $entity_id = $entity->id();
 
     $this->drupalGet($entity->toUrl());
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);
     $link = $this->xpath("//a[@class='media-download-all']");
     $this->assertCount(1, $link);
     $mda_link = $link[0];
@@ -192,7 +192,7 @@ class MdaFormatterTest extends BrowserTestBase {
     ]);
     $entity->save();
     $this->drupalGet($entity->toUrl());
-    $this->assertResponse(200);
+    $this->assertSession()->statusCodeEquals(200);
     $link = $this->xpath("//a[@class='media-download-all']");
     $this->assertCount(0, $link);
   }

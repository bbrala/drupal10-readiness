diff --git a/src/Plugin/Block/HierarchicalTaxonomyMenuBlock.php b/src/Plugin/Block/HierarchicalTaxonomyMenuBlock.php
index 0e79e1b..8201cb2 100644
--- a/src/Plugin/Block/HierarchicalTaxonomyMenuBlock.php
+++ b/src/Plugin/Block/HierarchicalTaxonomyMenuBlock.php
@@ -790,11 +790,11 @@ class HierarchicalTaxonomyMenuBlock extends BlockBase implements ContainerFactor
           $path = $style->buildUrl($file->getFileUri());
         }
         else {
-          $path = Url::fromUri(file_create_url($file->getFileUri()));
+          $path = \Drupal::service('file_url_generator')->generate($file->getFileUri());
         }
       }
       else {
-        $path = Url::fromUri(file_create_url($file->getFileUri()));
+        $path = \Drupal::service('file_url_generator')->generate($file->getFileUri());
       }
       return $path;
     }
diff --git a/tests/src/Functional/HierarchicalTaxonomyMenuCacheTest.php b/tests/src/Functional/HierarchicalTaxonomyMenuCacheTest.php
index c07de9e..e7200e0 100644
--- a/tests/src/Functional/HierarchicalTaxonomyMenuCacheTest.php
+++ b/tests/src/Functional/HierarchicalTaxonomyMenuCacheTest.php
@@ -52,7 +52,7 @@ class HierarchicalTaxonomyMenuCacheTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $vocabulary = $this->createVocabulary();
@@ -98,12 +98,12 @@ class HierarchicalTaxonomyMenuCacheTest extends BrowserTestBase {
     $this->drupalGet('taxonomy/term/1');
     $this->assertCacheContext('url.path');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Term 1');
+    $this->assertEquals($block_title_element->getText(), 'Term 1');
 
     $this->drupalGet('taxonomy/term/2');
     $this->assertCacheContext('url.path');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Term 2');
+    $this->assertEquals($block_title_element->getText(), 'Term 2');
   }
 
   /**
@@ -118,12 +118,12 @@ class HierarchicalTaxonomyMenuCacheTest extends BrowserTestBase {
     $this->drupalGet('taxonomy/term/1');
     $this->assertCacheContext('url.path');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Term 1');
+    $this->assertEquals($block_title_element->getText(), 'Term 1');
 
     $this->drupalGet('taxonomy/term/2');
     $this->assertCacheContext('url.path');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Term 2');
+    $this->assertEquals($block_title_element->getText(), 'Term 2');
   }
 
   /**
diff --git a/tests/src/Functional/HierarchicalTaxonomyMenuImageTest.php b/tests/src/Functional/HierarchicalTaxonomyMenuImageTest.php
index bd5ae7e..764894d 100644
--- a/tests/src/Functional/HierarchicalTaxonomyMenuImageTest.php
+++ b/tests/src/Functional/HierarchicalTaxonomyMenuImageTest.php
@@ -54,7 +54,7 @@ class HierarchicalTaxonomyMenuImageTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $vocabulary = $this->createVocabulary();
diff --git a/tests/src/Functional/HierarchicalTaxonomyMenuTest.php b/tests/src/Functional/HierarchicalTaxonomyMenuTest.php
index 765153a..d15a78f 100644
--- a/tests/src/Functional/HierarchicalTaxonomyMenuTest.php
+++ b/tests/src/Functional/HierarchicalTaxonomyMenuTest.php
@@ -33,7 +33,7 @@ class HierarchicalTaxonomyMenuTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $admin_user = $this->drupalCreateUser([
diff --git a/tests/src/Functional/HierarchicalTaxonomyMenuTranslationTest.php b/tests/src/Functional/HierarchicalTaxonomyMenuTranslationTest.php
index 0004ff1..0f0796a 100644
--- a/tests/src/Functional/HierarchicalTaxonomyMenuTranslationTest.php
+++ b/tests/src/Functional/HierarchicalTaxonomyMenuTranslationTest.php
@@ -39,7 +39,7 @@ class HierarchicalTaxonomyMenuTranslationTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $language = ConfigurableLanguage::createFromLangcode('sr');
@@ -163,11 +163,11 @@ class HierarchicalTaxonomyMenuTranslationTest extends BrowserTestBase {
   public function testDynamicBlockTitle() {
     $this->drupalGet('taxonomy/term/1');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Parent');
+    $this->assertEquals($block_title_element->getText(), 'Parent');
 
     $this->drupalGet('sr/taxonomy/term/1');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Roditelj');
+    $this->assertEquals($block_title_element->getText(), 'Roditelj');
   }
 
 }
diff --git a/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuAdvancedTest.php b/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuAdvancedTest.php
index 1672840..0489e9b 100644
--- a/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuAdvancedTest.php
+++ b/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuAdvancedTest.php
@@ -63,7 +63,7 @@ class HierarchicalTaxonomyMenuAdvancedTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $admin_user = $this->drupalCreateUser([
diff --git a/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuBasicTest.php b/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuBasicTest.php
index 53b74f8..373b166 100644
--- a/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuBasicTest.php
+++ b/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuBasicTest.php
@@ -58,7 +58,7 @@ class HierarchicalTaxonomyMenuBasicTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $admin_user = $this->drupalCreateUser([
@@ -205,7 +205,7 @@ class HierarchicalTaxonomyMenuBasicTest extends WebDriverTestBase {
 
     $this->drupalGet('taxonomy/term/1');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Parent term 1');
+    $this->assertEquals($block_title_element->getText(), 'Parent term 1');
   }
 
   /**
@@ -222,7 +222,7 @@ class HierarchicalTaxonomyMenuBasicTest extends WebDriverTestBase {
 
     $this->drupalGet('taxonomy/term/1');
     $block_title_element = $this->getSession()->getPage()->find('css', '#block-hierarchicaltaxonomymenu h2');
-    $this->assertEqual($block_title_element->getText(), 'Hierarchical Taxonomy Menu');
+    $this->assertEquals($block_title_element->getText(), 'Hierarchical Taxonomy Menu');
   }
 
   /**
diff --git a/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuDynamicTest.php b/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuDynamicTest.php
index ff94e28..7b26cbf 100644
--- a/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuDynamicTest.php
+++ b/tests/src/FunctionalJavascript/HierarchicalTaxonomyMenuDynamicTest.php
@@ -58,7 +58,7 @@ class HierarchicalTaxonomyMenuDynamicTest extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $admin_user = $this->drupalCreateUser([

diff --git a/image_resize_filter.module b/image_resize_filter.module
index 27bbc26..8d18d94 100644
--- a/image_resize_filter.module
+++ b/image_resize_filter.module
@@ -320,7 +320,7 @@ function image_resize_filter_pathinfo($uri) {
  *   Settings for the input filter.
  */
 function image_resize_filter_image_tag($image = NULL, $settings = NULL) {
-  $src = file_create_url($image['destination']);
+  $src = \Drupal::service('file_url_generator')->generateAbsoluteString($image['destination']);
 
   // Strip the http:// from the path if the original did not include it.
   if (!preg_match('/^http[s]?:\/\/' . preg_quote($_SERVER['HTTP_HOST']) . '/', $image['original'])) {
diff --git a/src/Plugin/Filter/FilterImageResize.php b/src/Plugin/Filter/FilterImageResize.php
index a3d28cc..9e8eb23 100644
--- a/src/Plugin/Filter/FilterImageResize.php
+++ b/src/Plugin/Filter/FilterImageResize.php
@@ -141,7 +141,7 @@ class FilterImageResize extends FilterBase implements ContainerFactoryPluginInte
           $image['destination'] = $this->systemFileConfig->get('default_scheme') . '://' . $local_file_path;
         }
         else {
-          $image['destination'] = file_default_scheme() . '://' . $local_file_path;
+          $image['destination'] = \Drupal::config('system.file')->get('default_scheme') . '://' . $local_file_path;
         }
       }
       // Destination and local path are the same if we're just adding attributes.
@@ -155,7 +155,7 @@ class FilterImageResize extends FilterBase implements ContainerFactoryPluginInte
           $local_file_dir = $this->streamWrapperManager->getTarget($path_info['dirname']);
         }
         else {
-          $local_file_dir = file_uri_target($path_info['dirname']);
+          $local_file_dir = \Drupal::service('stream_wrapper_manager')->getTarget($path_info['dirname']);
         }
         $local_file_path = 'resize/' . ($local_file_dir ? $local_file_dir . '/' : '') . $path_info['filename'] . '-' . $image['expected_size']['width'] . 'x' . $image['expected_size']['height'] . '.' . $path_info['extension'];
         $image['destination'] = $path_info['scheme'] . '://' . $local_file_path;

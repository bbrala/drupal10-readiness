diff --git a/modules/ctools_block/tests/src/Functional/EntityFieldBlockTest.php b/modules/ctools_block/tests/src/Functional/EntityFieldBlockTest.php
index 56baf0da..2921d4d3 100644
--- a/modules/ctools_block/tests/src/Functional/EntityFieldBlockTest.php
+++ b/modules/ctools_block/tests/src/Functional/EntityFieldBlockTest.php
@@ -83,8 +83,8 @@ class EntityFieldBlockTest extends BrowserTestBase {
     $this->drupalGet('node/' . $node->id());
 
     $url = $file->getFileUri();
-    $url = file_create_url($url);
-    $url = file_url_transform_relative($url);
+    $url = \Drupal::service('file_url_generator')->generateAbsoluteString($url);
+    $url = \Drupal::service('file_url_generator')->transformRelative($url);
     $this->assertSession()->responseContains('src="' . $url . '"');
   }
 
diff --git a/modules/ctools_entity_mask/tests/src/Functional/DisplayTest.php b/modules/ctools_entity_mask/tests/src/Functional/DisplayTest.php
index b65d66da..a03557ec 100644
--- a/modules/ctools_entity_mask/tests/src/Functional/DisplayTest.php
+++ b/modules/ctools_entity_mask/tests/src/Functional/DisplayTest.php
@@ -39,7 +39,7 @@ class DisplayTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $account = $this->drupalCreateUser(['administer blocks']);
@@ -109,10 +109,10 @@ class DisplayTest extends BrowserTestBase {
     $this->assertNotFalse(strpos($rendered, $block->field_link->uri));
 
     $image_url = $block->field_image->entity->getFileUri();
-    $image_url = file_create_url($image_url);
+    $image_url = \Drupal::service('file_url_generator')->generateAbsoluteString($image_url);
     // file_create_url() will include the host and port, but the rendered output
     // won't include those.
-    $image_url = file_url_transform_relative($image_url);
+    $image_url = \Drupal::service('file_url_generator')->transformRelative($image_url);
     // @todo Use assertStringContainsString() when we rely exclusively on
     // PHPUnit 8.
     $this->assertNotFalse(strpos($rendered, $image_url));
diff --git a/modules/ctools_entity_mask/tests/src/Kernel/EntityMaskTest.php b/modules/ctools_entity_mask/tests/src/Kernel/EntityMaskTest.php
index f4d14a39..1192ddc0 100644
--- a/modules/ctools_entity_mask/tests/src/Kernel/EntityMaskTest.php
+++ b/modules/ctools_entity_mask/tests/src/Kernel/EntityMaskTest.php
@@ -34,7 +34,7 @@ class EntityMaskTest extends KernelTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->installConfig(['block_content', 'entity_mask_test']);
     $this->installEntitySchema('fake_block_content');

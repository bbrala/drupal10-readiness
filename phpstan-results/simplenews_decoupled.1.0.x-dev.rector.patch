diff --git a/src/Controller/SubscribeController.php b/src/Controller/SubscribeController.php
index c469e63..fb67d89 100644
--- a/src/Controller/SubscribeController.php
+++ b/src/Controller/SubscribeController.php
@@ -126,7 +126,7 @@ class SubscribeController extends ControllerBase implements ContainerInjectionIn
     if ($subscriber && $hash == simplenews_generate_hash($subscriber->getMail(), $action, $timestamp)) {
       // If the hash is valid but timestamp is too old, display form to request
       // a new hash.
-      if ($timestamp < REQUEST_TIME - $config->get('hash_expiration') && $action !== 'remove') {
+      if ($timestamp < \Drupal::time()->getRequestTime() - $config->get('hash_expiration') && $action !== 'remove') {
         return new JsonResponse([
           'success' => FALSE,
           // @todo Use $this->t().
diff --git a/tests/src/Functional/LoadTest.php b/tests/src/Functional/LoadTest.php
index 3d27936..d816532 100644
--- a/tests/src/Functional/LoadTest.php
+++ b/tests/src/Functional/LoadTest.php
@@ -29,7 +29,7 @@ class LoadTest extends BrowserTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
     $this->user = $this->drupalCreateUser(['administer site configuration']);
     $this->drupalLogin($this->user);

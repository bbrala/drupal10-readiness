diff --git a/organigrams.module b/organigrams.module
index 106eeb9..76f100d 100644
--- a/organigrams.module
+++ b/organigrams.module
@@ -126,7 +126,7 @@ function organigrams_vocabulary_form_submit(array $form, FormStateInterface $for
  */
 function organigrams_create_term_fields($vid) {
   // Set the config path to the field configs.
-  $config_path = drupal_get_path('module', 'organigrams') . '/config';
+  $config_path = \Drupal::service('extension.list.module')->getPath('organigrams') . '/config';
 
   // Get the sources for the config files.
   $field_storage_source = new FileStorage($config_path . '/optional');
@@ -243,7 +243,7 @@ function organigrams_tokens($type, $tokens, array $data, array $options, Bubblea
       $organigramsController = new OrganigramsController($taxonomyTermTree);
       $organigram = $organigramsController->viewOrganigram($vocabulary);
       // Put the organigram as value in this token.
-      $replacements[$original] = render($organigram);
+      $replacements[$original] = \Drupal::service('renderer')->render($organigram);
     }
   }
   return $replacements;
diff --git a/src/TaxonomyTermTree.php b/src/TaxonomyTermTree.php
index 819f833..b31db8e 100644
--- a/src/TaxonomyTermTree.php
+++ b/src/TaxonomyTermTree.php
@@ -183,7 +183,7 @@ class TaxonomyTermTree {
           '#style_name' => 'thumbnail',
           '#uri' => $image_uri,
         ];
-        $markup = render($image) . $markup;
+        $markup = \Drupal::service('renderer')->render($image) . $markup;
       }
     }
 
@@ -211,7 +211,7 @@ class TaxonomyTermTree {
         $renderable_link['#attributes'] = [
           'class' => ['nodecontent'],
         ];
-        $markup = render($renderable_link);
+        $markup = \Drupal::service('renderer')->render($renderable_link);
       }
     }
     // If not, wrap the mkarup in a div.

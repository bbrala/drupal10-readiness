diff --git a/core/connectors/InstapageCmsPluginDrupal7Connector.php b/core/connectors/InstapageCmsPluginDrupal7Connector.php
index a3924ac..e64117d 100644
--- a/core/connectors/InstapageCmsPluginDrupal7Connector.php
+++ b/core/connectors/InstapageCmsPluginDrupal7Connector.php
@@ -254,7 +254,9 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      db_query($sql, $args);
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+      \Drupal::database()->query($sql, $args);
 
       return true;
     } catch (Exception $e) {
@@ -290,7 +292,9 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      $result = db_query($sql, $args);
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+      $result = \Drupal::database()->query($sql, $args);
 
       return $result->fetchObject();
     } catch (Exception $e) {
@@ -314,7 +318,9 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      $result = db_query($sql, $args);
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+      $result = \Drupal::database()->query($sql, $args);
       $resultArray = $result->fetchAll(PDO::FETCH_OBJ);
 
       if (!is_array($resultArray)) {
diff --git a/src/EventSubscriber/InstapagePluginSubscriber.php b/src/EventSubscriber/InstapagePluginSubscriber.php
index e2d96ea..de956d7 100644
--- a/src/EventSubscriber/InstapagePluginSubscriber.php
+++ b/src/EventSubscriber/InstapagePluginSubscriber.php
@@ -28,7 +28,7 @@ class InstapagePluginSubscriber implements EventSubscriberInterface {
    *
    * @param object $event Event object.
    */
-  public function onKernelResponse(FilterResponseEvent $event) {
+  public function onKernelResponse(\Symfony\Component\HttpKernel\Event\ResponseEvent $event) {
 
     if (!$event->isMasterRequest()) {
       return;

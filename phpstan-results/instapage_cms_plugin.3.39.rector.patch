diff --git a/core/connectors/InstapageCmsPluginDrupal7Connector.php b/core/connectors/InstapageCmsPluginDrupal7Connector.php
index a3924ac..00c59c0 100644
--- a/core/connectors/InstapageCmsPluginDrupal7Connector.php
+++ b/core/connectors/InstapageCmsPluginDrupal7Connector.php
@@ -60,9 +60,9 @@ function instapage_cms_plugin_uninstall() {
  * Drupal 7 hook. Function called to load plugin's dashboard.
  */
 function load_instapage_cms_plugin_dashboard() {
-  $jsDir = base_path() . drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/js';
-  $knockoutDir = base_path() . drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/knockout';
-  $languageFile = base_path() . drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/lang/' . InstapageCmsPluginConnector::getSelectedLanguage() . '.js';
+  $jsDir = base_path() . \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/js';
+  $knockoutDir = base_path() . \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/knockout';
+  $languageFile = base_path() . \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/lang/' . InstapageCmsPluginConnector::getSelectedLanguage() . '.js';
   $options = array(
     'scope' => 'footer',
     'group' => JS_LIBRARY,
@@ -124,7 +124,7 @@ function load_instapage_cms_plugin_dashboard() {
   drupal_add_js($jsDir . '/tabs.js', $options);
 
   $options = array('preprocess' => 'false');
-  $cssDir = drupal_get_path('module', InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/css';
+  $cssDir = \Drupal::service('extension.list.module')->getPath(InstapageCmsPluginConnector::getPluginDirectoryName()) . '/core/assets/css';
   drupal_add_css($cssDir . '/mrwhite-reset.css', $options);
   drupal_add_css($cssDir . '/mrwhite-ui-kit.css', $options);
   drupal_add_css($cssDir . '/general.css', $options);
@@ -254,7 +254,9 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      db_query($sql, $args);
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+      \Drupal::database()->query($sql, $args);
 
       return true;
     } catch (Exception $e) {
@@ -290,7 +292,9 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      $result = db_query($sql, $args);
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+      $result = \Drupal::database()->query($sql, $args);
 
       return $result->fetchObject();
     } catch (Exception $e) {
@@ -314,7 +318,9 @@ class InstapageCmsPluginDrupal7Connector {
     $sql = $this->prepare($sql);
 
     try {
-      $result = db_query($sql, $args);
+      // TODO: Drupal Rector Notice: Please delete the following comment after you've made any necessary changes.
+      // You will need to use `\Drupal\core\Database\Database::getConnection()` if you do not yet have access to the container here.
+      $result = \Drupal::database()->query($sql, $args);
       $resultArray = $result->fetchAll(PDO::FETCH_OBJ);
 
       if (!is_array($resultArray)) {
diff --git a/src/EventSubscriber/InstapagePluginSubscriber.php b/src/EventSubscriber/InstapagePluginSubscriber.php
index e2d96ea..de956d7 100644
--- a/src/EventSubscriber/InstapagePluginSubscriber.php
+++ b/src/EventSubscriber/InstapagePluginSubscriber.php
@@ -28,7 +28,7 @@ class InstapagePluginSubscriber implements EventSubscriberInterface {
    *
    * @param object $event Event object.
    */
-  public function onKernelResponse(FilterResponseEvent $event) {
+  public function onKernelResponse(\Symfony\Component\HttpKernel\Event\ResponseEvent $event) {
 
     if (!$event->isMasterRequest()) {
       return;

diff --git a/src/Controller/XmlSitemapController.php b/src/Controller/XmlSitemapController.php
index ccd7535..c72641b 100644
--- a/src/Controller/XmlSitemapController.php
+++ b/src/Controller/XmlSitemapController.php
@@ -159,7 +159,7 @@ class XmlSitemapController extends ControllerBase {
    */
   public function renderSitemapXsl() {
     // Read the XSL content from the file.
-    $module_path = drupal_get_path('module', 'xmlsitemap');
+    $module_path = \Drupal::service('extension.list.module')->getPath('xmlsitemap');
     $xsl_content = file_get_contents($module_path . '/xsl/xmlsitemap.xsl');
 
     // Make sure the strings in the XSL content are translated properly.
diff --git a/src/XmlSitemapLinkStorage.php b/src/XmlSitemapLinkStorage.php
index 2a641c6..3614227 100644
--- a/src/XmlSitemapLinkStorage.php
+++ b/src/XmlSitemapLinkStorage.php
@@ -108,7 +108,7 @@ class XmlSitemapLinkStorage implements XmlSitemapLinkStorageInterface {
         }
         else {
           // Attempt to transform this to a relative URL.
-          $loc = file_url_transform_relative($url->toString());
+          $loc = \Drupal::service('file_url_generator')->transformRelative($url->toString());
           // If it could not be transformed into a relative path, disregard it
           // since we cannot store external URLs in the sitemap.
           if (UrlHelper::isExternal($loc)) {

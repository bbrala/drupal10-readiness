diff --git a/image_replace.info.yml b/image_replace.info.yml
index e945aa2..75d389e 100644
--- a/image_replace.info.yml
+++ b/image_replace.info.yml
@@ -1,6 +1,6 @@
 name: Image Replace Effect
 type: module
 description: 'Provides an image style effect capable of replacing the whole image with another one.'
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
 dependencies:
   - drupal:image
diff --git a/src/Tests/AdminTest.php b/src/Tests/AdminTest.php
index bfba630..3731475 100644
--- a/src/Tests/AdminTest.php
+++ b/src/Tests/AdminTest.php
@@ -35,7 +35,7 @@ class AdminTest extends ImageReplaceTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     // Create an image style containing the replace effect.
@@ -138,7 +138,8 @@ class AdminTest extends ImageReplaceTestBase {
     ];
     $edit['files[image_original_0]'] = $file_system->realpath($original_file->getFileUri());
     $edit['files[image_replacement_0]'] = $file_system->realpath($replacement_file->getFileUri());
-    $this->drupalPostForm('node/add/article', $edit, t('Save'));
+    $this->drupalGet('node/add/article');
+    $this->submitForm($edit, t('Save'));
     $this->assertSession()->statusCodeEquals(200);
 
     $edit = [
@@ -152,8 +153,8 @@ class AdminTest extends ImageReplaceTestBase {
     $node = Node::load($matches[1]);
 
     // Verify that the original image is shown on the full node view.
-    $generated_url = file_create_url($node->image_original->entity->getFileUri());
-    $relative_url = file_url_transform_relative($generated_url);
+    $generated_url = \Drupal::service('file_url_generator')->generateAbsoluteString($node->image_original->entity->getFileUri());
+    $relative_url = \Drupal::service('file_url_generator')->transformRelative($generated_url);
     $this->assertSession()->responseContains(Html::escape($relative_url));
 
     $generated_image_data = $this->drupalGet($generated_url);
@@ -169,7 +170,7 @@ class AdminTest extends ImageReplaceTestBase {
     $this->drupalGet('node');
     $this->assertSession()->statusCodeEquals(200);
     $generated_url = ImageStyle::load($this->styleName)->buildUrl($node->image_original->entity->getFileUri());
-    $relative_url = file_url_transform_relative($generated_url);
+    $relative_url = \Drupal::service('file_url_generator')->transformRelative($generated_url);
     $this->assertSession()->responseContains(Html::escape($relative_url));
 
     $generated_image_data = $this->drupalGet($generated_url);
@@ -184,7 +185,8 @@ class AdminTest extends ImageReplaceTestBase {
     $edit = [
       $field_name => '0',
     ];
-    $this->drupalPostForm('admin/structure/types/manage/article/fields/node.article.image_original', $edit, t('Save settings'));
+    $this->drupalGet('admin/structure/types/manage/article/fields/node.article.image_original');
+    $this->submitForm($edit, t('Save settings'));
     $this->assertSession()->statusCodeEquals(200);
 
     // Verify that a message is displayed if the mapping changes when there is
diff --git a/src/Tests/EntityTest.php b/src/Tests/EntityTest.php
index ef1a7ab..6a98a7c 100644
--- a/src/Tests/EntityTest.php
+++ b/src/Tests/EntityTest.php
@@ -28,7 +28,7 @@ class EntityTest extends ImageReplaceTestBase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     // Create an image style containing the replace effect.
@@ -92,7 +92,7 @@ class EntityTest extends ImageReplaceTestBase {
     $this->drupalGet('node');
     $this->assertSession()->statusCodeEquals(200);
     $generated_url = ImageStyle::load($this->styleName)->buildUrl($node->image_original->entity->getFileUri());
-    $relative_url = file_url_transform_relative($generated_url);
+    $relative_url = \Drupal::service('file_url_generator')->transformRelative($generated_url);
     $this->assertSession()->responseContains(Html::escape($relative_url));
 
     $generated_image_data = $this->drupalGet($generated_url);
@@ -107,8 +107,8 @@ class EntityTest extends ImageReplaceTestBase {
     // Check full view.
     $this->drupalGet('node/' . $node->id());
     $this->assertSession()->statusCodeEquals(200);
-    $generated_url = file_create_url($node->image_original->entity->getFileUri());
-    $relative_url = file_url_transform_relative($generated_url);
+    $generated_url = \Drupal::service('file_url_generator')->generateAbsoluteString($node->image_original->entity->getFileUri());
+    $relative_url = \Drupal::service('file_url_generator')->transformRelative($generated_url);
     $this->assertSession()->responseContains(Html::escape($relative_url));
 
     $generated_image_data = $this->drupalGet($generated_url);

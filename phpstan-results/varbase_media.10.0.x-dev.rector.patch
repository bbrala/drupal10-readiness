diff --git a/modules/entity_browser_generic_embed/src/MediaHelper.php b/modules/entity_browser_generic_embed/src/MediaHelper.php
index 5770d13..24f1764 100644
--- a/modules/entity_browser_generic_embed/src/MediaHelper.php
+++ b/modules/entity_browser_generic_embed/src/MediaHelper.php
@@ -163,7 +163,7 @@ class MediaHelper {
       return $file;
     }
     else {
-      $file = file_move($file, $destination, $replace);
+      $file = \Drupal::service('file.repository')->move($file, $destination, $replace);
 
       if ($file) {
         $field->setValue($file);
diff --git a/tests/src/FunctionalJavascript/VarbaseMediaTests.php b/tests/src/FunctionalJavascript/VarbaseMediaTests.php
index 77fa0ae..2e1bf35 100644
--- a/tests/src/FunctionalJavascript/VarbaseMediaTests.php
+++ b/tests/src/FunctionalJavascript/VarbaseMediaTests.php
@@ -50,7 +50,7 @@ class VarbaseMediaTests extends WebDriverTestBase {
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Insall the Claro admin theme.
diff --git a/varbase_media.module b/varbase_media.module
index d7a0905..8b0195b 100644
--- a/varbase_media.module
+++ b/varbase_media.module
@@ -715,7 +715,7 @@ function _varbase_media_image_url($media_entity, $style_name = NULL) {
             ->getString());
       }
       else {
-        return file_create_url($file_entity->get('uri')->getString());
+        return \Drupal::service('file_url_generator')->generateAbsoluteString($file_entity->get('uri')->getString());
       }
     }
   }

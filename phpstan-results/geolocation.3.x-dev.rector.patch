diff --git a/modules/geolocation_demo/geolocation_demo.install b/modules/geolocation_demo/geolocation_demo.install
index 18c04fa..d2622d9 100644
--- a/modules/geolocation_demo/geolocation_demo.install
+++ b/modules/geolocation_demo/geolocation_demo.install
@@ -29,7 +29,7 @@ function geolocation_demo_install() {
 
     $taxonomy_storage = \Drupal::entityTypeManager()->getStorage('taxonomy_term');
 
-    $icon_path = drupal_get_path('module', 'geolocation_demo') . '/icons/';
+    $icon_path = \Drupal::service('extension.list.module')->getPath('geolocation_demo') . '/icons/';
 
     /** @var \Drupal\taxonomy\TermInterface $term_a */
     $term_a = $taxonomy_storage->create([
@@ -38,7 +38,7 @@ function geolocation_demo_install() {
     ]);
 
     $data = file_get_contents($icon_path . 'druplicon-deadpool.png');
-    $file = file_save_data($data, 'public://druplicon-deadpool.png', FileSystemInterface::EXISTS_REPLACE);
+    $file = \Drupal::service('file.repository')->writeData($data, 'public://druplicon-deadpool.png', FileSystemInterface::EXISTS_REPLACE);
     if ($file) {
       $term_a->set('field_geolocation_demo_term_icon', [
         'target_id' => $file->id(),
@@ -55,7 +55,7 @@ function geolocation_demo_install() {
     ]);
 
     $data = file_get_contents($icon_path . 'druplicon-wolverine.png');
-    $file = file_save_data($data, 'public://druplicon-wolverine.png', FileSystemInterface::EXISTS_REPLACE);
+    $file = \Drupal::service('file.repository')->writeData($data, 'public://druplicon-wolverine.png', FileSystemInterface::EXISTS_REPLACE);
     if ($file) {
       $term_b->set('field_geolocation_demo_term_icon', [
         'target_id' => $file->id(),
@@ -72,7 +72,7 @@ function geolocation_demo_install() {
     ]);
 
     $data = file_get_contents($icon_path . 'druplicon-wonder-woman.png');
-    $file = file_save_data($data, 'public://druplicon-wonder-woman.png', FileSystemInterface::EXISTS_REPLACE);
+    $file = \Drupal::service('file.repository')->writeData($data, 'public://druplicon-wonder-woman.png', FileSystemInterface::EXISTS_REPLACE);
     if ($file) {
       $term_c->set('field_geolocation_demo_term_icon', [
         'target_id' => $file->id(),
@@ -111,7 +111,7 @@ function geolocation_demo_install() {
     ]);
 
     $data = file_get_contents($icon_path . 'druplicon-nick-fury.png');
-    $file = file_save_data($data, 'public://druplicon-nick-fury.png', FileSystemInterface::EXISTS_REPLACE);
+    $file = \Drupal::service('file.repository')->writeData($data, 'public://druplicon-nick-fury.png', FileSystemInterface::EXISTS_REPLACE);
     if ($file) {
       $term_single->set('field_geolocation_demo_term_icon', [
         'target_id' => $file->id(),
diff --git a/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/MarkerIcon.php b/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/MarkerIcon.php
index 938f88a..678397a 100644
--- a/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/MarkerIcon.php
+++ b/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/MarkerIcon.php
@@ -168,7 +168,7 @@ class MarkerIcon extends MapFeatureBase {
 
     if (!empty($feature_settings['marker_icon_path'])) {
       $path = \Drupal::token()->replace($feature_settings['marker_icon_path'], $context);
-      $path = file_create_url($path);
+      $path = \Drupal::service('file_url_generator')->generateAbsoluteString($path);
       $render_array['#attached']['drupalSettings']['geolocation']['maps'][$render_array['#id']][$this->getPluginId()]['markerIconPath'] = $path;
 
       if (!empty($render_array['#children']['locations'])) {
diff --git a/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/Spiderfying.php b/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/Spiderfying.php
index 23fc97d..9bacbd4 100644
--- a/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/Spiderfying.php
+++ b/modules/geolocation_google_maps/src/Plugin/geolocation/MapFeature/Spiderfying.php
@@ -22,7 +22,7 @@ class Spiderfying extends MapFeatureBase {
    */
   public static function getDefaultSettings() {
     return [
-      'spiderfiable_marker_path' => base_path() . drupal_get_path('module', 'geolocation_google_maps') . '/images/marker-plus.svg',
+      'spiderfiable_marker_path' => base_path() . \Drupal::service('extension.list.module')->getPath('geolocation_google_maps') . '/images/marker-plus.svg',
       'markersWontMove' => TRUE,
       'markersWontHide' => FALSE,
       'keepSpiderfied' => TRUE,
diff --git a/modules/geolocation_leaflet/src/Plugin/geolocation/MapFeature/LeafletMarkerIcon.php b/modules/geolocation_leaflet/src/Plugin/geolocation/MapFeature/LeafletMarkerIcon.php
index d20e4ee..5d9e1a7 100644
--- a/modules/geolocation_leaflet/src/Plugin/geolocation/MapFeature/LeafletMarkerIcon.php
+++ b/modules/geolocation_leaflet/src/Plugin/geolocation/MapFeature/LeafletMarkerIcon.php
@@ -195,13 +195,13 @@ class LeafletMarkerIcon extends MapFeatureBase {
 
     if (!empty($feature_settings['marker_icon_path'])) {
       $iconPath = \Drupal::token()->replace($feature_settings['marker_icon_path'], $context);
-      $iconUrl = file_url_transform_relative(file_create_url($iconPath));
+      $iconUrl = \Drupal::service('file_url_generator')->generateString($iconPath);
       $render_array['#attached']['drupalSettings']['geolocation']['maps'][$render_array['#id']][$this->getPluginId()]['markerIconPath'] = $iconUrl;
     }
 
     if (!empty($feature_settings['marker_shadow_path'])) {
       $shadowPath = \Drupal::token()->replace($feature_settings['marker_shadow_path'], $context);
-      $shadowUrl = file_url_transform_relative(file_create_url($shadowPath));
+      $shadowUrl = \Drupal::service('file_url_generator')->generateString($shadowPath);
       $render_array['#attached']['drupalSettings']['geolocation']['maps'][$render_array['#id']][$this->getPluginId()]['markerShadowPath'] = $shadowUrl;
     }
 

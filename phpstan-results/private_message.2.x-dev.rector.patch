diff --git a/private_message.theme.inc b/private_message.theme.inc
index 0d92faa..084ecb6 100644
--- a/private_message.theme.inc
+++ b/private_message.theme.inc
@@ -12,7 +12,7 @@ use Drupal\Core\Url;
  * Implements hook_preprocess_private_message_notification_block().
  */
 function template_preprocess_private_message_notification_block(&$vars) {
-  $vars['notification_image_path'] = base_path() . drupal_get_path('module', 'private_message') . '/images/private-message-notification-icon.png';
+  $vars['notification_image_path'] = base_path() . \Drupal::service('extension.list.module')->getPath('private_message') . '/images/private-message-notification-icon.png';
   $link_title = $vars['new_message_count'] ? \Drupal::service('string_translation')->formatPlural($vars['new_message_count'], 'You have 1 unread private message', 'You have @count unread private messages') : t('You have no unread private messages');
   $url = Url::fromRoute('private_message.private_message_page', [], ['attributes' => ['title' => $link_title, 'class' => ['private-message-page-link']]]);
   $count = $vars['new_message_count'] > 99 ? '99+' : $vars['new_message_count'];
diff --git a/src/Plugin/Field/FieldFormatter/PrivateMessageThreadMemberFormatter.php b/src/Plugin/Field/FieldFormatter/PrivateMessageThreadMemberFormatter.php
index c793da3..1e827fa 100644
--- a/src/Plugin/Field/FieldFormatter/PrivateMessageThreadMemberFormatter.php
+++ b/src/Plugin/Field/FieldFormatter/PrivateMessageThreadMemberFormatter.php
@@ -285,7 +285,7 @@ class PrivateMessageThreadMemberFormatter extends FormatterBase implements Conta
           }
           elseif ($this->getSetting('display_type') == 'entity') {
             $renderable = $view_builder->view($user, $this->getSetting('entity_display_mode'));
-            $users[$user->id()] = render($renderable);
+            $users[$user->id()] = \Drupal::service('renderer')->render($renderable);
           }
         }
       }

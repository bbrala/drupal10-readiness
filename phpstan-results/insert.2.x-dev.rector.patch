diff --git a/insert.module b/insert.module
index 7982976..a2f9aa8 100644
--- a/insert.module
+++ b/insert.module
@@ -538,7 +538,7 @@ function insert_insert_variables($insertType, array &$element, $styleName, array
     'entity_type' => $file->getEntityTypeId(),
     'mime_type' => $file->getMimeType(),
     'uuid' => $file->uuid(),
-    'url' => file_create_url($file->getFileUri()),
+    'url' => \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri()),
   ];
 
   if (!$config->get('absolute')) {
diff --git a/modules/insert_responsive_image/insert_responsive_image.module b/modules/insert_responsive_image/insert_responsive_image.module
index 7b10672..21c65bb 100644
--- a/modules/insert_responsive_image/insert_responsive_image.module
+++ b/modules/insert_responsive_image/insert_responsive_image.module
@@ -58,11 +58,11 @@ function insert_responsive_image_insert_variables($insertType, array &$element,
   $style = ImageStyle::load($responsiveStyle->getFallbackImageStyle());
 
   $vars['url'] = $style === NULL
-    ? file_create_url($file->getFileUri())
+    ? \Drupal::service('file_url_generator')->generateAbsoluteString($file->getFileUri())
     : $style->buildUrl($file->getFileUri());
 
   if (!\Drupal::config('insert.config')->get('absolute')) {
-    $vars['url'] = file_url_transform_relative($vars['url']);
+    $vars['url'] = \Drupal::service('file_url_generator')->transformRelative($vars['url']);
   }
 
   // Have Responsive Image module generate the srcset and sizes attributes:
diff --git a/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTestBase.php b/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTestBase.php
index 92a915f..b037717 100644
--- a/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTestBase.php
+++ b/modules/insert_responsive_image/tests/src/FunctionalJavaScript/InsertResponsiveImageTestBase.php
@@ -25,7 +25,7 @@ abstract class InsertResponsiveImageTestBase extends InsertImageTestBase {
   /**
    * @inheritdoc
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Install the 'wide' responsive image style.
diff --git a/tests/src/FunctionalJavaScript/InsertFileTestBase.php b/tests/src/FunctionalJavaScript/InsertFileTestBase.php
index d0a7f38..8ff5421 100644
--- a/tests/src/FunctionalJavaScript/InsertFileTestBase.php
+++ b/tests/src/FunctionalJavaScript/InsertFileTestBase.php
@@ -40,7 +40,7 @@ abstract class InsertFileTestBase extends WebDriverTestBase {
   /**
    *
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     $this->contentTypeName = 'article';
diff --git a/tests/src/FunctionalJavaScript/InsertImageCKEditorTestBase.php b/tests/src/FunctionalJavaScript/InsertImageCKEditorTestBase.php
index d3d72e5..bdaf3c9 100644
--- a/tests/src/FunctionalJavaScript/InsertImageCKEditorTestBase.php
+++ b/tests/src/FunctionalJavaScript/InsertImageCKEditorTestBase.php
@@ -20,7 +20,7 @@ abstract class InsertImageCKEditorTestBase extends InsertImageTestBase {
   /**
    * @inheritdoc
    */
-  protected function setUp() {
+  protected function setUp(): void {
     parent::setUp();
 
     // Create text format and associate CKEditor.

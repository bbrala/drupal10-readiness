modules/contrib/ga_login/ga_login.install
modules/contrib/ga_login/src/Plugin/TfaSetup/GALoginHotpSetup.php
modules/contrib/ga_login/src/Plugin/TfaSetup/GALoginTotpSetup.php
modules/contrib/ga_login/src/Plugin/TfaValidation/GALoginHotpValidation.php
modules/contrib/ga_login/src/Plugin/TfaValidation/GALoginTotpValidation.php
modules/contrib/ga_login/tests/src/Functional/GALoginHotpSetupPluginTest.php
modules/contrib/ga_login/tests/src/Functional/GALoginHotpValidationPluginTest.php
modules/contrib/ga_login/tests/src/Functional/GALoginTotpSetupPluginTest.php
modules/contrib/ga_login/tests/src/Functional/GALoginTotpValidationPluginTest.php

4 files with changes
====================

1) modules/contrib/ga_login/tests/src/Functional/GALoginTotpValidationPluginTest.php:80

    ---------- begin diff ----------
@@ @@
     $edit = [
       'current_pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm('user/' . $this->userAccount->id() . '/security/tfa/' . $this->validationPluginId, $edit, 'Confirm');
+    $this->drupalGet('user/' . $this->userAccount->id() . '/security/tfa/' . $this->validationPluginId);
+    $this->submitForm($edit, 'Confirm');

     // Fetch seed.
     $result = $this->xpath('//input[@name="seed"]');
@@ @@
     $edit = [
       'code' => $this->validationPlugin->auth->otp->totp(Encoding::base32DecodeUpper($this->seed)),
     ];
-    $this->drupalPostForm(NULL, $edit, 'Verify and save');
+    $this->submitForm($edit, 'Verify and save');

     $this->assertSession()->linkExists('Disable TFA');
   }
@@ @@
       'name' => $this->userAccount->getAccountName(),
       'pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm('user/login', $edit, 'Log in');
+    $this->drupalGet('user/login');
+    $this->submitForm($edit, 'Log in');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Verification code is application generated and 6 digits long.');

     // Try invalid code.
     $edit = ['code' => 112233];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid application code. Please try again.');

@@ @@
     $this->validationPlugin->auth->otp->setTotpOffset(-1800);
     $old_code = $this->validationPlugin->auth->otp->totp(Encoding::base32DecodeUpper($this->seed));
     $edit = ['code' => $old_code];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid application code. Please try again.');

@@ @@
     $this->validationPlugin->auth->otp->setTotpOffset($this->validationPlugin->getTimeSkew() * 30);
     $valid_code = $this->validationPlugin->auth->otp->totp(Encoding::base32DecodeUpper($this->seed));
     $edit = ['code' => $valid_code];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains($this->userAccount->getDisplayName());

@@ @@
       'name' => $this->userAccount->getAccountName(),
       'pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm('user/login', $edit, 'Log in');
+    $this->drupalGet('user/login');
+    $this->submitForm($edit, 'Log in');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Verification code is application generated and 6 digits long.');

     $edit = ['code' => $valid_code];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid code, it was recently used for a login. Please try a new code.');
   }
    ----------- end diff -----------

Applied rules:
 * UiHelperTraitDrupalPostFormRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


2) modules/contrib/ga_login/tests/src/Functional/GALoginTotpSetupPluginTest.php:83

    ---------- begin diff ----------
@@ @@
     $edit = [
       'current_pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Confirm');
+    $this->submitForm($edit, 'Confirm');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Application verification code');

@@ @@
     $edit = [
       'code' => substr(str_shuffle('1234567890'), 0, 6),
     ];
-    $this->drupalPostForm(NULL, $edit, 'Verify and save');
+    $this->submitForm($edit, 'Verify and save');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid application code. Please try again.');

@@ @@
     $edit = [
       'code' => $this->setupPlugin->auth->otp->totp(Encoding::base32DecodeUpper($seed)),
     ];
-    $this->drupalPostForm(NULL, $edit, 'Verify and save');
+    $this->submitForm($edit, 'Verify and save');
     $assert->statusCodeEquals(200);

     $assert->linkExists('Disable TFA');
    ----------- end diff -----------

Applied rules:
 * UiHelperTraitDrupalPostFormRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


3) modules/contrib/ga_login/tests/src/Functional/GALoginHotpValidationPluginTest.php:80

    ---------- begin diff ----------
@@ @@
     $edit = [
       'current_pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm('user/' . $this->userAccount->id() . '/security/tfa/' . $this->validationPluginId, $edit, 'Confirm');
+    $this->drupalGet('user/' . $this->userAccount->id() . '/security/tfa/' . $this->validationPluginId);
+    $this->submitForm($edit, 'Confirm');

     // Fetch seed.
     $result = $this->xpath('//input[@name="seed"]');
@@ @@
     $edit = [
       'code' => $this->validationPlugin->auth->otp->hotp(Encoding::base32DecodeUpper($this->seed), $this->validationPlugin->getHotpCounter()),
     ];
-    $this->drupalPostForm(NULL, $edit, 'Verify and save');
+    $this->submitForm($edit, 'Verify and save');

     $this->assertSession()->linkExists('Disable TFA');
   }
@@ @@
       'name' => $this->userAccount->getAccountName(),
       'pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm('user/login', $edit, 'Log in');
+    $this->drupalGet('user/login');
+    $this->submitForm($edit, 'Log in');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Verification code is application generated and 6 digits long.');

     // Try invalid code.
     $edit = ['code' => 112233];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid application code. Please try again.');

@@ @@
     // generate the same code we used during setup.
     $valid_code = $this->validationPlugin->auth->otp->hotp(Encoding::base32DecodeUpper($this->seed), $this->validationPlugin->getHotpCounter() + 1);
     $edit = ['code' => $valid_code];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains($this->userAccount->getDisplayName());

@@ @@
       'name' => $this->userAccount->getAccountName(),
       'pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm('user/login', $edit, 'Log in');
+    $this->drupalGet('user/login');
+    $this->submitForm($edit, 'Log in');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Verification code is application generated and 6 digits long.');

     $edit = ['code' => $valid_code];
-    $this->drupalPostForm(NULL, $edit, 'Verify');
+    $this->submitForm($edit, 'Verify');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid code, it was recently used for a login. Please try a new code.');
   }
    ----------- end diff -----------

Applied rules:
 * UiHelperTraitDrupalPostFormRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


4) modules/contrib/ga_login/tests/src/Functional/GALoginHotpSetupPluginTest.php:83

    ---------- begin diff ----------
@@ @@
     $edit = [
       'current_pass' => $this->userAccount->passRaw,
     ];
-    $this->drupalPostForm(NULL, $edit, 'Confirm');
+    $this->submitForm($edit, 'Confirm');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Application verification code');

@@ @@
     $edit = [
       'code' => substr(str_shuffle('1234567890'), 0, 6),
     ];
-    $this->drupalPostForm(NULL, $edit, 'Verify and save');
+    $this->submitForm($edit, 'Verify and save');
     $assert->statusCodeEquals(200);
     $assert->pageTextContains('Invalid application code. Please try again.');

@@ @@
     $edit = [
       'code' => $this->setupPlugin->auth->otp->hotp(Encoding::base32DecodeUpper($seed), 1),
     ];
-    $this->drupalPostForm(NULL, $edit, 'Verify and save');
+    $this->submitForm($edit, 'Verify and save');
     $assert->statusCodeEquals(200);

     $assert->linkExists('Disable TFA');
    ----------- end diff -----------

Applied rules:
 * UiHelperTraitDrupalPostFormRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * ChangeMethodVisibilityRector


 [OK] 4 files have been changed by Rector                                       


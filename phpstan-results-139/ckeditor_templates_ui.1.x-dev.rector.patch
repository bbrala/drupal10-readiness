diff --git a/ckeditor_templates_ui.info.yml b/ckeditor_templates_ui.info.yml
index 9f70f9a..4bb4361 100644
--- a/ckeditor_templates_ui.info.yml
+++ b/ckeditor_templates_ui.info.yml
@@ -2,8 +2,7 @@ name: CKEditor Templates User Interface
 description: Provide ui for adding ckeditor templates
 package: CKEditor
 type: module
-core: 8.x
 configure: entity.ckeditor_template.collection
 dependencies:
 - ckeditor_templates:ckeditor_templates
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.3 || ^10
diff --git a/ckeditor_templates_ui.module b/ckeditor_templates_ui.module
index fd12658..ef40b6b 100644
--- a/ckeditor_templates_ui.module
+++ b/ckeditor_templates_ui.module
@@ -62,8 +62,8 @@ function ckeditor_templates_ui_js_settings_alter(array &$settings, AttachedAsset
         // that cannot evaluate to false, is the same for all templates and
         // is used to create the image path. This makes it inconvenient for us.
         // For things to work out all url-s must start with "/".
-        $templates[$i]['image'] = file_create_url($value->image);
-        $templates[$i]['image'] = file_url_transform_relative($templates[$i]['image']);
+        $templates[$i]['image'] = \Drupal::service('file_url_generator')->generateAbsoluteString($value->image);
+        $templates[$i]['image'] = \Drupal::service('file_url_generator')->transformRelative($templates[$i]['image']);
         // Remove leading "/" since it will be added separately
         // by the "imagesPath" parameter.
         $templates[$i]['image'] = substr($templates[$i]['image'], 1);
diff --git a/src/CkeditorTemplatesUi.php b/src/CkeditorTemplatesUi.php
index 266e614..b471e6f 100644
--- a/src/CkeditorTemplatesUi.php
+++ b/src/CkeditorTemplatesUi.php
@@ -49,7 +49,7 @@ class CkeditorTemplatesUi extends CkeditorTemplates {
    */
   private function getTemplatesDefaultPath() {
     global $base_path;
-    return [$base_path . drupal_get_path('module', 'ckeditor_templates_ui') . '/js/ckeditor_templates.js'];
+    return [$base_path . \Drupal::service('extension.list.module')->getPath('ckeditor_templates_ui') . '/js/ckeditor_templates.js'];
   }
 
 }
diff --git a/src/Form/CkeditorTemplateForm.php b/src/Form/CkeditorTemplateForm.php
index 67bae0a..c2f3258 100644
--- a/src/Form/CkeditorTemplateForm.php
+++ b/src/Form/CkeditorTemplateForm.php
@@ -71,7 +71,7 @@ class CkeditorTemplateForm extends EntityForm {
     $image = $template->get('image');
     if ($image) {
       $image_markup = '<div class="form-item image-preview" style="max-width: 200px; max-height: 200px;">';
-      $image_markup .= '<img src="' . file_create_url($image) . '" alt="' . $this->t('Preview') . '" />';
+      $image_markup .= '<img src="' . \Drupal::service('file_url_generator')->generateAbsoluteString($image) . '" alt="' . $this->t('Preview') . '" />';
       $image_markup .= '</div>';
       $form['image_preview'] = [
         '#type' => 'inline_template',

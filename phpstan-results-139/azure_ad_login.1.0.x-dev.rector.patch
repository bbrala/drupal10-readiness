diff --git a/azure_ad_login.info.yml b/azure_ad_login.info.yml
index 32e5f73..dd54cc7 100644
--- a/azure_ad_login.info.yml
+++ b/azure_ad_login.info.yml
@@ -2,7 +2,6 @@ name: Azure AD Login
 type: module
 description: Use Active record Directory to login into Drupal
 package: Custom
-core: 8.x
-core_version_requirement: ^8 || ^9
+core_version_requirement: ^9.1 || ^10
 dependencies:
   - user
diff --git a/src/Controller/CallbackController.php b/src/Controller/CallbackController.php
index b43e688..b390284 100644
--- a/src/Controller/CallbackController.php
+++ b/src/Controller/CallbackController.php
@@ -136,7 +136,7 @@ class CallbackController extends ControllerBase {
     $language = $this->languageManager->getCurrentLanguage()->getId();
 
     $new_user = User::create();
-    $new_user->setPassword(user_password(25));
+    $new_user->setPassword(\Drupal::service('password_generator')->generate(25));
     $new_user->setEmail($account['userPrincipalName']);
     $new_user->setUsername($name);
     $new_user->set('init', 'email');

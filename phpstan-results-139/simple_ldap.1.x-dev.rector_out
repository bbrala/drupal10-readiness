modules/contrib/simple_ldap/modules/simple_ldap_sso/src/Form/SimpleLdapSSOSettingsForm.php
modules/contrib/simple_ldap/modules/simple_ldap_user/tests/src/Functional/SimpleLdapUserTest.php
modules/contrib/simple_ldap/modules/simple_ldap_user/simple_ldap_user.module
modules/contrib/simple_ldap/modules/simple_ldap_user/tests/src/Unit/SimpleLdapUserManagerTest.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/Events/Events.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/Events/SimpleLdapUserEvent.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/Form/SimpleLdapUserSettingsForm.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/Routing/SimpleLdapUserRouteSubscriber.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/SimpleLdapUser.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/SimpleLdapUserAuthenticator.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/SimpleLdapUserManager.php
modules/contrib/simple_ldap/src/Controller/SimpleLdapTestController.php
modules/contrib/simple_ldap/src/Form/SimpleLdapServerSettingsForm.php
modules/contrib/simple_ldap/src/SimpleLdap.php
modules/contrib/simple_ldap/modules/simple_ldap_user/src/SimpleLdapUserSync.php
modules/contrib/simple_ldap/src/SimpleLdapConnection.php
modules/contrib/simple_ldap/src/SimpleLdapConnectionInterface.php
modules/contrib/simple_ldap/src/SimpleLdapException.php
modules/contrib/simple_ldap/src/SimpleLdapServer.php
modules/contrib/simple_ldap/src/SimpleLdapServerSchema.php
modules/contrib/simple_ldap/tests/src/Functional/SimpleLdapTest.php
modules/contrib/simple_ldap/tests/src/Unit/SimpleLdapServerTest.php
modules/contrib/simple_ldap/tests/src/Unit/SimpleLdapTestBase.php

7 files with changes
====================

1) modules/contrib/simple_ldap/modules/simple_ldap_user/src/SimpleLdapUserSync.php:121

    ---------- begin diff ----------
@@ @@
     $event = new SimpleLdapUserEvent($user, $account);
     // If save is enforced we can safely skip serialization.
     $hashed_pre = $save_happening ? '' : $this->serialize($account);
-    $this->eventDispatcher->dispatch(Events::USER_SYNCHRONIZATION, $event);
+    $this->eventDispatcher->dispatch($event, Events::USER_SYNCHRONIZATION);
     $hashed_post = $save_happening ? '' : $this->serialize($account);
     $has_changed = $hashed_pre !== $hashed_post;
     if (empty($scheduled_saves[$uuid]) && ($has_changed || $force_save)) {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector
 * MakeDispatchFirstArgumentEventRector
 * WrapReturnRector


2) modules/contrib/simple_ldap/modules/simple_ldap_user/simple_ldap_user.module:0

    ---------- begin diff ----------
@@ @@
 <?php

+use Drupal\Core\Form\FormStateInterface;
 use Drupal\Core\Cache\Cache;
 use Drupal\user\Entity\User;
 use Drupal\user\UserInterface;
@@ @@
 /**
  * Implements hook_form_FORM_ID_alter().
  */
-function simple_ldap_user_form_user_login_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
+function simple_ldap_user_form_user_login_form_alter(&$form, FormStateInterface $form_state, $form_id) {
   // Put our validation function after Drupal's auth (::validateAuthentication)
   // and before ::validateFinal. This way, we have the chance to set the uid
   // so ::validateFinal passes. By doing it this way, we still benefit from
@@ @@
 /**
  * Implements hook_form_FORM_ID_alter().
  */
-function simple_ldap_user_form_user_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
+function simple_ldap_user_form_user_form_alter(&$form, FormStateInterface $form_state, $form_id) {
   $server = \Drupal::service('simple_ldap.server');
   /** @var \Drupal\user\UserInterface $user */
   $user = $form_state->getFormObject()->getEntity();
@@ @@
  *
  * Attempts LDAP authentication for user login attempts.
  */
-function simple_ldap_user_login_validate(&$form, \Drupal\Core\Form\FormStateInterface $form_state) {
+function simple_ldap_user_login_validate(&$form, FormStateInterface $form_state) {
   $name = $form_state->getValue('name');
   $password = $form_state->getValue('pass');

@@ @@
 /**
  * Custom validation handler for the user profile form.
  */
-function simple_ldap_user_profile_validate(&$form, \Drupal\Core\Form\FormStateInterface $form_state) {
+function simple_ldap_user_profile_validate(&$form, FormStateInterface $form_state) {
   // Only do this validation if the Submit button was pressed. Otherwise, it
   // gets annoying.
   if ($form_state->getTriggeringElement() !== 'submit') {
    ----------- end diff -----------

Applied rules:
 * ArgumentRemoverRector


3) modules/contrib/simple_ldap/tests/src/Unit/SimpleLdapTestBase.php:35

    ---------- begin diff ----------
@@ @@
    *
    * @param string $config_name
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();

-    $this->config = $this->getMockBuilder('\Drupal\Core\Config\ImmutableConfig')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $this->config = $this->createMock('\Drupal\Core\Config\ImmutableConfig');

-    $this->config_factory = $this->getMockBuilder('\Drupal\Core\Config\ConfigFactory')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $this->config_factory = $this->createMock('\Drupal\Core\Config\ConfigFactory');
     $this->config_factory->expects($this->once())
       ->method('get')
       ->with($this->config_name)
    ----------- end diff -----------

Applied rules:
 * GetMockBuilderGetMockToCreateMockRector (https://github.com/lmc-eu/steward/pull/187/files#diff-c7e8c65e59b8b4ff8b54325814d4ba55L80)
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


4) modules/contrib/simple_ldap/tests/src/Unit/SimpleLdapServerTest.php:30

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();

-    $this->ldap = $this->getMockBuilder('\Drupal\simple_ldap\SimpleLdap')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $this->ldap = $this->createMock('\Drupal\simple_ldap\SimpleLdap');
   }

   /**
    ----------- end diff -----------

Applied rules:
 * GetMockBuilderGetMockToCreateMockRector (https://github.com/lmc-eu/steward/pull/187/files#diff-c7e8c65e59b8b4ff8b54325814d4ba55L80)
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


5) modules/contrib/simple_ldap/tests/src/Functional/SimpleLdapTest.php:50

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     if (!extension_loaded('ldap')) {
       $this->markTestSkipped("Skipping because the PHP LDAP extension is not enabled.");
     }
@@ @@
     $server = \Drupal::service('simple_ldap.ldap_wrapper');
     $server->connect();
     // Test that the server is connected.
-    $this->assertEqual("simple_ldap.ldap_wrapper", $server->_serviceId);
+    $this->assertEquals("simple_ldap.ldap_wrapper", $server->_serviceId);
     // Test that the server is unbound.
-    $this->assertEqual(FALSE, $server->isBound());
+    $this->assertEquals(FALSE, $server->isBound());

     // Test SimpleLdap::ldapBind().
     $server->ldapBind($this->binddn, $this->bindpw);
-    $this->assertEqual(TRUE, $server->isBound());
+    $this->assertEquals(TRUE, $server->isBound());

     // Test SimpleLdap::ldapSearch() and SimpleLdap::getEntries().
     $base_dn = 'dc=example,dc=com';
@@ @@
     $attributes = array();
     $search_results = $server->ldapSearch($base_dn, $search_filter, $attributes);
     $search_info = $server->getEntries($search_results);
-    $this->assertEqual(1, $search_info['count']);
+    $this->assertEquals(1, $search_info['count']);

     // Test SimpleLdap::ldapRead().
     $object_class_filter = 'objectClass=*';
     $read_results = $server->ldapRead($base_dn, $object_class_filter, $attributes);
     $read_info = $server->getEntries($read_results);
-    $this->assertEqual(1, $read_info['count']);
+    $this->assertEquals(1, $read_info['count']);

     // Test SimpleLdap::ldapList().
     $list_filter = "ou=mathematicians";
     $list_results = $server->ldapList($base_dn, $list_filter, $attributes);
     $list_info = $server->getEntries($list_results);
-    $this->assertEqual(1, $list_info['count']);
+    $this->assertEquals(1, $list_info['count']);
   }
 }
    ----------- end diff -----------

Applied rules:
 * AssertEqualRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


6) modules/contrib/simple_ldap/modules/simple_ldap_user/tests/src/Unit/SimpleLdapUserManagerTest.php:48

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();

-    $this->server = $this->getMockBuilder('\Drupal\simple_ldap\SimpleLdapServer')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $this->server = $this->createMock('\Drupal\simple_ldap\SimpleLdapServer');

-    $this->query_factory = $this->getMockBuilder('\Drupal\Core\Entity\Query\QueryFactory')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $this->query_factory = $this->createMock('\Drupal\Core\Entity\Query\QueryFactory');

-    $this->entity_manager = $this->getMockBuilder('\Drupal\Core\Entity\EntityTypeManager')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $this->entity_manager = $this->createMock('\Drupal\Core\Entity\EntityTypeManager');
   }

   /**
@@ @@
     $attributes = $ldap_user->getAttributes();
     $this->setUpDrupalUserTests();

-    $query = $this->getMockBuilder('\Drupal\Core\Entity\Query\QueryInterface')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $query = $this->createMock('\Drupal\Core\Entity\Query\QueryInterface');
     $query->expects($this->exactly(2))
       ->method('condition')
       ->willReturn($query);
@@ @@
       ->method('get')
       ->willReturn($query);

-    $user_storage = $this->getMockBuilder('\Drupal\user\UserStorage')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $user_storage = $this->createMock('\Drupal\user\UserStorage');
     $user_storage->expects($this->once())
       ->method('load')
       ->with(5)
@@ @@
         'mail'
       ));

-    $user_storage = $this->getMockBuilder('\Drupal\user\UserStorage')
-      ->disableOriginalConstructor()
-      ->getMock();
+    $user_storage = $this->createMock('\Drupal\user\UserStorage');

-    $user = $this->getMockBuilder('\Drupal\user\User')
-      ->disableOriginalConstructor()
-      ->setMethods(array('enforceIsNew', 'activate', 'save'))
-      ->getMock();
+    $user = $this->createMock('\Drupal\user\User');
     $user->expects($this->once())
       ->method('enforceIsNew');
     $user->expects($this->once())
    ----------- end diff -----------

Applied rules:
 * GetMockBuilderGetMockToCreateMockRector (https://github.com/lmc-eu/steward/pull/187/files#diff-c7e8c65e59b8b4ff8b54325814d4ba55L80)
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


7) modules/contrib/simple_ldap/modules/simple_ldap_user/tests/src/Functional/SimpleLdapUserTest.php:24

    ---------- begin diff ----------
@@ @@
   /**
    * {@inheritdoc}
    */
-  protected function setUp() {
+  protected function setUp(): void {
     if (!extension_loaded('ldap')) {
       $this->markTestSkipped("Skipping because the PHP LDAP extension is not enabled.");
     }
@@ @@
       'name' => 'einstein',
       'pass' => 'password',
     ];
-    $this->drupalPostForm($user_login_url, $edit, t('Log in'));
-    $this->assertText(t('New user created for einstein.'));
+    $this->drupalGet($user_login_url);
+    $this->submitForm($edit, t('Log in'));
+    $this->assertSession()->pageTextContains(t('New user created for einstein.'));

     // 2. Correct username & incorrect password.
     $edit = [
@@ @@
       'name' => 'einstein',
       'pass' => 'incorrect!',
     ];
-    $this->drupalPostForm($user_login_url, $edit, t('Log in'));
-    $this->assertText(t('Could not authenticate with your username/password in LDAP. Please contact your site administrator.'));
+    $this->drupalGet($user_login_url);
+    $this->submitForm($edit, t('Log in'));
+    $this->assertSession()->pageTextContains(t('Could not authenticate with your username/password in LDAP. Please contact your site administrator.'));

     // 3. Incorrect username & incorrect password.
     $edit = [
@@ @@
       'name' => 'nobodyNotExists',
       'pass' => 'incorrect!',
     ];
-    $this->drupalPostForm($user_login_url, $edit, t('Log in'));
-    $this->assertText(t('An account could not be found or an ID conflict has been detected. Please contact your site administrator.'));
+    $this->drupalGet($user_login_url);
+    $this->submitForm($edit, t('Log in'));
+    $this->assertSession()->pageTextContains(t('An account could not be found or an ID conflict has been detected. Please contact your site administrator.'));
   }
 }
    ----------- end diff -----------

Applied rules:
 * AssertTextRector
 * UiHelperTraitDrupalPostFormRector
 * ArgumentRemoverRector
 * WrapReturnRector
 * AddReturnTypeDeclarationRector
 * ChangeMethodVisibilityRector


 [OK] 7 files have been changed by Rector                                       


diff --git a/dark_awesome.theme b/dark_awesome.theme
index e106364..01737e1 100644
--- a/dark_awesome.theme
+++ b/dark_awesome.theme
@@ -1,5 +1,6 @@
 <?php
 
+use Drupal\file\Entity\File;
 use Drupal\Core\Form\FormStateInterface;
 
 /*
@@ -48,9 +49,9 @@ function dark_awesome_preprocess_page(&$variables) {
 
     $fid = theme_get_setting("footer_image", "dark_awesome");
     if (!empty($fid)) {
-      $file = \Drupal\file\Entity\File::load($fid[0]);
+      $file = File::load($fid[0]);
       $uri = $file->getFileUri();
-      $image_path = file_create_url($uri);
+      $image_path = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
     }
     else {
       $image_path = base_path().$variables['directory']. '/images/dark-awesome.png';
@@ -62,9 +63,9 @@ function dark_awesome_preprocess_page(&$variables) {
 
     $fid = theme_get_setting("header_image", "dark_awesome");
     if (!empty($fid)) {
-      $file = \Drupal\file\Entity\File::load($fid[0]);
+      $file = File::load($fid[0]);
       $uri = $file->getFileUri();
-      $image_path = file_create_url($uri);
+      $image_path = \Drupal::service('file_url_generator')->generateAbsoluteString($uri);
     }
     else {
       $image_path = base_path().$variables['directory']. '/images/slider.png';
@@ -73,7 +74,7 @@ function dark_awesome_preprocess_page(&$variables) {
 
 }
 
-function dark_awesome_settings_form_submit(&$form, \Drupal\Core\Form\FormStateInterface $form_state) {
+function dark_awesome_settings_form_submit(&$form, FormStateInterface $form_state) {
     $account = \Drupal::currentUser();
     $values = $form_state->getValues();
   }
diff --git a/theme-settings.php b/theme-settings.php
index a1aa387..cc1d026 100644
--- a/theme-settings.php
+++ b/theme-settings.php
@@ -259,7 +259,7 @@ function dark_awesome_form_system_theme_settings_alter(&$form, FormStateInterfac
 
     $form['#submit'][] = 'dark_awesome_settings_form_submit';
     $theme = \Drupal::theme()->getActiveTheme()->getName();    
-    $theme_file = drupal_get_path('theme', $theme) . '/dark_awesome.theme';
+    $theme_file = \Drupal::service('extension.list.theme')->getPath($theme) . '/dark_awesome.theme';
     $build_info = $form_state->getBuildInfo();
     if (!in_array($theme_file, $build_info['files'])) {
       $build_info['files'][] = $theme_file;

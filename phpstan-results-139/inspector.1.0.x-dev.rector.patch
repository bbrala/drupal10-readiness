diff --git a/d7-bk/inspector.module b/d7-bk/inspector.module
index 4c78108..317caca 100644
--- a/d7-bk/inspector.module
+++ b/d7-bk/inspector.module
@@ -47,7 +47,7 @@ function inspector_search_component() {
   $db_or = db_or();
   $db_or->condition('ic.cid', "%$search%", 'LIKE');
   $db_or->condition('ic.component_name', "%$search%", 'LIKE');
-  $matches = db_select('inspector_component', 'ic')
+  $matches = \Drupal::database()->select('inspector_component', 'ic')
     ->fields('ic', array('cid', 'component_name'))
     ->condition($db_or)
     ->execute()
@@ -58,13 +58,13 @@ function inspector_search_component() {
 function inspector_get_component($component_name) {
   //dpm($component_name, 'Inspecting Component:');
   // Step0 : get component
-  $component = db_select('inspector_component', 'ic')
+  $component = \Drupal::database()->select('inspector_component', 'ic')
     ->fields('ic', array('cid', 'component_name'))
     ->condition('ic.cid', $component_name, '=')
     ->execute()
     ->fetchAll(PDO::FETCH_ASSOC);
   // Step1 : get dependencies
-  $dependencies = db_select('inspector_structure', 'ist')
+  $dependencies = \Drupal::database()->select('inspector_structure', 'ist')
     ->fields('ist', array('dependency'))
     ->condition('ist.dependant', "$component_name", '=')
     ->execute()
@@ -72,7 +72,7 @@ function inspector_get_component($component_name) {
   $dependencies = _inspector_get_components(array_keys($dependencies));
   //dpm($dependencies, 'dependencies');
   // Step2 : get dependants
-  $dependants = db_select('inspector_structure', 'ist')
+  $dependants = \Drupal::database()->select('inspector_structure', 'ist')
     ->fields('ist', array('dependant'))
     ->condition('ist.dependency', $component_name, '=')
     ->execute()
@@ -102,7 +102,7 @@ function _inspector_get_components($cids) {
     $cids = array($cids);
   }
 
-  $components = db_select('inspector_component', 'ic')
+  $components = \Drupal::database()->select('inspector_component', 'ic')
     ->fields('ic', array('cid', 'component_name'))
     ->condition('ic.cid', $cids, 'IN')
     ->execute()
@@ -131,7 +131,7 @@ function inspector_browser_page() {
   drupal_add_js('//ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular.js', array('type' => 'external', 'scope' => 'footer'));
   drupal_add_js('//ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular-sanitize.js', array('type' => 'external', 'scope' => 'footer'));
   drupal_add_js('//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.10.0/ui-bootstrap-tpls.min.js', array('type' => 'external', 'scope' => 'footer'));
-  drupal_add_js(drupal_get_path('module', 'inspector') . '/js/inspector_browser.js', array('scope' => 'footer'));
+  drupal_add_js(\Drupal::service('extension.list.module')->getPath('inspector') . '/js/inspector_browser.js', array('scope' => 'footer'));
   $inspector_js_settings = array(
     'inspector' => array(
       'search_path' => $base_url . '/inspector/search',
@@ -156,7 +156,7 @@ function inspector_theme() {
   return array(
     'inspector_browser' => array(
       'render element' => 'elements',
-      'path' => drupal_get_path('module', 'inspector') . '/theme',
+      'path' => \Drupal::service('extension.list.module')->getPath('inspector') . '/theme',
       'template' => 'inspector-browser',
     ),
   );
@@ -204,7 +204,7 @@ function inspector_run_form($form, &$form_state) {
 
 function inspector_run_form_submit($form, $form_state) {
   variable_set('inspector_run', TRUE);
-  drupal_set_message('inspector was run');
+  \Drupal::messenger()->addStatus('inspector was run');
 
   $batch_operations = _inspector_gather_batch_operations();
 
@@ -247,11 +247,11 @@ function inspector_function_b($param, &$context) {
 }
 
 function inspector_function_finished($success, $results, $operations) {
-  drupal_set_message('operation is finished');
+  \Drupal::messenger()->addStatus('operation is finished');
 }
 
 function inspector_save_relation($dependant, $dependency, $dep_role, $dep_name) {
-  $result = db_insert('inspector_structure')
+  $result = \Drupal::database()->insert('inspector_structure')
     ->fields(array(
       'dependant' => $dependant,
       'dependency' => $dependency,
@@ -263,7 +263,7 @@ function inspector_save_relation($dependant, $dependency, $dep_role, $dep_name)
 }
 
 function inspector_save_detail($cid, $name) {
-  $result = db_insert('inspector_component')
+  $result = \Drupal::database()->insert('inspector_component')
     ->fields(array(
       'cid' => $cid,
       'component_name' => $name,
diff --git a/d7-bk/modules/panels_pages_inspector/panels_pages_inspector.module b/d7-bk/modules/panels_pages_inspector/panels_pages_inspector.module
index e20101c..137ff4d 100644
--- a/d7-bk/modules/panels_pages_inspector/panels_pages_inspector.module
+++ b/d7-bk/modules/panels_pages_inspector/panels_pages_inspector.module
@@ -8,7 +8,7 @@ function panels_pages_inspector_inspector_info() {
 }
 
 function _panels_pages_inspector_get_components_list() {
-  include_once(drupal_get_path('module', 'page_manager') . '/page_manager.admin.inc');
+  include_once(\Drupal::service('extension.list.module')->getPath('page_manager') . '/page_manager.admin.inc');
 
   // Code taken from page_manager.admin.inc:37 (page callback handler for pages list)
   $tasks = page_manager_get_tasks_by_type('page');

diff --git a/sir_trevor.module b/sir_trevor.module
index 6573730..b4c14e4 100644
--- a/sir_trevor.module
+++ b/sir_trevor.module
@@ -19,7 +19,7 @@ function sir_trevor_theme($existing, $type, $theme, $path) {
           'data' => [],
           'entity' => NULL,
         ],
-        'path' => drupal_get_path('module', $plugin->getDefiningModule()),
+        'path' => \Drupal::service('extension.list.module')->getPath($plugin->getDefiningModule()),
         'template' => $plugin->getTemplate(),
       ];
     }
diff --git a/src/ComplexDataValueProcessingEvent.php b/src/ComplexDataValueProcessingEvent.php
index 1817e44..b10ded6 100644
--- a/src/ComplexDataValueProcessingEvent.php
+++ b/src/ComplexDataValueProcessingEvent.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\sir_trevor;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class ComplexDataValueProcessingEvent
diff --git a/src/Controller/ImageStorage.php b/src/Controller/ImageStorage.php
index 5884de7..55ac9b5 100644
--- a/src/Controller/ImageStorage.php
+++ b/src/Controller/ImageStorage.php
@@ -27,7 +27,7 @@ class ImageStorage extends ControllerBase {
       $extension = $extensionGuesser->guess($mime);
       $filename = "public://contentbuilder/{$baseFileName}-{$id}.{$extension}";
 
-      $file = file_save_data($image, $filename);
+      $file = \Drupal::service('file.repository')->writeData($image, $filename);
       $images[$id] = $file;
     }
 
diff --git a/src/EventDispatchingDataProcessor.php b/src/EventDispatchingDataProcessor.php
index 3851417..e7ee1fd 100644
--- a/src/EventDispatchingDataProcessor.php
+++ b/src/EventDispatchingDataProcessor.php
@@ -73,7 +73,7 @@ class EventDispatchingDataProcessor {
     $eventName = ComplexDataValueProcessingEvent::class;
 
     /** @var ComplexDataValueProcessingEvent $event */
-    $event = $this->eventDispatcher->dispatch($eventName, $event);
+    $event = $this->eventDispatcher->dispatch($event, $eventName);
     return $event;
   }
 
diff --git a/tests/src/Unit/AnnotationAsserter.php b/tests/src/Unit/AnnotationAsserter.php
index 471f47a..e8caa7c 100644
--- a/tests/src/Unit/AnnotationAsserter.php
+++ b/tests/src/Unit/AnnotationAsserter.php
@@ -19,7 +19,7 @@ trait AnnotationAsserter {
    */
   protected function assertClassAnnotationsMatch(array $expectedAnnotations, $classToTest) {
     $annotations = $this->getClassAnnotations($classToTest);
-    \PHPUnit_Framework_Assert::assertEquals($expectedAnnotations, $annotations);
+    \PHPUnit\Framework\Assert::assertEquals($expectedAnnotations, $annotations);
   }
 
   /**
diff --git a/tests/src/Unit/FieldFormatter/EventDispatchingDataProcessorTest.php b/tests/src/Unit/FieldFormatter/EventDispatchingDataProcessorTest.php
index 80bcfa1..ecf3b17 100644
--- a/tests/src/Unit/FieldFormatter/EventDispatchingDataProcessorTest.php
+++ b/tests/src/Unit/FieldFormatter/EventDispatchingDataProcessorTest.php
@@ -12,7 +12,7 @@ use Drupal\Tests\sir_trevor\Unit\TestDoubles\EventDispatcherSpy;
  *
  * @package Drupal\sir_trevor\Tests\Unit\FieldFormatter
  */
-class EventDispatchingDataProcessorTest extends \PHPUnit_Framework_TestCase {
+class EventDispatchingDataProcessorTest extends \PHPUnit\Framework\TestCase {
   /** @var EventDispatcherSpy */
   private $dispatcher;
   /** @var EventDispatchingDataProcessor */
diff --git a/tests/src/Unit/FieldFormatter/SirTrevorTest.php b/tests/src/Unit/FieldFormatter/SirTrevorTest.php
index ee27571..2c9b0f2 100644
--- a/tests/src/Unit/FieldFormatter/SirTrevorTest.php
+++ b/tests/src/Unit/FieldFormatter/SirTrevorTest.php
@@ -25,7 +25,7 @@ class SirTrevorTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     \Drupal::setContainer(new Container());
diff --git a/tests/src/Unit/FieldType/SirTrevorTest.php b/tests/src/Unit/FieldType/SirTrevorTest.php
index 4d82750..1dcbbf8 100644
--- a/tests/src/Unit/FieldType/SirTrevorTest.php
+++ b/tests/src/Unit/FieldType/SirTrevorTest.php
@@ -20,7 +20,7 @@ class SirTrevorTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
 
     \Drupal::setContainer(new Container());
diff --git a/tests/src/Unit/FieldWidget/SirTrevorTest.php b/tests/src/Unit/FieldWidget/SirTrevorTest.php
index 25f8ed3..a89a699 100644
--- a/tests/src/Unit/FieldWidget/SirTrevorTest.php
+++ b/tests/src/Unit/FieldWidget/SirTrevorTest.php
@@ -35,7 +35,7 @@ class SirTrevorTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     parent::setUp();
     $this->pluginManagerMock = new SirTrevorPluginManagerMock();
 
diff --git a/tests/src/Unit/IconSvgMergerTest.php b/tests/src/Unit/IconSvgMergerTest.php
index 4d342fb..77d337e 100644
--- a/tests/src/Unit/IconSvgMergerTest.php
+++ b/tests/src/Unit/IconSvgMergerTest.php
@@ -10,7 +10,7 @@ use Symfony\Component\HttpKernel\Tests\Logger;
  * @package Drupal\sir_trevor\Tests
  * @group SirTrevor
  */
-class IconSvgMergerTest extends \PHPUnit_Framework_TestCase {
+class IconSvgMergerTest extends \PHPUnit\Framework\TestCase {
   /** @var Logger */
   protected $logger;
 
diff --git a/tests/src/Unit/IconsControllerTest.php b/tests/src/Unit/IconsControllerTest.php
index 7fbb430..5c8debf 100644
--- a/tests/src/Unit/IconsControllerTest.php
+++ b/tests/src/Unit/IconsControllerTest.php
@@ -15,7 +15,7 @@ define('DRUPAL_ROOT','ROOT');
  * @package Drupal\sir_trevor\Tests
  * @group SirTrevor
  */
-class IconsControllerTest extends \PHPUnit_Framework_TestCase {
+class IconsControllerTest extends \PHPUnit\Framework\TestCase {
   /** @var SirTrevorPluginManagerMock */
   private $blockPluginManager;
   /** @var IconSvgMergerMock */
diff --git a/tests/src/Unit/LibraryInfoBuilderTest.php b/tests/src/Unit/LibraryInfoBuilderTest.php
index 4980fa5..4870422 100644
--- a/tests/src/Unit/LibraryInfoBuilderTest.php
+++ b/tests/src/Unit/LibraryInfoBuilderTest.php
@@ -11,7 +11,7 @@ use Drupal\Tests\sir_trevor\Unit\TestDoubles\SirTrevorPluginManagerMock;
 /**
  * @group SirTrevor
  */
-class LibraryInfoBuilderTest extends \PHPUnit_Framework_TestCase {
+class LibraryInfoBuilderTest extends \PHPUnit\Framework\TestCase {
   /** @var SirTrevorPluginManagerMock */
   private $blockPluginManager;
   /** @var LibraryInfoBuilder */
diff --git a/tests/src/Unit/Plugin/SirTrevorBlockPluginTest.php b/tests/src/Unit/Plugin/SirTrevorBlockPluginTest.php
index 971e19a..583cf6b 100644
--- a/tests/src/Unit/Plugin/SirTrevorBlockPluginTest.php
+++ b/tests/src/Unit/Plugin/SirTrevorBlockPluginTest.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\sir_trevor\Tests\Unit\Plugin;
 
+use Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException;
 use Drupal\sir_trevor\Plugin\SirTrevorBlock;
 use Drupal\Tests\UnitTestCase;
 
@@ -19,10 +20,10 @@ class SirTrevorBlockPluginTest extends UnitTestCase {
 
   /**
    * @test
-   * @expectedException \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
-   * @expectedExceptionMessage "some_id" must define "template".
    */
   public function definitionWithoutTemplate() {
+    $this->expectException(InvalidPluginDefinitionException::class);
+    $this->expectExceptionMessage('"some_id" must define "template".');
     new SirTrevorBlock($this->getDefinitionBase());
   }
 }
diff --git a/tests/src/Unit/Plugin/SirTrevorPluginManagerTest.php b/tests/src/Unit/Plugin/SirTrevorPluginManagerTest.php
index 9467292..0a49d81 100644
--- a/tests/src/Unit/Plugin/SirTrevorPluginManagerTest.php
+++ b/tests/src/Unit/Plugin/SirTrevorPluginManagerTest.php
@@ -2,6 +2,8 @@
 
 namespace Drupal\sir_trevor\Tests\Unit\Plugin;
 
+use Drupal\Component\Plugin\Exception\PluginNotFoundException;
+use Drupal\Component\Plugin\Exception\PluginException;
 use Drupal\Component\FileCache\FileCacheFactory;
 use Drupal\sir_trevor\Plugin\SirTrevorBlock;
 use Drupal\sir_trevor\Plugin\SirTrevorBlockPlugin;
@@ -25,7 +27,7 @@ class SirTrevorPluginManagerTest extends UnitTestCase {
   /**
    * {@inheritdoc}
    */
-  public function setUp() {
+  public function setUp(): void {
     FileCacheFactory::setPrefix('prefix');
     $this->moduleHandler = new ModuleHandlerMock();
     $directories = [
@@ -48,10 +50,10 @@ class SirTrevorPluginManagerTest extends UnitTestCase {
 
   /**
    * @test
-   * @expectedException \Drupal\Component\Plugin\Exception\PluginNotFoundException
-   * @expectedExceptionMessage The "unknown" plugin does not exist.
    */
   public function getUnknownDefinition() {
+    $this->expectException(PluginNotFoundException::class);
+    $this->expectExceptionMessage('The "unknown" plugin does not exist.');
     $this->getSut()->getDefinition('unknown');
   }
 
@@ -80,10 +82,10 @@ class SirTrevorPluginManagerTest extends UnitTestCase {
 
   /**
    * @test
-   * @expectedException \Drupal\Component\Plugin\Exception\PluginException
-   * @expectedExceptionMessage The "unknown" plugin does not exist.
    */
   public function createInstanceWithInvalidPlugin() {
+    $this->expectException(PluginException::class);
+    $this->expectExceptionMessage('The "unknown" plugin does not exist.');
     $this->getSut()->createInstance('unknown');
   }
 
diff --git a/tests/src/Unit/TestDoubles/EventDispatcherDummy.php b/tests/src/Unit/TestDoubles/EventDispatcherDummy.php
index e197c7f..abe8422 100644
--- a/tests/src/Unit/TestDoubles/EventDispatcherDummy.php
+++ b/tests/src/Unit/TestDoubles/EventDispatcherDummy.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\Tests\sir_trevor\Unit\TestDoubles;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 use Symfony\Component\EventDispatcher\EventDispatcherInterface;
 use Symfony\Component\EventDispatcher\EventSubscriberInterface;
 
diff --git a/tests/src/Unit/TestDoubles/EventDispatcherMock.php b/tests/src/Unit/TestDoubles/EventDispatcherMock.php
index bccc471..db6da85 100644
--- a/tests/src/Unit/TestDoubles/EventDispatcherMock.php
+++ b/tests/src/Unit/TestDoubles/EventDispatcherMock.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\Tests\sir_trevor\Unit\TestDoubles;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class EventDispatcherMock
diff --git a/tests/src/Unit/TestDoubles/EventDispatcherSpy.php b/tests/src/Unit/TestDoubles/EventDispatcherSpy.php
index 63adb29..9d14a47 100644
--- a/tests/src/Unit/TestDoubles/EventDispatcherSpy.php
+++ b/tests/src/Unit/TestDoubles/EventDispatcherSpy.php
@@ -2,7 +2,7 @@
 
 namespace Drupal\Tests\sir_trevor\Unit\TestDoubles;
 
-use Symfony\Component\EventDispatcher\Event;
+use Symfony\Contracts\EventDispatcher\Event;
 
 /**
  * Class EventDispatcherSpy
